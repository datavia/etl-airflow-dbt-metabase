{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0b2", "generated_at": "2025-04-28T12:21:10.390049Z", "invocation_id": "05dde9c7-5285-4016-b92a-a78387b6674e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T12:18:57.726392Z", "completed_at": "2025-04-28T12:18:57.761796Z"}, {"name": "execute", "started_at": "2025-04-28T12:18:57.762504Z", "completed_at": "2025-04-28T12:20:54.956848Z"}], "thread_id": "Thread-4", "execution_time": 117.23607158660889, "adapter_response": {"_message": "SELECT 6767169", "code": "SELECT", "rows_affected": 6767169}, "message": "SELECT 6767169", "failures": null, "unique_id": "model.dbt_lab08_project.ods_location_events_dbt", "compiled": true, "compiled_code": "\n\nselect load_dttm,\n       (json_data->>'event_id')::uuid event_id,\n        json_data->>'page_url' page_url,\n        json_data->>'page_url_path' page_url_path,\n        json_data->>'referer_url' referer_url,\n        json_data->>'referer_medium' referer_medium,\n        json_data->>'utm_medium' utm_medium,\n        json_data->>'utm_source' utm_source,\n        json_data->>'utm_content' utm_content,\n        json_data->>'utm_campaign' utm_campaign\n  from \"lab08_db\".\"stg\".\"stg_location_events\"\n\n", "relation_name": "\"lab08_db\".\"ods_ods\".\"ods_location_events_dbt\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T12:18:57.742112Z", "completed_at": "2025-04-28T12:18:57.799832Z"}, {"name": "execute", "started_at": "2025-04-28T12:18:57.841619Z", "completed_at": "2025-04-28T12:20:55.017165Z"}], "thread_id": "Thread-3", "execution_time": 117.30007123947144, "adapter_response": {"_message": "SELECT 6746937", "code": "SELECT", "rows_affected": 6746937}, "message": "SELECT 6746937", "failures": null, "unique_id": "model.dbt_lab08_project.ods_geo_events_dbt", "compiled": true, "compiled_code": "\n\nselect load_dttm,\n       (json_data->>'click_id')::uuid click_id,\n        (json_data->>'geo_latitude')::float geo_latitude,\n        (json_data->>'geo_longitude')::float geo_longitude,\n        json_data->>'geo_country' geo_country,\n        json_data->>'geo_timezone' geo_timezone,\n        json_data->>'geo_region_name' geo_region_name,\n        json_data->>'ip_address' ip_address\n  from \"lab08_db\".\"stg\".\"stg_geo_events\"\n\n", "relation_name": "\"lab08_db\".\"ods_ods\".\"ods_geo_events_dbt\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T12:18:57.734868Z", "completed_at": "2025-04-28T12:18:57.760611Z"}, {"name": "execute", "started_at": "2025-04-28T12:18:57.774005Z", "completed_at": "2025-04-28T12:21:00.300987Z"}], "thread_id": "Thread-2", "execution_time": 122.59295845031738, "adapter_response": {"_message": "SELECT 6767169", "code": "SELECT", "rows_affected": 6767169}, "message": "SELECT 6767169", "failures": null, "unique_id": "model.dbt_lab08_project.ods_device_events_dbt", "compiled": true, "compiled_code": "\n\nselect  load_dttm,\n\n       (json_data->>'click_id')::uuid click_id,\n        json_data->>'os' os,\n        json_data->>'os_name' os_name,\n        json_data->>'os_timezone' os_timezone,\n        json_data->>'device_type' device_type,\n        (json_data->>'device_is_mobile')::bool device_is_mobile,\n        json_data->>'user_custom_id' user_custom_id,\n        (json_data->>'user_domain_id')::uuid user_domain_id\n  from \"lab08_db\".\"stg\".\"stg_device_events\"\n\n", "relation_name": "\"lab08_db\".\"ods_ods\".\"ods_device_events_dbt\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T12:18:57.691430Z", "completed_at": "2025-04-28T12:18:57.747863Z"}, {"name": "execute", "started_at": "2025-04-28T12:18:57.749099Z", "completed_at": "2025-04-28T12:21:10.200164Z"}], "thread_id": "Thread-1", "execution_time": 132.51601648330688, "adapter_response": {"_message": "SELECT 6767169", "code": "SELECT", "rows_affected": 6767169}, "message": "SELECT 6767169", "failures": null, "unique_id": "model.dbt_lab08_project.ods_browser_events_dbt", "compiled": true, "compiled_code": "\n\nselect load_dttm,\n       (json_data->>'event_id')::uuid event_id,\n       (json_data->>'event_timestamp')::timestamp event_timestamp,\n       json_data->>'event_type' event_type,\n       (json_data->>'click_id')::uuid click_id,\n       json_data->>'browser_name' browser_name,\n       json_data->>'browser_user_agent' browser_user_agent,\n       json_data->>'browser_language' browser_language\n  from \"lab08_db\".\"stg\".\"stg_browser_events\"\n\n", "relation_name": "\"lab08_db\".\"ods_ods\".\"ods_browser_events_dbt\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-04-28T12:21:10.224101Z", "completed_at": "2025-04-28T12:21:10.236954Z"}, {"name": "execute", "started_at": "2025-04-28T12:21:10.247939Z", "completed_at": "2025-04-28T12:21:10.312426Z"}], "thread_id": "Thread-4", "execution_time": 0.11373162269592285, "adapter_response": {}, "message": "Database Error in model dm_events_dbt (models/dm/dm_events_dbt.sql)\n  column e.load_hour does not exist\n  LINE 20:  e.load_hour,\n            ^\n  compiled code at target/run/dbt_lab08_project/models/dm/dm_events_dbt.sql", "failures": null, "unique_id": "model.dbt_lab08_project.dm_events_dbt", "compiled": true, "compiled_code": "WITH distinct_clicks AS (\n\tSELECT DISTINCT\n\t\tclick_id,\n\t\tdevice_type\n\tFROM \"lab08_db\".\"ods_ods\".\"ods_device_events_dbt\"\n)\nSELECT\n\te.load_hour,\n\te.event_id,\n\te.event_type,\n\te.event_timestamp,\n\tEXTRACT(HOUR FROM e.event_timestamp) AS event_hour,\n\te.browser_name,\n\td.device_type\nFROM \"lab08_db\".\"ods_ods\".\"ods_browser_events_dbt\" e\nJOIN distinct_clicks d USING(click_id)\n", "relation_name": "\"lab08_db\".\"ods\".\"dm_events_dbt\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-04-28T12:21:10.214668Z", "completed_at": "2025-04-28T12:21:10.235275Z"}, {"name": "execute", "started_at": "2025-04-28T12:21:10.237596Z", "completed_at": "2025-04-28T12:21:10.315192Z"}], "thread_id": "Thread-3", "execution_time": 0.10950684547424316, "adapter_response": {}, "message": "Database Error in model dm_sales (models/dm/dm_sales.sql)\n  column obe.load_hour does not exist\n  LINE 31:     obe.load_hour,\n               ^\n  compiled code at target/run/dbt_lab08_project/models/dm/dm_sales.sql", "failures": null, "unique_id": "model.dbt_lab08_project.dm_sales", "compiled": true, "compiled_code": "WITH unique_devices AS (\nSELECT DISTINCT \n\tclick_id,\n\tos,\n\tos_name,\n\tdevice_type,\n\tuser_custom_id\nFROM \"lab08_db\".\"ods_ods\".\"ods_device_events_dbt\"\n),\nunique_geo AS (\nSELECT DISTINCT\n\tclick_id,\n\tgeo_country,\n\tgeo_region_name\nFROM \"lab08_db\".\"ods_ods\".\"ods_geo_events_dbt\"\n),\ncte_lead AS (\nSELECT\n    obe.load_hour,\n\tevent_timestamp,\n\tevent_type,\n\tpage_url,\n\tpage_url_path,\n\treferer_url,\n\treferer_medium,\n\tutm_medium,\n\tutm_source,\n\tutm_content,\n\tutm_campaign,\n\tbrowser_name,\n\tbrowser_user_agent,\n\tbrowser_language,\n\tos,\n\tos_name,\n\tuser_custom_id,\n\tdevice_type,\n\tgeo_country,\n\tgeo_region_name,\n    LEAD(page_url_path, 1) OVER w AS next_page_lead1,\n    LEAD(page_url_path, 2) OVER w AS next_page_lead2,\n    LEAD(page_url_path, 3) OVER w AS next_page_lead3,\n    LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp\nFROM \"lab08_db\".\"ods_ods\".\"ods_location_events_dbt\" ole\nJOIN \"lab08_db\".\"ods_ods\".\"ods_browser_events_dbt\" obe ON ole.event_id = obe.event_id\nJOIN unique_devices ud ON obe.click_id = ud.click_id\nJOIN unique_geo ug ON ug.click_id = obe.click_id\nWHERE ole.page_url_path != '/home'\n\nWINDOW w AS (\n\tPARTITION BY user_custom_id\n\tORDER BY event_timestamp\n\t)\n)\nSELECT\n    load_hour,\n\tuser_custom_id AS sale_custom_id,\n\tevent_timestamp,\n\tconfirmation_timestamp AS sale_timestamp,\n\tEXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,\n\t1 AS sale_item_cnt,\n\tbrowser_name AS sale_browser,\n\tdevice_type AS sale_platform,\n\tpage_url_path AS sale_page_before,\n\tREPLACE(page_url_path, '/product_', '') AS clear_sale_page_before,\n\tutm_source AS sale_source,\n\tutm_campaign AS sale_utm_campaign,\n\treferer_url AS sale_referer_url,\n\treferer_medium AS sale_referer_medium,\n\tutm_content AS sale_utm_content,\n\tgeo_country AS sale_geo_country,\n\tgeo_region_name AS sale_geo_region_name\nFROM cte_lead\nWHERE (next_page_lead1, next_page_lead2, next_page_lead3) = ('/cart', '/payment', '/confirmation')\nAND page_url_path NOT IN ('/payment', '/cart')", "relation_name": "\"lab08_db\".\"ods\".\"dm_sales\"", "batch_results": null}], "elapsed_time": 133.10980415344238, "args": {"profiles_dir": "/dbt", "send_anonymous_usage_stats": true, "vars": {}, "empty": false, "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "skip_nodes_if_on_run_start_fails": false, "indirect_selection": "eager", "log_format_file": "debug", "partial_parse": true, "quiet": false, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "/dbt", "log_file_max_bytes": 10485760, "printer_width": 80, "write_json": true, "macro_debugging": false, "defer": false, "require_resource_names_without_spaces": false, "log_format": "default", "print": true, "log_path": "/dbt/logs", "partial_parse_file_diff": true, "favor_state": false, "log_level_file": "debug", "version_check": true, "introspect": true, "which": "run", "require_explicit_package_overrides_for_builtin_materializations": true, "exclude": [], "use_colors_file": true, "state_modified_compare_vars": false, "show_resource_report": false, "use_colors": true, "log_level": "info", "select": [], "source_freshness_run_project_hooks": false, "invocation_command": "dbt run --profiles-dir /dbt --project-dir /dbt", "static_parser": true, "populate_cache": true}}