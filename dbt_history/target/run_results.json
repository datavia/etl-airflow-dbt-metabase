{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-04-30T14:18:23.211337Z", "invocation_id": "5d9b3716-d7e0-42d7-b665-df247f0521c1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:16:28.691467Z", "completed_at": "2025-04-30T14:16:28.782279Z"}, {"name": "execute", "started_at": "2025-04-30T14:16:28.786513Z", "completed_at": "2025-04-30T14:17:26.065556Z"}], "thread_id": "Thread-3", "execution_time": 57.377323150634766, "adapter_response": {"_message": "INSERT 0 18159", "code": "INSERT", "rows_affected": 18159}, "message": "INSERT 0 18159", "failures": null, "unique_id": "model.dbt_lab08_project.ods_geo_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'click_id')::uuid as click_id,\n    (json_data ->> 'geo_latitude')::float as geo_latitude,\n    (json_data ->> 'geo_longitude')::float as geo_longitude,\n    json_data ->> 'geo_country' as geo_country,\n    json_data ->> 'geo_timezone' as geo_timezone,\n    json_data ->> 'geo_region_name' as geo_region_name,\n    json_data ->> 'ip_address' as ip_address\nfrom \"lab08_db\".\"stg\".\"stg_geo_events\"\n\n\n    where load_dttm >= '2025-04-30T11:00:00' and load_dttm < '2025-04-30T12:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_geo_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:16:28.679503Z", "completed_at": "2025-04-30T14:16:28.819355Z"}, {"name": "execute", "started_at": "2025-04-30T14:16:28.820473Z", "completed_at": "2025-04-30T14:17:30.064460Z"}], "thread_id": "Thread-1", "execution_time": 61.3901104927063, "adapter_response": {"_message": "INSERT 0 18159", "code": "INSERT", "rows_affected": 18159}, "message": "INSERT 0 18159", "failures": null, "unique_id": "model.dbt_lab08_project.ods_browser_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'event_id')::uuid as event_id,\n    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,\n    (json_data ->> 'click_id')::uuid as click_id,\n    json_data ->> 'event_type' as event_type,\n    json_data ->> 'browser_name' as browser_name,\n    json_data ->> 'browser_user_agent' as browser_user_agent,\n    json_data ->> 'browser_language' as browser_language\nfrom \"lab08_db\".\"stg\".\"stg_browser_events\"\n\n\n    where load_dttm >= '2025-04-30T11:00:00' and load_dttm < '2025-04-30T12:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_browser_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:16:28.692842Z", "completed_at": "2025-04-30T14:16:28.771422Z"}, {"name": "execute", "started_at": "2025-04-30T14:16:28.773436Z", "completed_at": "2025-04-30T14:17:30.831310Z"}], "thread_id": "Thread-4", "execution_time": 62.1408429145813, "adapter_response": {"_message": "INSERT 0 18159", "code": "INSERT", "rows_affected": 18159}, "message": "INSERT 0 18159", "failures": null, "unique_id": "model.dbt_lab08_project.ods_location_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'event_id')::uuid as event_id,\n    json_data ->> 'page_url' as page_url,\n    json_data ->> 'page_url_path' as page_url_path,\n    json_data ->> 'referer_url' as referer_url,\n    json_data ->> 'referer_medium' as referer_medium,\n    json_data ->> 'utm_medium' as utm_medium,\n    json_data ->> 'utm_source' as utm_source,\n    json_data ->> 'utm_content' as utm_content,\n    json_data ->> 'utm_campaign' as utm_campaign\nfrom \"lab08_db\".\"stg\".\"stg_location_events\"\n\n\n    where load_dttm >= '2025-04-30T11:00:00' and load_dttm < '2025-04-30T12:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_location_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:16:28.687801Z", "completed_at": "2025-04-30T14:16:28.809526Z"}, {"name": "execute", "started_at": "2025-04-30T14:16:28.811152Z", "completed_at": "2025-04-30T14:17:36.257042Z"}], "thread_id": "Thread-2", "execution_time": 67.57201957702637, "adapter_response": {"_message": "INSERT 0 18159", "code": "INSERT", "rows_affected": 18159}, "message": "INSERT 0 18159", "failures": null, "unique_id": "model.dbt_lab08_project.ods_device_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'click_id')::uuid as click_id,\n    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,\n    (json_data ->> 'user_domain_id')::uuid as user_domain_id,\n    json_data ->> 'os' as os,\n    json_data ->> 'os_name' as os_name,\n    json_data ->> 'os_timezone' as os_timezone,\n    json_data ->> 'device_type' as device_type,\n    json_data ->> 'user_custom_id' as user_custom_id\nfrom \"lab08_db\".\"stg\".\"stg_device_events\"\n\n\n    where load_dttm >= '2025-04-30T11:00:00' and load_dttm < '2025-04-30T12:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_device_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:17:36.285135Z", "completed_at": "2025-04-30T14:17:36.342994Z"}, {"name": "execute", "started_at": "2025-04-30T14:17:36.344005Z", "completed_at": "2025-04-30T14:18:03.221515Z"}], "thread_id": "Thread-3", "execution_time": 26.940043449401855, "adapter_response": {"_message": "INSERT 0 18159", "code": "INSERT", "rows_affected": 18159}, "message": "INSERT 0 18159", "failures": null, "unique_id": "model.dbt_lab08_project.dm_events", "compiled": true, "compiled_code": "\n\n\nwith distinct_clicks as (\n    select distinct\n        click_id,\n        device_type\n    from \"lab08_db\".\"ods\".\"ods_device_events\"\n)\n\nselect\n    e.load_hour,\n    e.event_id,\n    e.event_type,\n    e.event_timestamp,\n    e.browser_name,\n    d.device_type,\n    EXTRACT(hour from e.event_timestamp) as event_hour\nfrom \"lab08_db\".\"ods\".\"ods_browser_events\" as e\ninner join distinct_clicks as d on e.click_id = d.click_id\n\n    where load_hour >= '2025-04-30T11:00:00' and load_hour < '2025-04-30T12:00:00'\n", "relation_name": "\"lab08_db\".\"dm\".\"dm_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:17:36.313177Z", "completed_at": "2025-04-30T14:17:36.361958Z"}, {"name": "execute", "started_at": "2025-04-30T14:17:36.392560Z", "completed_at": "2025-04-30T14:18:23.150082Z"}], "thread_id": "Thread-1", "execution_time": 46.850093126297, "adapter_response": {"_message": "INSERT 0 1007", "code": "INSERT", "rows_affected": 1007}, "message": "INSERT 0 1007", "failures": null, "unique_id": "model.dbt_lab08_project.dm_sales", "compiled": true, "compiled_code": "\n\n\nwith unique_devices as (\n    select distinct\n        click_id,\n        os,\n        os_name,\n        device_type,\n        user_custom_id\n    from \"lab08_db\".\"ods\".\"ods_device_events\"\n),\n\nunique_geo as (\n    select distinct\n        click_id,\n        geo_country,\n        geo_region_name,\n        geo_latitude,\n        geo_longitude\n    from \"lab08_db\".\"ods\".\"ods_geo_events\"\n),\n\ncte_lead as (\n    select\n        obe.load_hour,\n        event_timestamp,\n        event_type,\n        page_url,\n        page_url_path,\n        referer_url,\n        referer_medium,\n        utm_medium,\n        utm_source,\n        utm_content,\n        utm_campaign,\n        browser_name,\n        browser_user_agent,\n        browser_language,\n        os,\n        os_name,\n        user_custom_id,\n        device_type,\n        geo_country,\n        geo_region_name,\n        geo_latitude,\n        geo_longitude,\n        LEAD(page_url_path, 1) over w as next_page_lead1,\n        LEAD(page_url_path, 2) over w as next_page_lead2,\n        LEAD(page_url_path, 3) over w as next_page_lead3,\n        LEAD(event_timestamp, 3) over w as confirmation_timestamp\n    from \"lab08_db\".\"ods\".\"ods_location_events\" as ole\n    inner join\n        \"lab08_db\".\"ods\".\"ods_browser_events\" as obe\n        on ole.event_id = obe.event_id\n    inner join unique_devices as ud on obe.click_id = ud.click_id\n    inner join unique_geo as ug on obe.click_id = ug.click_id\n    where\n        ole.page_url_path != '/home'\n        \n            and ole.load_hour >= '2025-04-30T11:00:00' and ole.load_hour < '2025-04-30T12:00:00'\n            and obe.load_hour >= '2025-04-30T11:00:00' and obe.load_hour < '2025-04-30T12:00:00'\n        \n    window w as (\n        partition by user_custom_id\n        order by event_timestamp\n    )\n)\n\nselect\n    load_hour,\n    user_custom_id as sale_custom_id,\n    event_timestamp,\n    confirmation_timestamp as sale_timestamp,\n    1 as sale_item_cnt,\n    browser_name as sale_browser,\n    device_type as sale_platform,\n    page_url_path as sale_page_before,\n    utm_source as sale_source,\n    utm_campaign as sale_utm_campaign,\n    referer_url as sale_referer_url,\n    referer_medium as sale_referer_medium,\n    utm_content as sale_utm_content,\n    geo_country as sale_geo_country,\n    geo_region_name as sale_geo_region_name,\n    geo_latitude as sale_geo_latitude,\n    geo_longitude as sale_geo_longitude,\n    EXTRACT(hour from confirmation_timestamp) as sale_hour,\n    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,\n    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,\n    COALESCE(i.item_ru, '') as clear_sale_page_before_ru\nfrom cte_lead\nleft join \"lab08_db\".\"ods\".\"italian_cities\" as ic on ic.city_en = geo_region_name\nleft join\n    \"lab08_db\".\"ods\".\"items\" as i\n    on i.item_en = REPLACE(page_url_path, '/product_', '')\nwhere\n    (next_page_lead1, next_page_lead2, next_page_lead3)\n    = ('/cart', '/payment', '/confirmation')\n    and page_url_path not in ('/payment', '/cart', '/confirmation')", "relation_name": "\"lab08_db\".\"dm\".\"dm_sales\""}], "elapsed_time": 114.94429588317871, "args": {"write_json": true, "exclude": [], "partial_parse_file_diff": true, "log_format_file": "debug", "use_colors": true, "log_path": "/dbt_history/logs", "print": true, "introspect": true, "indirect_selection": "eager", "empty": false, "macro_debugging": false, "defer": false, "quiet": false, "use_colors_file": true, "printer_width": 80, "log_level": "info", "show_resource_report": false, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {"start_date": "2025-04-30T11:00:00", "end_date": "2025-04-30T12:00:00"}, "log_format": "default", "enable_legacy_logger": false, "profiles_dir": "/dbt_history", "partial_parse": true, "send_anonymous_usage_stats": true, "strict_mode": false, "invocation_command": "dbt run --profiles-dir /dbt_history --project-dir /dbt_history --vars {\"start_date\": \"2025-04-30T11:00:00\", \"end_date\": \"2025-04-30T12:00:00\"}", "populate_cache": true, "version_check": true, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": false, "log_level_file": "debug", "static_parser": true, "select": [], "require_resource_names_without_spaces": false, "favor_state": false, "project_dir": "/dbt_history", "which": "run", "warn_error_options": {"include": [], "exclude": []}}}