{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-04-30T13:09:25.932875Z", "invocation_id": "52cbf527-e15f-46c3-b454-d65c552c90da", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T12:49:24.311820Z", "completed_at": "2025-04-30T12:49:24.490357Z"}, {"name": "execute", "started_at": "2025-04-30T12:49:24.509893Z", "completed_at": "2025-04-30T12:50:21.181250Z"}], "thread_id": "Thread-3", "execution_time": 56.8844313621521, "adapter_response": {"_message": "INSERT 0 12088", "code": "INSERT", "rows_affected": 12088}, "message": "INSERT 0 12088", "failures": null, "unique_id": "model.dbt_lab08_project.ods_geo_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'click_id')::uuid as click_id,\n    (json_data ->> 'geo_latitude')::float as geo_latitude,\n    (json_data ->> 'geo_longitude')::float as geo_longitude,\n    json_data ->> 'geo_country' as geo_country,\n    json_data ->> 'geo_timezone' as geo_timezone,\n    json_data ->> 'geo_region_name' as geo_region_name,\n    json_data ->> 'ip_address' as ip_address\nfrom \"lab08_db\".\"stg\".\"stg_geo_events\"\n\n\n    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_geo_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T12:49:24.302034Z", "completed_at": "2025-04-30T12:49:24.442800Z"}, {"name": "execute", "started_at": "2025-04-30T12:49:24.452758Z", "completed_at": "2025-04-30T12:50:26.803619Z"}], "thread_id": "Thread-4", "execution_time": 62.50577998161316, "adapter_response": {"_message": "INSERT 0 12088", "code": "INSERT", "rows_affected": 12088}, "message": "INSERT 0 12088", "failures": null, "unique_id": "model.dbt_lab08_project.ods_location_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'event_id')::uuid as event_id,\n    json_data ->> 'page_url' as page_url,\n    json_data ->> 'page_url_path' as page_url_path,\n    json_data ->> 'referer_url' as referer_url,\n    json_data ->> 'referer_medium' as referer_medium,\n    json_data ->> 'utm_medium' as utm_medium,\n    json_data ->> 'utm_source' as utm_source,\n    json_data ->> 'utm_content' as utm_content,\n    json_data ->> 'utm_campaign' as utm_campaign\nfrom \"lab08_db\".\"stg\".\"stg_location_events\"\n\n\n    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_location_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T12:49:24.312029Z", "completed_at": "2025-04-30T12:49:24.432613Z"}, {"name": "execute", "started_at": "2025-04-30T12:49:24.434324Z", "completed_at": "2025-04-30T12:50:31.234851Z"}], "thread_id": "Thread-1", "execution_time": 66.94059300422668, "adapter_response": {"_message": "INSERT 0 12088", "code": "INSERT", "rows_affected": 12088}, "message": "INSERT 0 12088", "failures": null, "unique_id": "model.dbt_lab08_project.ods_browser_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'event_id')::uuid as event_id,\n    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,\n    (json_data ->> 'click_id')::uuid as click_id,\n    json_data ->> 'event_type' as event_type,\n    json_data ->> 'browser_name' as browser_name,\n    json_data ->> 'browser_user_agent' as browser_user_agent,\n    json_data ->> 'browser_language' as browser_language\nfrom \"lab08_db\".\"stg\".\"stg_browser_events\"\n\n\n    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_browser_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T12:49:24.314728Z", "completed_at": "2025-04-30T12:49:24.445897Z"}, {"name": "execute", "started_at": "2025-04-30T12:49:24.446720Z", "completed_at": "2025-04-30T12:50:35.562069Z"}], "thread_id": "Thread-2", "execution_time": 71.25131297111511, "adapter_response": {"_message": "INSERT 0 12088", "code": "INSERT", "rows_affected": 12088}, "message": "INSERT 0 12088", "failures": null, "unique_id": "model.dbt_lab08_project.ods_device_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'click_id')::uuid as click_id,\n    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,\n    (json_data ->> 'user_domain_id')::uuid as user_domain_id,\n    json_data ->> 'os' as os,\n    json_data ->> 'os_name' as os_name,\n    json_data ->> 'os_timezone' as os_timezone,\n    json_data ->> 'device_type' as device_type,\n    json_data ->> 'user_custom_id' as user_custom_id\nfrom \"lab08_db\".\"stg\".\"stg_device_events\"\n\n\n    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_device_events\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-04-30T12:50:35.593552Z", "completed_at": "2025-04-30T12:50:35.644578Z"}, {"name": "execute", "started_at": "2025-04-30T12:50:35.646557Z", "completed_at": "2025-04-30T13:08:50.690244Z"}], "thread_id": "Thread-4", "execution_time": 1095.1159763336182, "adapter_response": {}, "message": "Database Error in model dm_sales (models/dm/dm_sales.sql)\n  terminating background worker \"parallel worker\" due to administrator command\n  CONTEXT:  parallel worker", "failures": null, "unique_id": "model.dbt_lab08_project.dm_sales", "compiled": true, "compiled_code": "\n\n\nwith unique_devices as (\n    select distinct\n        click_id,\n        os,\n        os_name,\n        device_type,\n        user_custom_id\n    from \"lab08_db\".\"ods\".\"ods_device_events\"\n),\n\nunique_geo as (\n    select distinct\n        click_id,\n        geo_country,\n        geo_region_name,\n        geo_latitude,\n        geo_longitude\n    from \"lab08_db\".\"ods\".\"ods_geo_events\"\n),\n\ncte_lead as (\n    select\n        obe.load_hour,\n        event_timestamp,\n        event_type,\n        page_url,\n        page_url_path,\n        referer_url,\n        referer_medium,\n        utm_medium,\n        utm_source,\n        utm_content,\n        utm_campaign,\n        browser_name,\n        browser_user_agent,\n        browser_language,\n        os,\n        os_name,\n        user_custom_id,\n        device_type,\n        geo_country,\n        geo_region_name,\n        geo_latitude,\n        geo_longitude,\n        LEAD(page_url_path, 1) over w as next_page_lead1,\n        LEAD(page_url_path, 2) over w as next_page_lead2,\n        LEAD(page_url_path, 3) over w as next_page_lead3,\n        LEAD(event_timestamp, 3) over w as confirmation_timestamp\n    from \"lab08_db\".\"ods\".\"ods_location_events\" as ole\n    inner join\n        \"lab08_db\".\"ods\".\"ods_browser_events\" as obe\n        on ole.event_id = obe.event_id\n    inner join unique_devices as ud on obe.click_id = ud.click_id\n    inner join unique_geo as ug on obe.click_id = ug.click_id\n    where\n        ole.page_url_path != '/home'\n        \n            and ole.load_hour >= '2025-04-30T08:00:00' and ole.load_hour < '2025-04-30T09:00:00'\n            and obe.load_hour >= '2025-04-30T08:00:00' and obe.load_hour < '2025-04-30T09:00:00'\n        \n    window w as (\n        partition by user_custom_id\n        order by event_timestamp\n    )\n)\n\nselect\n    load_hour,\n    user_custom_id as sale_custom_id,\n    event_timestamp,\n    confirmation_timestamp as sale_timestamp,\n    1 as sale_item_cnt,\n    browser_name as sale_browser,\n    device_type as sale_platform,\n    page_url_path as sale_page_before,\n    utm_source as sale_source,\n    utm_campaign as sale_utm_campaign,\n    referer_url as sale_referer_url,\n    referer_medium as sale_referer_medium,\n    utm_content as sale_utm_content,\n    geo_country as sale_geo_country,\n    geo_region_name as sale_geo_region_name,\n    geo_latitude as sale_geo_latitude,\n    geo_longitude as sale_geo_longitude,\n    EXTRACT(hour from confirmation_timestamp) as sale_hour,\n    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,\n    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,\n    COALESCE(i.item_ru, '') as clear_sale_page_before_ru\nfrom cte_lead\nleft join \"lab08_db\".\"ods\".\"italian_cities\" as ic on ic.city_en = geo_region_name\nleft join\n    \"lab08_db\".\"ods\".\"items\" as i\n    on i.item_en = REPLACE(page_url_path, '/product_', '')\nwhere\n    (next_page_lead1, next_page_lead2, next_page_lead3)\n    = ('/cart', '/payment', '/confirmation')\n    and page_url_path not in ('/payment', '/cart', '/confirmation')", "relation_name": "\"lab08_db\".\"dm\".\"dm_sales\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-04-30T12:50:35.586363Z", "completed_at": "2025-04-30T12:50:35.645782Z"}, {"name": "execute", "started_at": "2025-04-30T12:50:35.653308Z", "completed_at": "2025-04-30T13:09:25.840823Z"}], "thread_id": "Thread-3", "execution_time": 1130.2600047588348, "adapter_response": {}, "message": "Database Error in model dm_events (models/dm/dm_events.sql)\n  terminating background worker \"parallel worker\" due to administrator command\n  CONTEXT:  parallel worker", "failures": null, "unique_id": "model.dbt_lab08_project.dm_events", "compiled": true, "compiled_code": "\n\n\nwith distinct_clicks as (\n    select distinct\n        click_id,\n        device_type\n    from \"lab08_db\".\"ods\".\"ods_device_events\"\n)\n\nselect\n    e.load_hour,\n    e.event_id,\n    e.event_type,\n    e.event_timestamp,\n    e.browser_name,\n    d.device_type,\n    EXTRACT(hour from e.event_timestamp) as event_hour\nfrom \"lab08_db\".\"ods\".\"ods_browser_events\" as e\ninner join distinct_clicks as d on e.click_id = d.click_id\n\n    where load_hour >= '2025-04-30T08:00:00' and load_hour < '2025-04-30T09:00:00'\n", "relation_name": "\"lab08_db\".\"dm\".\"dm_events\""}], "elapsed_time": 1202.1184742450714, "args": {"enable_legacy_logger": false, "which": "run", "macro_debugging": false, "log_format_file": "debug", "log_level": "info", "partial_parse_file_diff": true, "write_json": true, "show_resource_report": false, "select": [], "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "invocation_command": "dbt run --profiles-dir /dbt_history --project-dir /dbt_history --vars {\"start_date\": \"2025-04-30T08:00:00\", \"end_date\": \"2025-04-30T09:00:00\"}", "cache_selected_only": false, "version_check": true, "defer": false, "indirect_selection": "eager", "project_dir": "/dbt_history", "profiles_dir": "/dbt_history", "quiet": false, "log_path": "/dbt_history/logs", "printer_width": 80, "use_colors_file": true, "exclude": [], "introspect": true, "static_parser": true, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "log_format": "default", "populate_cache": true, "vars": {"start_date": "2025-04-30T08:00:00", "end_date": "2025-04-30T09:00:00"}, "favor_state": false, "partial_parse": true, "print": true, "empty": false, "log_file_max_bytes": 10485760, "log_level_file": "debug", "require_resource_names_without_spaces": false, "use_colors": true, "source_freshness_run_project_hooks": false}}