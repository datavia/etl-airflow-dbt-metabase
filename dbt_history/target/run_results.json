{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-04-30T15:00:12.211282Z", "invocation_id": "1ff26326-20f4-4676-aa29-6e4aff896643", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:56:41.062571Z", "completed_at": "2025-04-30T14:56:41.176088Z"}, {"name": "execute", "started_at": "2025-04-30T14:56:41.205883Z", "completed_at": "2025-04-30T14:57:59.094461Z"}], "thread_id": "Thread-4", "execution_time": 78.03695440292358, "adapter_response": {"_message": "INSERT 0 580020", "code": "INSERT", "rows_affected": 580020}, "message": "INSERT 0 580020", "failures": null, "unique_id": "model.dbt_lab08_project.ods_location_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'event_id')::uuid as event_id,\n    json_data ->> 'page_url' as page_url,\n    json_data ->> 'page_url_path' as page_url_path,\n    json_data ->> 'referer_url' as referer_url,\n    json_data ->> 'referer_medium' as referer_medium,\n    json_data ->> 'utm_medium' as utm_medium,\n    json_data ->> 'utm_source' as utm_source,\n    json_data ->> 'utm_content' as utm_content,\n    json_data ->> 'utm_campaign' as utm_campaign\nfrom \"lab08_db\".\"stg\".\"stg_location_events\"\n\n\n    where load_dttm >= '2025-04-26T12:00:00' and load_dttm < '2025-04-28T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_location_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:56:41.075856Z", "completed_at": "2025-04-30T14:56:41.161411Z"}, {"name": "execute", "started_at": "2025-04-30T14:56:41.165182Z", "completed_at": "2025-04-30T14:58:02.003599Z"}], "thread_id": "Thread-2", "execution_time": 80.95143842697144, "adapter_response": {"_message": "INSERT 0 580020", "code": "INSERT", "rows_affected": 580020}, "message": "INSERT 0 580020", "failures": null, "unique_id": "model.dbt_lab08_project.ods_device_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'click_id')::uuid as click_id,\n    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,\n    (json_data ->> 'user_domain_id')::uuid as user_domain_id,\n    json_data ->> 'os' as os,\n    json_data ->> 'os_name' as os_name,\n    json_data ->> 'os_timezone' as os_timezone,\n    json_data ->> 'device_type' as device_type,\n    json_data ->> 'user_custom_id' as user_custom_id\nfrom \"lab08_db\".\"stg\".\"stg_device_events\"\n\n\n    where load_dttm >= '2025-04-26T12:00:00' and load_dttm < '2025-04-28T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_device_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:56:41.076548Z", "completed_at": "2025-04-30T14:56:41.395961Z"}, {"name": "execute", "started_at": "2025-04-30T14:56:41.430145Z", "completed_at": "2025-04-30T14:58:04.408740Z"}], "thread_id": "Thread-3", "execution_time": 83.33871030807495, "adapter_response": {"_message": "INSERT 0 580020", "code": "INSERT", "rows_affected": 580020}, "message": "INSERT 0 580020", "failures": null, "unique_id": "model.dbt_lab08_project.ods_geo_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'click_id')::uuid as click_id,\n    (json_data ->> 'geo_latitude')::float as geo_latitude,\n    (json_data ->> 'geo_longitude')::float as geo_longitude,\n    json_data ->> 'geo_country' as geo_country,\n    json_data ->> 'geo_timezone' as geo_timezone,\n    json_data ->> 'geo_region_name' as geo_region_name,\n    json_data ->> 'ip_address' as ip_address\nfrom \"lab08_db\".\"stg\".\"stg_geo_events\"\n\n\n    where load_dttm >= '2025-04-26T12:00:00' and load_dttm < '2025-04-28T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_geo_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:56:41.076353Z", "completed_at": "2025-04-30T14:56:41.174356Z"}, {"name": "execute", "started_at": "2025-04-30T14:56:41.177117Z", "completed_at": "2025-04-30T14:58:07.059733Z"}], "thread_id": "Thread-1", "execution_time": 86.02400946617126, "adapter_response": {"_message": "INSERT 0 580020", "code": "INSERT", "rows_affected": 580020}, "message": "INSERT 0 580020", "failures": null, "unique_id": "model.dbt_lab08_project.ods_browser_events", "compiled": true, "compiled_code": "\n\n\nselect\n    load_dttm as load_hour,\n    (json_data ->> 'event_id')::uuid as event_id,\n    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,\n    (json_data ->> 'click_id')::uuid as click_id,\n    json_data ->> 'event_type' as event_type,\n    json_data ->> 'browser_name' as browser_name,\n    json_data ->> 'browser_user_agent' as browser_user_agent,\n    json_data ->> 'browser_language' as browser_language\nfrom \"lab08_db\".\"stg\".\"stg_browser_events\"\n\n\n    where load_dttm >= '2025-04-26T12:00:00' and load_dttm < '2025-04-28T09:00:00'\n", "relation_name": "\"lab08_db\".\"ods\".\"ods_browser_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:58:07.109874Z", "completed_at": "2025-04-30T14:58:07.155436Z"}, {"name": "execute", "started_at": "2025-04-30T14:58:07.156347Z", "completed_at": "2025-04-30T14:59:24.746269Z"}], "thread_id": "Thread-4", "execution_time": 77.67621302604675, "adapter_response": {"_message": "INSERT 0 580020", "code": "INSERT", "rows_affected": 580020}, "message": "INSERT 0 580020", "failures": null, "unique_id": "model.dbt_lab08_project.dm_events", "compiled": true, "compiled_code": "\n\n\nwith distinct_clicks as (\n    select distinct\n        click_id,\n        device_type\n    from \"lab08_db\".\"ods\".\"ods_device_events\"\n)\n\nselect\n    e.load_hour,\n    e.event_id,\n    e.event_type,\n    e.event_timestamp,\n    e.browser_name,\n    d.device_type,\n    EXTRACT(hour from e.event_timestamp) as event_hour\nfrom \"lab08_db\".\"ods\".\"ods_browser_events\" as e\ninner join distinct_clicks as d on e.click_id = d.click_id\n\n    where load_hour >= '2025-04-26T12:00:00' and load_hour < '2025-04-28T09:00:00'\n", "relation_name": "\"lab08_db\".\"dm\".\"dm_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-30T14:58:07.086478Z", "completed_at": "2025-04-30T14:58:07.143082Z"}, {"name": "execute", "started_at": "2025-04-30T14:58:07.144185Z", "completed_at": "2025-04-30T15:00:12.122520Z"}], "thread_id": "Thread-2", "execution_time": 125.04709029197693, "adapter_response": {"_message": "INSERT 0 33078", "code": "INSERT", "rows_affected": 33078}, "message": "INSERT 0 33078", "failures": null, "unique_id": "model.dbt_lab08_project.dm_sales", "compiled": true, "compiled_code": "\n\n\nwith unique_devices as (\n    select distinct\n        click_id,\n        os,\n        os_name,\n        device_type,\n        user_custom_id\n    from \"lab08_db\".\"ods\".\"ods_device_events\"\n),\n\nunique_geo as (\n    select distinct\n        click_id,\n        geo_country,\n        geo_region_name,\n        geo_latitude,\n        geo_longitude\n    from \"lab08_db\".\"ods\".\"ods_geo_events\"\n),\n\ncte_lead as (\n    select\n        obe.load_hour,\n        event_timestamp,\n        event_type,\n        page_url,\n        page_url_path,\n        referer_url,\n        referer_medium,\n        utm_medium,\n        utm_source,\n        utm_content,\n        utm_campaign,\n        browser_name,\n        browser_user_agent,\n        browser_language,\n        os,\n        os_name,\n        user_custom_id,\n        device_type,\n        geo_country,\n        geo_region_name,\n        geo_latitude,\n        geo_longitude,\n        LEAD(page_url_path, 1) over w as next_page_lead1,\n        LEAD(page_url_path, 2) over w as next_page_lead2,\n        LEAD(page_url_path, 3) over w as next_page_lead3,\n        LEAD(event_timestamp, 3) over w as confirmation_timestamp\n    from \"lab08_db\".\"ods\".\"ods_location_events\" as ole\n    inner join\n        \"lab08_db\".\"ods\".\"ods_browser_events\" as obe\n        on ole.event_id = obe.event_id\n    inner join unique_devices as ud on obe.click_id = ud.click_id\n    inner join unique_geo as ug on obe.click_id = ug.click_id\n    where\n        ole.page_url_path != '/home'\n        \n            and ole.load_hour >= '2025-04-26T12:00:00' and ole.load_hour < '2025-04-28T09:00:00'\n            and obe.load_hour >= '2025-04-26T12:00:00' and obe.load_hour < '2025-04-28T09:00:00'\n        \n    window w as (\n        partition by user_custom_id\n        order by event_timestamp\n    )\n)\n\nselect\n    load_hour,\n    user_custom_id as sale_custom_id,\n    event_timestamp,\n    confirmation_timestamp as sale_timestamp,\n    1 as sale_item_cnt,\n    browser_name as sale_browser,\n    device_type as sale_platform,\n    page_url_path as sale_page_before,\n    utm_source as sale_source,\n    utm_campaign as sale_utm_campaign,\n    referer_url as sale_referer_url,\n    referer_medium as sale_referer_medium,\n    utm_content as sale_utm_content,\n    geo_country as sale_geo_country,\n    geo_region_name as sale_geo_region_name,\n    geo_latitude as sale_geo_latitude,\n    geo_longitude as sale_geo_longitude,\n    EXTRACT(hour from confirmation_timestamp) as sale_hour,\n    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,\n    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,\n    COALESCE(i.item_ru, '') as clear_sale_page_before_ru\nfrom cte_lead\nleft join \"lab08_db\".\"ods\".\"italian_cities\" as ic on ic.city_en = geo_region_name\nleft join\n    \"lab08_db\".\"ods\".\"items\" as i\n    on i.item_en = REPLACE(page_url_path, '/product_', '')\nwhere\n    (next_page_lead1, next_page_lead2, next_page_lead3)\n    = ('/cart', '/payment', '/confirmation')\n    and page_url_path not in ('/payment', '/cart', '/confirmation')", "relation_name": "\"lab08_db\".\"dm\".\"dm_sales\""}], "elapsed_time": 211.6298644542694, "args": {"enable_legacy_logger": false, "send_anonymous_usage_stats": true, "empty": false, "use_colors": true, "partial_parse": true, "indirect_selection": "eager", "log_level_file": "debug", "quiet": false, "log_file_max_bytes": 10485760, "log_format": "default", "require_resource_names_without_spaces": false, "profiles_dir": "/dbt_history", "select": [], "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {"start_date": "2025-04-26T12:00:00", "end_date": "2025-04-28T09:00:00"}, "macro_debugging": false, "exclude": [], "invocation_command": "dbt run --profiles-dir /dbt_history --project-dir /dbt_history --vars {\"start_date\": \"2025-04-26T12:00:00\", \"end_date\": \"2025-04-28T09:00:00\"}", "populate_cache": true, "printer_width": 80, "show_resource_report": false, "log_path": "/dbt_history/logs", "version_check": true, "defer": false, "strict_mode": false, "partial_parse_file_diff": true, "print": true, "static_parser": true, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "favor_state": false, "log_level": "info", "use_colors_file": true, "introspect": true, "log_format_file": "debug", "source_freshness_run_project_hooks": false, "project_dir": "/dbt_history", "which": "run", "write_json": true}}