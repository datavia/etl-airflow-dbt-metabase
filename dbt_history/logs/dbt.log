[0m12:18:53.503507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f12af4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f123e5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f123ef220>]}


============================== 12:18:53.511888 | 05dde9c7-5285-4016-b92a-a78387b6674e ==============================
[0m12:18:53.511888 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m12:18:53.513231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:53.861617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f14e98730>]}
[0m12:18:54.019566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f11df16d0>]}
[0m12:18:54.021738 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:18:54.059949 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m12:18:54.062472 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:18:54.063708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f10371c70>]}
[0m12:18:57.037120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f10213be0>]}
[0m12:18:57.272641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ff2b910>]}
[0m12:18:57.273740 [info ] [MainThread]: Found 6 models, 4 sources, 423 macros
[0m12:18:57.274435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1007edc0>]}
[0m12:18:57.277517 [info ] [MainThread]: 
[0m12:18:57.278227 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m12:18:57.278680 [info ] [MainThread]: 
[0m12:18:57.279662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:57.289950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m12:18:57.301725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m12:18:57.398578 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m12:18:57.399510 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m12:18:57.401022 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m12:18:57.401926 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m12:18:57.402550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:57.403430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:57.445531 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.042 seconds
[0m12:18:57.448467 [debug] [ThreadPool]: On list_lab08_db: Close
[0m12:18:57.450080 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.047 seconds
[0m12:18:57.453772 [debug] [ThreadPool]: On list_lab08_db: Close
[0m12:18:57.455206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now create_lab08_db_ods_ods)
[0m12:18:57.456537 [debug] [ThreadPool]: Creating schema "database: "lab08_db"
schema: "ods_ods"
"
[0m12:18:57.466788 [debug] [ThreadPool]: Using postgres connection "create_lab08_db_ods_ods"
[0m12:18:57.467509 [debug] [ThreadPool]: On create_lab08_db_ods_ods: BEGIN
[0m12:18:57.468234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:57.502210 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m12:18:57.503117 [debug] [ThreadPool]: Using postgres connection "create_lab08_db_ods_ods"
[0m12:18:57.503596 [debug] [ThreadPool]: On create_lab08_db_ods_ods: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "create_lab08_db_ods_ods"} */
create schema if not exists "ods_ods"
[0m12:18:57.509877 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m12:18:57.512260 [debug] [ThreadPool]: On create_lab08_db_ods_ods: COMMIT
[0m12:18:57.512971 [debug] [ThreadPool]: Using postgres connection "create_lab08_db_ods_ods"
[0m12:18:57.513892 [debug] [ThreadPool]: On create_lab08_db_ods_ods: COMMIT
[0m12:18:57.520608 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m12:18:57.521274 [debug] [ThreadPool]: On create_lab08_db_ods_ods: Close
[0m12:18:57.527463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lab08_db_ods_ods, now list_lab08_db_ods)
[0m12:18:57.534393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_ods)
[0m12:18:57.542250 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m12:18:57.546986 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_ods"
[0m12:18:57.547918 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m12:18:57.548768 [debug] [ThreadPool]: On list_lab08_db_ods_ods: BEGIN
[0m12:18:57.549328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:57.549937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:57.581460 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m12:18:57.582759 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m12:18:57.583326 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m12:18:57.584696 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m12:18:57.585982 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_ods"
[0m12:18:57.586638 [debug] [ThreadPool]: On list_lab08_db_ods_ods: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_ods'
  
[0m12:18:57.596468 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m12:18:57.599390 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m12:18:57.600176 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m12:18:57.603155 [debug] [ThreadPool]: On list_lab08_db_ods_ods: ROLLBACK
[0m12:18:57.604081 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m12:18:57.608058 [debug] [ThreadPool]: On list_lab08_db_ods_ods: Close
[0m12:18:57.618492 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:57.619177 [debug] [MainThread]: On master: BEGIN
[0m12:18:57.619906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:57.652222 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m12:18:57.653004 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:57.653774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:57.661742 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m12:18:57.665038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1389bb80>]}
[0m12:18:57.666101 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:57.668178 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:57.668687 [debug] [MainThread]: On master: BEGIN
[0m12:18:57.673220 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:18:57.673975 [debug] [MainThread]: On master: COMMIT
[0m12:18:57.674566 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:57.675162 [debug] [MainThread]: On master: COMMIT
[0m12:18:57.677326 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:18:57.677946 [debug] [MainThread]: On master: Close
[0m12:18:57.683327 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events_dbt
[0m12:18:57.684522 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_ods.ods_browser_events_dbt .............. [RUN]
[0m12:18:57.686293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_ods, now model.dbt_lab08_project.ods_browser_events_dbt)
[0m12:18:57.687488 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events_dbt
[0m12:18:57.688224 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events_dbt
[0m12:18:57.688838 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events_dbt
[0m12:18:57.689709 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events_dbt
[0m12:18:57.690572 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_ods.ods_device_events_dbt ............... [RUN]
[0m12:18:57.697059 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_ods.ods_geo_events_dbt .................. [RUN]
[0m12:18:57.709523 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_ods.ods_location_events_dbt ............. [RUN]
[0m12:18:57.711202 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events_dbt)
[0m12:18:57.719285 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events_dbt'
[0m12:18:57.723759 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events_dbt'
[0m12:18:57.725851 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events_dbt
[0m12:18:57.724600 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events_dbt
[0m12:18:57.725231 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events_dbt
[0m12:18:57.722549 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events_dbt"
[0m12:18:57.748173 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events_dbt
[0m12:18:57.741438 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events_dbt"
[0m12:18:57.734218 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events_dbt"
[0m12:18:57.762019 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events_dbt
[0m12:18:57.760913 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events_dbt
[0m12:18:57.759472 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events_dbt"
[0m12:18:57.800357 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events_dbt
[0m12:18:58.167358 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events_dbt"
[0m12:18:58.180401 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events_dbt"
[0m12:18:58.178288 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events_dbt"
[0m12:18:58.161558 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events_dbt"
[0m12:18:58.183907 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events_dbt"
[0m12:18:58.184631 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events_dbt: BEGIN
[0m12:18:58.185772 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events_dbt"
[0m12:18:58.186647 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:18:58.187499 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events_dbt"
[0m12:18:58.188425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events_dbt"
[0m12:18:58.190556 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events_dbt: BEGIN
[0m12:18:58.193278 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:18:58.191739 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events_dbt: BEGIN
[0m12:18:58.192330 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events_dbt: BEGIN
[0m12:18:58.194685 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:18:58.195640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:58.219369 [debug] [Thread-3  ]: SQL status: BEGIN in 0.033 seconds
[0m12:18:58.223864 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events_dbt"
[0m12:18:58.228040 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events_dbt: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events_dbt"} */

      
  
    

  create  table "lab08_db"."ods_ods"."ods_geo_events_dbt"
  
  
    as
  
  (
    

select load_dttm,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


  );
  
  
[0m12:18:58.229042 [debug] [Thread-4  ]: SQL status: BEGIN in 0.036 seconds
[0m12:18:58.229865 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events_dbt"
[0m12:18:58.230924 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events_dbt: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events_dbt"} */

      
  
    

  create  table "lab08_db"."ods_ods"."ods_location_events_dbt"
  
  
    as
  
  (
    

select load_dttm,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


  );
  
  
[0m12:18:58.236970 [debug] [Thread-1  ]: SQL status: BEGIN in 0.041 seconds
[0m12:18:58.237905 [debug] [Thread-2  ]: SQL status: BEGIN in 0.043 seconds
[0m12:18:58.238768 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events_dbt"
[0m12:18:58.239503 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events_dbt"
[0m12:18:58.241802 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events_dbt: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events_dbt"} */

      
  
    

  create  table "lab08_db"."ods_ods"."ods_browser_events_dbt"
  
  
    as
  
  (
    

select load_dttm,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


  );
  
  
[0m12:18:58.243155 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events_dbt: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events_dbt"} */

      
  
    

  create  table "lab08_db"."ods_ods"."ods_device_events_dbt"
  
  
    as
  
  (
    

select  load_dttm,

       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


  );
  
  
[0m12:20:54.849689 [debug] [Thread-4  ]: SQL status: SELECT 6767169 in 116.617 seconds
[0m12:20:54.904584 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events_dbt: COMMIT
[0m12:20:54.905380 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events_dbt"
[0m12:20:54.906141 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events_dbt: COMMIT
[0m12:20:54.953912 [debug] [Thread-4  ]: SQL status: COMMIT in 0.047 seconds
[0m12:20:54.957070 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events_dbt: Close
[0m12:20:54.961227 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ea72f40>]}
[0m12:20:54.964323 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_ods.ods_location_events_dbt ........ [[32mSELECT 6767169[0m in 117.24s]
[0m12:20:54.965516 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events_dbt
[0m12:20:54.985210 [debug] [Thread-3  ]: SQL status: SELECT 6746937 in 116.755 seconds
[0m12:20:54.988679 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events_dbt: COMMIT
[0m12:20:54.989413 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events_dbt"
[0m12:20:54.990103 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events_dbt: COMMIT
[0m12:20:55.015283 [debug] [Thread-3  ]: SQL status: COMMIT in 0.024 seconds
[0m12:20:55.017341 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events_dbt: Close
[0m12:20:55.018861 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ea72d90>]}
[0m12:20:55.020688 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_ods.ods_geo_events_dbt ............. [[32mSELECT 6746937[0m in 117.30s]
[0m12:20:55.021712 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events_dbt
[0m12:21:00.262401 [debug] [Thread-2  ]: SQL status: SELECT 6767169 in 122.018 seconds
[0m12:21:00.267573 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events_dbt: COMMIT
[0m12:21:00.268185 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events_dbt"
[0m12:21:00.268766 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events_dbt: COMMIT
[0m12:21:00.298776 [debug] [Thread-2  ]: SQL status: COMMIT in 0.029 seconds
[0m12:21:00.301526 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events_dbt: Close
[0m12:21:00.303679 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ea72e80>]}
[0m12:21:00.305910 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_ods.ods_device_events_dbt .......... [[32mSELECT 6767169[0m in 122.59s]
[0m12:21:00.307617 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events_dbt
[0m12:21:10.155308 [debug] [Thread-1  ]: SQL status: SELECT 6767169 in 131.911 seconds
[0m12:21:10.158771 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events_dbt: COMMIT
[0m12:21:10.159698 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events_dbt"
[0m12:21:10.160401 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events_dbt: COMMIT
[0m12:21:10.198792 [debug] [Thread-1  ]: SQL status: COMMIT in 0.038 seconds
[0m12:21:10.200417 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events_dbt: Close
[0m12:21:10.201678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0eb38f70>]}
[0m12:21:10.203214 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_ods.ods_browser_events_dbt ......... [[32mSELECT 6767169[0m in 132.52s]
[0m12:21:10.205084 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events_dbt
[0m12:21:10.206257 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_events_dbt
[0m12:21:10.207850 [info ] [Thread-4  ]: 5 of 6 START sql incremental model ods.dm_events_dbt ........................... [RUN]
[0m12:21:10.210234 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events_dbt, now model.dbt_lab08_project.dm_events_dbt)
[0m12:21:10.206910 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m12:21:10.211989 [info ] [Thread-3  ]: 6 of 6 START sql incremental model ods.dm_sales ................................ [RUN]
[0m12:21:10.213396 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events_dbt, now model.dbt_lab08_project.dm_sales)
[0m12:21:10.213993 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m12:21:10.210931 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_events_dbt
[0m12:21:10.223138 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m12:21:10.234295 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events_dbt"
[0m12:21:10.235935 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m12:21:10.237170 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_events_dbt
[0m12:21:10.254051 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m12:21:10.257595 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events_dbt"
[0m12:21:10.259970 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:21:10.261011 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m12:21:10.261862 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events_dbt"
[0m12:21:10.262466 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:21:10.263114 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events_dbt: BEGIN
[0m12:21:10.263958 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:21:10.301460 [debug] [Thread-4  ]: SQL status: BEGIN in 0.037 seconds
[0m12:21:10.303412 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events_dbt"
[0m12:21:10.304171 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events_dbt: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events_dbt"} */

      
  
    

  create  table "lab08_db"."ods"."dm_events_dbt"
  
  
    as
  
  (
    WITH distinct_clicks AS (
	SELECT DISTINCT
		click_id,
		device_type
	FROM "lab08_db"."ods_ods"."ods_device_events_dbt"
)
SELECT
	e.load_hour,
	e.event_id,
	e.event_type,
	e.event_timestamp,
	EXTRACT(HOUR FROM e.event_timestamp) AS event_hour,
	e.browser_name,
	d.device_type
FROM "lab08_db"."ods_ods"."ods_browser_events_dbt" e
JOIN distinct_clicks d USING(click_id)

  );
  
  
[0m12:21:10.302542 [debug] [Thread-3  ]: SQL status: BEGIN in 0.040 seconds
[0m12:21:10.305099 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:21:10.305751 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      
  
    

  create  table "lab08_db"."ods"."dm_sales"
  
  
    as
  
  (
    WITH unique_devices AS (
SELECT DISTINCT 
	click_id,
	os,
	os_name,
	device_type,
	user_custom_id
FROM "lab08_db"."ods_ods"."ods_device_events_dbt"
),
unique_geo AS (
SELECT DISTINCT
	click_id,
	geo_country,
	geo_region_name
FROM "lab08_db"."ods_ods"."ods_geo_events_dbt"
),
cte_lead AS (
SELECT
    obe.load_hour,
	event_timestamp,
	event_type,
	page_url,
	page_url_path,
	referer_url,
	referer_medium,
	utm_medium,
	utm_source,
	utm_content,
	utm_campaign,
	browser_name,
	browser_user_agent,
	browser_language,
	os,
	os_name,
	user_custom_id,
	device_type,
	geo_country,
	geo_region_name,
    LEAD(page_url_path, 1) OVER w AS next_page_lead1,
    LEAD(page_url_path, 2) OVER w AS next_page_lead2,
    LEAD(page_url_path, 3) OVER w AS next_page_lead3,
    LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
FROM "lab08_db"."ods_ods"."ods_location_events_dbt" ole
JOIN "lab08_db"."ods_ods"."ods_browser_events_dbt" obe ON ole.event_id = obe.event_id
JOIN unique_devices ud ON obe.click_id = ud.click_id
JOIN unique_geo ug ON ug.click_id = obe.click_id
WHERE ole.page_url_path != '/home'

WINDOW w AS (
	PARTITION BY user_custom_id
	ORDER BY event_timestamp
	)
)
SELECT
    load_hour,
	user_custom_id AS sale_custom_id,
	event_timestamp,
	confirmation_timestamp AS sale_timestamp,
	EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
	1 AS sale_item_cnt,
	browser_name AS sale_browser,
	device_type AS sale_platform,
	page_url_path AS sale_page_before,
	REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before,
	utm_source AS sale_source,
	utm_campaign AS sale_utm_campaign,
	referer_url AS sale_referer_url,
	referer_medium AS sale_referer_medium,
	utm_content AS sale_utm_content,
	geo_country AS sale_geo_country,
	geo_region_name AS sale_geo_region_name
FROM cte_lead
WHERE (next_page_lead1, next_page_lead2, next_page_lead3) = ('/cart', '/payment', '/confirmation')
AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m12:21:10.308785 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column e.load_hour does not exist
LINE 20:  e.load_hour,
          ^

[0m12:21:10.309513 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events_dbt: ROLLBACK
[0m12:21:10.310148 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column obe.load_hour does not exist
LINE 31:     obe.load_hour,
             ^

[0m12:21:10.310824 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: ROLLBACK
[0m12:21:10.312629 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events_dbt: Close
[0m12:21:10.315457 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m12:21:10.319570 [debug] [Thread-3  ]: Database Error in model dm_sales (models/dm/dm_sales.sql)
  column obe.load_hour does not exist
  LINE 31:     obe.load_hour,
               ^
  compiled code at target/run/dbt_lab08_project/models/dm/dm_sales.sql
[0m12:21:10.321434 [debug] [Thread-4  ]: Database Error in model dm_events_dbt (models/dm/dm_events_dbt.sql)
  column e.load_hour does not exist
  LINE 20:  e.load_hour,
            ^
  compiled code at target/run/dbt_lab08_project/models/dm/dm_events_dbt.sql
[0m12:21:10.322691 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0eb894c0>]}
[0m12:21:10.323531 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dde9c7-5285-4016-b92a-a78387b6674e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0eaeeac0>]}
[0m12:21:10.326567 [error] [Thread-4  ]: 5 of 6 ERROR creating sql incremental model ods.dm_events_dbt .................. [[31mERROR[0m in 0.11s]
[0m12:21:10.327255 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_events_dbt
[0m12:21:10.325270 [error] [Thread-3  ]: 6 of 6 ERROR creating sql incremental model ods.dm_sales ....................... [[31mERROR[0m in 0.11s]
[0m12:21:10.327924 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m12:21:10.329316 [debug] [Thread-7  ]: Marking all children of 'model.dbt_lab08_project.dm_events_dbt' to be skipped because of status 'error'.  Reason: Database Error in model dm_events_dbt (models/dm/dm_events_dbt.sql)
  column e.load_hour does not exist
  LINE 20:  e.load_hour,
            ^
  compiled code at target/run/dbt_lab08_project/models/dm/dm_events_dbt.sql.
[0m12:21:10.333331 [debug] [Thread-7  ]: Marking all children of 'model.dbt_lab08_project.dm_sales' to be skipped because of status 'error'.  Reason: Database Error in model dm_sales (models/dm/dm_sales.sql)
  column obe.load_hour does not exist
  LINE 31:     obe.load_hour,
               ^
  compiled code at target/run/dbt_lab08_project/models/dm/dm_sales.sql.
[0m12:21:10.337780 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:10.338882 [debug] [MainThread]: On master: BEGIN
[0m12:21:10.339255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:10.375986 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:21:10.380934 [debug] [MainThread]: On master: COMMIT
[0m12:21:10.381867 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:10.382468 [debug] [MainThread]: On master: COMMIT
[0m12:21:10.384888 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:21:10.385449 [debug] [MainThread]: On master: Close
[0m12:21:10.386328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:10.386908 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events_dbt' was properly closed.
[0m12:21:10.387423 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events_dbt' was properly closed.
[0m12:21:10.387939 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m12:21:10.388388 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events_dbt' was properly closed.
[0m12:21:10.388977 [info ] [MainThread]: 
[0m12:21:10.389475 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 13.11 seconds (133.11s).
[0m12:21:10.392012 [debug] [MainThread]: Command end result
[0m12:21:10.454979 [info ] [MainThread]: 
[0m12:21:10.455884 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successs, and 0 warnings:[0m
[0m12:21:10.456320 [info ] [MainThread]: 
[0m12:21:10.456833 [error] [MainThread]:   Database Error in model dm_events_dbt (models/dm/dm_events_dbt.sql)
  column e.load_hour does not exist
  LINE 20:  e.load_hour,
            ^
  compiled code at target/run/dbt_lab08_project/models/dm/dm_events_dbt.sql
[0m12:21:10.457190 [info ] [MainThread]: 
[0m12:21:10.457581 [error] [MainThread]:   Database Error in model dm_sales (models/dm/dm_sales.sql)
  column obe.load_hour does not exist
  LINE 31:     obe.load_hour,
               ^
  compiled code at target/run/dbt_lab08_project/models/dm/dm_sales.sql
[0m12:21:10.457966 [info ] [MainThread]: 
[0m12:21:10.458377 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m12:21:10.459653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 137.05646, "process_user_time": 6.746548, "process_kernel_time": 0.375546, "process_mem_max_rss": "109476", "process_in_blocks": "128", "process_out_blocks": "2808", "command_success": false}
[0m12:21:10.460451 [debug] [MainThread]: Command `dbt run` failed at 12:21:10.460289 after 137.06 seconds
[0m12:21:10.461000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f12af4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f14e98730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0feebb50>]}
[0m12:21:10.461525 [debug] [MainThread]: Flushing usage events
[0m12:21:11.175165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:09.067426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107ed6feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107eb170a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e5772b0>]}


============================== 13:01:09.074496 | 561c1f13-4533-4912-acf8-6d81f0b681cf ==============================
[0m13:01:09.074496 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m13:01:09.075492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:09.401243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '561c1f13-4533-4912-acf8-6d81f0b681cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e033460>]}
[0m13:01:09.557579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '561c1f13-4533-4912-acf8-6d81f0b681cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c666d30>]}
[0m13:01:09.558777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:09.597065 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m13:01:09.856761 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:01:09.857643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '561c1f13-4533-4912-acf8-6d81f0b681cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e563850>]}
[0m13:01:09.863354 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_lab08_project: generate_schema_name.yml - Runtime Error
    Syntax error near line 1
    ------------------------------
    1  | {% macro generate_schema_name(custom_schema_name, node) -%}
    2  | 
    3  |     {%- set default_schema = target.schema -%}
    4  |     {%- if custom_schema_name is none -%}
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 1, column 2
[0m13:01:09.869107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8980751, "process_user_time": 3.062112, "process_kernel_time": 0.232658, "process_mem_max_rss": "92312", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:01:09.870245 [debug] [MainThread]: Command `dbt run` failed at 13:01:09.870005 after 0.90 seconds
[0m13:01:09.872107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107ed6feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c3986a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107c3987f0>]}
[0m13:01:09.873623 [debug] [MainThread]: Flushing usage events
[0m13:01:10.394663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:40.705187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743d8fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743b5a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743599850>]}


============================== 13:07:40.715514 | 68939f22-4671-460e-bcaf-6f17e7e48f46 ==============================
[0m13:07:40.715514 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m13:07:40.716496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:07:41.093973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68939f22-4671-460e-bcaf-6f17e7e48f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd746131730>]}
[0m13:07:41.215927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68939f22-4671-460e-bcaf-6f17e7e48f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743b9cd00>]}
[0m13:07:41.217389 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:07:41.247179 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m13:07:41.463148 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:07:41.464051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68939f22-4671-460e-bcaf-6f17e7e48f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74357e7c0>]}
[0m13:07:41.475462 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_lab08_project: generate_schema_name.yml - Runtime Error
    Syntax error near line 1
    ------------------------------
    1  | {% macro generate_schema_name(custom_schema_name, node) -%}
    2  | 
    3  |     {%- set default_schema = target.schema -%}
    4  |     {%- if custom_schema_name is none -%}
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 1, column 2
[0m13:07:41.477619 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88279325, "process_user_time": 2.993836, "process_kernel_time": 0.201269, "process_mem_max_rss": "92240", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m13:07:41.478853 [debug] [MainThread]: Command `dbt run` failed at 13:07:41.478608 after 0.88 seconds
[0m13:07:41.479647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd743d8fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7413bf3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7413bf2b0>]}
[0m13:07:41.480381 [debug] [MainThread]: Flushing usage events
[0m13:07:42.077004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:01.169423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16ea6feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16e8160a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16e2722b0>]}


============================== 13:12:01.177934 | bc7ba0f8-0261-4467-96f8-3f01046fbc19 ==============================
[0m13:12:01.177934 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m13:12:01.179241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:12:01.717695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc7ba0f8-0261-4467-96f8-3f01046fbc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16c439460>]}
[0m13:12:01.922369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc7ba0f8-0261-4467-96f8-3f01046fbc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16c366d30>]}
[0m13:12:01.924005 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:12:01.957950 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m13:12:02.247798 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:12:02.248546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc7ba0f8-0261-4467-96f8-3f01046fbc19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16e263850>]}
[0m13:12:02.258875 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_lab08_project: generate_schema_name.yml - Runtime Error
    Syntax error near line 1
    ------------------------------
    1  | {% macro generate_schema_name(custom_schema_name, node) -%}
    2  | 
    3  |     {%- set default_schema = target.schema -%}
    4  |     {%- if custom_schema_name is none -%}
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 1, column 2
[0m13:12:02.261231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1905413, "process_user_time": 3.529377, "process_kernel_time": 0.253122, "process_mem_max_rss": "92352", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:12:02.262241 [debug] [MainThread]: Command `dbt run` failed at 13:12:02.262029 after 1.19 seconds
[0m13:12:02.263134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16ea6feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16c093610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16c093790>]}
[0m13:12:02.263679 [debug] [MainThread]: Flushing usage events
[0m13:12:02.979779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:35.824388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ed2d8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ed07f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ecad82b0>]}


============================== 13:19:35.831286 | ddbfbfce-eddf-4ff5-be9b-c02ebf8120a8 ==============================
[0m13:19:35.831286 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m13:19:35.832949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:36.177204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddbfbfce-eddf-4ff5-be9b-c02ebf8120a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1eaca2460>]}
[0m13:19:36.332432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddbfbfce-eddf-4ff5-be9b-c02ebf8120a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1eabcfd30>]}
[0m13:19:36.334982 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:19:36.366840 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m13:19:36.618502 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:19:36.619173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddbfbfce-eddf-4ff5-be9b-c02ebf8120a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ecacc850>]}
[0m13:19:39.200658 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "stg_stg_browser_events".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("stg", "stg_browser_events").
  
  To fix this, change the name of one of these resources:
  - source.dbt_lab08_project.stg.stg_browser_events (models/stg/s3/_stg_s3_sources.yml)
  - source.dbt_lab08_project.stg.stg_browser_events (models/schema.yml)
[0m13:19:39.204836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5074997, "process_user_time": 5.391092, "process_kernel_time": 0.313209, "process_mem_max_rss": "96220", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:19:39.205838 [debug] [MainThread]: Command `dbt run` failed at 13:19:39.205647 after 3.51 seconds
[0m13:19:39.206454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ed2d8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ea76f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ea787310>]}
[0m13:19:39.207002 [debug] [MainThread]: Flushing usage events
[0m13:19:39.736427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:47.542917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f76a6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f74709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f6eafa00>]}


============================== 13:21:47.552260 | 5591a849-d5f7-4fe2-93c3-a1f4089fcf02 ==============================
[0m13:21:47.552260 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m13:21:47.553192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:47.861728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f4fcdc70>]}
[0m13:21:47.980007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f6fccf70>]}
[0m13:21:47.982204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:48.014358 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m13:21:48.251985 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:21:48.252895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f6e947c0>]}
[0m13:21:50.931921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m13:21:50.955926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f4ab0c40>]}
[0m13:21:51.186975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f499a1c0>]}
[0m13:21:51.188061 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m13:21:51.188793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f4a3da30>]}
[0m13:21:51.192214 [info ] [MainThread]: 
[0m13:21:51.193000 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:21:51.195326 [info ] [MainThread]: 
[0m13:21:51.196989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:51.215147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m13:21:51.222146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m13:21:51.363710 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m13:21:51.364810 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m13:21:51.366855 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m13:21:51.367412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:51.366188 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m13:21:51.372328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:51.432435 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.060 seconds
[0m13:21:51.436691 [debug] [ThreadPool]: On list_lab08_db: Close
[0m13:21:51.446318 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.079 seconds
[0m13:21:51.449646 [debug] [ThreadPool]: On list_lab08_db: Close
[0m13:21:51.453595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m13:21:51.464337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m13:21:51.474390 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m13:21:51.475176 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m13:21:51.475751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:51.480153 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m13:21:51.480784 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m13:21:51.481217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:51.511575 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m13:21:51.512333 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m13:21:51.512980 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m13:21:51.525683 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m13:21:51.529082 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m13:21:51.530082 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m13:21:51.530882 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m13:21:51.531362 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m13:21:51.532666 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m13:21:51.551867 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m13:21:51.554696 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m13:21:51.558019 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m13:21:51.571236 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.572817 [debug] [MainThread]: On master: BEGIN
[0m13:21:51.573755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:51.639419 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m13:21:51.640613 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.642273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:51.660272 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m13:21:51.663550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f499a520>]}
[0m13:21:51.669333 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:51.672633 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.673370 [debug] [MainThread]: On master: BEGIN
[0m13:21:51.682820 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:21:51.684319 [debug] [MainThread]: On master: COMMIT
[0m13:21:51.684885 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.685765 [debug] [MainThread]: On master: COMMIT
[0m13:21:51.691673 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m13:21:51.692640 [debug] [MainThread]: On master: Close
[0m13:21:51.697700 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m13:21:51.698924 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m13:21:51.699673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m13:21:51.700637 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m13:21:51.702857 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m13:21:51.703638 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m13:21:51.709914 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m13:21:51.711037 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m13:21:51.734408 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m13:21:51.737058 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m13:21:51.722790 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m13:21:51.732088 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m13:21:51.760337 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m13:21:51.770247 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m13:21:51.758726 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m13:21:51.804802 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m13:21:51.802397 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m13:21:51.829911 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m13:21:51.827265 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m13:21:51.823822 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m13:21:51.844424 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m13:21:51.841058 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m13:21:51.853868 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m13:21:51.935868 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m13:21:52.222446 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:21:52.225244 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:21:52.231744 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:21:52.232555 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp132152068064"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m13:21:52.237648 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:21:52.238704 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp132152058538"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m13:21:52.239959 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp132152206010"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m13:21:52.241096 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:21:52.241866 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp132152060665"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m13:21:52.242431 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:21:52.242927 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:21:52.244013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:16.863597 [debug] [Thread-3  ]: SQL status: SELECT 20634 in 84.621 seconds
[0m13:23:16.897312 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:23:16.898051 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m13:23:16.902794 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m13:23:16.903679 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:23:16.904450 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp132152058538'
        
      order by ordinal_position

  
[0m13:23:16.928087 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.023 seconds
[0m13:23:16.938279 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:23:16.938950 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:16.946304 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m13:23:16.962257 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:23:16.963175 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:16.971014 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m13:23:16.999803 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m13:23:17.000797 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:23:17.001444 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp132152058538"
    )


  
[0m13:23:17.048173 [debug] [Thread-3  ]: SQL status: INSERT 0 20634 in 0.046 seconds
[0m13:23:17.078297 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m13:23:17.079112 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:23:17.079709 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m13:23:17.100064 [debug] [Thread-3  ]: SQL status: COMMIT in 0.019 seconds
[0m13:23:17.103742 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m13:23:17.108180 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f9a16ee0>]}
[0m13:23:17.109411 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 20634[0m in 85.35s]
[0m13:23:17.111286 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m13:23:21.748984 [debug] [Thread-4  ]: SQL status: SELECT 20634 in 89.506 seconds
[0m13:23:21.758667 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:23:21.759292 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m13:23:21.762090 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m13:23:21.762914 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:23:21.764362 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp132152206010'
        
      order by ordinal_position

  
[0m13:23:21.781609 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.016 seconds
[0m13:23:21.790248 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:23:21.791002 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:21.799847 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m13:23:21.809992 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:23:21.811023 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:21.819904 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m13:23:21.825898 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m13:23:21.826818 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:23:21.827391 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp132152206010"
    )


  
[0m13:23:22.734812 [debug] [Thread-2  ]: SQL status: SELECT 20634 in 90.494 seconds
[0m13:23:22.741123 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:23:22.741743 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m13:23:22.744738 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m13:23:22.745307 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:23:22.746602 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp132152068064'
        
      order by ordinal_position

  
[0m13:23:22.759190 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m13:23:22.766996 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:23:22.767881 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:22.777256 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m13:23:22.787432 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:23:22.790957 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:22.798003 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m13:23:22.803004 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m13:23:22.804235 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:23:22.805018 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp132152068064"
    )


  
[0m13:23:23.092899 [debug] [Thread-2  ]: SQL status: INSERT 0 20634 in 0.287 seconds
[0m13:23:23.097803 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m13:23:23.098816 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:23:23.099700 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m13:23:23.125157 [debug] [Thread-2  ]: SQL status: COMMIT in 0.025 seconds
[0m13:23:23.127056 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m13:23:23.128011 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ef595d90>]}
[0m13:23:23.128962 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 20634[0m in 91.39s]
[0m13:23:23.130473 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m13:23:24.538363 [debug] [Thread-4  ]: SQL status: INSERT 0 20634 in 2.710 seconds
[0m13:23:24.541681 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m13:23:24.543293 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:23:24.544072 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m13:23:24.568369 [debug] [Thread-4  ]: SQL status: COMMIT in 0.023 seconds
[0m13:23:24.570532 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m13:23:24.572910 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ef595c40>]}
[0m13:23:24.574885 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 20634[0m in 92.81s]
[0m13:23:24.578513 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m13:23:26.542020 [debug] [Thread-1  ]: SQL status: SELECT 20634 in 94.298 seconds
[0m13:23:26.547567 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:23:26.548141 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m13:23:26.551040 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m13:23:26.551646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:23:26.552478 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp132152060665'
        
      order by ordinal_position

  
[0m13:23:26.566549 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.013 seconds
[0m13:23:26.670617 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:23:26.671566 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:26.677292 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m13:23:26.683659 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:23:26.684441 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:23:26.690605 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m13:23:26.695266 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m13:23:26.696147 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:23:26.697635 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp132152060665"
    )


  
[0m13:23:27.738585 [debug] [Thread-1  ]: SQL status: INSERT 0 20634 in 1.040 seconds
[0m13:23:27.741746 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m13:23:27.742690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:23:27.743847 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m13:23:27.760973 [debug] [Thread-1  ]: SQL status: COMMIT in 0.016 seconds
[0m13:23:27.762814 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m13:23:27.765626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ecc62be0>]}
[0m13:23:27.766917 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 20634[0m in 96.07s]
[0m13:23:27.767817 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m13:23:27.769164 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m13:23:27.769884 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m13:23:27.771974 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m13:23:27.772616 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m13:23:27.770983 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m13:23:27.774027 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m13:23:27.774753 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m13:23:27.773180 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m13:23:27.783498 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m13:23:27.792368 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m13:23:27.793522 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m13:23:27.803777 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:23:27.804482 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp132327798879"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m13:23:27.805240 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:23:27.806176 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m13:23:27.813659 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:23:27.814551 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp132327810740"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m13:23:27.815348 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:28.140037 [debug] [Thread-3  ]: SQL status: SELECT 20634 in 60.335 seconds
[0m13:24:28.157293 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:24:28.158784 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m13:24:28.161951 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m13:24:28.162981 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:24:28.163717 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp132327798879'
        
      order by ordinal_position

  
[0m13:24:28.175479 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.011 seconds
[0m13:24:28.181949 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:24:28.182722 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:24:28.188538 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.005 seconds
[0m13:24:28.195275 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:24:28.195984 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:24:28.209340 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.013 seconds
[0m13:24:28.216448 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m13:24:28.217525 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:24:28.218151 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp132327798879"
    )


  
[0m13:24:30.056197 [debug] [Thread-3  ]: SQL status: INSERT 0 20634 in 1.837 seconds
[0m13:24:30.058918 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m13:24:30.059515 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:24:30.059929 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m13:24:30.089214 [debug] [Thread-3  ]: SQL status: COMMIT in 0.029 seconds
[0m13:24:30.091250 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m13:24:30.092701 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ef5f53d0>]}
[0m13:24:30.094157 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 20634[0m in 62.32s]
[0m13:24:30.094957 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m13:24:43.816956 [debug] [Thread-2  ]: SQL status: SELECT 1151 in 76.001 seconds
[0m13:24:43.823038 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:24:43.823648 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m13:24:43.827560 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m13:24:43.828453 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:24:43.829637 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp132327810740'
        
      order by ordinal_position

  
[0m13:24:43.840962 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.011 seconds
[0m13:24:43.854118 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:24:43.854832 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:24:43.861550 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m13:24:43.868608 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:24:43.869796 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:24:43.876691 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m13:24:43.884729 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m13:24:43.887310 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:24:43.888684 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp132327810740"
    )


  
[0m13:24:43.894273 [debug] [Thread-2  ]: SQL status: INSERT 0 1151 in 0.004 seconds
[0m13:24:43.897769 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m13:24:43.898544 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:24:43.901031 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m13:24:43.908214 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m13:24:43.910063 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m13:24:43.911559 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5591a849-d5f7-4fe2-93c3-a1f4089fcf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73ef5f5730>]}
[0m13:24:43.914034 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1151[0m in 76.14s]
[0m13:24:43.915206 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m13:24:43.917868 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:43.918797 [debug] [MainThread]: On master: BEGIN
[0m13:24:43.919263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:43.958454 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m13:24:43.959394 [debug] [MainThread]: On master: COMMIT
[0m13:24:43.959821 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:43.960159 [debug] [MainThread]: On master: COMMIT
[0m13:24:43.963001 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:24:43.963543 [debug] [MainThread]: On master: Close
[0m13:24:43.964519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:43.965294 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m13:24:43.965811 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m13:24:43.966169 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m13:24:43.966460 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m13:24:43.966894 [info ] [MainThread]: 
[0m13:24:43.967435 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 52.77 seconds (172.77s).
[0m13:24:43.970798 [debug] [MainThread]: Command end result
[0m13:24:44.034123 [info ] [MainThread]: 
[0m13:24:44.035126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:44.035682 [info ] [MainThread]: 
[0m13:24:44.037544 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:24:44.039017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 176.59879, "process_user_time": 7.406492, "process_kernel_time": 0.383833, "process_mem_max_rss": "111788", "process_out_blocks": "2992", "process_in_blocks": "0"}
[0m13:24:44.039980 [debug] [MainThread]: Command `dbt run` succeeded at 13:24:44.039785 after 176.60 seconds
[0m13:24:44.040726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f76a6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f74a60a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f4f91850>]}
[0m13:24:44.041284 [debug] [MainThread]: Flushing usage events
[0m13:24:44.757204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:57.001971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc860adee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8718b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc853f8970>]}


============================== 14:00:57.009707 | 8b504d33-ed59-4fa3-ae62-3c85510e5bbc ==============================
[0m14:00:57.009707 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m14:00:57.011086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:00:57.320090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc839d36d0>]}
[0m14:00:57.420997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc839a89d0>]}
[0m14:00:57.422358 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:00:57.459058 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m14:00:57.690043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:57.691145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:57.703339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m14:00:57.772478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc83651be0>]}
[0m14:00:57.962592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc83700be0>]}
[0m14:00:57.963675 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m14:00:57.964148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8384b820>]}
[0m14:00:57.968125 [info ] [MainThread]: 
[0m14:00:57.968727 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:00:57.969104 [info ] [MainThread]: 
[0m14:00:57.969906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:57.977808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m14:00:57.988962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m14:00:58.083222 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m14:00:58.084946 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m14:00:58.084190 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m14:00:58.085859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:58.086932 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m14:00:58.088845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:58.131513 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.046 seconds
[0m14:00:58.134074 [debug] [ThreadPool]: On list_lab08_db: Close
[0m14:00:58.135614 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.046 seconds
[0m14:00:58.139283 [debug] [ThreadPool]: On list_lab08_db: Close
[0m14:00:58.143756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m14:00:58.150330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m14:00:58.167079 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m14:00:58.168003 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m14:00:58.160824 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m14:00:58.169154 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m14:00:58.169855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:58.168584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:58.209215 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m14:00:58.210540 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m14:00:58.211208 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m14:00:58.219994 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m14:00:58.232281 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m14:00:58.236225 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m14:00:58.237180 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m14:00:58.239677 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m14:00:58.245756 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m14:00:58.253654 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m14:00:58.255847 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m14:00:58.260351 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m14:00:58.282125 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:58.283115 [debug] [MainThread]: On master: BEGIN
[0m14:00:58.283862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:58.318966 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:00:58.320185 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:58.320961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:58.329906 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m14:00:58.332616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc835e2100>]}
[0m14:00:58.333740 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:58.336549 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:58.337247 [debug] [MainThread]: On master: BEGIN
[0m14:00:58.342641 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:00:58.343875 [debug] [MainThread]: On master: COMMIT
[0m14:00:58.344421 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:58.346007 [debug] [MainThread]: On master: COMMIT
[0m14:00:58.349338 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:00:58.349941 [debug] [MainThread]: On master: Close
[0m14:00:58.368136 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m14:00:58.369048 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m14:00:58.378231 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m14:00:58.382206 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m14:00:58.369937 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m14:00:58.377526 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m14:00:58.385369 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m14:00:58.390063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m14:00:58.394757 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m14:00:58.393027 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m14:00:58.386708 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m14:00:58.393914 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m14:00:58.417277 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m14:00:58.408689 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m14:00:58.401167 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m14:00:58.445020 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m14:00:58.475539 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m14:00:58.489084 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m14:00:58.491836 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m14:00:58.495817 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m14:00:58.497114 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m14:00:58.498246 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m14:00:58.499005 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m14:00:58.499749 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m14:00:58.849533 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:00:58.857133 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp140058716123"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m14:00:58.840627 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:00:58.855871 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:00:58.861669 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp140058736546"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m14:00:58.853432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:00:58.863640 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp140058744535"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m14:00:58.864503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:00:58.858003 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:00:58.860542 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp140058712985"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m14:00:58.867065 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:00:58.862627 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:02:10.927205 [debug] [Thread-3  ]: SQL status: SELECT 19637 in 72.065 seconds
[0m14:02:10.955794 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:10.956428 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m14:02:10.959308 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m14:02:10.959982 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:10.960452 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp140058736546'
        
      order by ordinal_position

  
[0m14:02:11.003097 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.042 seconds
[0m14:02:11.018491 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:11.019926 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:11.031472 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.011 seconds
[0m14:02:11.052679 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:11.053750 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:11.078432 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.024 seconds
[0m14:02:11.109803 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m14:02:11.111017 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:11.111778 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp140058736546"
    )


  
[0m14:02:11.175311 [debug] [Thread-3  ]: SQL status: INSERT 0 19637 in 0.063 seconds
[0m14:02:11.210402 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m14:02:11.211464 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:11.212057 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m14:02:11.247359 [debug] [Thread-3  ]: SQL status: COMMIT in 0.034 seconds
[0m14:02:11.254833 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m14:02:11.262351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc821f4760>]}
[0m14:02:11.264540 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 19637[0m in 72.86s]
[0m14:02:11.266452 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m14:02:21.409672 [debug] [Thread-4  ]: SQL status: SELECT 19637 in 82.551 seconds
[0m14:02:21.417628 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:21.418242 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m14:02:21.421679 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m14:02:21.422246 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:21.422814 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp140058716123'
        
      order by ordinal_position

  
[0m14:02:21.437490 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m14:02:21.542092 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:21.543070 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:21.553636 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.009 seconds
[0m14:02:21.559413 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:21.560028 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:21.568973 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m14:02:21.573880 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m14:02:21.574773 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:21.575260 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp140058716123"
    )


  
[0m14:02:23.661784 [debug] [Thread-4  ]: SQL status: INSERT 0 19637 in 2.086 seconds
[0m14:02:23.665728 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m14:02:23.666594 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:23.667163 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m14:02:23.709081 [debug] [Thread-4  ]: SQL status: COMMIT in 0.041 seconds
[0m14:02:23.710943 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m14:02:23.712050 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc821f43a0>]}
[0m14:02:23.714289 [debug] [Thread-2  ]: SQL status: SELECT 19637 in 84.847 seconds
[0m14:02:23.713528 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 19637[0m in 85.30s]
[0m14:02:23.725683 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:23.727057 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m14:02:23.728524 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m14:02:23.732679 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m14:02:23.733312 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:23.734131 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp140058712985'
        
      order by ordinal_position

  
[0m14:02:23.746077 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m14:02:23.755580 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:23.756442 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:23.762768 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m14:02:23.768765 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:23.769464 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:23.777894 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m14:02:23.783896 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m14:02:23.785160 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:23.785871 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp140058712985"
    )


  
[0m14:02:23.880320 [debug] [Thread-2  ]: SQL status: INSERT 0 19637 in 0.094 seconds
[0m14:02:23.883586 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m14:02:23.884269 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:23.884916 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m14:02:23.914691 [debug] [Thread-2  ]: SQL status: COMMIT in 0.028 seconds
[0m14:02:23.916622 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m14:02:23.917935 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc821f41c0>]}
[0m14:02:23.918878 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 19637[0m in 85.53s]
[0m14:02:23.919769 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m14:02:26.480818 [debug] [Thread-1  ]: SQL status: SELECT 19637 in 87.616 seconds
[0m14:02:26.490014 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:26.490897 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m14:02:26.495156 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m14:02:26.496248 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:26.497207 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp140058744535'
        
      order by ordinal_position

  
[0m14:02:26.509470 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m14:02:26.519997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:26.521257 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:26.529026 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m14:02:26.551471 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:26.552214 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:26.559634 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m14:02:26.565783 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m14:02:26.568217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:26.569115 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp140058744535"
    )


  
[0m14:02:27.601337 [debug] [Thread-1  ]: SQL status: INSERT 0 19637 in 1.031 seconds
[0m14:02:27.605997 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m14:02:27.606769 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:27.607306 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m14:02:27.638967 [debug] [Thread-1  ]: SQL status: COMMIT in 0.030 seconds
[0m14:02:27.640902 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m14:02:27.641940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc82202850>]}
[0m14:02:27.645096 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 19637[0m in 89.25s]
[0m14:02:27.645984 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m14:02:27.647112 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m14:02:27.648103 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m14:02:27.649069 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m14:02:27.650145 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m14:02:27.651398 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m14:02:27.653170 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m14:02:27.665246 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m14:02:27.662851 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m14:02:27.666456 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m14:02:27.668234 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m14:02:27.688481 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:02:27.684906 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m14:02:27.690481 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp140227678888"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m14:02:27.692163 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:02:27.692973 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m14:02:27.705863 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:02:27.707280 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp140227702145"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m14:02:27.707928 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:03:24.209149 [debug] [Thread-3  ]: SQL status: SELECT 19637 in 56.517 seconds
[0m14:03:24.215606 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:24.217073 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m14:03:24.223378 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m14:03:24.224183 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:24.224854 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp140227678888'
        
      order by ordinal_position

  
[0m14:03:24.245990 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.020 seconds
[0m14:03:24.259545 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:24.263587 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:24.271724 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m14:03:24.281919 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:24.283144 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:24.291552 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m14:03:24.296418 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m14:03:24.297941 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:24.302514 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp140227678888"
    )


  
[0m14:03:24.329527 [debug] [Thread-3  ]: SQL status: INSERT 0 19637 in 0.026 seconds
[0m14:03:24.332851 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m14:03:24.334593 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:24.335111 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m14:03:24.352223 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m14:03:24.353749 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m14:03:24.354670 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc839ddb80>]}
[0m14:03:24.356220 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 19637[0m in 56.71s]
[0m14:03:24.357528 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m14:03:35.864108 [debug] [Thread-4  ]: SQL status: SELECT 1148 in 68.156 seconds
[0m14:03:35.875186 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:35.876220 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m14:03:35.881536 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m14:03:35.882345 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:35.883048 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp140227702145'
        
      order by ordinal_position

  
[0m14:03:35.901380 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.017 seconds
[0m14:03:35.911525 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:35.912876 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:35.921506 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.008 seconds
[0m14:03:35.929782 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:35.930618 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:35.938539 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.007 seconds
[0m14:03:35.943569 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m14:03:35.944692 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:35.945672 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp140227702145"
    )


  
[0m14:03:35.982263 [debug] [Thread-4  ]: SQL status: INSERT 0 1148 in 0.035 seconds
[0m14:03:35.984556 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m14:03:35.985167 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:35.985651 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m14:03:35.996833 [debug] [Thread-4  ]: SQL status: COMMIT in 0.010 seconds
[0m14:03:35.998597 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m14:03:36.002067 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b504d33-ed59-4fa3-ae62-3c85510e5bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc800f7a90>]}
[0m14:03:36.009011 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1148[0m in 68.34s]
[0m14:03:36.010280 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m14:03:36.012160 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:36.013180 [debug] [MainThread]: On master: BEGIN
[0m14:03:36.013832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:36.094142 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m14:03:36.094928 [debug] [MainThread]: On master: COMMIT
[0m14:03:36.095514 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:36.096090 [debug] [MainThread]: On master: COMMIT
[0m14:03:36.100367 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:03:36.101352 [debug] [MainThread]: On master: Close
[0m14:03:36.102791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:36.104190 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m14:03:36.104939 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m14:03:36.105483 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m14:03:36.106318 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m14:03:36.107601 [info ] [MainThread]: 
[0m14:03:36.109847 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 38.14 seconds (158.14s).
[0m14:03:36.116360 [debug] [MainThread]: Command end result
[0m14:03:36.196889 [info ] [MainThread]: 
[0m14:03:36.198924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:36.200179 [info ] [MainThread]: 
[0m14:03:36.201636 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:03:36.204199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 159.30347, "process_user_time": 4.923772, "process_kernel_time": 0.364807, "process_mem_max_rss": "105964", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m14:03:36.205445 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:36.205297 after 159.31 seconds
[0m14:03:36.207319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc860adee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc85eb1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8361e2e0>]}
[0m14:03:36.207907 [debug] [MainThread]: Flushing usage events
[0m14:03:36.970647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:57.572260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f608bae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f606859d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f600c1a00>]}


============================== 15:00:57.580073 | 52a8fd77-0d15-4861-83cb-1a113007345a ==============================
[0m15:00:57.580073 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:00:57.580756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:00:57.926355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5e1e2c70>]}
[0m15:00:58.043148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f601e4f70>]}
[0m15:00:58.044700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:00:58.079174 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m15:00:58.354392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:58.355201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:58.371532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m15:00:58.461908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5dea1bb0>]}
[0m15:00:58.680194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5de8cbb0>]}
[0m15:00:58.681530 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m15:00:58.682929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5e088fd0>]}
[0m15:00:58.686601 [info ] [MainThread]: 
[0m15:00:58.688269 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:00:58.689504 [info ] [MainThread]: 
[0m15:00:58.690898 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:58.699164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m15:00:58.700291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m15:00:58.801335 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m15:00:58.802057 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m15:00:58.803095 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m15:00:58.803617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:58.802631 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m15:00:58.804494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:58.852249 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.048 seconds
[0m15:00:58.855080 [debug] [ThreadPool]: On list_lab08_db: Close
[0m15:00:58.855911 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.052 seconds
[0m15:00:58.859316 [debug] [ThreadPool]: On list_lab08_db: Close
[0m15:00:58.863560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m15:00:58.865255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m15:00:58.893956 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m15:00:58.894715 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m15:00:58.895512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:58.899572 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m15:00:58.900184 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m15:00:58.900732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:58.937378 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m15:00:58.938385 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m15:00:58.940068 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m15:00:58.949900 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m15:00:58.951503 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m15:00:58.952213 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m15:00:58.954361 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m15:00:58.957384 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m15:00:58.959807 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m15:00:58.960742 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m15:00:58.963341 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m15:00:58.970905 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m15:00:58.986115 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:58.988357 [debug] [MainThread]: On master: BEGIN
[0m15:00:58.989177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:59.049583 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m15:00:59.050265 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:59.050919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:59.065694 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m15:00:59.068208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5cda1310>]}
[0m15:00:59.069205 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:59.075537 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:59.076080 [debug] [MainThread]: On master: BEGIN
[0m15:00:59.085123 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:00:59.085807 [debug] [MainThread]: On master: COMMIT
[0m15:00:59.086372 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:59.086925 [debug] [MainThread]: On master: COMMIT
[0m15:00:59.091938 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:00:59.092548 [debug] [MainThread]: On master: Close
[0m15:00:59.099463 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m15:00:59.100622 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m15:00:59.103651 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m15:00:59.105462 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m15:00:59.104807 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m15:00:59.102007 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m15:00:59.106387 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m15:00:59.107726 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m15:00:59.108945 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m15:00:59.110212 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m15:00:59.111328 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m15:00:59.123151 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m15:00:59.134521 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m15:00:59.138991 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m15:00:59.140474 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m15:00:59.141573 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m15:00:59.151211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m15:00:59.152842 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m15:00:59.153989 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m15:00:59.163199 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m15:00:59.172318 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m15:00:59.186222 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m15:00:59.196217 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m15:00:59.281619 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m15:00:59.526607 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:00:59.547026 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp150059455330"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m15:00:59.533742 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:00:59.551446 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp150059379870"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m15:00:59.528786 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:00:59.548180 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:00:59.552799 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:00:59.544337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:00:59.553557 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp150059397993"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m15:00:59.555949 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp150059403101"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m15:00:59.558108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:59.556820 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:02:08.074490 [debug] [Thread-3  ]: SQL status: SELECT 18116 in 68.522 seconds
[0m15:02:08.123857 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:08.125304 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m15:02:08.129520 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m15:02:08.130419 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:08.131020 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp150059379870'
        
      order by ordinal_position

  
[0m15:02:08.144653 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.013 seconds
[0m15:02:08.154481 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:08.155319 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:08.162725 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m15:02:08.181280 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:08.182537 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:08.189527 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m15:02:08.216737 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m15:02:08.218032 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:08.218829 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp150059379870"
    )


  
[0m15:02:08.251225 [debug] [Thread-3  ]: SQL status: INSERT 0 18116 in 0.031 seconds
[0m15:02:08.294282 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m15:02:08.295873 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:08.297079 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m15:02:08.316333 [debug] [Thread-3  ]: SQL status: COMMIT in 0.018 seconds
[0m15:02:08.320269 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m15:02:08.323801 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5c9e8700>]}
[0m15:02:08.324827 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 18116[0m in 69.20s]
[0m15:02:08.325933 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m15:02:17.347226 [debug] [Thread-2  ]: SQL status: SELECT 18116 in 77.799 seconds
[0m15:02:17.354785 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:17.356119 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m15:02:17.359921 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m15:02:17.360567 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:17.362091 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp150059455330'
        
      order by ordinal_position

  
[0m15:02:17.380690 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.017 seconds
[0m15:02:17.394204 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:17.395066 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:17.404523 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.009 seconds
[0m15:02:17.498556 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:17.499214 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:17.509321 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.009 seconds
[0m15:02:17.514047 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m15:02:17.515151 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:17.515972 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp150059455330"
    )


  
[0m15:02:17.587400 [debug] [Thread-2  ]: SQL status: INSERT 0 18116 in 0.071 seconds
[0m15:02:17.592115 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m15:02:17.593079 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:17.593654 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m15:02:17.618763 [debug] [Thread-2  ]: SQL status: COMMIT in 0.024 seconds
[0m15:02:17.620634 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m15:02:17.622214 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5c9f8f70>]}
[0m15:02:17.623485 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 18116[0m in 78.52s]
[0m15:02:17.625045 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m15:02:17.984015 [debug] [Thread-4  ]: SQL status: SELECT 18116 in 78.427 seconds
[0m15:02:17.992975 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:17.994347 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m15:02:17.997351 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m15:02:17.998231 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:17.999073 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp150059397993'
        
      order by ordinal_position

  
[0m15:02:18.013904 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m15:02:18.021744 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:18.022597 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:18.032301 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.009 seconds
[0m15:02:18.039819 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:18.040514 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:18.047090 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m15:02:18.057090 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m15:02:18.058340 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:18.059059 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp150059397993"
    )


  
[0m15:02:19.111702 [debug] [Thread-4  ]: SQL status: INSERT 0 18116 in 1.052 seconds
[0m15:02:19.116325 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m15:02:19.117200 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:19.117894 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m15:02:19.125273 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m15:02:19.126568 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m15:02:19.127509 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5c9e8c70>]}
[0m15:02:19.128557 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 18116[0m in 79.99s]
[0m15:02:19.129750 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m15:02:24.232057 [debug] [Thread-1  ]: SQL status: SELECT 18116 in 84.674 seconds
[0m15:02:24.237673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:24.238369 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m15:02:24.243525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m15:02:24.244514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:24.245352 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp150059403101'
        
      order by ordinal_position

  
[0m15:02:24.257061 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m15:02:24.267088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:24.268343 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:24.275479 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m15:02:24.282262 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:24.283015 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:24.290155 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m15:02:24.297237 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m15:02:24.298357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:24.298958 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp150059403101"
    )


  
[0m15:02:24.943151 [debug] [Thread-1  ]: SQL status: INSERT 0 18116 in 0.643 seconds
[0m15:02:24.946602 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m15:02:24.948029 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:24.948893 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m15:02:24.985947 [debug] [Thread-1  ]: SQL status: COMMIT in 0.036 seconds
[0m15:02:24.987503 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m15:02:24.988515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5ddde100>]}
[0m15:02:24.990234 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 18116[0m in 85.88s]
[0m15:02:24.991432 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m15:02:24.993382 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m15:02:24.994889 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m15:02:24.994065 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m15:02:24.998294 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m15:02:24.999621 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m15:02:25.000399 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m15:02:24.996882 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m15:02:25.009619 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m15:02:25.016354 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m15:02:25.008835 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m15:02:25.018081 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m15:02:25.025356 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:02:25.026333 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m15:02:25.033918 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:02:25.034646 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp150225031258"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m15:02:25.035390 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:02:25.027213 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp150225023199"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m15:02:25.037134 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:03:26.089541 [debug] [Thread-3  ]: SQL status: SELECT 18116 in 61.054 seconds
[0m15:03:26.095629 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:26.101530 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m15:03:26.106978 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m15:03:26.109384 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:26.110665 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp150225031258'
        
      order by ordinal_position

  
[0m15:03:26.124321 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.013 seconds
[0m15:03:26.130588 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:26.133044 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:26.140224 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m15:03:26.148433 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:26.152676 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:26.164325 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m15:03:26.167656 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m15:03:26.168972 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:26.169779 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp150225031258"
    )


  
[0m15:03:26.207063 [debug] [Thread-3  ]: SQL status: INSERT 0 18116 in 0.036 seconds
[0m15:03:26.209534 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m15:03:26.210302 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:26.211350 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m15:03:26.235297 [debug] [Thread-3  ]: SQL status: COMMIT in 0.023 seconds
[0m15:03:26.236906 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m15:03:26.238080 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5ca355e0>]}
[0m15:03:26.239473 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 18116[0m in 61.24s]
[0m15:03:26.240896 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m15:03:44.624007 [debug] [Thread-2  ]: SQL status: SELECT 1028 in 79.587 seconds
[0m15:03:44.630049 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:44.630776 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m15:03:44.636064 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m15:03:44.636663 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:44.637135 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp150225023199'
        
      order by ordinal_position

  
[0m15:03:44.650353 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.012 seconds
[0m15:03:44.660407 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:44.661597 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:44.668369 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.005 seconds
[0m15:03:44.679093 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:44.680034 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:44.686475 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m15:03:44.692310 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m15:03:44.693908 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:44.694586 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp150225023199"
    )


  
[0m15:03:44.795472 [debug] [Thread-2  ]: SQL status: INSERT 0 1028 in 0.100 seconds
[0m15:03:44.798089 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m15:03:44.798909 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:44.799546 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m15:03:44.812320 [debug] [Thread-2  ]: SQL status: COMMIT in 0.012 seconds
[0m15:03:44.813772 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m15:03:44.814774 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a8fd77-0d15-4861-83cb-1a113007345a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5c99c790>]}
[0m15:03:44.816933 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1028[0m in 79.82s]
[0m15:03:44.818705 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m15:03:44.822208 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:44.822807 [debug] [MainThread]: On master: BEGIN
[0m15:03:44.823826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:44.864973 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m15:03:44.866570 [debug] [MainThread]: On master: COMMIT
[0m15:03:44.867417 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:44.867990 [debug] [MainThread]: On master: COMMIT
[0m15:03:44.870903 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:03:44.871926 [debug] [MainThread]: On master: Close
[0m15:03:44.872988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:44.874523 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m15:03:44.875329 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m15:03:44.876067 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m15:03:44.876535 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m15:03:44.877243 [info ] [MainThread]: 
[0m15:03:44.880731 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 46.19 seconds (166.19s).
[0m15:03:44.884167 [debug] [MainThread]: Command end result
[0m15:03:44.951954 [info ] [MainThread]: 
[0m15:03:44.953692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:44.955138 [info ] [MainThread]: 
[0m15:03:44.956222 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:03:44.958271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 167.49922, "process_user_time": 4.606201, "process_kernel_time": 0.439496, "process_mem_max_rss": "106240", "process_out_blocks": "2120", "process_in_blocks": "0"}
[0m15:03:44.959276 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:44.959065 after 167.50 seconds
[0m15:03:44.960006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f608bae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f606bb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5de2a2e0>]}
[0m15:03:44.960756 [debug] [MainThread]: Flushing usage events
[0m15:03:45.664957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:22.979728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02bae0a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02bac65d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ba5a5ca0>]}


============================== 15:11:22.989231 | 3fffc091-7818-44cc-acd8-a05b8285142d ==============================
[0m15:11:22.989231 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:11:22.990772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /dbt --project-dir /dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:23.000405 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m15:11:23.002355 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.14192839, "process_user_time": 2.381398, "process_kernel_time": 0.217475, "process_mem_max_rss": "82680", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m15:11:23.003680 [debug] [MainThread]: Command `dbt docs generate` failed at 15:11:23.003461 after 0.14 seconds
[0m15:11:23.004461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02bae0a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ba05ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ba05e4c0>]}
[0m15:11:23.005286 [debug] [MainThread]: Flushing usage events
[0m15:11:23.513882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:55.208205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cbdd0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cb0b0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cb0b0550>]}


============================== 15:28:55.225207 | 030ac038-1345-4c4e-8579-8aed8f7f0e96 ==============================
[0m15:28:55.225207 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:28:55.227323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:28:55.238636 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m15:28:55.240401 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.13182195, "process_user_time": 2.411582, "process_kernel_time": 0.181537, "process_mem_max_rss": "82700", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m15:28:55.241378 [debug] [MainThread]: Command `dbt docs generate` failed at 15:28:55.241232 after 0.13 seconds
[0m15:28:55.242498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cbdd0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cb024a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34cb024850>]}
[0m15:28:55.243168 [debug] [MainThread]: Flushing usage events
[0m15:28:55.806904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:14.982607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36135ee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36129bbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36129a7700>]}


============================== 15:32:14.999609 | 6ddd22ff-787d-4514-b7ad-f7c43506e1ce ==============================
[0m15:32:14.999609 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:32:15.001756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:32:15.520800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ddd22ff-787d-4514-b7ad-f7c43506e1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36129b0250>]}
[0m15:32:15.701529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ddd22ff-787d-4514-b7ad-f7c43506e1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610f76ac0>]}
[0m15:32:15.707143 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:32:15.746636 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m15:32:16.140677 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:32:16.142677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ddd22ff-787d-4514-b7ad-f7c43506e1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3612ddf8b0>]}
[0m15:32:19.467139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m15:32:19.507896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ddd22ff-787d-4514-b7ad-f7c43506e1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36109f6460>]}
[0m15:32:19.536269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ddd22ff-787d-4514-b7ad-f7c43506e1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361090aaf0>]}
[0m15:32:19.537577 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m15:32:19.538937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ddd22ff-787d-4514-b7ad-f7c43506e1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361090aa00>]}
[0m15:32:19.542639 [info ] [MainThread]: 
[0m15:32:19.544401 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:32:19.546132 [info ] [MainThread]: 
[0m15:32:19.547764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:32:19.561090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db_ods_dev'
[0m15:32:19.593305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db_dm_dev'
[0m15:32:19.667419 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m15:32:19.668093 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m15:32:19.669371 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m15:32:19.669955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:19.668805 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m15:32:19.671209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:19.739660 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m15:32:19.740469 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m15:32:19.741568 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m15:32:19.742345 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m15:32:19.741044 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m15:32:19.743322 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m15:32:19.754528 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m15:32:19.755609 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m15:32:19.761403 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m15:32:19.758351 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m15:32:19.764740 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m15:32:19.767506 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m15:32:19.777694 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:19.778625 [debug] [MainThread]: On master: BEGIN
[0m15:32:19.779057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:19.812319 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m15:32:19.813080 [debug] [MainThread]: Using postgres connection "master"
[0m15:32:19.813825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:32:19.831063 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m15:32:19.834061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ddd22ff-787d-4514-b7ad-f7c43506e1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610926370>]}
[0m15:32:19.835096 [debug] [MainThread]: On master: ROLLBACK
[0m15:32:19.838012 [debug] [MainThread]: On master: Close
[0m15:32:19.842551 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m15:32:19.843368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m15:32:19.844312 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m15:32:19.850096 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m15:32:19.850950 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m15:32:19.851570 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m15:32:19.852226 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m15:32:19.854192 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m15:32:19.852940 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m15:32:19.855903 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m15:32:19.856627 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m15:32:19.855101 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m15:32:19.904954 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m15:32:19.907095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m15:32:19.917777 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m15:32:19.918825 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m15:32:19.916231 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m15:32:19.919737 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m15:32:19.911207 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m15:32:19.923239 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m15:32:19.922397 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m15:32:19.929978 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m15:32:19.921577 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m15:32:19.931643 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.dm_events
[0m15:32:19.932504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_browser_events, now model.dbt_lab08_project.dm_events)
[0m15:32:19.933326 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m15:32:19.928170 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m15:32:19.943000 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m15:32:19.943741 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m15:32:19.944841 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m15:32:19.939521 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m15:32:19.958661 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.dm_events
[0m15:32:19.960884 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.dm_events
[0m15:32:19.963061 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m15:32:19.965578 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m15:32:19.967018 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m15:32:19.970807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:19.971492 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m15:32:19.972092 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m15:32:19.973238 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_geo_events' was properly closed.
[0m15:32:19.973665 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m15:32:19.976408 [debug] [MainThread]: Command end result
[0m15:32:20.172639 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m15:32:20.173231 [info ] [MainThread]: Building catalog
[0m15:32:20.200961 [debug] [ThreadPool]: Acquiring new postgres connection 'lab08_db.information_schema'
[0m15:32:20.228353 [debug] [ThreadPool]: Using postgres connection "lab08_db.information_schema"
[0m15:32:20.230491 [debug] [ThreadPool]: On lab08_db.information_schema: BEGIN
[0m15:32:20.231407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:20.268572 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m15:32:20.269938 [debug] [ThreadPool]: Using postgres connection "lab08_db.information_schema"
[0m15:32:20.270846 [debug] [ThreadPool]: On lab08_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "lab08_db.information_schema"} */

    
    

    select
        'lab08_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_geo_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_geo_events')) or (upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_browser_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_device_events')) or (upper(sch.nspname) = upper('dm_dev') and
           upper(tbl.relname) = upper('dm_events')) or (upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_device_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_browser_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_location_events')) or (upper(sch.nspname) = upper('dm_dev') and
           upper(tbl.relname) = upper('dm_sales')) or (upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_location_events')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m15:32:20.284943 [debug] [ThreadPool]: SQL status: SELECT 75 in 0.012 seconds
[0m15:32:20.298304 [debug] [ThreadPool]: On lab08_db.information_schema: ROLLBACK
[0m15:32:20.301407 [debug] [ThreadPool]: On lab08_db.information_schema: Close
[0m15:32:20.382468 [info ] [MainThread]: Catalog written to /dbt/target/catalog.json
[0m15:32:20.385582 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.592145, "process_user_time": 6.646393, "process_kernel_time": 0.496031, "process_mem_max_rss": "109876", "process_out_blocks": "6536", "process_in_blocks": "0"}
[0m15:32:20.386962 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:32:20.386761 after 5.59 seconds
[0m15:32:20.387684 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:32:20.388556 [debug] [MainThread]: Connection 'lab08_db.information_schema' was properly closed.
[0m15:32:20.389471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36135ee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610df11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3610a6dbe0>]}
[0m15:32:20.390314 [debug] [MainThread]: Flushing usage events
[0m15:32:20.937847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:01.345912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb7dd2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb70aaee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb70aadc0>]}


============================== 15:33:01.358582 | 39bf77b2-02df-49c2-9d7b-e59d51454bc9 ==============================
[0m15:33:01.358582 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:33:01.359697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:01.798180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39bf77b2-02df-49c2-9d7b-e59d51454bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb5769e80>]}
[0m15:33:01.948525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39bf77b2-02df-49c2-9d7b-e59d51454bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb72602e0>]}
[0m15:33:22.762489 [error] [MainThread]: Encountered an error:

[0m15:33:22.765070 [error] [MainThread]: Traceback (most recent call last):
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/root/.local/lib/python3.8/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:33:22.767913 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 21.55295, "process_user_time": 2.915157, "process_kernel_time": 0.249869, "process_mem_max_rss": "90344", "process_in_blocks": "48", "process_out_blocks": "3400", "command_success": false}
[0m15:33:22.769341 [debug] [MainThread]: Command `dbt docs serve` failed at 15:33:22.769094 after 21.55 seconds
[0m15:33:22.769927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb7dd2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb558b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb55ac9d0>]}
[0m15:33:22.770730 [debug] [MainThread]: Flushing usage events
[0m15:33:23.278533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:49.042952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3500f44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34f3cfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34f3cf0d0>]}


============================== 15:33:49.053475 | 453a4383-304f-4202-9fd0-0106ca2d2e39 ==============================
[0m15:33:49.053475 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:33:49.054810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8082', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:49.374841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '453a4383-304f-4202-9fd0-0106ca2d2e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35248ecd0>]}
[0m15:33:49.518243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '453a4383-304f-4202-9fd0-0106ca2d2e39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd350e897f0>]}
[0m15:37:46.247176 [error] [MainThread]: Encountered an error:

[0m15:37:46.249882 [error] [MainThread]: Traceback (most recent call last):
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/root/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/root/.local/lib/python3.8/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:37:46.251677 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 237.30841, "process_user_time": 2.949508, "process_kernel_time": 0.180874, "process_mem_max_rss": "90480", "process_out_blocks": "3368", "command_success": false, "process_in_blocks": "0"}
[0m15:37:46.252568 [debug] [MainThread]: Command `dbt docs serve` failed at 15:37:46.252422 after 237.31 seconds
[0m15:37:46.253110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3500f44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34d86e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34d88ca60>]}
[0m15:37:46.253673 [debug] [MainThread]: Flushing usage events
[0m15:37:46.761623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:54.636758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b9dcce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b9b979d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b95d6a00>]}


============================== 16:00:54.645763 | 5d8008d5-ac36-4169-aefc-e5aac68d8da3 ==============================
[0m16:00:54.645763 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:00:54.646517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:00:54.948113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b7759fa0>]}
[0m16:00:55.049273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b96eff70>]}
[0m16:00:55.050812 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:55.089169 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m16:00:55.345832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:55.346460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:55.359001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m16:00:55.440665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b73b1b20>]}
[0m16:00:55.655493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b73a0bb0>]}
[0m16:00:55.656359 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m16:00:55.656884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b74bbfa0>]}
[0m16:00:55.659355 [info ] [MainThread]: 
[0m16:00:55.659919 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:00:55.660272 [info ] [MainThread]: 
[0m16:00:55.661078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:55.671666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m16:00:55.682943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m16:00:55.787776 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m16:00:55.788470 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m16:00:55.789273 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:55.789660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:55.788898 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:55.790703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:55.834026 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.043 seconds
[0m16:00:55.836613 [debug] [ThreadPool]: On list_lab08_db: Close
[0m16:00:55.838654 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.049 seconds
[0m16:00:55.840802 [debug] [ThreadPool]: On list_lab08_db: Close
[0m16:00:55.847092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m16:00:55.862725 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m16:00:55.863499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m16:00:55.868635 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m16:00:55.869403 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m16:00:55.869845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:55.864177 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m16:00:55.871067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:55.908305 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m16:00:55.910861 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m16:00:55.911700 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m16:00:55.920610 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m16:00:55.922921 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m16:00:55.925599 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m16:00:55.929526 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m16:00:55.930186 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m16:00:55.931363 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m16:00:55.949408 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m16:00:55.957916 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m16:00:55.961884 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m16:00:55.976311 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:55.977774 [debug] [MainThread]: On master: BEGIN
[0m16:00:55.978383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:56.016807 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m16:00:56.017990 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:56.018754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:56.028771 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m16:00:56.031809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b73000d0>]}
[0m16:00:56.032647 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:56.036476 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:56.037114 [debug] [MainThread]: On master: BEGIN
[0m16:00:56.042370 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:00:56.043184 [debug] [MainThread]: On master: COMMIT
[0m16:00:56.044061 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:56.044846 [debug] [MainThread]: On master: COMMIT
[0m16:00:56.047444 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:00:56.048193 [debug] [MainThread]: On master: Close
[0m16:00:56.057091 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m16:00:56.058439 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m16:00:56.061488 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m16:00:56.059712 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m16:00:56.066143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m16:00:56.063600 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m16:00:56.067649 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m16:00:56.062229 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m16:00:56.068435 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m16:00:56.064963 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m16:00:56.076472 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m16:00:56.082434 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m16:00:56.066800 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m16:00:56.069801 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m16:00:56.125910 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m16:00:56.139994 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m16:00:56.137324 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m16:00:56.138825 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m16:00:56.163301 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m16:00:56.134393 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m16:00:56.181255 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m16:00:56.184641 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m16:00:56.197450 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m16:00:56.269025 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m16:00:56.520888 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:00:56.521678 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp160056388791"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m16:00:56.523083 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:00:56.524475 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:00:56.530391 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:00:56.531296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:00:56.532347 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp160056378967"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m16:00:56.539219 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:00:56.533762 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp160056332412"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m16:00:56.537137 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp160056311258"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m16:00:56.541565 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:00:56.542322 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:02:12.610587 [debug] [Thread-3  ]: SQL status: SELECT 16448 in 76.068 seconds
[0m16:02:12.646831 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:12.647708 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m16:02:12.651082 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m16:02:12.651889 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:12.652629 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp160056311258'
        
      order by ordinal_position

  
[0m16:02:12.670041 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.017 seconds
[0m16:02:12.688243 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:12.689206 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:12.696491 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m16:02:12.717547 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:12.718504 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:12.724776 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m16:02:12.748520 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m16:02:12.749698 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:12.750300 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp160056311258"
    )


  
[0m16:02:12.787031 [debug] [Thread-3  ]: SQL status: INSERT 0 16448 in 0.036 seconds
[0m16:02:12.843069 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m16:02:12.845852 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:12.846686 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m16:02:12.861440 [debug] [Thread-3  ]: SQL status: COMMIT in 0.014 seconds
[0m16:02:12.865638 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m16:02:12.870151 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b5f28610>]}
[0m16:02:12.872055 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 16448[0m in 76.79s]
[0m16:02:12.874738 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m16:02:21.156830 [debug] [Thread-4  ]: SQL status: SELECT 16448 in 84.615 seconds
[0m16:02:21.170397 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:21.171655 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m16:02:21.177597 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m16:02:21.178321 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:21.178961 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp160056332412'
        
      order by ordinal_position

  
[0m16:02:21.218362 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.039 seconds
[0m16:02:21.233643 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:21.234732 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:21.248201 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m16:02:21.337708 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:21.338485 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:21.349162 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.010 seconds
[0m16:02:21.353567 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m16:02:21.354743 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:21.355250 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp160056332412"
    )


  
[0m16:02:22.062413 [debug] [Thread-2  ]: SQL status: SELECT 16448 in 85.523 seconds
[0m16:02:22.070430 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:22.071169 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m16:02:22.075337 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m16:02:22.076056 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:22.076873 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp160056378967'
        
      order by ordinal_position

  
[0m16:02:22.101705 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.024 seconds
[0m16:02:22.107787 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:22.108578 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:22.119784 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.010 seconds
[0m16:02:22.127052 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:22.127772 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:22.136108 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m16:02:22.140943 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m16:02:22.141994 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:22.142685 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp160056378967"
    )


  
[0m16:02:22.182030 [debug] [Thread-2  ]: SQL status: INSERT 0 16448 in 0.038 seconds
[0m16:02:22.186658 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m16:02:22.187311 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:22.187939 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m16:02:22.218185 [debug] [Thread-2  ]: SQL status: COMMIT in 0.029 seconds
[0m16:02:22.219714 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m16:02:22.220623 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b460efd0>]}
[0m16:02:22.221789 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 16448[0m in 86.15s]
[0m16:02:22.222779 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m16:02:22.669226 [debug] [Thread-4  ]: SQL status: INSERT 0 16448 in 1.313 seconds
[0m16:02:22.671820 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m16:02:22.672456 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:22.673370 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m16:02:22.682423 [debug] [Thread-4  ]: SQL status: COMMIT in 0.008 seconds
[0m16:02:22.684469 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m16:02:22.685765 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b446bc40>]}
[0m16:02:22.686641 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 16448[0m in 86.55s]
[0m16:02:22.687616 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m16:02:24.358394 [debug] [Thread-1  ]: SQL status: SELECT 16448 in 87.827 seconds
[0m16:02:24.365618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:24.366492 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m16:02:24.370317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m16:02:24.371082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:24.372027 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp160056388791'
        
      order by ordinal_position

  
[0m16:02:24.392237 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.018 seconds
[0m16:02:24.403263 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:24.406918 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:24.414961 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m16:02:24.425253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:24.426426 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:24.435144 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m16:02:24.443230 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m16:02:24.451729 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:24.454694 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp160056388791"
    )


  
[0m16:02:24.564523 [debug] [Thread-1  ]: SQL status: INSERT 0 16448 in 0.106 seconds
[0m16:02:24.569983 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m16:02:24.570652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:24.571192 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m16:02:24.598905 [debug] [Thread-1  ]: SQL status: COMMIT in 0.027 seconds
[0m16:02:24.600296 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m16:02:24.601359 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b5ed7e20>]}
[0m16:02:24.602330 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 16448[0m in 88.54s]
[0m16:02:24.603143 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m16:02:24.604647 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m16:02:24.605909 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m16:02:24.607002 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m16:02:24.609456 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m16:02:24.610585 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m16:02:24.607942 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m16:02:24.617082 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m16:02:24.617969 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m16:02:24.627913 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m16:02:24.631392 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m16:02:24.632357 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m16:02:24.633128 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m16:02:24.640982 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:02:24.648567 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:02:24.649756 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp160224637693"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m16:02:24.650720 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp160224645548"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m16:02:24.651539 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:02:24.653032 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:03:21.956085 [debug] [Thread-3  ]: SQL status: SELECT 16448 in 57.303 seconds
[0m16:03:21.963701 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:21.964730 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m16:03:21.968190 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m16:03:21.970020 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:21.970686 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp160224645548'
        
      order by ordinal_position

  
[0m16:03:21.995542 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.024 seconds
[0m16:03:22.002208 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:22.003064 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:22.014176 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m16:03:22.024481 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:22.025604 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:22.040335 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.013 seconds
[0m16:03:22.044382 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m16:03:22.045436 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:22.045904 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp160224645548"
    )


  
[0m16:03:22.075226 [debug] [Thread-3  ]: SQL status: INSERT 0 16448 in 0.029 seconds
[0m16:03:22.078654 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m16:03:22.079791 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:22.080340 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m16:03:22.100182 [debug] [Thread-3  ]: SQL status: COMMIT in 0.018 seconds
[0m16:03:22.109722 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m16:03:22.111172 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b5ec0100>]}
[0m16:03:22.112580 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 16448[0m in 57.50s]
[0m16:03:22.114172 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m16:03:36.928863 [debug] [Thread-2  ]: SQL status: SELECT 928 in 72.277 seconds
[0m16:03:36.939216 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:36.940130 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m16:03:36.944934 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m16:03:36.945790 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:36.946813 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp160224637693'
        
      order by ordinal_position

  
[0m16:03:36.962742 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.015 seconds
[0m16:03:36.973088 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:36.974031 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:36.981139 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m16:03:36.989602 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:36.990624 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:37.002309 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.011 seconds
[0m16:03:37.006700 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m16:03:37.008518 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:37.009172 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp160224637693"
    )


  
[0m16:03:37.016117 [debug] [Thread-2  ]: SQL status: INSERT 0 928 in 0.006 seconds
[0m16:03:37.019306 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m16:03:37.020117 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:37.020923 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m16:03:37.029604 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m16:03:37.031528 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m16:03:37.033270 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8008d5-ac36-4169-aefc-e5aac68d8da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b5ec7ee0>]}
[0m16:03:37.034311 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 928[0m in 72.42s]
[0m16:03:37.035883 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m16:03:37.038613 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:37.039716 [debug] [MainThread]: On master: BEGIN
[0m16:03:37.040224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:37.095166 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m16:03:37.095919 [debug] [MainThread]: On master: COMMIT
[0m16:03:37.096776 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:37.097629 [debug] [MainThread]: On master: COMMIT
[0m16:03:37.100244 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:03:37.100801 [debug] [MainThread]: On master: Close
[0m16:03:37.101816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:37.102392 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m16:03:37.102893 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m16:03:37.103486 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m16:03:37.103923 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m16:03:37.104401 [info ] [MainThread]: 
[0m16:03:37.104941 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 41.44 seconds (161.44s).
[0m16:03:37.106788 [debug] [MainThread]: Command end result
[0m16:03:37.163496 [info ] [MainThread]: 
[0m16:03:37.164212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:37.164634 [info ] [MainThread]: 
[0m16:03:37.165102 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:03:37.166548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 162.65355, "process_user_time": 4.824853, "process_kernel_time": 0.346579, "process_mem_max_rss": "106096", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m16:03:37.167247 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:37.167112 after 162.65 seconds
[0m16:03:37.167755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b9dcce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b73a0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60b733c2e0>]}
[0m16:03:37.168279 [debug] [MainThread]: Flushing usage events
[0m16:03:37.807929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:42.799143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257e84e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257662490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc25730fc10>]}


============================== 16:03:42.806533 | 51f9d688-4dc2-497a-8ae6-e35ad4a5d1db ==============================
[0m16:03:42.806533 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:03:42.807312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:03:43.156007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51f9d688-4dc2-497a-8ae6-e35ad4a5d1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc25a228730>]}
[0m16:03:43.309597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51f9d688-4dc2-497a-8ae6-e35ad4a5d1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc255810340>]}
[0m16:03:43.311209 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:03:43.343057 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m16:03:43.619087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:43.619764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:43.630993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m16:03:43.709000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51f9d688-4dc2-497a-8ae6-e35ad4a5d1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc25542af10>]}
[0m16:03:43.735174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51f9d688-4dc2-497a-8ae6-e35ad4a5d1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc255481fd0>]}
[0m16:03:43.736400 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m16:03:43.737569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f9d688-4dc2-497a-8ae6-e35ad4a5d1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc255481f40>]}
[0m16:03:43.742291 [info ] [MainThread]: 
[0m16:03:43.744147 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:03:43.745044 [info ] [MainThread]: 
[0m16:03:43.746072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:43.759151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db_dm_dev'
[0m16:03:43.760868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db_ods_dev'
[0m16:03:43.872161 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m16:03:43.873785 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m16:03:43.874442 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m16:03:43.874947 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m16:03:43.875676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:43.876559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:43.922269 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:03:43.923059 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:03:43.925803 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m16:03:43.926286 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m16:03:43.924113 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m16:03:43.927677 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m16:03:43.935801 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m16:03:43.937311 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m16:03:43.942587 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m16:03:43.950483 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m16:03:43.954138 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m16:03:43.956452 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m16:03:43.967563 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:43.968308 [debug] [MainThread]: On master: BEGIN
[0m16:03:43.968764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:44.004513 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m16:03:44.005514 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:44.006325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:44.017167 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m16:03:44.020129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51f9d688-4dc2-497a-8ae6-e35ad4a5d1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc25548ec40>]}
[0m16:03:44.021412 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:44.024729 [debug] [MainThread]: On master: Close
[0m16:03:44.030835 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m16:03:44.032518 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m16:03:44.033460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m16:03:44.034319 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m16:03:44.035331 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m16:03:44.038538 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m16:03:44.039658 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m16:03:44.040841 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m16:03:44.041805 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m16:03:44.042597 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m16:03:44.054528 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m16:03:44.071212 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m16:03:44.108025 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m16:03:44.109064 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m16:03:44.119345 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m16:03:44.121320 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m16:03:44.125168 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m16:03:44.124188 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m16:03:44.122520 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m16:03:44.126424 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m16:03:44.128052 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m16:03:44.129144 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m16:03:44.131046 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m16:03:44.132027 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m16:03:44.133643 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_events
[0m16:03:44.134795 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_events)
[0m16:03:44.135582 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m16:03:44.142498 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m16:03:44.143899 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m16:03:44.144904 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_sales)
[0m16:03:44.145723 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m16:03:44.146216 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_events
[0m16:03:44.161489 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m16:03:44.162836 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_events
[0m16:03:44.164237 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m16:03:44.165555 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m16:03:44.167770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:44.168297 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m16:03:44.169488 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m16:03:44.169867 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m16:03:44.170179 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m16:03:44.172495 [debug] [MainThread]: Command end result
[0m16:03:44.391745 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:03:44.394538 [info ] [MainThread]: Building catalog
[0m16:03:44.421537 [debug] [ThreadPool]: Acquiring new postgres connection 'lab08_db.information_schema'
[0m16:03:44.436300 [debug] [ThreadPool]: Using postgres connection "lab08_db.information_schema"
[0m16:03:44.437348 [debug] [ThreadPool]: On lab08_db.information_schema: BEGIN
[0m16:03:44.438122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:44.476131 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m16:03:44.477573 [debug] [ThreadPool]: Using postgres connection "lab08_db.information_schema"
[0m16:03:44.478454 [debug] [ThreadPool]: On lab08_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "lab08_db.information_schema"} */

    
    

    select
        'lab08_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dm_dev') and
           upper(tbl.relname) = upper('dm_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_browser_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_geo_events')) or (upper(sch.nspname) = upper('dm_dev') and
           upper(tbl.relname) = upper('dm_sales')) or (upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_location_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_device_events')) or (upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_browser_events')) or (upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_geo_events')) or (upper(sch.nspname) = upper('ods_dev') and
           upper(tbl.relname) = upper('ods_device_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_location_events')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:03:44.488808 [debug] [ThreadPool]: SQL status: SELECT 75 in 0.009 seconds
[0m16:03:44.502777 [debug] [ThreadPool]: On lab08_db.information_schema: ROLLBACK
[0m16:03:44.506167 [debug] [ThreadPool]: On lab08_db.information_schema: Close
[0m16:03:44.581368 [info ] [MainThread]: Catalog written to /dbt/target/catalog.json
[0m16:03:44.583738 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.8822929, "process_user_time": 3.971495, "process_kernel_time": 0.28675, "process_mem_max_rss": "104140", "process_out_blocks": "5344", "process_in_blocks": "0"}
[0m16:03:44.584856 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:03:44.584678 after 1.88 seconds
[0m16:03:44.585511 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:03:44.585884 [debug] [MainThread]: Connection 'lab08_db.information_schema' was properly closed.
[0m16:03:44.586616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257e84e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc258297850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257691a30>]}
[0m16:03:44.587511 [debug] [MainThread]: Flushing usage events
[0m16:03:45.141442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:00.107871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5184bbaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51843c5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51843c58e0>]}


============================== 17:01:00.122717 | cec6d304-623a-444f-81bf-3fee397c72aa ==============================
[0m17:01:00.122717 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m17:01:00.123581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:01:00.475585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec6d304-623a-444f-81bf-3fee397c72aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5183f44c40>]}
[0m17:01:00.628622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec6d304-623a-444f-81bf-3fee397c72aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518403ad30>]}
[0m17:01:00.630183 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:01:00.671495 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m17:01:00.967440 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:01:00.969263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cec6d304-623a-444f-81bf-3fee397c72aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51843ae850>]}
[0m17:01:03.768015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m17:01:03.792450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec6d304-623a-444f-81bf-3fee397c72aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181f2b850>]}
[0m17:01:03.967418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec6d304-623a-444f-81bf-3fee397c72aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181e81ac0>]}
[0m17:01:03.968197 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m17:01:03.968669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec6d304-623a-444f-81bf-3fee397c72aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181f4a700>]}
[0m17:01:03.971235 [info ] [MainThread]: 
[0m17:01:03.971945 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:01:03.972978 [info ] [MainThread]: 
[0m17:01:03.974134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:01:03.983559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:01:03.995115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:01:04.086566 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:01:04.087309 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:01:04.087865 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:01:04.088617 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:01:04.089257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:04.089919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:04.136071 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.046 seconds
[0m17:01:04.139831 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:01:04.141181 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.052 seconds
[0m17:01:04.146680 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:01:04.150697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m17:01:04.158932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m17:01:04.173219 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:01:04.173970 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m17:01:04.174576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:04.175924 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:01:04.176783 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m17:01:04.177417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:04.221247 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:01:04.221956 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:01:04.222447 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m17:01:04.233670 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m17:01:04.236027 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m17:01:04.240015 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m17:01:04.250462 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m17:01:04.251521 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:01:04.252985 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m17:01:04.266897 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m17:01:04.271716 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m17:01:04.279518 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m17:01:04.296082 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.296882 [debug] [MainThread]: On master: BEGIN
[0m17:01:04.297487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:04.337830 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m17:01:04.338990 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.340130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:01:04.351510 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:01:04.358802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec6d304-623a-444f-81bf-3fee397c72aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5185ae3bb0>]}
[0m17:01:04.361963 [debug] [MainThread]: On master: ROLLBACK
[0m17:01:04.365914 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.367116 [debug] [MainThread]: On master: BEGIN
[0m17:01:04.372937 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:01:04.373799 [debug] [MainThread]: On master: COMMIT
[0m17:01:04.374424 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.374907 [debug] [MainThread]: On master: COMMIT
[0m17:01:04.377668 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:01:04.378369 [debug] [MainThread]: On master: Close
[0m17:01:04.384945 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m17:01:04.386358 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m17:01:04.387307 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m17:01:04.388221 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m17:01:04.389118 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m17:01:04.389967 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m17:01:04.394972 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m17:01:04.390637 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m17:01:04.393253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m17:01:04.391906 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m17:01:04.397077 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m17:01:04.399072 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m17:01:04.401033 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m17:01:04.402422 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m17:01:04.414480 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m17:01:04.443105 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m17:01:04.443934 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m17:01:04.440187 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m17:01:04.454708 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m17:01:04.463244 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m17:01:04.464240 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m17:01:04.465788 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m17:01:04.466955 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m17:01:04.479921 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m17:01:04.760631 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:01:04.762368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:01:04.763818 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp170104582879"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m17:01:04.776208 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:01:04.774995 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp170104578873"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m17:01:04.777528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:01:04.773514 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:01:04.779045 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp170104654819"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m17:01:04.779881 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:01:04.781737 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:01:04.783068 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp170104752331"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m17:01:04.784234 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:02:12.825184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416a38fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416b468ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4169b97c70>]}


============================== 17:02:12.835261 | 7f8b568c-5fc4-400b-8755-ea1803b82c19 ==============================
[0m17:02:12.835261 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m17:02:12.836144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:02:13.539578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f8b568c-5fc4-400b-8755-ea1803b82c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416c731700>]}
[0m17:02:13.870064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f8b568c-5fc4-400b-8755-ea1803b82c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416967b040>]}
[0m17:02:13.871920 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:02:13.977642 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m17:02:14.646290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:02:14.647095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:02:14.679863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m17:02:15.010105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f8b568c-5fc4-400b-8755-ea1803b82c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167973b20>]}
[0m17:02:15.514770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f8b568c-5fc4-400b-8755-ea1803b82c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167961b20>]}
[0m17:02:15.516183 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m17:02:15.517066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f8b568c-5fc4-400b-8755-ea1803b82c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167b2cfd0>]}
[0m17:02:15.520048 [info ] [MainThread]: 
[0m17:02:15.520947 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:02:15.522285 [info ] [MainThread]: 
[0m17:02:15.523091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:02:15.531782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:02:15.542648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:02:15.737523 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:02:15.738156 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:02:15.738727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:15.739572 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:02:15.739993 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:02:15.740591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:15.822371 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.084 seconds
[0m17:02:15.826295 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:02:15.833749 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.093 seconds
[0m17:02:15.838247 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:02:15.851545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m17:02:15.877915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m17:02:15.910131 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:02:15.931459 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m17:02:15.932013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:15.930683 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:02:15.933092 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m17:02:15.940934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:15.985742 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m17:02:15.996600 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:02:15.997255 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m17:02:16.003010 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m17:02:16.005100 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:02:16.005579 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m17:02:16.010409 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m17:02:16.012959 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m17:02:16.021402 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m17:02:16.023576 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m17:02:16.028699 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m17:02:16.031091 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m17:02:16.055953 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:16.056652 [debug] [MainThread]: On master: BEGIN
[0m17:02:16.059995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:16.106255 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m17:02:16.106827 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:16.107505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:02:16.117741 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:02:16.120501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f8b568c-5fc4-400b-8755-ea1803b82c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167d6f460>]}
[0m17:02:16.121509 [debug] [MainThread]: On master: ROLLBACK
[0m17:02:16.126492 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:16.127231 [debug] [MainThread]: On master: BEGIN
[0m17:02:16.147634 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:02:16.148613 [debug] [MainThread]: On master: COMMIT
[0m17:02:16.149294 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:16.149752 [debug] [MainThread]: On master: COMMIT
[0m17:02:16.152947 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m17:02:16.153578 [debug] [MainThread]: On master: Close
[0m17:02:16.191071 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m17:02:16.192745 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m17:02:16.193595 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m17:02:16.194228 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m17:02:16.199632 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m17:02:16.215108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m17:02:16.210895 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m17:02:16.225400 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m17:02:16.226251 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m17:02:16.211666 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m17:02:16.239946 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m17:02:16.249181 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m17:02:16.209856 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m17:02:16.250708 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m17:02:16.251668 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m17:02:16.215993 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m17:02:16.377749 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m17:02:16.379070 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m17:02:16.419025 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m17:02:16.390706 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m17:02:16.407963 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m17:02:16.430578 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m17:02:16.444056 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m17:02:16.445283 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m17:02:16.942088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:02:16.947617 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:02:16.944474 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:02:16.951657 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp170216835850"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m17:02:16.952403 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:02:16.950536 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp170216813813"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m17:02:16.953174 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:02:16.948316 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:02:16.954079 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp170216842125"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m17:02:16.954868 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:02:16.948876 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp170216827155"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m17:02:16.955961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:31.437047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14fe1c4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14fdaca610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14fd9c7130>]}


============================== 17:04:31.476799 | b72cc43d-6ef5-47af-a670-6f72788e5f6d ==============================
[0m17:04:31.476799 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m17:04:31.484755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8088', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:04:32.083099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b72cc43d-6ef5-47af-a670-6f72788e5f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15005319a0>]}
[0m17:04:32.365734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b72cc43d-6ef5-47af-a670-6f72788e5f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14fba0e2b0>]}
[0m17:04:38.679901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4744d78eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4744b1f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f474457b2b0>]}


============================== 17:04:38.691453 | 7e821adc-01bd-43a3-9e3f-2148568839d0 ==============================
[0m17:04:38.691453 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m17:04:38.694422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:04:39.116615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4742743460>]}
[0m17:04:39.295136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4742674ca0>]}
[0m17:04:39.297385 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:04:39.373489 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m17:04:39.957655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:39.959202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:39.974551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m17:04:40.072191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f474231bbe0>]}
[0m17:04:40.312359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f474238bbe0>]}
[0m17:04:40.313738 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m17:04:40.315195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47424a9790>]}
[0m17:04:40.317807 [info ] [MainThread]: 
[0m17:04:40.319560 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:04:40.320978 [info ] [MainThread]: 
[0m17:04:40.324064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:04:40.336872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:04:40.351231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:04:40.445816 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:04:40.446529 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:04:40.448058 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:04:40.448644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:40.447319 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:04:40.449922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:40.488954 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.039 seconds
[0m17:04:40.492015 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:04:40.493504 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.044 seconds
[0m17:04:40.496196 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:04:40.499936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m17:04:40.517334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m17:04:40.528066 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:04:40.537300 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m17:04:40.538066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:40.536174 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:04:40.539317 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m17:04:40.540377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:40.579234 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m17:04:40.580236 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:04:40.581260 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m17:04:40.582256 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m17:04:40.584965 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:04:40.585452 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m17:04:40.590485 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m17:04:40.593722 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m17:04:40.594467 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m17:04:40.597427 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m17:04:40.598085 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m17:04:40.599936 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m17:04:40.611913 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:40.614425 [debug] [MainThread]: On master: BEGIN
[0m17:04:40.615014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:40.665696 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m17:04:40.667492 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:40.668472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:04:40.678157 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:04:40.680932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4741260fa0>]}
[0m17:04:40.682115 [debug] [MainThread]: On master: ROLLBACK
[0m17:04:40.685132 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:40.685787 [debug] [MainThread]: On master: BEGIN
[0m17:04:40.690841 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:04:40.691577 [debug] [MainThread]: On master: COMMIT
[0m17:04:40.692951 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:40.694349 [debug] [MainThread]: On master: COMMIT
[0m17:04:40.697082 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:04:40.698550 [debug] [MainThread]: On master: Close
[0m17:04:40.703667 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m17:04:40.705843 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m17:04:40.709005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m17:04:40.704499 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m17:04:40.710586 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m17:04:40.712529 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m17:04:40.713153 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m17:04:40.705137 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m17:04:40.719587 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m17:04:40.721904 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m17:04:40.707931 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m17:04:40.724262 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m17:04:40.725862 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m17:04:40.726587 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m17:04:40.709675 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m17:04:40.723002 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m17:04:40.773787 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m17:04:40.781114 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m17:04:40.779983 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m17:04:40.790066 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m17:04:40.783538 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m17:04:40.796813 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m17:04:40.782756 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m17:04:40.804041 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m17:04:41.350790 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:04:41.355391 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:04:41.369132 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp170441209981"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m17:04:41.370560 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:04:41.366860 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:04:41.372883 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp170441254137"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m17:04:41.374779 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:04:41.367630 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp170441149783"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m17:04:41.376770 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:04:41.364922 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:04:41.379625 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp170441162911"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m17:04:41.381429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:06:01.062594 [debug] [Thread-3  ]: SQL status: SELECT 18401 in 79.692 seconds
[0m17:06:01.097727 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:06:01.098412 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m17:06:01.103015 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m17:06:01.105449 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:06:01.106367 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp170441209981'
        
      order by ordinal_position

  
[0m17:06:01.133775 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.027 seconds
[0m17:06:01.147460 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:06:01.148287 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:01.160155 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.011 seconds
[0m17:06:01.175883 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:06:01.176676 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:01.188333 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.011 seconds
[0m17:06:01.221819 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m17:06:01.223585 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:06:01.224436 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp170441209981"
    )


  
[0m17:06:01.275494 [debug] [Thread-3  ]: SQL status: INSERT 0 18401 in 0.050 seconds
[0m17:06:01.313018 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m17:06:01.313793 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:06:01.314940 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m17:06:01.337051 [debug] [Thread-3  ]: SQL status: COMMIT in 0.021 seconds
[0m17:06:01.341491 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m17:06:01.346032 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4740ebcd00>]}
[0m17:06:01.347714 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 18401[0m in 80.62s]
[0m17:06:01.350263 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m17:06:02.725504 [debug] [Thread-2  ]: SQL status: SELECT 18401 in 81.349 seconds
[0m17:06:02.731296 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:06:02.732066 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m17:06:02.736267 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m17:06:02.737528 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:06:02.738104 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp170441149783'
        
      order by ordinal_position

  
[0m17:06:02.755583 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.017 seconds
[0m17:06:02.763375 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:06:02.764333 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:02.773899 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.009 seconds
[0m17:06:02.783657 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:06:02.784836 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:02.797936 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m17:06:02.896010 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m17:06:02.898425 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:06:02.899413 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp170441149783"
    )


  
[0m17:06:02.954010 [debug] [Thread-2  ]: SQL status: INSERT 0 18401 in 0.053 seconds
[0m17:06:02.957452 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m17:06:02.958264 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:06:02.958741 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m17:06:02.984393 [debug] [Thread-2  ]: SQL status: COMMIT in 0.025 seconds
[0m17:06:02.986957 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m17:06:02.988095 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4745911c40>]}
[0m17:06:02.989248 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 18401[0m in 82.28s]
[0m17:06:02.990314 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m17:06:03.679262 [debug] [Thread-4  ]: SQL status: SELECT 18401 in 82.304 seconds
[0m17:06:03.688908 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:06:03.689723 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m17:06:03.693939 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m17:06:03.694546 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:06:03.695026 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp170441254137'
        
      order by ordinal_position

  
[0m17:06:03.722546 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.027 seconds
[0m17:06:03.729362 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:06:03.730087 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:03.737442 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m17:06:03.744561 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:06:03.745186 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:03.755664 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.010 seconds
[0m17:06:03.760565 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m17:06:03.761747 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:06:03.762279 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp170441254137"
    )


  
[0m17:06:03.817615 [debug] [Thread-4  ]: SQL status: INSERT 0 18401 in 0.055 seconds
[0m17:06:03.819854 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m17:06:03.820481 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:06:03.821103 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m17:06:03.840604 [debug] [Thread-4  ]: SQL status: COMMIT in 0.019 seconds
[0m17:06:03.842836 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m17:06:03.843957 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4740ebc4c0>]}
[0m17:06:03.844960 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 18401[0m in 83.12s]
[0m17:06:03.847951 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m17:06:06.365016 [debug] [Thread-1  ]: SQL status: SELECT 18401 in 84.984 seconds
[0m17:06:06.371719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:06:06.372590 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m17:06:06.375940 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m17:06:06.376648 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:06:06.378015 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp170441162911'
        
      order by ordinal_position

  
[0m17:06:06.390422 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m17:06:06.399932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:06:06.401622 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:06.408919 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m17:06:06.419400 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:06:06.420394 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:06:06.427958 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m17:06:06.432440 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m17:06:06.434730 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:06:06.435569 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp170441162911"
    )


  
[0m17:06:06.519432 [debug] [Thread-1  ]: SQL status: INSERT 0 18401 in 0.083 seconds
[0m17:06:06.523336 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m17:06:06.524592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:06:06.525856 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m17:06:06.560588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.034 seconds
[0m17:06:06.563094 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m17:06:06.565905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4740f0ce50>]}
[0m17:06:06.568099 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 18401[0m in 85.86s]
[0m17:06:06.569359 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m17:06:06.571310 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m17:06:06.572927 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m17:06:06.572066 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m17:06:06.574282 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m17:06:06.575904 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m17:06:06.578140 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m17:06:06.579277 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m17:06:06.576978 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m17:06:06.599332 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m17:06:06.602495 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m17:06:06.603670 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m17:06:06.613962 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:06:06.615645 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m17:06:06.616865 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp170606609230"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m17:06:06.632893 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:06:06.633886 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:06:06.635230 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp170606625333"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m17:06:06.637641 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:07:01.778403 [debug] [Thread-3  ]: SQL status: SELECT 18401 in 55.140 seconds
[0m17:07:01.791244 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:07:01.792601 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m17:07:01.798607 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m17:07:01.800225 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:07:01.801072 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp170606625333'
        
      order by ordinal_position

  
[0m17:07:01.814597 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.013 seconds
[0m17:07:01.823243 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:07:01.824007 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:07:01.834249 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.009 seconds
[0m17:07:01.846043 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:07:01.847203 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:07:01.859115 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.011 seconds
[0m17:07:01.866166 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m17:07:01.867751 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:07:01.868525 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp170606625333"
    )


  
[0m17:07:01.895073 [debug] [Thread-3  ]: SQL status: INSERT 0 18401 in 0.025 seconds
[0m17:07:01.898479 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m17:07:01.899353 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:07:01.899999 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m17:07:01.925838 [debug] [Thread-3  ]: SQL status: COMMIT in 0.025 seconds
[0m17:07:01.928497 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m17:07:01.929943 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4740ef31c0>]}
[0m17:07:01.931795 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 18401[0m in 55.36s]
[0m17:07:01.936385 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m17:07:16.595688 [debug] [Thread-2  ]: SQL status: SELECT 1036 in 69.962 seconds
[0m17:07:16.603049 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:07:16.603658 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m17:07:16.608450 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m17:07:16.609271 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:07:16.610057 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp170606609230'
        
      order by ordinal_position

  
[0m17:07:16.634939 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.024 seconds
[0m17:07:16.644141 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:07:16.644930 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:07:16.653337 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.008 seconds
[0m17:07:16.663760 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:07:16.664807 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:07:16.679693 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.014 seconds
[0m17:07:16.686801 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m17:07:16.687909 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:07:16.688666 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp170606609230"
    )


  
[0m17:07:16.712635 [debug] [Thread-2  ]: SQL status: INSERT 0 1036 in 0.023 seconds
[0m17:07:16.715315 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m17:07:16.717759 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:07:16.718318 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m17:07:16.726846 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m17:07:16.728466 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m17:07:16.732155 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e821adc-01bd-43a3-9e3f-2148568839d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4740ef32b0>]}
[0m17:07:16.733355 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1036[0m in 70.15s]
[0m17:07:16.734564 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m17:07:16.737299 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:16.737754 [debug] [MainThread]: On master: BEGIN
[0m17:07:16.738125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:16.777276 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m17:07:16.778082 [debug] [MainThread]: On master: COMMIT
[0m17:07:16.778672 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:16.779085 [debug] [MainThread]: On master: COMMIT
[0m17:07:16.781840 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:07:16.782403 [debug] [MainThread]: On master: Close
[0m17:07:16.785544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:16.786314 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m17:07:16.786622 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m17:07:16.786922 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m17:07:16.787282 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m17:07:16.788163 [info ] [MainThread]: 
[0m17:07:16.788613 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 36.46 seconds (156.46s).
[0m17:07:16.790666 [debug] [MainThread]: Command end result
[0m17:07:16.857110 [info ] [MainThread]: 
[0m17:07:16.857854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:16.858345 [info ] [MainThread]: 
[0m17:07:16.858714 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:07:16.860232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 158.31688, "process_user_time": 4.928956, "process_kernel_time": 0.529509, "process_mem_max_rss": "106072", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m17:07:16.861354 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:16.861004 after 158.32 seconds
[0m17:07:16.862101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4744d78eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4742743460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47422ea250>]}
[0m17:07:16.862710 [debug] [MainThread]: Flushing usage events
[0m17:07:17.646337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:16.696533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f2c7ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f3d5cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f2105d90>]}


============================== 17:08:16.704898 | c8a82db7-c1bb-44e6-a182-13c1653e72fe ==============================
[0m17:08:16.704898 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m17:08:16.706169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8088', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:08:17.401128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8a82db7-c1bb-44e6-a182-13c1653e72fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f502ba00>]}
[0m17:08:17.642297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8a82db7-c1bb-44e6-a182-13c1653e72fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f2105e80>]}
[0m18:01:05.300845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3386f7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3384c19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd337efea00>]}


============================== 18:01:05.310813 | a571d6e3-e1bb-471f-9298-5a347ec4a23b ==============================
[0m18:01:05.310813 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m18:01:05.313072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:01:05.633191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd33601ec70>]}
[0m18:01:05.740234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd338010f70>]}
[0m18:01:05.741791 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:01:05.777052 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m18:01:06.063900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:06.064914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:06.080839 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m18:01:06.150461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd335cdbcd0>]}
[0m18:01:06.339674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd335cc9c10>]}
[0m18:01:06.340453 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m18:01:06.340926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd335e4afd0>]}
[0m18:01:06.343762 [info ] [MainThread]: 
[0m18:01:06.344401 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m18:01:06.344873 [info ] [MainThread]: 
[0m18:01:06.345491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:01:06.354824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m18:01:06.374836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m18:01:06.457560 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m18:01:06.458605 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m18:01:06.459344 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m18:01:06.460361 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m18:01:06.461242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:06.464194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:06.501167 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.037 seconds
[0m18:01:06.504206 [debug] [ThreadPool]: On list_lab08_db: Close
[0m18:01:06.505402 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.044 seconds
[0m18:01:06.509286 [debug] [ThreadPool]: On list_lab08_db: Close
[0m18:01:06.513464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m18:01:06.521181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m18:01:06.530663 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m18:01:06.531662 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m18:01:06.532244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:06.537042 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m18:01:06.541003 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m18:01:06.541713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:06.571398 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m18:01:06.572333 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m18:01:06.573076 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m18:01:06.583509 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m18:01:06.590508 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m18:01:06.597284 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m18:01:06.598511 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m18:01:06.600031 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m18:01:06.602244 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m18:01:06.611531 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m18:01:06.619749 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m18:01:06.624913 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m18:01:06.651886 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:06.657359 [debug] [MainThread]: On master: BEGIN
[0m18:01:06.658257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:06.705935 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m18:01:06.707161 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:06.708013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:01:06.718137 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m18:01:06.720752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd33540b1f0>]}
[0m18:01:06.721612 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:06.724305 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:06.724886 [debug] [MainThread]: On master: BEGIN
[0m18:01:06.729579 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m18:01:06.730154 [debug] [MainThread]: On master: COMMIT
[0m18:01:06.730584 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:06.731036 [debug] [MainThread]: On master: COMMIT
[0m18:01:06.733531 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:01:06.734083 [debug] [MainThread]: On master: Close
[0m18:01:06.739361 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m18:01:06.740493 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m18:01:06.743959 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m18:01:06.744435 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m18:01:06.741917 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m18:01:06.745601 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m18:01:06.746356 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m18:01:06.752141 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m18:01:06.751166 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m18:01:06.753734 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m18:01:06.752950 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m18:01:06.747011 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m18:01:06.762798 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m18:01:06.763780 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m18:01:06.750223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m18:01:06.764818 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m18:01:06.821929 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m18:01:06.830813 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m18:01:06.840036 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m18:01:06.834419 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m18:01:06.838693 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m18:01:06.859708 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m18:01:06.867172 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m18:01:06.868425 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m18:01:07.111591 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:01:07.121104 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp180107001446"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m18:01:07.121789 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:01:07.120091 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:01:07.129335 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp180107044807"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m18:01:07.128484 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:01:07.130029 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:01:07.125333 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:01:07.130672 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp180107030019"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m18:01:07.132325 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp180107017665"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m18:01:07.133248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:07.134221 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:02:22.668927 [debug] [Thread-3  ]: SQL status: SELECT 21009 in 75.534 seconds
[0m18:02:22.703730 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:22.706118 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m18:02:22.709121 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m18:02:22.709827 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:22.710355 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp180107017665'
        
      order by ordinal_position

  
[0m18:02:22.726972 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.016 seconds
[0m18:02:22.735858 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:22.736504 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:22.748851 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.012 seconds
[0m18:02:22.763302 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:22.764243 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:22.772188 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m18:02:22.793984 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m18:02:22.795329 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:22.796458 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp180107017665"
    )


  
[0m18:02:22.846611 [debug] [Thread-3  ]: SQL status: INSERT 0 21009 in 0.049 seconds
[0m18:02:22.879474 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m18:02:22.880576 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:22.881359 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m18:02:22.903664 [debug] [Thread-3  ]: SQL status: COMMIT in 0.021 seconds
[0m18:02:22.907668 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m18:02:22.910492 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3347e8d60>]}
[0m18:02:22.911435 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 21009[0m in 76.16s]
[0m18:02:22.912321 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m18:02:29.016880 [debug] [Thread-4  ]: SQL status: SELECT 21009 in 81.886 seconds
[0m18:02:29.026222 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:29.027128 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m18:02:29.030846 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m18:02:29.031426 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:29.032305 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp180107044807'
        
      order by ordinal_position

  
[0m18:02:29.048081 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.015 seconds
[0m18:02:29.056998 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:29.057863 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:29.065017 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m18:02:29.073217 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:29.073923 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:29.082130 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m18:02:29.086456 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m18:02:29.087616 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:29.088152 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp180107044807"
    )


  
[0m18:02:29.122454 [debug] [Thread-4  ]: SQL status: INSERT 0 21009 in 0.033 seconds
[0m18:02:29.231845 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m18:02:29.232964 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:29.233500 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m18:02:29.253852 [debug] [Thread-2  ]: SQL status: SELECT 21009 in 82.132 seconds
[0m18:02:29.255350 [debug] [Thread-4  ]: SQL status: COMMIT in 0.021 seconds
[0m18:02:29.262533 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m18:02:29.263528 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:29.264347 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m18:02:29.265165 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd334667ac0>]}
[0m18:02:29.266710 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 21009[0m in 82.50s]
[0m18:02:29.267517 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m18:02:29.268407 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m18:02:29.269020 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:29.269774 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp180107001446'
        
      order by ordinal_position

  
[0m18:02:29.283152 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m18:02:29.288922 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:29.289558 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:29.295954 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m18:02:29.301860 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:29.302502 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:29.311058 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m18:02:29.314524 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m18:02:29.315464 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:29.315961 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp180107001446"
    )


  
[0m18:02:29.379670 [debug] [Thread-2  ]: SQL status: INSERT 0 21009 in 0.063 seconds
[0m18:02:29.382332 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m18:02:29.383226 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:29.383907 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m18:02:29.413779 [debug] [Thread-2  ]: SQL status: COMMIT in 0.029 seconds
[0m18:02:29.416015 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m18:02:29.417546 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3345ca370>]}
[0m18:02:29.419030 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 21009[0m in 82.67s]
[0m18:02:29.421775 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m18:02:31.619220 [debug] [Thread-1  ]: SQL status: SELECT 21009 in 84.486 seconds
[0m18:02:31.625647 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:31.626701 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m18:02:31.629453 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m18:02:31.630665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:31.631348 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp180107030019'
        
      order by ordinal_position

  
[0m18:02:31.647010 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.014 seconds
[0m18:02:31.661094 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:31.661984 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:31.671572 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m18:02:31.680626 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:31.681350 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:31.687608 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m18:02:31.692565 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m18:02:31.693998 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:31.694645 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp180107030019"
    )


  
[0m18:02:31.877354 [debug] [Thread-1  ]: SQL status: INSERT 0 21009 in 0.182 seconds
[0m18:02:31.879736 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m18:02:31.880326 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:31.880901 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m18:02:31.894622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.013 seconds
[0m18:02:31.896536 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m18:02:31.897949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3347e8dc0>]}
[0m18:02:31.899231 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 21009[0m in 85.15s]
[0m18:02:31.900342 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m18:02:31.901903 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m18:02:31.902810 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m18:02:31.905314 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m18:02:31.906194 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m18:02:31.903766 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m18:02:31.907346 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m18:02:31.910036 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m18:02:31.924387 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m18:02:31.925211 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m18:02:31.926699 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m18:02:31.945205 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m18:02:31.948817 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:02:31.951450 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp180231942481"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m18:02:31.952840 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m18:02:31.953931 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:02:31.961890 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:02:31.963532 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp180231959263"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m18:02:31.964301 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:03:28.703390 [debug] [Thread-3  ]: SQL status: SELECT 21009 in 56.739 seconds
[0m18:03:28.709848 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:28.710675 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m18:03:28.716413 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m18:03:28.717237 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:28.717798 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp180231959263'
        
      order by ordinal_position

  
[0m18:03:28.730880 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.012 seconds
[0m18:03:28.737837 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:28.738799 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:28.745648 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m18:03:28.752388 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:28.753492 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:28.761164 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m18:03:28.764998 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m18:03:28.766138 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:28.766777 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp180231959263"
    )


  
[0m18:03:28.795645 [debug] [Thread-3  ]: SQL status: INSERT 0 21009 in 0.028 seconds
[0m18:03:28.798521 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m18:03:28.799239 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:28.799766 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m18:03:28.814192 [debug] [Thread-3  ]: SQL status: COMMIT in 0.014 seconds
[0m18:03:28.815957 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m18:03:28.817119 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd33473aa60>]}
[0m18:03:28.818770 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 21009[0m in 56.91s]
[0m18:03:28.820150 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m18:03:42.248000 [debug] [Thread-4  ]: SQL status: SELECT 1223 in 70.294 seconds
[0m18:03:42.258374 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:42.259438 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m18:03:42.262716 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m18:03:42.263748 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:42.264266 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp180231942481'
        
      order by ordinal_position

  
[0m18:03:42.277246 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.012 seconds
[0m18:03:42.286350 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:42.287411 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:42.295070 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m18:03:42.302706 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:42.303426 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:42.310989 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.007 seconds
[0m18:03:42.319204 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m18:03:42.321734 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:42.322489 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp180231942481"
    )


  
[0m18:03:42.350246 [debug] [Thread-4  ]: SQL status: INSERT 0 1223 in 0.026 seconds
[0m18:03:42.353131 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m18:03:42.353687 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:42.354515 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m18:03:42.362660 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m18:03:42.364157 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m18:03:42.365136 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a571d6e3-e1bb-471f-9298-5a347ec4a23b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3347e89d0>]}
[0m18:03:42.366018 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1223[0m in 70.46s]
[0m18:03:42.366834 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m18:03:42.372572 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:42.373335 [debug] [MainThread]: On master: BEGIN
[0m18:03:42.374273 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:42.414109 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m18:03:42.414780 [debug] [MainThread]: On master: COMMIT
[0m18:03:42.415210 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:42.415553 [debug] [MainThread]: On master: COMMIT
[0m18:03:42.417988 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:03:42.418528 [debug] [MainThread]: On master: Close
[0m18:03:42.419337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:42.419798 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m18:03:42.420138 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m18:03:42.420454 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m18:03:42.421099 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m18:03:42.421704 [info ] [MainThread]: 
[0m18:03:42.422873 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 36.08 seconds (156.08s).
[0m18:03:42.425538 [debug] [MainThread]: Command end result
[0m18:03:42.483703 [info ] [MainThread]: 
[0m18:03:42.484360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:42.484801 [info ] [MainThread]: 
[0m18:03:42.486926 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:03:42.488348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 157.31084, "process_user_time": 4.675268, "process_kernel_time": 0.333409, "process_mem_max_rss": "105996", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m18:03:42.489081 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:42.488944 after 157.31 seconds
[0m18:03:42.489585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3386f7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd338010f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd335c42f40>]}
[0m18:03:42.490126 [debug] [MainThread]: Flushing usage events
[0m18:03:43.224307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:09.284931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f26e5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f24af9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f1ee6a00>]}


============================== 19:01:09.293905 | 372bc67d-d05e-4d33-af84-aa1a24bbf6db ==============================
[0m19:01:09.293905 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m19:01:09.294917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:01:09.629946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f000bc70>]}
[0m19:01:09.748365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f2007f70>]}
[0m19:01:09.749545 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:01:09.773005 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m19:01:10.016926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:10.017771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:10.030629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m19:01:10.112528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86efcc8bb0>]}
[0m19:01:10.335880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86efcb7c10>]}
[0m19:01:10.337221 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m19:01:10.338820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86efeb5fd0>]}
[0m19:01:10.343289 [info ] [MainThread]: 
[0m19:01:10.345346 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m19:01:10.346548 [info ] [MainThread]: 
[0m19:01:10.348897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:10.361339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m19:01:10.366604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m19:01:10.456170 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m19:01:10.456990 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m19:01:10.457551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:10.459051 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m19:01:10.459766 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m19:01:10.460374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:10.500255 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.043 seconds
[0m19:01:10.503397 [debug] [ThreadPool]: On list_lab08_db: Close
[0m19:01:10.504459 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.044 seconds
[0m19:01:10.507253 [debug] [ThreadPool]: On list_lab08_db: Close
[0m19:01:10.510891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m19:01:10.517538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m19:01:10.531108 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m19:01:10.532573 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m19:01:10.533738 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m19:01:10.534485 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m19:01:10.535024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:10.535664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:10.576124 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m19:01:10.577292 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m19:01:10.577856 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m19:01:10.578792 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m19:01:10.579487 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m19:01:10.579969 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m19:01:10.586492 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m19:01:10.588439 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m19:01:10.589117 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m19:01:10.591465 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m19:01:10.592219 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m19:01:10.598839 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m19:01:10.611187 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:10.611811 [debug] [MainThread]: On master: BEGIN
[0m19:01:10.612261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:10.648998 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m19:01:10.650138 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:10.650847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:10.659112 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m19:01:10.661245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f005d9d0>]}
[0m19:01:10.661922 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:10.664848 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:10.665430 [debug] [MainThread]: On master: BEGIN
[0m19:01:10.670667 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m19:01:10.671584 [debug] [MainThread]: On master: COMMIT
[0m19:01:10.672013 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:10.673492 [debug] [MainThread]: On master: COMMIT
[0m19:01:10.676056 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:01:10.676593 [debug] [MainThread]: On master: Close
[0m19:01:10.680620 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m19:01:10.681703 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m19:01:10.682660 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m19:01:10.683945 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m19:01:10.684681 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m19:01:10.685421 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m19:01:10.687824 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m19:01:10.692034 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m19:01:10.686680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m19:01:10.690854 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m19:01:10.692889 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m19:01:10.689771 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m19:01:10.693533 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m19:01:10.694074 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m19:01:10.705032 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m19:01:10.749389 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m19:01:10.748369 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m19:01:10.743383 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m19:01:10.741828 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m19:01:10.757661 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m19:01:10.758843 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m19:01:10.759842 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m19:01:10.761102 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m19:01:10.822427 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m19:01:11.109982 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:01:11.111944 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:01:11.113048 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:01:11.120314 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp190111054481"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m19:01:11.121696 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:01:11.119453 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp190110969776"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m19:01:11.122588 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:01:11.117752 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:01:11.123395 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp190110978361"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m19:01:11.118823 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp190110968983"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m19:01:11.126478 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:01:11.124346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:02:29.983193 [debug] [Thread-3  ]: SQL status: SELECT 22533 in 78.861 seconds
[0m19:02:30.014743 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:30.015677 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m19:02:30.022525 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m19:02:30.023177 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:30.023683 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp190111054481'
        
      order by ordinal_position

  
[0m19:02:30.043558 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.019 seconds
[0m19:02:30.059841 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:30.060821 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:30.070616 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.008 seconds
[0m19:02:30.095370 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:30.096414 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:30.103369 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m19:02:30.136203 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m19:02:30.137856 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:30.138567 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp190111054481"
    )


  
[0m19:02:30.176122 [debug] [Thread-3  ]: SQL status: INSERT 0 22533 in 0.037 seconds
[0m19:02:30.197900 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m19:02:30.198624 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:30.199046 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m19:02:30.222288 [debug] [Thread-3  ]: SQL status: COMMIT in 0.023 seconds
[0m19:02:30.225792 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m19:02:30.228632 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee82ffa0>]}
[0m19:02:30.229889 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 22533[0m in 79.54s]
[0m19:02:30.230793 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m19:02:39.056826 [debug] [Thread-4  ]: SQL status: SELECT 22533 in 87.934 seconds
[0m19:02:39.063591 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:39.064431 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m19:02:39.067228 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m19:02:39.067943 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:39.068605 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp190110969776'
        
      order by ordinal_position

  
[0m19:02:39.083033 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m19:02:39.174407 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:39.175073 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:39.182396 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m19:02:39.190842 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:39.191777 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:39.198145 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m19:02:39.203561 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m19:02:39.204855 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:39.205822 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp190110969776"
    )


  
[0m19:02:39.242836 [debug] [Thread-4  ]: SQL status: INSERT 0 22533 in 0.036 seconds
[0m19:02:39.245213 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m19:02:39.245893 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:39.246336 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m19:02:39.271033 [debug] [Thread-4  ]: SQL status: COMMIT in 0.024 seconds
[0m19:02:39.272864 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m19:02:39.273966 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f36582b0>]}
[0m19:02:39.275210 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 22533[0m in 88.57s]
[0m19:02:39.275941 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m19:02:42.816742 [debug] [Thread-2  ]: SQL status: SELECT 22533 in 91.691 seconds
[0m19:02:42.822833 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.823504 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m19:02:42.827410 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m19:02:42.828654 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.829192 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp190110968983'
        
      order by ordinal_position

  
[0m19:02:42.840630 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m19:02:42.848236 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.849523 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:42.857472 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m19:02:42.865540 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.866194 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:42.872450 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.005 seconds
[0m19:02:42.876491 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.877451 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.878161 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp190110968983"
    )


  
[0m19:02:42.962483 [debug] [Thread-2  ]: SQL status: INSERT 0 22533 in 0.083 seconds
[0m19:02:42.965594 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m19:02:42.966311 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.966821 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m19:02:42.996090 [debug] [Thread-2  ]: SQL status: COMMIT in 0.028 seconds
[0m19:02:42.998728 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m19:02:43.000523 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee82fd00>]}
[0m19:02:43.002073 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 22533[0m in 92.31s]
[0m19:02:43.003165 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m19:02:44.942859 [debug] [Thread-1  ]: SQL status: SELECT 22533 in 93.818 seconds
[0m19:02:44.949475 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:44.950084 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m19:02:44.953258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m19:02:44.953886 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:44.954624 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp190110978361'
        
      order by ordinal_position

  
[0m19:02:44.966015 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m19:02:44.971548 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:44.972544 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:44.979135 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m19:02:44.987967 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:44.988749 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m19:02:44.995062 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m19:02:44.999069 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m19:02:45.000212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:45.000835 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp190110978361"
    )


  
[0m19:02:45.151786 [debug] [Thread-1  ]: SQL status: INSERT 0 22533 in 0.150 seconds
[0m19:02:45.154722 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m19:02:45.155542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:45.155962 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m19:02:45.183807 [debug] [Thread-1  ]: SQL status: COMMIT in 0.027 seconds
[0m19:02:45.185489 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m19:02:45.186543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee7d12b0>]}
[0m19:02:45.187559 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 22533[0m in 94.50s]
[0m19:02:45.188749 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m19:02:45.190193 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m19:02:45.191003 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m19:02:45.193225 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m19:02:45.194481 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m19:02:45.194966 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m19:02:45.191893 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m19:02:45.207661 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m19:02:45.207215 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m19:02:45.209450 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m19:02:45.210675 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m19:02:45.218153 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m19:02:45.229683 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:02:45.230745 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp190245227003"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m19:02:45.231736 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m19:02:45.232810 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:02:45.240408 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:02:45.241360 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp190245237737"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m19:02:45.241833 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:04:04.443627 [debug] [Thread-3  ]: SQL status: SELECT 22533 in 79.202 seconds
[0m19:04:04.450658 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:04:04.451883 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m19:04:04.458801 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m19:04:04.459642 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:04:04.460331 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp190245237737'
        
      order by ordinal_position

  
[0m19:04:04.508439 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.047 seconds
[0m19:04:04.517095 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:04:04.517786 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m19:04:04.537816 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.019 seconds
[0m19:04:04.550094 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:04:04.551662 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m19:04:04.564514 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.012 seconds
[0m19:04:04.568754 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m19:04:04.569774 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:04:04.570308 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp190245237737"
    )


  
[0m19:04:04.703240 [debug] [Thread-3  ]: SQL status: INSERT 0 22533 in 0.132 seconds
[0m19:04:04.707031 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m19:04:04.708318 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:04:04.713421 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m19:04:04.738366 [debug] [Thread-3  ]: SQL status: COMMIT in 0.024 seconds
[0m19:04:04.741011 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m19:04:04.743057 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ec57c610>]}
[0m19:04:04.744416 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 22533[0m in 79.54s]
[0m19:04:04.747089 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m19:04:14.002542 [debug] [Thread-4  ]: SQL status: SELECT 1329 in 88.770 seconds
[0m19:04:14.013218 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:14.013821 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m19:04:14.017125 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m19:04:14.017903 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:14.018685 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp190245227003'
        
      order by ordinal_position

  
[0m19:04:14.030818 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.011 seconds
[0m19:04:14.039893 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:14.041004 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m19:04:14.048076 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m19:04:14.055122 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:14.056138 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m19:04:14.065012 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.008 seconds
[0m19:04:14.069722 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m19:04:14.070811 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:14.071555 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp190245227003"
    )


  
[0m19:04:14.080090 [debug] [Thread-4  ]: SQL status: INSERT 0 1329 in 0.007 seconds
[0m19:04:14.083363 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m19:04:14.084195 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:14.084827 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m19:04:14.093072 [debug] [Thread-4  ]: SQL status: COMMIT in 0.008 seconds
[0m19:04:14.094264 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m19:04:14.095225 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372bc67d-d05e-4d33-af84-aa1a24bbf6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ec708bb0>]}
[0m19:04:14.096243 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1329[0m in 88.90s]
[0m19:04:14.098325 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m19:04:14.100877 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:14.101529 [debug] [MainThread]: On master: BEGIN
[0m19:04:14.101860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:14.137725 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m19:04:14.138554 [debug] [MainThread]: On master: COMMIT
[0m19:04:14.140435 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:14.140987 [debug] [MainThread]: On master: COMMIT
[0m19:04:14.143924 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:04:14.144524 [debug] [MainThread]: On master: Close
[0m19:04:14.145553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:14.146028 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m19:04:14.146389 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m19:04:14.147442 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m19:04:14.148071 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m19:04:14.148616 [info ] [MainThread]: 
[0m19:04:14.149283 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 3 minutes and 3.80 seconds (183.80s).
[0m19:04:14.152118 [debug] [MainThread]: Command end result
[0m19:04:14.222287 [info ] [MainThread]: 
[0m19:04:14.223146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:14.223727 [info ] [MainThread]: 
[0m19:04:14.224253 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:04:14.225585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 185.05453, "process_user_time": 4.745277, "process_kernel_time": 0.330053, "process_mem_max_rss": "105912", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m19:04:14.226371 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:14.226189 after 185.06 seconds
[0m19:04:14.226936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f26e5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f000bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86efc54250>]}
[0m19:04:14.227614 [debug] [MainThread]: Flushing usage events
[0m19:04:14.887310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:56.346713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e92b4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e90b4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e858f460>]}


============================== 20:00:56.354672 | f1c71ee5-d0ee-4374-b350-902f91170436 ==============================
[0m20:00:56.354672 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m20:00:56.355644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:00:56.617562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e6c46550>]}
[0m20:00:56.718526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e85b3640>]}
[0m20:00:56.719582 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:00:56.745781 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m20:00:56.983129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:56.983694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:56.993153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m20:00:57.061039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e6897c70>]}
[0m20:00:57.252232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e6884bb0>]}
[0m20:00:57.253232 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m20:00:57.253913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e6ac3f70>]}
[0m20:00:57.256584 [info ] [MainThread]: 
[0m20:00:57.257213 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m20:00:57.258253 [info ] [MainThread]: 
[0m20:00:57.259177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:00:57.268130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m20:00:57.269387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m20:00:57.351091 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m20:00:57.351948 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m20:00:57.352984 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m20:00:57.353627 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m20:00:57.354278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:57.354838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:57.393060 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.038 seconds
[0m20:00:57.394248 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.040 seconds
[0m20:00:57.397061 [debug] [ThreadPool]: On list_lab08_db: Close
[0m20:00:57.399801 [debug] [ThreadPool]: On list_lab08_db: Close
[0m20:00:57.404555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m20:00:57.416378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m20:00:57.417826 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m20:00:57.421738 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m20:00:57.422433 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m20:00:57.423301 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m20:00:57.424020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:57.425330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:57.459528 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m20:00:57.460381 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m20:00:57.461009 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m20:00:57.465985 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m20:00:57.467613 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m20:00:57.468383 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m20:00:57.470435 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m20:00:57.473184 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m20:00:57.474380 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m20:00:57.479367 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m20:00:57.480155 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m20:00:57.485854 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m20:00:57.496446 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.497420 [debug] [MainThread]: On master: BEGIN
[0m20:00:57.498161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:57.534914 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m20:00:57.535662 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.536332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:00:57.544115 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m20:00:57.546116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e57573d0>]}
[0m20:00:57.548981 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:57.552573 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.553260 [debug] [MainThread]: On master: BEGIN
[0m20:00:57.558650 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:00:57.560647 [debug] [MainThread]: On master: COMMIT
[0m20:00:57.561403 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:57.561985 [debug] [MainThread]: On master: COMMIT
[0m20:00:57.564871 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:00:57.565545 [debug] [MainThread]: On master: Close
[0m20:00:57.572947 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m20:00:57.574020 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m20:00:57.577301 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m20:00:57.578040 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m20:00:57.579187 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m20:00:57.575583 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m20:00:57.586304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m20:00:57.586877 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m20:00:57.587465 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m20:00:57.588350 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m20:00:57.591126 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m20:00:57.591793 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m20:00:57.585579 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m20:00:57.592790 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m20:00:57.594363 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m20:00:57.595244 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m20:00:57.655422 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m20:00:57.668384 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m20:00:57.662343 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m20:00:57.678839 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m20:00:57.658992 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m20:00:57.667173 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m20:00:57.696129 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m20:00:57.738504 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m20:00:57.983241 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:00:57.986802 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:00:57.991932 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:00:57.996922 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:00:58.000696 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp200057858896"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m20:00:57.998976 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp200057901074"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m20:00:58.002066 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:00:58.001433 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:00:57.999892 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp200057906465"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m20:00:57.998056 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp200057866451"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m20:00:58.003715 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:00:58.004832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:26.663404 [debug] [Thread-3  ]: SQL status: SELECT 20600 in 88.661 seconds
[0m20:02:26.690986 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:26.691702 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m20:02:26.694821 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:02:26.695327 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:26.695944 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp200057901074'
        
      order by ordinal_position

  
[0m20:02:26.712604 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.016 seconds
[0m20:02:26.723692 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:26.724387 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:26.730746 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m20:02:26.746675 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:26.748299 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:26.754762 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m20:02:26.777199 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m20:02:26.778355 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:26.779108 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp200057901074"
    )


  
[0m20:02:26.818697 [debug] [Thread-3  ]: SQL status: INSERT 0 20600 in 0.039 seconds
[0m20:02:26.842700 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m20:02:26.843727 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:26.844318 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m20:02:26.867461 [debug] [Thread-3  ]: SQL status: COMMIT in 0.022 seconds
[0m20:02:26.870639 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m20:02:26.873090 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e540be80>]}
[0m20:02:26.874257 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 20600[0m in 89.28s]
[0m20:02:26.875168 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m20:02:31.567091 [debug] [Thread-4  ]: SQL status: SELECT 20600 in 93.566 seconds
[0m20:02:31.574877 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:31.575668 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m20:02:31.578818 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:02:31.579495 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:31.580037 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp200057858896'
        
      order by ordinal_position

  
[0m20:02:31.600275 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.020 seconds
[0m20:02:31.607424 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:31.608132 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:31.622398 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m20:02:31.703979 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:31.704643 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:31.714185 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.009 seconds
[0m20:02:31.720588 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m20:02:31.722456 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:31.722999 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp200057858896"
    )


  
[0m20:02:31.769232 [debug] [Thread-4  ]: SQL status: INSERT 0 20600 in 0.046 seconds
[0m20:02:31.772025 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m20:02:31.772649 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:31.773207 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m20:02:31.797305 [debug] [Thread-4  ]: SQL status: COMMIT in 0.023 seconds
[0m20:02:31.798888 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m20:02:31.799845 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e540bd00>]}
[0m20:02:31.801085 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 20600[0m in 94.21s]
[0m20:02:31.801860 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m20:02:34.462181 [debug] [Thread-2  ]: SQL status: SELECT 20600 in 96.458 seconds
[0m20:02:34.470365 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:34.471110 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m20:02:34.473905 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:02:34.474459 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:34.474952 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp200057906465'
        
      order by ordinal_position

  
[0m20:02:34.486764 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m20:02:34.491921 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:34.492520 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:34.499582 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m20:02:34.506490 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:34.507189 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:34.514459 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m20:02:34.520677 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m20:02:34.522136 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:34.522996 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp200057906465"
    )


  
[0m20:02:34.594541 [debug] [Thread-2  ]: SQL status: INSERT 0 20600 in 0.071 seconds
[0m20:02:34.598923 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m20:02:34.600121 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:34.601400 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m20:02:34.629678 [debug] [Thread-2  ]: SQL status: COMMIT in 0.027 seconds
[0m20:02:34.631481 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m20:02:34.632877 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e53f4bb0>]}
[0m20:02:34.634199 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 20600[0m in 97.05s]
[0m20:02:34.637734 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m20:02:37.917886 [debug] [Thread-1  ]: SQL status: SELECT 20600 in 99.913 seconds
[0m20:02:37.923128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:37.923823 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m20:02:37.926272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:02:37.926798 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:37.927243 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp200057866451'
        
      order by ordinal_position

  
[0m20:02:37.939283 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m20:02:37.945694 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:37.946315 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:37.953281 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m20:02:37.959482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:37.960118 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m20:02:37.966029 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m20:02:37.970000 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m20:02:37.976017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:37.976968 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp200057866451"
    )


  
[0m20:02:38.100381 [debug] [Thread-1  ]: SQL status: INSERT 0 20600 in 0.123 seconds
[0m20:02:38.103246 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m20:02:38.104063 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:38.104789 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m20:02:38.124174 [debug] [Thread-1  ]: SQL status: COMMIT in 0.019 seconds
[0m20:02:38.125873 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m20:02:38.126805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e53f4ee0>]}
[0m20:02:38.127732 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 20600[0m in 100.54s]
[0m20:02:38.128496 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m20:02:38.129544 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m20:02:38.130226 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m20:02:38.131045 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m20:02:38.133947 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m20:02:38.132304 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m20:02:38.134695 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m20:02:38.136009 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m20:02:38.145227 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m20:02:38.146239 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m20:02:38.152878 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m20:02:38.155875 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m20:02:38.165656 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:02:38.166678 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp200238162027"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m20:02:38.167254 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:02:38.168902 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m20:02:38.177369 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:02:38.178306 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp200238173611"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m20:02:38.179726 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:03:42.369553 [debug] [Thread-3  ]: SQL status: SELECT 20600 in 64.202 seconds
[0m20:03:42.375795 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:42.376480 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m20:03:42.380383 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:03:42.381047 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:42.381501 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp200238162027'
        
      order by ordinal_position

  
[0m20:03:42.397229 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.015 seconds
[0m20:03:42.402508 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:42.403282 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m20:03:42.411850 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.008 seconds
[0m20:03:42.419113 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:42.419737 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m20:03:42.429120 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.009 seconds
[0m20:03:42.434671 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m20:03:42.435901 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:42.436556 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp200238162027"
    )


  
[0m20:03:42.494682 [debug] [Thread-3  ]: SQL status: INSERT 0 20600 in 0.057 seconds
[0m20:03:42.497630 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m20:03:42.498355 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:42.499011 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m20:03:42.521476 [debug] [Thread-3  ]: SQL status: COMMIT in 0.022 seconds
[0m20:03:42.526219 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m20:03:42.527649 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e41d7fd0>]}
[0m20:03:42.528688 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 20600[0m in 64.39s]
[0m20:03:42.529812 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m20:03:51.292803 [debug] [Thread-4  ]: SQL status: SELECT 1255 in 73.113 seconds
[0m20:03:51.297582 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:51.298169 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m20:03:51.300875 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:03:51.301407 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:51.302203 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp200238173611'
        
      order by ordinal_position

  
[0m20:03:51.317671 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.014 seconds
[0m20:03:51.323657 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:51.324293 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m20:03:51.330853 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m20:03:51.337637 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:51.338555 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m20:03:51.344889 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.005 seconds
[0m20:03:51.349359 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m20:03:51.350738 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:51.351427 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp200238173611"
    )


  
[0m20:03:51.367781 [debug] [Thread-4  ]: SQL status: INSERT 0 1255 in 0.015 seconds
[0m20:03:51.371412 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m20:03:51.372417 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:51.373367 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m20:03:51.380177 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m20:03:51.381730 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m20:03:51.382659 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c71ee5-d0ee-4374-b350-902f91170436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e5344310>]}
[0m20:03:51.383984 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1255[0m in 73.25s]
[0m20:03:51.384761 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m20:03:51.386645 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:51.387075 [debug] [MainThread]: On master: BEGIN
[0m20:03:51.387494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:03:51.418758 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m20:03:51.419481 [debug] [MainThread]: On master: COMMIT
[0m20:03:51.419925 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:51.420261 [debug] [MainThread]: On master: COMMIT
[0m20:03:51.422430 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:03:51.422989 [debug] [MainThread]: On master: Close
[0m20:03:51.423691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:51.424071 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m20:03:51.424628 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m20:03:51.425284 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m20:03:51.425614 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m20:03:51.426052 [info ] [MainThread]: 
[0m20:03:51.426431 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 54.17 seconds (174.17s).
[0m20:03:51.428269 [debug] [MainThread]: Command end result
[0m20:03:51.482261 [info ] [MainThread]: 
[0m20:03:51.482979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:51.483887 [info ] [MainThread]: 
[0m20:03:51.484314 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:03:51.485788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 175.22498, "process_user_time": 4.026891, "process_kernel_time": 0.334793, "process_mem_max_rss": "105816", "process_out_blocks": "2152", "process_in_blocks": "0"}
[0m20:03:51.486466 [debug] [MainThread]: Command `dbt run` succeeded at 20:03:51.486322 after 175.23 seconds
[0m20:03:51.486968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e92b4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e90b4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19e6884b80>]}
[0m20:03:51.487583 [debug] [MainThread]: Flushing usage events
[0m20:03:52.116054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:00.019939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41c082e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41d162100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41b365340>]}


============================== 21:01:00.026841 | 5250cec7-1e94-4e6f-a556-9216c1873976 ==============================
[0m21:01:00.026841 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m21:01:00.027511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:00.318715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4199a69a0>]}
[0m21:01:00.417553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41b380790>]}
[0m21:01:00.419718 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:01:00.449409 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m21:01:00.671209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:00.672066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:00.686278 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m21:01:00.750505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419623b50>]}
[0m21:01:00.931665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419694b50>]}
[0m21:01:00.932538 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m21:01:00.933851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4197d8f70>]}
[0m21:01:00.936513 [info ] [MainThread]: 
[0m21:01:00.937796 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m21:01:00.938881 [info ] [MainThread]: 
[0m21:01:00.940124 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:01:00.947290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m21:01:00.958349 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m21:01:01.014339 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m21:01:01.014972 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m21:01:01.016134 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m21:01:01.017081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.015629 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m21:01:01.018390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.057008 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.040 seconds
[0m21:01:01.057786 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.039 seconds
[0m21:01:01.060117 [debug] [ThreadPool]: On list_lab08_db: Close
[0m21:01:01.062606 [debug] [ThreadPool]: On list_lab08_db: Close
[0m21:01:01.066370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db_dm_dev'
[0m21:01:01.077597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m21:01:01.090804 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m21:01:01.091495 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m21:01:01.091955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.092532 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m21:01:01.093358 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m21:01:01.093802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:01.137654 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m21:01:01.138399 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m21:01:01.138936 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m21:01:01.142326 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m21:01:01.142860 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m21:01:01.143388 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m21:01:01.147423 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m21:01:01.150822 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m21:01:01.151654 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m21:01:01.154327 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m21:01:01.154970 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m21:01:01.158802 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m21:01:01.168277 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.169019 [debug] [MainThread]: On master: BEGIN
[0m21:01:01.169365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:01.204473 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:01:01.205405 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.206013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:01:01.213777 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m21:01:01.215615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe418589820>]}
[0m21:01:01.216302 [debug] [MainThread]: On master: ROLLBACK
[0m21:01:01.218951 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.219409 [debug] [MainThread]: On master: BEGIN
[0m21:01:01.224895 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:01:01.225657 [debug] [MainThread]: On master: COMMIT
[0m21:01:01.226043 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:01.226386 [debug] [MainThread]: On master: COMMIT
[0m21:01:01.228890 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m21:01:01.229485 [debug] [MainThread]: On master: Close
[0m21:01:01.233792 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m21:01:01.234612 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m21:01:01.235452 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m21:01:01.236307 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m21:01:01.239672 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m21:01:01.237808 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m21:01:01.241342 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m21:01:01.237106 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m21:01:01.243082 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m21:01:01.238921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m21:01:01.244883 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m21:01:01.240541 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_lab08_db, now model.dbt_lab08_project.ods_geo_events)
[0m21:01:01.243890 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m21:01:01.242102 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m21:01:01.256399 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m21:01:01.270682 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m21:01:01.271759 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m21:01:01.278836 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m21:01:01.286400 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m21:01:01.293161 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m21:01:01.297630 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m21:01:01.294393 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m21:01:01.296553 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m21:01:01.295826 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m21:01:01.608422 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:01:01.609886 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:01:01.612441 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:01:01.615823 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:01:01.616540 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp210101532935"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m21:01:01.617379 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp210101567424"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m21:01:01.618065 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp210101472954"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m21:01:01.618859 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp210101477629"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m21:01:01.619554 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:01.620319 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:01:01.621958 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:01:01.622623 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:02:16.472496 [debug] [Thread-3  ]: SQL status: SELECT 21886 in 74.850 seconds
[0m21:02:16.495872 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:16.496652 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m21:02:16.499848 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m21:02:16.500441 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:16.500874 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp210101477629'
        
      order by ordinal_position

  
[0m21:02:16.516288 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.015 seconds
[0m21:02:16.524824 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:16.525501 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:16.531529 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m21:02:16.548275 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:16.549332 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:16.555260 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m21:02:16.573273 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m21:02:16.574765 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:16.575735 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp210101477629"
    )


  
[0m21:02:16.615893 [debug] [Thread-3  ]: SQL status: INSERT 0 21886 in 0.040 seconds
[0m21:02:16.639599 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m21:02:16.640201 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:16.640606 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m21:02:16.670693 [debug] [Thread-3  ]: SQL status: COMMIT in 0.029 seconds
[0m21:02:16.674723 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m21:02:16.678174 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4181b1a00>]}
[0m21:02:16.679294 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 21886[0m in 75.44s]
[0m21:02:16.680425 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m21:02:19.668536 [debug] [Thread-4  ]: SQL status: SELECT 21886 in 78.046 seconds
[0m21:02:19.674267 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:19.674933 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m21:02:19.678454 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m21:02:19.679019 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:19.679486 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp210101472954'
        
      order by ordinal_position

  
[0m21:02:19.692329 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m21:02:19.767762 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:19.768469 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:19.774888 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m21:02:19.781927 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:19.783518 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:19.789871 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m21:02:19.793368 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m21:02:19.794367 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:19.794839 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp210101472954"
    )


  
[0m21:02:19.831761 [debug] [Thread-4  ]: SQL status: INSERT 0 21886 in 0.036 seconds
[0m21:02:19.834037 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m21:02:19.834583 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:19.835056 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m21:02:19.857644 [debug] [Thread-4  ]: SQL status: COMMIT in 0.022 seconds
[0m21:02:19.859305 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m21:02:19.860541 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe418589040>]}
[0m21:02:19.861768 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 21886[0m in 78.62s]
[0m21:02:19.862849 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m21:02:22.411271 [debug] [Thread-2  ]: SQL status: SELECT 21886 in 80.791 seconds
[0m21:02:22.416446 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:22.417047 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m21:02:22.419951 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m21:02:22.420768 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:22.421317 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp210101567424'
        
      order by ordinal_position

  
[0m21:02:22.432602 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m21:02:22.440216 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:22.441141 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:22.447287 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.005 seconds
[0m21:02:22.454271 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:22.455039 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:22.460910 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.005 seconds
[0m21:02:22.464094 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m21:02:22.465164 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:22.465679 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp210101567424"
    )


  
[0m21:02:22.510493 [debug] [Thread-2  ]: SQL status: INSERT 0 21886 in 0.044 seconds
[0m21:02:22.513023 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m21:02:22.513585 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:22.513982 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m21:02:22.549421 [debug] [Thread-2  ]: SQL status: COMMIT in 0.035 seconds
[0m21:02:22.551057 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m21:02:22.552020 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4181b1e20>]}
[0m21:02:22.553021 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 21886[0m in 81.31s]
[0m21:02:22.554085 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m21:02:23.138276 [debug] [Thread-1  ]: SQL status: SELECT 21886 in 81.519 seconds
[0m21:02:23.145895 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:23.146722 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m21:02:23.149304 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m21:02:23.150184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:23.150666 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp210101532935'
        
      order by ordinal_position

  
[0m21:02:23.161777 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.010 seconds
[0m21:02:23.168053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:23.168904 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:23.174624 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m21:02:23.181819 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:23.182422 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m21:02:23.187591 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m21:02:23.191795 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m21:02:23.192982 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:23.193711 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp210101532935"
    )


  
[0m21:02:23.308687 [debug] [Thread-1  ]: SQL status: INSERT 0 21886 in 0.114 seconds
[0m21:02:23.311195 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m21:02:23.311770 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:23.312185 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m21:02:23.338543 [debug] [Thread-1  ]: SQL status: COMMIT in 0.026 seconds
[0m21:02:23.340312 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m21:02:23.341384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4181fe6a0>]}
[0m21:02:23.342318 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 21886[0m in 82.10s]
[0m21:02:23.343949 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m21:02:23.345540 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m21:02:23.346216 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m21:02:23.347251 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m21:02:23.348474 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m21:02:23.349455 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m21:02:23.350378 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m21:02:23.351766 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m21:02:23.351128 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m21:02:23.363127 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m21:02:23.366896 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m21:02:23.368249 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m21:02:23.369090 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m21:02:23.377010 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:02:23.386515 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:02:23.387436 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp210223374332"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m21:02:23.388268 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp210223381369"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m21:02:23.389750 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:02:23.389144 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:03:25.261912 [debug] [Thread-3  ]: SQL status: SELECT 21886 in 61.873 seconds
[0m21:03:25.268184 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:25.268896 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m21:03:25.275698 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m21:03:25.276625 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:25.277383 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp210223374332'
        
      order by ordinal_position

  
[0m21:03:25.308904 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.031 seconds
[0m21:03:25.315160 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:25.315775 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m21:03:25.328222 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.012 seconds
[0m21:03:25.336207 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:25.337025 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m21:03:25.348776 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.011 seconds
[0m21:03:25.353202 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m21:03:25.354172 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:25.354670 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp210223374332"
    )


  
[0m21:03:25.436825 [debug] [Thread-3  ]: SQL status: INSERT 0 21886 in 0.082 seconds
[0m21:03:25.439037 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m21:03:25.439594 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:25.440043 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m21:03:25.461857 [debug] [Thread-3  ]: SQL status: COMMIT in 0.021 seconds
[0m21:03:25.463702 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m21:03:25.464839 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41b365a60>]}
[0m21:03:25.465933 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 21886[0m in 62.12s]
[0m21:03:25.467233 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m21:03:54.064726 [debug] [Thread-4  ]: SQL status: SELECT 1208 in 90.675 seconds
[0m21:03:54.069753 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:54.070348 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m21:03:54.074604 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m21:03:54.075388 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:54.075860 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp210223381369'
        
      order by ordinal_position

  
[0m21:03:54.094052 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.017 seconds
[0m21:03:54.102028 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:54.102774 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m21:03:54.111786 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.008 seconds
[0m21:03:54.120175 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:54.121058 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m21:03:54.135048 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.013 seconds
[0m21:03:54.139486 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m21:03:54.140875 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:54.141609 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp210223381369"
    )


  
[0m21:03:54.202897 [debug] [Thread-4  ]: SQL status: INSERT 0 1208 in 0.061 seconds
[0m21:03:54.205547 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m21:03:54.206205 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:54.207709 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m21:03:54.302074 [debug] [Thread-4  ]: SQL status: COMMIT in 0.094 seconds
[0m21:03:54.304348 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m21:03:54.305869 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5250cec7-1e94-4e6f-a556-9216c1873976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4181a92e0>]}
[0m21:03:54.307111 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1208[0m in 90.96s]
[0m21:03:54.308455 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m21:03:54.310408 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:54.310990 [debug] [MainThread]: On master: BEGIN
[0m21:03:54.311494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:54.351483 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m21:03:54.352233 [debug] [MainThread]: On master: COMMIT
[0m21:03:54.352790 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:54.353375 [debug] [MainThread]: On master: COMMIT
[0m21:03:54.357989 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m21:03:54.358786 [debug] [MainThread]: On master: Close
[0m21:03:54.359759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:54.360208 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m21:03:54.360567 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m21:03:54.361006 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m21:03:54.361538 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m21:03:54.362112 [info ] [MainThread]: 
[0m21:03:54.362670 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 53.42 seconds (173.42s).
[0m21:03:54.365146 [debug] [MainThread]: Command end result
[0m21:03:54.419107 [info ] [MainThread]: 
[0m21:03:54.420125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:54.420674 [info ] [MainThread]: 
[0m21:03:54.421796 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:03:54.423246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 174.48479, "process_user_time": 3.756881, "process_kernel_time": 0.282634, "process_mem_max_rss": "105960", "process_out_blocks": "2120", "process_in_blocks": "0"}
[0m21:03:54.424380 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:54.424220 after 174.49 seconds
[0m21:03:54.425150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41c082e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41be93130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419694c70>]}
[0m21:03:54.425832 [debug] [MainThread]: Flushing usage events
[0m21:03:55.048562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:47.307051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ae349e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5af429130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ad6375b0>]}


============================== 22:00:47.314153 | 0639b437-930a-4b74-878f-f9098526bae3 ==============================
[0m22:00:47.314153 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m22:00:47.314883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:00:47.572877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5abc6fbb0>]}
[0m22:00:47.671613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ad647700>]}
[0m22:00:47.672836 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:00:47.695511 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m22:00:47.931311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:47.932005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:47.944822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m22:00:48.011516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ab92db80>]}
[0m22:00:48.208739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ab91bb80>]}
[0m22:00:48.209548 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m22:00:48.210071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5abae3df0>]}
[0m22:00:48.212366 [info ] [MainThread]: 
[0m22:00:48.213172 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m22:00:48.213605 [info ] [MainThread]: 
[0m22:00:48.214355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:48.224595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m22:00:48.234423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m22:00:48.285810 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m22:00:48.286690 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m22:00:48.287282 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m22:00:48.288107 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m22:00:48.288612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:48.289134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:48.331624 [debug] [ThreadPool]: SQL status: SELECT 59 in 0.043 seconds
[0m22:00:48.332554 [debug] [ThreadPool]: SQL status: SELECT 59 in 0.043 seconds
[0m22:00:48.336081 [debug] [ThreadPool]: On list_lab08_db: Close
[0m22:00:48.338307 [debug] [ThreadPool]: On list_lab08_db: Close
[0m22:00:48.341878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m22:00:48.342853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m22:00:48.356238 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m22:00:48.360352 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m22:00:48.361143 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m22:00:48.361930 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m22:00:48.362530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:48.363318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:48.398465 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m22:00:48.399115 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m22:00:48.399885 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m22:00:48.401496 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m22:00:48.401944 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m22:00:48.402442 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m22:00:48.414409 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m22:00:48.415242 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m22:00:48.418682 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m22:00:48.421110 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m22:00:48.424297 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m22:00:48.424989 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m22:00:48.436579 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:48.437553 [debug] [MainThread]: On master: BEGIN
[0m22:00:48.438240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:48.470320 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m22:00:48.470932 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:48.471385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:48.479111 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m22:00:48.481038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa865340>]}
[0m22:00:48.481920 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:48.484578 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:48.485062 [debug] [MainThread]: On master: BEGIN
[0m22:00:48.488984 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:00:48.489578 [debug] [MainThread]: On master: COMMIT
[0m22:00:48.489958 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:48.490300 [debug] [MainThread]: On master: COMMIT
[0m22:00:48.491936 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:00:48.492413 [debug] [MainThread]: On master: Close
[0m22:00:48.496518 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m22:00:48.497463 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m22:00:48.498267 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m22:00:48.499043 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m22:00:48.499744 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m22:00:48.503238 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m22:00:48.504305 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m22:00:48.502099 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m22:00:48.505582 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m22:00:48.500358 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m22:00:48.506905 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m22:00:48.507402 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m22:00:48.501140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m22:00:48.506163 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m22:00:48.504818 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m22:00:48.519578 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m22:00:48.531259 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m22:00:48.537747 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m22:00:48.543606 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m22:00:48.550171 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m22:00:48.551490 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m22:00:48.568498 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m22:00:48.574724 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m22:00:48.585905 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m22:00:48.815420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:00:48.816855 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:00:48.823033 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp220048727953"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m22:00:48.819697 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:00:48.822294 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:00:48.825856 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp220048799348"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m22:00:48.823580 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:00:48.825211 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp220048710073"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m22:00:48.826363 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:00:48.820372 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp220048724381"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m22:00:48.827332 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:00:48.828131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:02:34.148773 [debug] [Thread-3  ]: SQL status: SELECT 13342 in 105.321 seconds
[0m22:02:34.176881 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:02:34.177861 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m22:02:34.181889 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:02:34.182449 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:02:34.182934 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp220048710073'
        
      order by ordinal_position

  
[0m22:02:34.270868 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.087 seconds
[0m22:02:34.278676 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:02:34.279359 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:34.307384 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.027 seconds
[0m22:02:34.320068 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:02:34.320860 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:34.361079 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.040 seconds
[0m22:02:34.381460 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m22:02:34.382686 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:02:34.383467 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp220048710073"
    )


  
[0m22:02:34.514920 [debug] [Thread-3  ]: SQL status: INSERT 0 13342 in 0.131 seconds
[0m22:02:34.538616 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m22:02:34.539243 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:02:34.539769 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m22:02:34.552409 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m22:02:34.555846 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m22:02:34.558483 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa481d60>]}
[0m22:02:34.559741 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 13342[0m in 106.05s]
[0m22:02:34.560873 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m22:02:44.217534 [debug] [Thread-4  ]: SQL status: SELECT 13342 in 115.394 seconds
[0m22:02:44.222942 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:44.223548 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m22:02:44.226151 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m22:02:44.226719 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:44.227293 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp220048727953'
        
      order by ordinal_position

  
[0m22:02:44.269761 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.042 seconds
[0m22:02:44.277217 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:44.278008 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:44.285556 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m22:02:44.365482 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:44.366184 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:44.373696 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m22:02:44.377599 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m22:02:44.378802 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:44.379395 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp220048727953"
    )


  
[0m22:02:44.429104 [debug] [Thread-4  ]: SQL status: INSERT 0 13342 in 0.049 seconds
[0m22:02:44.431306 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m22:02:44.431885 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:44.432343 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m22:02:44.455415 [debug] [Thread-4  ]: SQL status: COMMIT in 0.022 seconds
[0m22:02:44.457261 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m22:02:44.458269 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5a826f910>]}
[0m22:02:44.459187 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 13342[0m in 115.95s]
[0m22:02:44.459939 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m22:02:44.573087 [debug] [Thread-2  ]: SQL status: SELECT 13342 in 115.747 seconds
[0m22:02:44.577768 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:44.578333 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m22:02:44.581006 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m22:02:44.581585 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:44.582116 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp220048799348'
        
      order by ordinal_position

  
[0m22:02:44.605090 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.022 seconds
[0m22:02:44.611870 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:44.612554 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:44.624687 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m22:02:44.630945 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:44.631716 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:44.645889 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m22:02:44.649414 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m22:02:44.650536 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:44.651219 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp220048799348"
    )


  
[0m22:02:44.740680 [debug] [Thread-2  ]: SQL status: INSERT 0 13342 in 0.089 seconds
[0m22:02:44.743270 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m22:02:44.744070 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:44.744556 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m22:02:44.764575 [debug] [Thread-2  ]: SQL status: COMMIT in 0.019 seconds
[0m22:02:44.765982 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m22:02:44.767238 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa481fd0>]}
[0m22:02:44.768184 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 13342[0m in 116.26s]
[0m22:02:44.769242 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m22:02:46.994995 [debug] [Thread-1  ]: SQL status: SELECT 13342 in 118.167 seconds
[0m22:02:46.999825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:47.000623 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m22:02:47.003705 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:02:47.004248 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:47.004692 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp220048724381'
        
      order by ordinal_position

  
[0m22:02:47.021475 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.016 seconds
[0m22:02:47.026976 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:47.027687 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:47.035267 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m22:02:47.041085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:47.041803 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m22:02:47.048349 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m22:02:47.052570 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m22:02:47.053493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:47.054158 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp220048724381"
    )


  
[0m22:02:47.143777 [debug] [Thread-1  ]: SQL status: INSERT 0 13342 in 0.089 seconds
[0m22:02:47.146728 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m22:02:47.147760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:47.148356 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m22:02:47.169208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.020 seconds
[0m22:02:47.170971 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m22:02:47.172207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa481d30>]}
[0m22:02:47.173207 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 13342[0m in 118.67s]
[0m22:02:47.174030 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m22:02:47.175778 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m22:02:47.176400 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m22:02:47.177289 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m22:02:47.178930 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m22:02:47.179816 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m22:02:47.180584 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m22:02:47.181358 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m22:02:47.182099 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m22:02:47.191409 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m22:02:47.203682 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m22:02:47.204866 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m22:02:47.211383 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:02:47.212571 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m22:02:47.213452 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp220247209028"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m22:02:47.220800 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:02:47.221701 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:02:47.222573 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp220247218340"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m22:02:47.224231 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m22:04:01.815553 [debug] [Thread-3  ]: SQL status: SELECT 13342 in 74.594 seconds
[0m22:04:01.821177 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:04:01.821918 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m22:04:01.826877 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m22:04:01.827515 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:04:01.828160 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp220247209028'
        
      order by ordinal_position

  
[0m22:04:01.841893 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.012 seconds
[0m22:04:01.847864 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:04:01.848558 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m22:04:01.856025 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m22:04:01.864275 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:04:01.865283 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m22:04:01.872526 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m22:04:01.876482 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m22:04:01.878125 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:04:01.878754 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp220247209028"
    )


  
[0m22:04:01.915037 [debug] [Thread-3  ]: SQL status: INSERT 0 13342 in 0.036 seconds
[0m22:04:01.917550 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m22:04:01.918442 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:04:01.919084 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m22:04:01.941038 [debug] [Thread-3  ]: SQL status: COMMIT in 0.021 seconds
[0m22:04:01.945087 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m22:04:01.947444 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ab872100>]}
[0m22:04:01.950361 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 13342[0m in 74.77s]
[0m22:04:01.954533 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m22:04:24.551304 [debug] [Thread-4  ]: SQL status: SELECT 791 in 97.327 seconds
[0m22:04:24.556544 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:04:24.557354 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m22:04:24.564189 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m22:04:24.564880 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:04:24.565358 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp220247218340'
        
      order by ordinal_position

  
[0m22:04:24.594188 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.028 seconds
[0m22:04:24.600386 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:04:24.601060 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m22:04:24.612091 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.010 seconds
[0m22:04:24.618871 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:04:24.619622 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m22:04:24.636589 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.014 seconds
[0m22:04:24.641958 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m22:04:24.642863 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:04:24.643380 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp220247218340"
    )


  
[0m22:04:24.686286 [debug] [Thread-4  ]: SQL status: INSERT 0 791 in 0.042 seconds
[0m22:04:24.689774 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m22:04:24.691288 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:04:24.692113 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m22:04:24.711048 [debug] [Thread-4  ]: SQL status: COMMIT in 0.018 seconds
[0m22:04:24.713087 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m22:04:24.714717 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0639b437-930a-4b74-878f-f9098526bae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa4814c0>]}
[0m22:04:24.716083 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 791[0m in 97.53s]
[0m22:04:24.717686 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m22:04:24.720314 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:24.720980 [debug] [MainThread]: On master: BEGIN
[0m22:04:24.721510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:24.797419 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m22:04:24.798036 [debug] [MainThread]: On master: COMMIT
[0m22:04:24.798450 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:24.798860 [debug] [MainThread]: On master: COMMIT
[0m22:04:24.801174 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:04:24.801621 [debug] [MainThread]: On master: Close
[0m22:04:24.802333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:24.802719 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m22:04:24.803489 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m22:04:24.803921 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m22:04:24.804217 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m22:04:24.804681 [info ] [MainThread]: 
[0m22:04:24.805129 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 3 minutes and 36.59 seconds (216.59s).
[0m22:04:24.807324 [debug] [MainThread]: Command end result
[0m22:04:24.852786 [info ] [MainThread]: 
[0m22:04:24.853551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:24.854717 [info ] [MainThread]: 
[0m22:04:24.855520 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:04:24.857555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 217.63269, "process_user_time": 3.61463, "process_kernel_time": 0.254204, "process_mem_max_rss": "105940", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m22:04:24.858215 [debug] [MainThread]: Command `dbt run` succeeded at 22:04:24.858087 after 217.63 seconds
[0m22:04:24.858735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ae349e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ab91bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ae143340>]}
[0m22:04:24.859204 [debug] [MainThread]: Flushing usage events
[0m22:04:25.513290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:25.723271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2aec7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2bfa7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2a1a7340>]}


============================== 23:00:25.730471 | c87d4d68-d108-44f0-8db9-7d3b99abf527 ==============================
[0m23:00:25.730471 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:00:25.731640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:00:26.008218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca287e99a0>]}
[0m23:00:26.114315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2a1c2700>]}
[0m23:00:26.115870 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:00:26.162946 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:00:26.360980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:26.361513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:26.370799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m23:00:26.436361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca28470b50>]}
[0m23:00:26.611671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca284dabb0>]}
[0m23:00:26.612448 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m23:00:26.612917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca28664f70>]}
[0m23:00:26.615202 [info ] [MainThread]: 
[0m23:00:26.615703 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:00:26.616024 [info ] [MainThread]: 
[0m23:00:26.617181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:26.624472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m23:00:26.625510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m23:00:26.697462 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m23:00:26.698131 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m23:00:26.698727 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m23:00:26.699300 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m23:00:26.699945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:26.700418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:26.741073 [debug] [ThreadPool]: SQL status: SELECT 63 in 0.040 seconds
[0m23:00:26.744360 [debug] [ThreadPool]: On list_lab08_db: Close
[0m23:00:26.745837 [debug] [ThreadPool]: SQL status: SELECT 63 in 0.046 seconds
[0m23:00:26.748824 [debug] [ThreadPool]: On list_lab08_db: Close
[0m23:00:26.752113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m23:00:26.762324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m23:00:26.765132 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m23:00:26.768776 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m23:00:26.769378 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m23:00:26.770328 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m23:00:26.770880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:26.771495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:26.804517 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m23:00:26.805251 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m23:00:26.805681 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m23:00:26.806959 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m23:00:26.807620 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m23:00:26.808229 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m23:00:26.814288 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m23:00:26.817523 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m23:00:26.818471 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m23:00:26.820630 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m23:00:26.821257 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m23:00:26.823780 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m23:00:26.836153 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:26.837191 [debug] [MainThread]: On master: BEGIN
[0m23:00:26.837911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:26.869832 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m23:00:26.870784 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:26.871601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:26.879144 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:00:26.880843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca28419460>]}
[0m23:00:26.881705 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:26.884050 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:26.884458 [debug] [MainThread]: On master: BEGIN
[0m23:00:26.888371 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:00:26.889017 [debug] [MainThread]: On master: COMMIT
[0m23:00:26.889528 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:26.890000 [debug] [MainThread]: On master: COMMIT
[0m23:00:26.891977 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:00:26.892355 [debug] [MainThread]: On master: Close
[0m23:00:26.896259 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m23:00:26.896943 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m23:00:26.898970 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m23:00:26.897771 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m23:00:26.899965 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m23:00:26.902329 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m23:00:26.901101 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m23:00:26.914134 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m23:00:26.900497 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m23:00:26.931702 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m23:00:26.901717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m23:00:26.933719 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m23:00:26.939586 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m23:00:26.929612 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m23:00:26.932891 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m23:00:26.916154 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m23:00:26.940859 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m23:00:26.941697 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m23:00:26.942398 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m23:00:26.949811 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m23:00:26.955915 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m23:00:26.957219 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m23:00:27.007255 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m23:00:27.024791 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m23:00:27.134482 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:00:27.135753 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:00:27.137120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:00:27.137859 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp230027070711"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m23:00:27.133615 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:00:27.138722 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp230027022712"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m23:00:27.139444 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp230027062621"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m23:00:27.140157 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:00:27.141021 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp230027039230"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m23:00:27.141652 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:00:27.142238 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:00:27.143344 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:01:46.166389 [debug] [Thread-3  ]: SQL status: SELECT 10254 in 79.023 seconds
[0m23:01:46.189513 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:46.190425 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m23:01:46.196895 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m23:01:46.197470 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:46.197956 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp230027039230'
        
      order by ordinal_position

  
[0m23:01:46.214302 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.016 seconds
[0m23:01:46.226862 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:46.227836 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:46.236024 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m23:01:46.253124 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:46.254237 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:46.262652 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m23:01:46.283748 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m23:01:46.285401 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:46.286065 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp230027039230"
    )


  
[0m23:01:46.303583 [debug] [Thread-3  ]: SQL status: INSERT 0 10254 in 0.017 seconds
[0m23:01:46.332572 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m23:01:46.333790 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:46.334808 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m23:01:46.350873 [debug] [Thread-3  ]: SQL status: COMMIT in 0.015 seconds
[0m23:01:46.354119 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m23:01:46.366281 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca26f4a610>]}
[0m23:01:46.367467 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 10254[0m in 79.42s]
[0m23:01:46.368982 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m23:01:51.831355 [debug] [Thread-4  ]: SQL status: SELECT 10254 in 84.691 seconds
[0m23:01:51.836084 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:51.836747 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m23:01:51.839043 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m23:01:51.839558 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:51.840023 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp230027070711'
        
      order by ordinal_position

  
[0m23:01:51.851912 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.011 seconds
[0m23:01:51.857795 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:51.858554 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:51.864683 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m23:01:51.870873 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:51.871555 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:51.877191 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.005 seconds
[0m23:01:51.884632 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m23:01:51.885921 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:51.886752 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp230027070711"
    )


  
[0m23:01:51.906656 [debug] [Thread-4  ]: SQL status: INSERT 0 10254 in 0.019 seconds
[0m23:01:51.908874 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m23:01:51.909442 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:51.910087 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m23:01:51.923152 [debug] [Thread-4  ]: SQL status: COMMIT in 0.013 seconds
[0m23:01:51.924433 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m23:01:51.925334 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca246f45e0>]}
[0m23:01:51.926208 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 10254[0m in 85.01s]
[0m23:01:51.927459 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m23:01:54.958881 [debug] [Thread-2  ]: SQL status: SELECT 10254 in 87.817 seconds
[0m23:01:55.033783 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:55.034667 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m23:01:55.039051 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m23:01:55.039682 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:55.040143 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp230027022712'
        
      order by ordinal_position

  
[0m23:01:55.070447 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.030 seconds
[0m23:01:55.077881 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:55.078555 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:55.092252 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m23:01:55.099602 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:55.100545 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:55.118410 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.017 seconds
[0m23:01:55.121861 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m23:01:55.122704 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:55.123188 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp230027022712"
    )


  
[0m23:01:55.158440 [debug] [Thread-2  ]: SQL status: INSERT 0 10254 in 0.035 seconds
[0m23:01:55.160909 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m23:01:55.161512 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:55.162045 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m23:01:55.186636 [debug] [Thread-2  ]: SQL status: COMMIT in 0.024 seconds
[0m23:01:55.187937 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m23:01:55.188820 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca287fd6d0>]}
[0m23:01:55.189999 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 10254[0m in 88.29s]
[0m23:01:55.191286 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m23:01:56.745751 [debug] [Thread-1  ]: SQL status: SELECT 10254 in 89.603 seconds
[0m23:01:56.751700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:01:56.752402 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m23:01:56.755104 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:01:56.755671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:01:56.756124 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp230027062621'
        
      order by ordinal_position

  
[0m23:01:56.773864 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.017 seconds
[0m23:01:56.779258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:01:56.779903 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:56.788076 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.008 seconds
[0m23:01:56.794790 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:01:56.795438 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m23:01:56.801606 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m23:01:56.805024 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m23:01:56.806026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:01:56.806632 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp230027062621"
    )


  
[0m23:01:56.876317 [debug] [Thread-1  ]: SQL status: INSERT 0 10254 in 0.069 seconds
[0m23:01:56.879259 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m23:01:56.880207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:01:56.880820 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m23:01:56.900305 [debug] [Thread-1  ]: SQL status: COMMIT in 0.019 seconds
[0m23:01:56.901781 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m23:01:56.903033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca27011d60>]}
[0m23:01:56.904097 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 10254[0m in 90.00s]
[0m23:01:56.905019 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m23:01:56.906246 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m23:01:56.907125 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m23:01:56.907794 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m23:01:56.908207 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m23:01:56.914408 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m23:01:56.915576 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m23:01:56.917842 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m23:01:56.916406 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m23:01:56.926295 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:01:56.927121 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m23:01:56.927860 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp230156923424"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m23:01:56.928863 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m23:01:56.929638 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:01:56.937581 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m23:01:56.939105 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m23:01:56.946028 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:01:56.946730 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp230156943649"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m23:01:56.947256 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:03:05.790952 [debug] [Thread-3  ]: SQL status: SELECT 10254 in 68.861 seconds
[0m23:03:05.797489 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:05.798290 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m23:03:05.803688 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m23:03:05.804355 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:05.804966 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp230156923424'
        
      order by ordinal_position

  
[0m23:03:05.818409 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.013 seconds
[0m23:03:05.823977 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:05.824762 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m23:03:05.833333 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.008 seconds
[0m23:03:05.841034 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:05.842213 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m23:03:05.848626 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m23:03:05.852016 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m23:03:05.852943 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:05.853504 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp230156923424"
    )


  
[0m23:03:05.871173 [debug] [Thread-3  ]: SQL status: INSERT 0 10254 in 0.017 seconds
[0m23:03:05.873294 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m23:03:05.873879 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:05.874332 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m23:03:05.887354 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m23:03:05.888933 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m23:03:05.889975 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca246b45e0>]}
[0m23:03:05.891058 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 10254[0m in 68.98s]
[0m23:03:05.892037 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m23:03:20.340968 [debug] [Thread-4  ]: SQL status: SELECT 599 in 83.394 seconds
[0m23:03:20.347114 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:20.347733 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m23:03:20.350885 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m23:03:20.351676 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:20.352194 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp230156943649'
        
      order by ordinal_position

  
[0m23:03:20.364426 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.011 seconds
[0m23:03:20.371180 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:20.371776 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m23:03:20.378402 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m23:03:20.384388 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:20.385050 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m23:03:20.392062 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m23:03:20.396127 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m23:03:20.397247 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:20.398064 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp230156943649"
    )


  
[0m23:03:20.410208 [debug] [Thread-4  ]: SQL status: INSERT 0 599 in 0.011 seconds
[0m23:03:20.412758 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m23:03:20.413517 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:20.414099 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m23:03:20.420186 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m23:03:20.421565 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m23:03:20.422473 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87d4d68-d108-44f0-8db9-7d3b99abf527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca283ec430>]}
[0m23:03:20.423390 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 599[0m in 83.50s]
[0m23:03:20.424247 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m23:03:20.426334 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:20.426850 [debug] [MainThread]: On master: BEGIN
[0m23:03:20.427217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:20.458709 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m23:03:20.459303 [debug] [MainThread]: On master: COMMIT
[0m23:03:20.459677 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:20.460138 [debug] [MainThread]: On master: COMMIT
[0m23:03:20.462431 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:03:20.462889 [debug] [MainThread]: On master: Close
[0m23:03:20.463646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:20.464041 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m23:03:20.464448 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m23:03:20.464814 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m23:03:20.465098 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m23:03:20.465617 [info ] [MainThread]: 
[0m23:03:20.466111 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 53.85 seconds (173.85s).
[0m23:03:20.467793 [debug] [MainThread]: Command end result
[0m23:03:20.520798 [info ] [MainThread]: 
[0m23:03:20.521446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:20.521884 [info ] [MainThread]: 
[0m23:03:20.522292 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:03:20.523470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 174.88899, "process_user_time": 3.439386, "process_kernel_time": 0.282424, "process_mem_max_rss": "105800", "process_out_blocks": "2112", "process_in_blocks": "0"}
[0m23:03:20.524253 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:20.524114 after 174.89 seconds
[0m23:03:20.524817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2aec7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ad213d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca284dacd0>]}
[0m23:03:20.525331 [debug] [MainThread]: Flushing usage events
[0m23:03:21.151944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:29.680401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f128c0f0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f128be970a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f128b8f32b0>]}


============================== 00:00:29.689368 | c105e7c4-4278-4813-83fd-2c4847b70cdd ==============================
[0m00:00:29.689368 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:00:29.690299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:29.973235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1289abb460>]}
[0m00:00:30.069456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12899ecca0>]}
[0m00:00:30.071410 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:00:30.097470 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:00:30.330840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:30.331400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:30.342061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m00:00:30.415681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12896b3be0>]}
[0m00:00:30.585971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1289703be0>]}
[0m00:00:30.586748 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m00:00:30.587203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f128988c790>]}
[0m00:00:30.589369 [info ] [MainThread]: 
[0m00:00:30.589885 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m00:00:30.590210 [info ] [MainThread]: 
[0m00:00:30.591300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:30.599842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m00:00:30.609743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m00:00:30.672345 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m00:00:30.673107 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m00:00:30.673725 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:30.674344 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:30.674940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:30.675669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:30.711430 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.036 seconds
[0m00:00:30.714043 [debug] [ThreadPool]: On list_lab08_db: Close
[0m00:00:30.714841 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.039 seconds
[0m00:00:30.717477 [debug] [ThreadPool]: On list_lab08_db: Close
[0m00:00:30.720025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m00:00:30.731419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m00:00:30.733271 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m00:00:30.737112 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m00:00:30.738253 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m00:00:30.739659 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m00:00:30.740302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:30.741420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:30.774360 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m00:00:30.775031 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m00:00:30.775448 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m00:00:30.777107 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m00:00:30.777838 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m00:00:30.778262 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m00:00:30.785085 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m00:00:30.785833 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m00:00:30.787927 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m00:00:30.790689 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m00:00:30.793881 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m00:00:30.794409 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m00:00:30.803900 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:30.804534 [debug] [MainThread]: On master: BEGIN
[0m00:00:30.804940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:30.833926 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m00:00:30.834553 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:30.835142 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:30.842351 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:00:30.844096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1289639ee0>]}
[0m00:00:30.844856 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:30.847181 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:30.847756 [debug] [MainThread]: On master: BEGIN
[0m00:00:30.852057 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:30.852580 [debug] [MainThread]: On master: COMMIT
[0m00:00:30.853109 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:30.853540 [debug] [MainThread]: On master: COMMIT
[0m00:00:30.855629 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:00:30.856319 [debug] [MainThread]: On master: Close
[0m00:00:30.860972 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m00:00:30.862067 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m00:00:30.862991 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m00:00:30.863966 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m00:00:30.869069 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m00:00:30.869826 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m00:00:30.868004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m00:00:30.870338 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m00:00:30.867121 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m00:00:30.865197 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m00:00:30.890305 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m00:00:30.888957 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m00:00:30.897465 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m00:00:30.891220 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m00:00:30.870902 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m00:00:30.902215 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m00:00:30.902892 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m00:00:30.909103 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m00:00:30.916628 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m00:00:30.926452 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m00:00:30.924585 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m00:00:30.925218 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m00:00:30.933615 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m00:00:30.955988 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m00:00:31.111764 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:00:31.118636 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:00:31.124075 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:00:31.124930 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp000031004421"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m00:00:31.125976 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:00:31.126721 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp000030999191"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m00:00:31.127397 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp000031010915"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m00:00:31.128103 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:00:31.128865 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp000031043673"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m00:00:31.129526 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:00:31.130175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:31.131032 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:01:45.218919 [debug] [Thread-3  ]: SQL status: SELECT 8940 in 74.089 seconds
[0m00:01:45.244189 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:45.245033 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m00:01:45.247900 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m00:01:45.248569 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:45.249041 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp000030999191'
        
      order by ordinal_position

  
[0m00:01:45.266120 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.016 seconds
[0m00:01:45.275243 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:45.275831 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:01:45.282817 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m00:01:45.294031 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:45.294631 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:01:45.300870 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m00:01:45.318086 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m00:01:45.319500 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:45.320267 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp000030999191"
    )


  
[0m00:01:45.337958 [debug] [Thread-3  ]: SQL status: INSERT 0 8940 in 0.017 seconds
[0m00:01:45.364906 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m00:01:45.365569 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:45.366247 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m00:01:45.379186 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m00:01:45.382093 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m00:01:45.384521 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1288239fa0>]}
[0m00:01:45.385659 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 8940[0m in 74.51s]
[0m00:01:45.386633 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m00:01:56.941635 [debug] [Thread-4  ]: SQL status: SELECT 8940 in 85.810 seconds
[0m00:01:56.947435 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:56.948157 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m00:01:56.951538 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m00:01:56.952162 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:56.952915 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp000031043673'
        
      order by ordinal_position

  
[0m00:01:56.973485 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.020 seconds
[0m00:01:56.979252 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:56.979943 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:01:56.990083 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.009 seconds
[0m00:01:56.996056 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:56.996811 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:01:57.006707 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.009 seconds
[0m00:01:57.009966 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m00:01:57.010954 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:57.011591 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp000031043673"
    )


  
[0m00:01:57.050320 [debug] [Thread-4  ]: SQL status: INSERT 0 8940 in 0.038 seconds
[0m00:01:57.052918 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m00:01:57.053501 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:57.053918 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m00:01:57.070534 [debug] [Thread-4  ]: SQL status: COMMIT in 0.016 seconds
[0m00:01:57.072256 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m00:01:57.073353 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12882262b0>]}
[0m00:01:57.074706 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 8940[0m in 86.18s]
[0m00:01:57.075735 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m00:01:58.413076 [debug] [Thread-2  ]: SQL status: SELECT 8940 in 87.285 seconds
[0m00:01:58.419741 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:58.420398 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m00:01:58.426012 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m00:01:58.426905 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:58.427535 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp000031004421'
        
      order by ordinal_position

  
[0m00:01:58.441131 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m00:01:58.518798 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:58.519667 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:01:58.531097 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m00:01:58.540993 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:58.542211 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:01:58.551082 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m00:01:58.555231 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m00:01:58.556369 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:58.556960 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp000031004421"
    )


  
[0m00:01:58.602673 [debug] [Thread-2  ]: SQL status: INSERT 0 8940 in 0.045 seconds
[0m00:01:58.605061 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m00:01:58.605695 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:58.606150 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m00:01:58.616310 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m00:01:58.619071 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m00:01:58.621080 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1288239dc0>]}
[0m00:01:58.622671 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 8940[0m in 87.73s]
[0m00:01:58.624041 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m00:02:03.564763 [debug] [Thread-1  ]: SQL status: SELECT 8940 in 92.434 seconds
[0m00:02:03.569956 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:02:03.570532 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m00:02:03.575372 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m00:02:03.576306 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:02:03.577024 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp000031010915'
        
      order by ordinal_position

  
[0m00:02:03.588568 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m00:02:03.594601 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:02:03.595591 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:02:03.602530 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m00:02:03.611708 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:02:03.612579 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m00:02:03.618779 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m00:02:03.622213 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m00:02:03.623128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:02:03.623806 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp000031010915"
    )


  
[0m00:02:03.672064 [debug] [Thread-1  ]: SQL status: INSERT 0 8940 in 0.048 seconds
[0m00:02:03.674393 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m00:02:03.675155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:02:03.675860 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m00:02:03.696551 [debug] [Thread-1  ]: SQL status: COMMIT in 0.020 seconds
[0m00:02:03.698407 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m00:02:03.699486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1288239fd0>]}
[0m00:02:03.700566 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 8940[0m in 92.83s]
[0m00:02:03.701442 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m00:02:03.702898 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m00:02:03.703641 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m00:02:03.704516 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m00:02:03.706079 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m00:02:03.706955 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m00:02:03.707831 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m00:02:03.708523 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m00:02:03.709237 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m00:02:03.715498 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m00:02:03.724113 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m00:02:03.725873 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m00:02:03.726501 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m00:02:03.744810 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:02:03.747089 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:02:03.747813 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp000203736861"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m00:02:03.748674 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp000203741257"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m00:02:03.749496 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:02:03.750064 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:03:11.561676 [debug] [Thread-3  ]: SQL status: SELECT 8940 in 67.812 seconds
[0m00:03:11.567406 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:03:11.568135 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m00:03:11.571289 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m00:03:11.572020 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:03:11.572650 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp000203736861'
        
      order by ordinal_position

  
[0m00:03:11.598825 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.025 seconds
[0m00:03:11.606291 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:03:11.607107 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m00:03:11.622111 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.014 seconds
[0m00:03:11.629163 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:03:11.629906 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m00:03:11.649181 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.019 seconds
[0m00:03:11.652658 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m00:03:11.662498 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:03:11.664416 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp000203736861"
    )


  
[0m00:03:11.697938 [debug] [Thread-3  ]: SQL status: INSERT 0 8940 in 0.033 seconds
[0m00:03:11.700539 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m00:03:11.702457 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:03:11.702995 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m00:03:11.720039 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m00:03:11.721874 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m00:03:11.722962 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1288284fa0>]}
[0m00:03:11.726110 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 8940[0m in 68.02s]
[0m00:03:11.727458 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m00:03:23.091138 [debug] [Thread-4  ]: SQL status: SELECT 502 in 79.341 seconds
[0m00:03:23.096693 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:23.097602 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m00:03:23.102223 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m00:03:23.103231 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:23.103718 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp000203741257'
        
      order by ordinal_position

  
[0m00:03:23.116504 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.012 seconds
[0m00:03:23.124988 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:23.125906 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m00:03:23.132620 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m00:03:23.140232 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:23.141490 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m00:03:23.147779 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m00:03:23.151941 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m00:03:23.153139 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:23.153721 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp000203741257"
    )


  
[0m00:03:23.158790 [debug] [Thread-4  ]: SQL status: INSERT 0 502 in 0.004 seconds
[0m00:03:23.161365 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m00:03:23.161930 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:23.162340 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m00:03:23.168940 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m00:03:23.170267 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m00:03:23.171170 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c105e7c4-4278-4813-83fd-2c4847b70cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1288239940>]}
[0m00:03:23.172111 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 502[0m in 79.46s]
[0m00:03:23.172891 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m00:03:23.174992 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:23.175745 [debug] [MainThread]: On master: BEGIN
[0m00:03:23.176628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:23.212910 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m00:03:23.213499 [debug] [MainThread]: On master: COMMIT
[0m00:03:23.213897 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:23.214231 [debug] [MainThread]: On master: COMMIT
[0m00:03:23.216990 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:03:23.217522 [debug] [MainThread]: On master: Close
[0m00:03:23.218286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:23.218734 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m00:03:23.219047 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m00:03:23.219323 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m00:03:23.219871 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m00:03:23.220543 [info ] [MainThread]: 
[0m00:03:23.221023 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 52.63 seconds (172.63s).
[0m00:03:23.223131 [debug] [MainThread]: Command end result
[0m00:03:23.270052 [info ] [MainThread]: 
[0m00:03:23.271586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:23.272751 [info ] [MainThread]: 
[0m00:03:23.273857 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:03:23.276075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 173.67958, "process_user_time": 3.544855, "process_kernel_time": 0.268584, "process_mem_max_rss": "105788", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m00:03:23.276956 [debug] [MainThread]: Command `dbt run` succeeded at 00:03:23.276798 after 173.68 seconds
[0m00:03:23.277509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f128c0f0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12899ba220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1289abb460>]}
[0m00:03:23.278133 [debug] [MainThread]: Flushing usage events
[0m00:03:23.991325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:25.839888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166447eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4167528160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41658c49d0>]}


============================== 01:00:25.846822 | ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a ==============================
[0m01:00:25.846822 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:00:25.847418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:00:26.137418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41687e57c0>]}
[0m01:00:26.248382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4165746790>]}
[0m01:00:26.249994 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:00:26.296675 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:00:26.521029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:26.521662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:26.532100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m01:00:26.592485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41639ffbb0>]}
[0m01:00:26.777608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163a5bc10>]}
[0m01:00:26.778547 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m01:00:26.779482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163be6760>]}
[0m01:00:26.782067 [info ] [MainThread]: 
[0m01:00:26.782899 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m01:00:26.783860 [info ] [MainThread]: 
[0m01:00:26.785052 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:26.793987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m01:00:26.804224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m01:00:26.883891 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m01:00:26.884385 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m01:00:26.886003 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m01:00:26.886429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:26.885400 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m01:00:26.887419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:26.942310 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.056 seconds
[0m01:00:26.945343 [debug] [ThreadPool]: On list_lab08_db: Close
[0m01:00:26.955129 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.067 seconds
[0m01:00:26.959518 [debug] [ThreadPool]: On list_lab08_db: Close
[0m01:00:26.962638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m01:00:26.969586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m01:00:26.973269 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m01:00:26.977357 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m01:00:26.978066 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m01:00:26.978596 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m01:00:26.979095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:26.979666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:27.012589 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m01:00:27.013529 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m01:00:27.014631 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m01:00:27.015589 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m01:00:27.016224 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m01:00:27.017412 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m01:00:27.028741 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m01:00:27.029829 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m01:00:27.032566 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m01:00:27.034868 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m01:00:27.037991 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m01:00:27.038705 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m01:00:27.049849 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:27.050693 [debug] [MainThread]: On master: BEGIN
[0m01:00:27.051301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:27.079740 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m01:00:27.080395 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:27.080941 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:27.087336 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m01:00:27.089670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41671efbb0>]}
[0m01:00:27.090384 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:27.092400 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:27.092924 [debug] [MainThread]: On master: BEGIN
[0m01:00:27.096732 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:00:27.097546 [debug] [MainThread]: On master: COMMIT
[0m01:00:27.098114 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:27.098495 [debug] [MainThread]: On master: COMMIT
[0m01:00:27.100228 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:00:27.100634 [debug] [MainThread]: On master: Close
[0m01:00:27.107015 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m01:00:27.107891 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m01:00:27.109101 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m01:00:27.110282 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m01:00:27.114383 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m01:00:27.112936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m01:00:27.112066 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m01:00:27.111168 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m01:00:27.119141 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m01:00:27.115899 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m01:00:27.118055 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m01:00:27.122111 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m01:00:27.120287 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m01:00:27.121424 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m01:00:27.117083 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m01:00:27.133306 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m01:00:27.148104 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m01:00:27.154825 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m01:00:27.161665 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m01:00:27.168291 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m01:00:27.169691 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m01:00:27.170562 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m01:00:27.171142 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m01:00:27.171995 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m01:00:27.485562 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:00:27.490345 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:00:27.495383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:00:27.496429 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp010027441881"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m01:00:27.498902 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:00:27.499787 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp010027400316"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m01:00:27.500683 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp010027393177"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m01:00:27.501445 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:00:27.502223 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp010027408216"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m01:00:27.503130 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:00:27.504089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:27.505234 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:01:56.753144 [debug] [Thread-3  ]: SQL status: SELECT 8785 in 89.252 seconds
[0m01:01:56.778340 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:56.779032 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m01:01:56.782364 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m01:01:56.783025 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:56.784145 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp010027441881'
        
      order by ordinal_position

  
[0m01:01:56.802201 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.017 seconds
[0m01:01:56.814152 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:56.814779 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:01:56.821857 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m01:01:56.833570 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:56.834213 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:01:56.843051 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.008 seconds
[0m01:01:56.863516 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m01:01:56.864569 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:56.865136 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp010027441881"
    )


  
[0m01:01:56.883675 [debug] [Thread-3  ]: SQL status: INSERT 0 8785 in 0.018 seconds
[0m01:01:56.909439 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m01:01:56.910235 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:56.910745 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m01:01:56.927309 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m01:01:56.930724 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m01:01:56.933462 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4162580880>]}
[0m01:01:56.934517 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 8785[0m in 89.82s]
[0m01:01:56.935302 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m01:02:08.099590 [debug] [Thread-4  ]: SQL status: SELECT 8785 in 100.596 seconds
[0m01:02:08.106749 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:02:08.107455 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m01:02:08.110352 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m01:02:08.110913 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:02:08.111336 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp010027400316'
        
      order by ordinal_position

  
[0m01:02:08.132824 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.021 seconds
[0m01:02:08.209154 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:02:08.209774 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:02:08.220761 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.010 seconds
[0m01:02:08.228280 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:02:08.228964 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:02:08.236430 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m01:02:08.241631 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m01:02:08.242576 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:02:08.243090 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp010027400316"
    )


  
[0m01:02:08.268240 [debug] [Thread-4  ]: SQL status: INSERT 0 8785 in 0.024 seconds
[0m01:02:08.270967 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m01:02:08.271533 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:02:08.271973 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m01:02:08.295173 [debug] [Thread-4  ]: SQL status: COMMIT in 0.023 seconds
[0m01:02:08.296728 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m01:02:08.297703 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163e12490>]}
[0m01:02:08.298606 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 8785[0m in 101.18s]
[0m01:02:08.299550 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m01:02:09.471187 [debug] [Thread-2  ]: SQL status: SELECT 8785 in 101.966 seconds
[0m01:02:09.476288 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:02:09.476905 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m01:02:09.479896 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m01:02:09.480586 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:02:09.481117 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp010027408216'
        
      order by ordinal_position

  
[0m01:02:09.492326 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m01:02:09.498802 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:02:09.499515 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:02:09.505731 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m01:02:09.513073 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:02:09.513870 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:02:09.519952 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.005 seconds
[0m01:02:09.524498 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m01:02:09.525590 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:02:09.526452 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp010027408216"
    )


  
[0m01:02:09.560061 [debug] [Thread-2  ]: SQL status: INSERT 0 8785 in 0.033 seconds
[0m01:02:09.562435 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m01:02:09.562995 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:02:09.563415 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m01:02:09.581236 [debug] [Thread-2  ]: SQL status: COMMIT in 0.017 seconds
[0m01:02:09.582784 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m01:02:09.583885 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41625a0f10>]}
[0m01:02:09.584858 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 8785[0m in 102.47s]
[0m01:02:09.585782 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m01:02:14.371200 [debug] [Thread-1  ]: SQL status: SELECT 8785 in 106.867 seconds
[0m01:02:14.377837 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:14.378436 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m01:02:14.381178 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:02:14.381837 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:14.382446 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp010027393177'
        
      order by ordinal_position

  
[0m01:02:14.397008 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.013 seconds
[0m01:02:14.404753 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:14.405466 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:02:14.417132 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m01:02:14.424426 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:14.425121 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m01:02:14.430909 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m01:02:14.434225 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m01:02:14.435681 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:14.436752 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp010027393177"
    )


  
[0m01:02:14.499858 [debug] [Thread-1  ]: SQL status: INSERT 0 8785 in 0.062 seconds
[0m01:02:14.502969 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m01:02:14.503529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:14.503981 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m01:02:14.516082 [debug] [Thread-1  ]: SQL status: COMMIT in 0.011 seconds
[0m01:02:14.517357 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m01:02:14.518262 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41624d73a0>]}
[0m01:02:14.519141 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 8785[0m in 107.41s]
[0m01:02:14.519866 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m01:02:14.521166 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m01:02:14.521766 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m01:02:14.522588 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m01:02:14.525043 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m01:02:14.525498 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m01:02:14.524187 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m01:02:14.532034 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m01:02:14.532975 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m01:02:14.533848 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m01:02:14.534433 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m01:02:14.542564 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m01:02:14.550518 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:02:14.551804 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp010214547595"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m01:02:14.553504 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m01:02:14.554341 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:02:14.562222 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:02:14.563464 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp010214558913"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m01:02:14.564063 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:03:16.530239 [debug] [Thread-3  ]: SQL status: SELECT 8785 in 61.976 seconds
[0m01:03:16.536508 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:03:16.537197 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m01:03:16.541289 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m01:03:16.541943 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:03:16.542440 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp010214547595'
        
      order by ordinal_position

  
[0m01:03:16.563829 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.021 seconds
[0m01:03:16.570921 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:03:16.571803 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m01:03:16.578347 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m01:03:16.584540 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:03:16.585173 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m01:03:16.592411 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m01:03:16.595682 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m01:03:16.596599 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:03:16.597455 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp010214547595"
    )


  
[0m01:03:16.610657 [debug] [Thread-3  ]: SQL status: INSERT 0 8785 in 0.013 seconds
[0m01:03:16.612962 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m01:03:16.613700 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:03:16.614295 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m01:03:16.626206 [debug] [Thread-3  ]: SQL status: COMMIT in 0.011 seconds
[0m01:03:16.628118 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m01:03:16.629324 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163ddc340>]}
[0m01:03:16.630744 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 8785[0m in 62.10s]
[0m01:03:16.631518 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m01:03:25.239311 [debug] [Thread-4  ]: SQL status: SELECT 531 in 70.675 seconds
[0m01:03:25.244187 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:25.244754 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m01:03:25.248692 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m01:03:25.249283 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:25.249772 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp010214558913'
        
      order by ordinal_position

  
[0m01:03:25.261312 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.011 seconds
[0m01:03:25.267180 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:25.267751 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m01:03:25.279892 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.011 seconds
[0m01:03:25.286719 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:25.289104 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m01:03:25.296306 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m01:03:25.302997 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m01:03:25.304236 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:25.304769 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp010214558913"
    )


  
[0m01:03:25.318977 [debug] [Thread-4  ]: SQL status: INSERT 0 531 in 0.014 seconds
[0m01:03:25.322430 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m01:03:25.323019 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:25.323802 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m01:03:25.327536 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m01:03:25.329662 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m01:03:25.330877 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed17dbe9-4e03-4dc8-810e-e1c9286e8a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416265f8e0>]}
[0m01:03:25.331872 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 531[0m in 70.80s]
[0m01:03:25.334012 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m01:03:25.337871 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:25.338434 [debug] [MainThread]: On master: BEGIN
[0m01:03:25.338904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:03:25.375167 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m01:03:25.375818 [debug] [MainThread]: On master: COMMIT
[0m01:03:25.376193 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:25.376572 [debug] [MainThread]: On master: COMMIT
[0m01:03:25.378649 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:03:25.379065 [debug] [MainThread]: On master: Close
[0m01:03:25.379694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:25.380244 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m01:03:25.380923 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m01:03:25.381403 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m01:03:25.382128 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m01:03:25.382775 [info ] [MainThread]: 
[0m01:03:25.383349 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 58.60 seconds (178.60s).
[0m01:03:25.385632 [debug] [MainThread]: Command end result
[0m01:03:25.437625 [info ] [MainThread]: 
[0m01:03:25.438343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:03:25.439206 [info ] [MainThread]: 
[0m01:03:25.439620 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:03:25.441379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 179.6885, "process_user_time": 3.860209, "process_kernel_time": 0.218105, "process_mem_max_rss": "105812", "process_out_blocks": "2112", "process_in_blocks": "0"}
[0m01:03:25.442176 [debug] [MainThread]: Command `dbt run` succeeded at 01:03:25.442041 after 179.69 seconds
[0m01:03:25.442638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166447eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4166248190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41639b92e0>]}
[0m01:03:25.443089 [debug] [MainThread]: Flushing usage events
[0m01:03:26.062900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:22.885966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd66121e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd67201130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd6540f5b0>]}


============================== 02:00:22.892452 | 05ac03e0-7958-449a-9254-fefe57f8447e ==============================
[0m02:00:22.892452 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m02:00:22.893371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:00:23.156003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd63a48bb0>]}
[0m02:00:23.266795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd65414670>]}
[0m02:00:23.268157 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:00:23.293338 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m02:00:23.520447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:23.521094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:23.530801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m02:00:23.592746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd63705b80>]}
[0m02:00:23.771617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd636f3be0>]}
[0m02:00:23.772521 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m02:00:23.773239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd638fedf0>]}
[0m02:00:23.776226 [info ] [MainThread]: 
[0m02:00:23.776811 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m02:00:23.777230 [info ] [MainThread]: 
[0m02:00:23.777864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:23.785467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m02:00:23.794942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m02:00:23.855671 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m02:00:23.856477 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m02:00:23.857210 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:23.858110 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:23.858704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:23.859289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:23.892476 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.033 seconds
[0m02:00:23.893368 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.035 seconds
[0m02:00:23.895791 [debug] [ThreadPool]: On list_lab08_db: Close
[0m02:00:23.898711 [debug] [ThreadPool]: On list_lab08_db: Close
[0m02:00:23.902440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m02:00:23.909854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m02:00:23.920282 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m02:00:23.921899 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m02:00:23.915545 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m02:00:23.922430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:23.923021 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m02:00:23.924051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:23.961059 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m02:00:23.961938 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m02:00:23.963244 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m02:00:23.963861 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m02:00:23.964368 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m02:00:23.965142 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m02:00:23.973898 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m02:00:23.975954 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m02:00:23.976747 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m02:00:23.979012 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m02:00:23.980040 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m02:00:23.984134 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m02:00:23.997183 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:23.998449 [debug] [MainThread]: On master: BEGIN
[0m02:00:23.999123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:24.029000 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m02:00:24.029986 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:24.030789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:24.038511 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m02:00:24.040432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd626134f0>]}
[0m02:00:24.041337 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:24.043544 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:24.044010 [debug] [MainThread]: On master: BEGIN
[0m02:00:24.047320 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:00:24.047988 [debug] [MainThread]: On master: COMMIT
[0m02:00:24.048492 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:24.048874 [debug] [MainThread]: On master: COMMIT
[0m02:00:24.051199 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:00:24.051747 [debug] [MainThread]: On master: Close
[0m02:00:24.055677 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m02:00:24.056454 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m02:00:24.057313 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m02:00:24.059361 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m02:00:24.058132 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m02:00:24.063322 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m02:00:24.065254 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m02:00:24.060266 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m02:00:24.061293 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m02:00:24.062495 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m02:00:24.079651 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m02:00:24.097099 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m02:00:24.098301 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m02:00:24.099516 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m02:00:24.100352 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m02:00:24.101210 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m02:00:24.102224 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m02:00:24.102849 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m02:00:24.109014 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m02:00:24.115837 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m02:00:24.124624 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m02:00:24.147553 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m02:00:24.153669 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m02:00:24.162942 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m02:00:24.307999 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:00:24.320059 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:00:24.322724 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp020024202694"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m02:00:24.320805 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp020024214600"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m02:00:24.323610 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:00:24.323180 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:00:24.322145 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:00:24.324961 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp020024209357"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m02:00:24.325433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:00:24.330456 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:00:24.332232 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp020024327142"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m02:00:24.332932 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:01:34.776535 [debug] [Thread-3  ]: SQL status: SELECT 5783 in 70.453 seconds
[0m02:01:34.802495 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:34.803256 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m02:01:34.806116 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m02:01:34.806883 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:34.807558 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp020024202694'
        
      order by ordinal_position

  
[0m02:01:34.822441 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.014 seconds
[0m02:01:34.833627 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:34.834247 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:34.840765 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m02:01:34.853395 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:34.854284 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:34.860443 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m02:01:34.881396 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m02:01:34.882371 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:34.882938 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp020024202694"
    )


  
[0m02:01:34.895202 [debug] [Thread-3  ]: SQL status: INSERT 0 5783 in 0.012 seconds
[0m02:01:34.925269 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m02:01:34.925967 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:34.927048 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m02:01:34.939696 [debug] [Thread-3  ]: SQL status: COMMIT in 0.011 seconds
[0m02:01:34.943264 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m02:01:34.946941 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd6226d520>]}
[0m02:01:34.947927 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 5783[0m in 70.85s]
[0m02:01:34.949234 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m02:01:45.058346 [debug] [Thread-4  ]: SQL status: SELECT 5783 in 80.735 seconds
[0m02:01:45.063949 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:45.064549 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m02:01:45.067256 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m02:01:45.067822 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:45.068341 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp020024214600'
        
      order by ordinal_position

  
[0m02:01:45.080798 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m02:01:45.086590 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:45.087285 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:45.093517 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m02:01:45.099057 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:45.099832 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:45.106230 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m02:01:45.109332 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m02:01:45.110372 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:45.110893 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp020024214600"
    )


  
[0m02:01:45.123232 [debug] [Thread-4  ]: SQL status: INSERT 0 5783 in 0.012 seconds
[0m02:01:45.126049 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m02:01:45.126587 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:45.127097 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m02:01:45.140414 [debug] [Thread-4  ]: SQL status: COMMIT in 0.013 seconds
[0m02:01:45.142090 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m02:01:45.143203 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd6225a070>]}
[0m02:01:45.144060 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 5783[0m in 81.04s]
[0m02:01:45.145012 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m02:01:46.092924 [debug] [Thread-2  ]: SQL status: SELECT 5783 in 81.760 seconds
[0m02:01:46.101930 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:46.109142 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m02:01:46.113093 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m02:01:46.114181 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:46.114886 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp020024327142'
        
      order by ordinal_position

  
[0m02:01:46.136680 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.020 seconds
[0m02:01:46.229509 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:46.230418 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:46.238957 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m02:01:46.246488 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:46.247213 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:46.253999 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m02:01:46.259427 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m02:01:46.260386 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:46.260960 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp020024327142"
    )


  
[0m02:01:46.275082 [debug] [Thread-2  ]: SQL status: INSERT 0 5783 in 0.012 seconds
[0m02:01:46.279672 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m02:01:46.280544 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:46.281292 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m02:01:46.293528 [debug] [Thread-2  ]: SQL status: COMMIT in 0.012 seconds
[0m02:01:46.295413 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m02:01:46.296485 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd6226dd90>]}
[0m02:01:46.297731 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 5783[0m in 82.22s]
[0m02:01:46.298637 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m02:01:48.870762 [debug] [Thread-1  ]: SQL status: SELECT 5783 in 84.545 seconds
[0m02:01:48.877036 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:48.878310 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m02:01:48.881713 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m02:01:48.882588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:48.883354 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp020024209357'
        
      order by ordinal_position

  
[0m02:01:48.904264 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.020 seconds
[0m02:01:48.911090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:48.911935 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:48.918773 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m02:01:48.925292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:48.926215 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m02:01:48.932584 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m02:01:48.936268 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m02:01:48.937587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:48.938294 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp020024209357"
    )


  
[0m02:01:48.970679 [debug] [Thread-1  ]: SQL status: INSERT 0 5783 in 0.031 seconds
[0m02:01:48.973716 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m02:01:48.974466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:48.975012 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m02:01:48.986865 [debug] [Thread-1  ]: SQL status: COMMIT in 0.011 seconds
[0m02:01:48.988505 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m02:01:48.989858 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd6226dd00>]}
[0m02:01:48.990985 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 5783[0m in 84.93s]
[0m02:01:48.992305 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m02:01:48.993880 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m02:01:48.995566 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m02:01:48.994729 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m02:01:48.997755 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m02:01:48.998795 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m02:01:48.999340 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m02:01:48.996846 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m02:01:49.006285 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m02:01:49.007530 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m02:01:49.015888 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m02:01:49.017030 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m02:01:49.027359 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:01:49.028211 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m02:01:49.029069 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp020149023539"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m02:01:49.037383 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m02:01:49.044483 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:01:49.045517 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp020149038356"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m02:01:49.046084 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:02:43.532387 [debug] [Thread-3  ]: SQL status: SELECT 5783 in 54.486 seconds
[0m02:02:43.537911 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:43.538504 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m02:02:43.541167 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m02:02:43.541692 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:43.542120 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp020149038356'
        
      order by ordinal_position

  
[0m02:02:43.556838 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.014 seconds
[0m02:02:43.562378 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:43.563004 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m02:02:43.571277 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.008 seconds
[0m02:02:43.576807 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:43.577699 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m02:02:43.588635 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m02:02:43.591764 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m02:02:43.592733 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:43.593279 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp020149038356"
    )


  
[0m02:02:43.611816 [debug] [Thread-3  ]: SQL status: INSERT 0 5783 in 0.018 seconds
[0m02:02:43.614464 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m02:02:43.615106 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:43.615535 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m02:02:43.623698 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m02:02:43.625176 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m02:02:43.626170 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd60103cd0>]}
[0m02:02:43.627141 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 5783[0m in 54.63s]
[0m02:02:43.628034 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m02:02:53.932619 [debug] [Thread-4  ]: SQL status: SELECT 337 in 64.895 seconds
[0m02:02:53.937639 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:02:53.938325 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m02:02:53.941365 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m02:02:53.942015 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:02:53.942756 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp020149023539'
        
      order by ordinal_position

  
[0m02:02:53.954560 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.011 seconds
[0m02:02:53.962502 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:02:53.963182 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m02:02:53.970075 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m02:02:53.975827 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:02:53.976594 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m02:02:53.983338 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m02:02:53.987386 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m02:02:53.988471 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:02:53.989108 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp020149023539"
    )


  
[0m02:02:53.997961 [debug] [Thread-4  ]: SQL status: INSERT 0 337 in 0.008 seconds
[0m02:02:54.000695 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m02:02:54.001628 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:02:54.002211 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m02:02:54.008314 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m02:02:54.010171 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m02:02:54.011262 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ac03e0-7958-449a-9254-fefe57f8447e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd6226d910>]}
[0m02:02:54.012343 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 337[0m in 65.01s]
[0m02:02:54.013837 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m02:02:54.020035 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:54.020521 [debug] [MainThread]: On master: BEGIN
[0m02:02:54.020898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:02:54.060385 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m02:02:54.061095 [debug] [MainThread]: On master: COMMIT
[0m02:02:54.061577 [debug] [MainThread]: Using postgres connection "master"
[0m02:02:54.061992 [debug] [MainThread]: On master: COMMIT
[0m02:02:54.064296 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:02:54.064831 [debug] [MainThread]: On master: Close
[0m02:02:54.065635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:02:54.066079 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m02:02:54.066473 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m02:02:54.066955 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m02:02:54.067438 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m02:02:54.067979 [info ] [MainThread]: 
[0m02:02:54.068746 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 30.29 seconds (150.29s).
[0m02:02:54.070793 [debug] [MainThread]: Command end result
[0m02:02:54.130999 [info ] [MainThread]: 
[0m02:02:54.131935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:02:54.132761 [info ] [MainThread]: 
[0m02:02:54.133706 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:02:54.135583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 151.34772, "process_user_time": 3.714093, "process_kernel_time": 0.290377, "process_mem_max_rss": "105752", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m02:02:54.136305 [debug] [MainThread]: Command `dbt run` succeeded at 02:02:54.136164 after 151.35 seconds
[0m02:02:54.137055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd66121e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd658ebc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd63a62bb0>]}
[0m02:02:54.137859 [debug] [MainThread]: Flushing usage events
[0m02:02:54.784895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:16.324833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29c08ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29be589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29b898a00>]}


============================== 03:00:16.332458 | 84fc3092-d616-41ab-8afc-ccc90d383f46 ==============================
[0m03:00:16.332458 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m03:00:16.333220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:00:16.604229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2999b7c70>]}
[0m03:00:16.700418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29b9b5f70>]}
[0m03:00:16.701673 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:00:16.724774 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m03:00:16.934822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:16.935572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:16.946013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m03:00:17.012422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2996b2bb0>]}
[0m03:00:17.194563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc299660be0>]}
[0m03:00:17.195322 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m03:00:17.195750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29989ffd0>]}
[0m03:00:17.198460 [info ] [MainThread]: 
[0m03:00:17.199241 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m03:00:17.199810 [info ] [MainThread]: 
[0m03:00:17.201239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:17.209358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m03:00:17.219427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m03:00:17.287708 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m03:00:17.288643 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m03:00:17.289424 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m03:00:17.290461 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m03:00:17.291245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:17.291874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:17.334435 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.043 seconds
[0m03:00:17.337192 [debug] [ThreadPool]: On list_lab08_db: Close
[0m03:00:17.337787 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.046 seconds
[0m03:00:17.340069 [debug] [ThreadPool]: On list_lab08_db: Close
[0m03:00:17.343555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m03:00:17.356654 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m03:00:17.357352 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m03:00:17.358267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m03:00:17.358786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:17.363225 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m03:00:17.364199 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m03:00:17.364593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:17.397424 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m03:00:17.398112 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m03:00:17.399295 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m03:00:17.400071 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m03:00:17.400677 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m03:00:17.401426 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m03:00:17.409869 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m03:00:17.412473 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m03:00:17.415132 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m03:00:17.417481 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m03:00:17.420630 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m03:00:17.421605 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m03:00:17.432423 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:17.433015 [debug] [MainThread]: On master: BEGIN
[0m03:00:17.433426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:17.461732 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m03:00:17.462611 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:17.463275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:17.469920 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m03:00:17.471754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2995c73a0>]}
[0m03:00:17.472679 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:17.478587 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:17.479222 [debug] [MainThread]: On master: BEGIN
[0m03:00:17.482774 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m03:00:17.483480 [debug] [MainThread]: On master: COMMIT
[0m03:00:17.483892 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:17.484281 [debug] [MainThread]: On master: COMMIT
[0m03:00:17.486135 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:00:17.486625 [debug] [MainThread]: On master: Close
[0m03:00:17.490742 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m03:00:17.491424 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m03:00:17.494858 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m03:00:17.495607 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m03:00:17.493546 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m03:00:17.496144 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m03:00:17.492644 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m03:00:17.502761 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m03:00:17.496813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m03:00:17.492041 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m03:00:17.503646 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m03:00:17.504280 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m03:00:17.515786 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m03:00:17.525539 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m03:00:17.526368 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m03:00:17.532693 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m03:00:17.533776 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m03:00:17.544146 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m03:00:17.543068 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m03:00:17.545405 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m03:00:17.551815 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m03:00:17.552736 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m03:00:17.575529 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m03:00:17.709857 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m03:00:17.812844 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:00:17.819316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:00:17.821740 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:00:17.824181 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:00:17.824939 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp030017762100"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m03:00:17.825828 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp030017678199"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m03:00:17.826617 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp030017685242"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m03:00:17.827493 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp030017711259"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m03:00:17.828169 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:00:17.829013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:00:17.829727 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:00:17.830806 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:01:26.570132 [debug] [Thread-3  ]: SQL status: SELECT 3384 in 68.742 seconds
[0m03:01:26.593230 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:26.593908 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m03:01:26.597427 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m03:01:26.597895 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:26.598429 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp030017762100'
        
      order by ordinal_position

  
[0m03:01:26.633192 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.034 seconds
[0m03:01:26.643551 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:26.644259 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:26.659663 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.015 seconds
[0m03:01:26.671933 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:26.672674 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:26.690792 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.017 seconds
[0m03:01:26.709441 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m03:01:26.710327 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:26.710805 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp030017762100"
    )


  
[0m03:01:26.730438 [debug] [Thread-3  ]: SQL status: INSERT 0 3384 in 0.019 seconds
[0m03:01:26.755156 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m03:01:26.755704 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:26.756085 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m03:01:26.764123 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m03:01:26.767424 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m03:01:26.770224 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29811bd60>]}
[0m03:01:26.771173 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 3384[0m in 69.24s]
[0m03:01:26.772077 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m03:01:34.429877 [debug] [Thread-2  ]: SQL status: SELECT 3384 in 76.599 seconds
[0m03:01:34.436800 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:34.437689 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m03:01:34.440888 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m03:01:34.441432 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:34.442099 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp030017711259'
        
      order by ordinal_position

  
[0m03:01:34.454365 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m03:01:34.460319 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:34.460948 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:34.469098 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m03:01:34.476775 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:34.477492 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:34.485635 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m03:01:34.577695 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m03:01:34.579817 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:34.580762 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp030017711259"
    )


  
[0m03:01:34.589056 [debug] [Thread-2  ]: SQL status: INSERT 0 3384 in 0.007 seconds
[0m03:01:34.591685 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m03:01:34.592309 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:34.592760 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m03:01:34.601372 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m03:01:34.602787 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m03:01:34.603783 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2997a0fa0>]}
[0m03:01:34.604698 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 3384[0m in 77.11s]
[0m03:01:34.605730 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m03:01:35.806358 [debug] [Thread-4  ]: SQL status: SELECT 3384 in 77.977 seconds
[0m03:01:35.811924 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:35.812696 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m03:01:35.815685 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m03:01:35.816305 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:35.816894 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp030017685242'
        
      order by ordinal_position

  
[0m03:01:35.832274 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.015 seconds
[0m03:01:35.838289 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:35.839085 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:35.845370 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m03:01:35.851018 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:35.851707 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:35.857797 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.005 seconds
[0m03:01:35.861458 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m03:01:35.862299 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:35.862760 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp030017685242"
    )


  
[0m03:01:35.872331 [debug] [Thread-4  ]: SQL status: INSERT 0 3384 in 0.009 seconds
[0m03:01:35.875305 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m03:01:35.875820 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:35.876398 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m03:01:35.885576 [debug] [Thread-4  ]: SQL status: COMMIT in 0.009 seconds
[0m03:01:35.887175 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m03:01:35.888150 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2981ccd90>]}
[0m03:01:35.889078 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 3384[0m in 78.38s]
[0m03:01:35.889863 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m03:01:38.135783 [debug] [Thread-1  ]: SQL status: SELECT 3384 in 80.307 seconds
[0m03:01:38.140992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:38.141553 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m03:01:38.144532 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m03:01:38.145241 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:38.145701 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp030017678199'
        
      order by ordinal_position

  
[0m03:01:38.157819 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m03:01:38.163872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:38.164513 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:38.170467 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m03:01:38.176281 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:38.176907 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m03:01:38.182848 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m03:01:38.185898 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m03:01:38.187097 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:38.187935 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp030017678199"
    )


  
[0m03:01:38.209493 [debug] [Thread-1  ]: SQL status: INSERT 0 3384 in 0.021 seconds
[0m03:01:38.211898 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m03:01:38.212504 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:38.213030 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m03:01:38.223465 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m03:01:38.226927 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m03:01:38.227932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2981ded30>]}
[0m03:01:38.229223 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 3384[0m in 80.73s]
[0m03:01:38.231583 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m03:01:38.233312 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m03:01:38.233997 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m03:01:38.234875 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m03:01:38.237324 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m03:01:38.236319 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m03:01:38.239243 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m03:01:38.239692 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m03:01:38.238234 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m03:01:38.257744 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m03:01:38.260394 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m03:01:38.261743 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m03:01:38.267524 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m03:01:38.274527 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:01:38.277120 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:01:38.278500 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp030138265723"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m03:01:38.279429 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp030138271816"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m03:01:38.280061 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:01:38.280558 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:02:30.112897 [debug] [Thread-3  ]: SQL status: SELECT 3384 in 51.832 seconds
[0m03:02:30.118669 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:30.119273 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m03:02:30.122802 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m03:02:30.123373 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:30.123852 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp030138271816'
        
      order by ordinal_position

  
[0m03:02:30.141305 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.017 seconds
[0m03:02:30.147019 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:30.147841 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m03:02:30.155097 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m03:02:30.161157 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:30.161900 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m03:02:30.168231 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m03:02:30.171338 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m03:02:30.172151 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:30.172632 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp030138271816"
    )


  
[0m03:02:30.183810 [debug] [Thread-3  ]: SQL status: INSERT 0 3384 in 0.010 seconds
[0m03:02:30.185906 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m03:02:30.186449 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:30.186883 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m03:02:30.196632 [debug] [Thread-3  ]: SQL status: COMMIT in 0.009 seconds
[0m03:02:30.198077 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m03:02:30.198977 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29812c1c0>]}
[0m03:02:30.199879 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 3384[0m in 51.96s]
[0m03:02:30.200770 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m03:02:41.657641 [debug] [Thread-2  ]: SQL status: SELECT 189 in 63.378 seconds
[0m03:02:41.664174 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:41.664745 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m03:02:41.667558 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m03:02:41.668240 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:41.668752 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp030138265723'
        
      order by ordinal_position

  
[0m03:02:41.683593 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.014 seconds
[0m03:02:41.690221 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:41.691049 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m03:02:41.697398 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m03:02:41.703018 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:41.703608 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m03:02:41.709449 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.005 seconds
[0m03:02:41.713287 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m03:02:41.714222 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:41.717001 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp030138265723"
    )


  
[0m03:02:41.724581 [debug] [Thread-2  ]: SQL status: INSERT 0 189 in 0.007 seconds
[0m03:02:41.726649 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m03:02:41.727190 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:41.727681 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m03:02:41.734082 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m03:02:41.735638 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m03:02:41.736556 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84fc3092-d616-41ab-8afc-ccc90d383f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2981de940>]}
[0m03:02:41.737497 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 189[0m in 63.50s]
[0m03:02:41.738287 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m03:02:41.739948 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:41.740334 [debug] [MainThread]: On master: BEGIN
[0m03:02:41.740891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:02:41.769436 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m03:02:41.770105 [debug] [MainThread]: On master: COMMIT
[0m03:02:41.770631 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:41.771207 [debug] [MainThread]: On master: COMMIT
[0m03:02:41.773448 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m03:02:41.773990 [debug] [MainThread]: On master: Close
[0m03:02:41.774785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:02:41.775392 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m03:02:41.775755 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m03:02:41.776260 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m03:02:41.776674 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m03:02:41.777239 [info ] [MainThread]: 
[0m03:02:41.777801 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 24.58 seconds (144.58s).
[0m03:02:41.780634 [debug] [MainThread]: Command end result
[0m03:02:41.836148 [info ] [MainThread]: 
[0m03:02:41.836957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:02:41.837585 [info ] [MainThread]: 
[0m03:02:41.838842 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m03:02:41.840647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.61569, "process_user_time": 3.880135, "process_kernel_time": 0.239314, "process_mem_max_rss": "106252", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m03:02:41.841581 [debug] [MainThread]: Command `dbt run` succeeded at 03:02:41.841431 after 145.62 seconds
[0m03:02:41.842132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29c08ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29b9b5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2995ff280>]}
[0m03:02:41.842680 [debug] [MainThread]: Flushing usage events
[0m03:02:42.498194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:00:15.493727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdd752e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdd51d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdcf5ca00>]}


============================== 04:00:15.502409 | ebb34756-5d2b-4c2e-b48a-ffb0006effed ==============================
[0m04:00:15.502409 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m04:00:15.503120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:00:15.812641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdb07ac70>]}
[0m04:00:15.941307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdd07cf70>]}
[0m04:00:15.942774 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:00:15.971143 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m04:00:16.261294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:00:16.261928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:00:16.274890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m04:00:16.354198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdacf4bb0>]}
[0m04:00:16.539516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdad65bb0>]}
[0m04:00:16.540540 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m04:00:16.541267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdaef0fd0>]}
[0m04:00:16.543966 [info ] [MainThread]: 
[0m04:00:16.544450 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m04:00:16.545063 [info ] [MainThread]: 
[0m04:00:16.546016 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:00:16.556591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m04:00:16.567212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m04:00:16.645775 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m04:00:16.646515 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m04:00:16.647091 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m04:00:16.647749 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m04:00:16.648262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:16.648815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:16.680667 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.032 seconds
[0m04:00:16.683519 [debug] [ThreadPool]: On list_lab08_db: Close
[0m04:00:16.685454 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.037 seconds
[0m04:00:16.687604 [debug] [ThreadPool]: On list_lab08_db: Close
[0m04:00:16.692692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m04:00:16.702329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m04:00:16.707104 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m04:00:16.713188 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m04:00:16.713892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:16.716177 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m04:00:16.717938 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m04:00:16.718422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:16.752387 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m04:00:16.753335 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m04:00:16.754048 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m04:00:16.754902 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m04:00:16.755614 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m04:00:16.756163 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m04:00:16.766359 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m04:00:16.768833 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m04:00:16.769631 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m04:00:16.771599 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m04:00:16.772452 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m04:00:16.774783 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m04:00:16.785133 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:16.785708 [debug] [MainThread]: On master: BEGIN
[0m04:00:16.786038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:00:16.823127 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m04:00:16.823788 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:16.824436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:00:16.832085 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m04:00:16.834065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd9c5a0a0>]}
[0m04:00:16.834949 [debug] [MainThread]: On master: ROLLBACK
[0m04:00:16.838284 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:16.839076 [debug] [MainThread]: On master: BEGIN
[0m04:00:16.844170 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m04:00:16.845102 [debug] [MainThread]: On master: COMMIT
[0m04:00:16.845499 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:16.845829 [debug] [MainThread]: On master: COMMIT
[0m04:00:16.848858 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m04:00:16.849450 [debug] [MainThread]: On master: Close
[0m04:00:16.857085 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m04:00:16.858059 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m04:00:16.859248 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m04:00:16.859964 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m04:00:16.860884 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m04:00:16.865427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m04:00:16.866423 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m04:00:16.861704 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m04:00:16.883326 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m04:00:16.862758 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m04:00:16.894126 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m04:00:16.889321 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m04:00:16.892979 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m04:00:16.894668 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m04:00:16.863611 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m04:00:16.916075 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m04:00:16.916674 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m04:00:16.903409 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m04:00:16.928970 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m04:00:16.927793 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m04:00:16.940027 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m04:00:16.937385 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m04:00:16.925381 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m04:00:16.964782 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m04:00:17.273193 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:00:17.278017 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:00:17.284304 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp040017158663"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m04:00:17.283637 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:00:17.288508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:00:17.289156 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp040017149391"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m04:00:17.289827 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m04:00:17.290739 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp040017138114"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m04:00:17.292014 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp040017176132"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m04:00:17.294335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:00:17.293749 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:00:17.292312 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:01:22.497545 [debug] [Thread-3  ]: SQL status: SELECT 3392 in 65.204 seconds
[0m04:01:22.523329 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:22.524054 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m04:01:22.531377 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m04:01:22.532220 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:22.532952 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp040017138114'
        
      order by ordinal_position

  
[0m04:01:22.551008 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.017 seconds
[0m04:01:22.559494 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:22.560157 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:22.567524 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m04:01:22.578924 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:22.579499 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:22.585831 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m04:01:22.606909 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m04:01:22.608036 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:22.608598 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp040017138114"
    )


  
[0m04:01:22.620279 [debug] [Thread-3  ]: SQL status: INSERT 0 3392 in 0.011 seconds
[0m04:01:22.648480 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m04:01:22.649291 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:22.649911 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m04:01:22.658392 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m04:01:22.662202 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m04:01:22.664813 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd98afe50>]}
[0m04:01:22.665905 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 3392[0m in 65.77s]
[0m04:01:22.666713 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m04:01:31.545472 [debug] [Thread-2  ]: SQL status: SELECT 3392 in 74.255 seconds
[0m04:01:31.554510 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:31.555295 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m04:01:31.558359 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m04:01:31.559432 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:31.560225 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp040017158663'
        
      order by ordinal_position

  
[0m04:01:31.578955 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.018 seconds
[0m04:01:31.674158 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:31.675124 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:31.682351 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m04:01:31.689289 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:31.689975 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:31.696373 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.005 seconds
[0m04:01:31.700240 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m04:01:31.701403 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:31.701961 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp040017158663"
    )


  
[0m04:01:31.711166 [debug] [Thread-2  ]: SQL status: INSERT 0 3392 in 0.009 seconds
[0m04:01:31.713813 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m04:01:31.714545 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:31.717995 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m04:01:31.727811 [debug] [Thread-2  ]: SQL status: COMMIT in 0.009 seconds
[0m04:01:31.729593 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m04:01:31.730473 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd98afdc0>]}
[0m04:01:31.731411 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 3392[0m in 74.85s]
[0m04:01:31.732132 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m04:01:35.488377 [debug] [Thread-4  ]: SQL status: SELECT 3392 in 78.196 seconds
[0m04:01:35.493827 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:35.494797 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m04:01:35.497640 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m04:01:35.498257 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:35.498772 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp040017149391'
        
      order by ordinal_position

  
[0m04:01:35.520102 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.021 seconds
[0m04:01:35.525664 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:35.526578 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:35.534948 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m04:01:35.540834 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:35.541487 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:35.549422 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m04:01:35.552939 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m04:01:35.554089 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:35.554634 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp040017149391"
    )


  
[0m04:01:35.563607 [debug] [Thread-4  ]: SQL status: INSERT 0 3392 in 0.008 seconds
[0m04:01:35.566657 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m04:01:35.567461 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:35.568256 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m04:01:35.576976 [debug] [Thread-4  ]: SQL status: COMMIT in 0.008 seconds
[0m04:01:35.579597 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m04:01:35.580887 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd9898220>]}
[0m04:01:35.582145 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 3392[0m in 78.67s]
[0m04:01:35.583873 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m04:01:36.317310 [debug] [Thread-1  ]: SQL status: SELECT 3392 in 79.023 seconds
[0m04:01:36.324164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:36.324815 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m04:01:36.327763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m04:01:36.328512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:36.329141 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp040017176132'
        
      order by ordinal_position

  
[0m04:01:36.341991 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m04:01:36.348107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:36.349393 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:36.357107 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m04:01:36.367785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:36.368483 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m04:01:36.375064 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m04:01:36.378694 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m04:01:36.379640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:36.380488 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp040017176132"
    )


  
[0m04:01:36.411584 [debug] [Thread-1  ]: SQL status: INSERT 0 3392 in 0.030 seconds
[0m04:01:36.414640 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m04:01:36.415702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:36.416692 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m04:01:36.431770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.014 seconds
[0m04:01:36.434077 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m04:01:36.435980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd97d0220>]}
[0m04:01:36.437513 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 3392[0m in 79.57s]
[0m04:01:36.438783 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m04:01:36.440125 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m04:01:36.441316 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m04:01:36.442277 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m04:01:36.443908 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m04:01:36.450202 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m04:01:36.454933 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m04:01:36.456442 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m04:01:36.457485 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m04:01:36.470808 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m04:01:36.472063 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m04:01:36.484187 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m04:01:36.497199 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m04:01:36.495813 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:01:36.507557 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp040136492245"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m04:01:36.508505 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m04:01:36.509667 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:01:36.510750 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp040136503420"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m04:01:36.511721 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m04:02:29.077208 [debug] [Thread-3  ]: SQL status: SELECT 3392 in 52.569 seconds
[0m04:02:29.083115 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:29.083960 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m04:02:29.087112 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m04:02:29.087660 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:29.088101 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp040136492245'
        
      order by ordinal_position

  
[0m04:02:29.101097 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.012 seconds
[0m04:02:29.110614 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:29.111657 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m04:02:29.118532 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m04:02:29.124286 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:29.124964 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m04:02:29.131476 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m04:02:29.134650 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m04:02:29.135517 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:29.136055 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp040136492245"
    )


  
[0m04:02:29.144470 [debug] [Thread-3  ]: SQL status: INSERT 0 3392 in 0.008 seconds
[0m04:02:29.147094 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m04:02:29.147654 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:29.148406 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m04:02:29.157569 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m04:02:29.159952 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m04:02:29.161761 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdca9cdc0>]}
[0m04:02:29.163180 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 3392[0m in 52.72s]
[0m04:02:29.164316 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m04:02:40.053540 [debug] [Thread-2  ]: SQL status: SELECT 190 in 63.542 seconds
[0m04:02:40.058914 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:02:40.059872 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m04:02:40.063886 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m04:02:40.064471 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:02:40.065167 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp040136503420'
        
      order by ordinal_position

  
[0m04:02:40.077562 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.012 seconds
[0m04:02:40.084827 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:02:40.085740 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m04:02:40.092543 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m04:02:40.102125 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:02:40.103023 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m04:02:40.109311 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m04:02:40.113929 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m04:02:40.115071 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:02:40.115803 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp040136503420"
    )


  
[0m04:02:40.119300 [debug] [Thread-2  ]: SQL status: INSERT 0 190 in 0.003 seconds
[0m04:02:40.123251 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m04:02:40.124076 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:02:40.124806 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m04:02:40.131949 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m04:02:40.133990 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m04:02:40.135901 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb34756-5d2b-4c2e-b48a-ffb0006effed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdca36730>]}
[0m04:02:40.137262 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 190[0m in 63.68s]
[0m04:02:40.138032 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m04:02:40.141543 [debug] [MainThread]: Using postgres connection "master"
[0m04:02:40.142234 [debug] [MainThread]: On master: BEGIN
[0m04:02:40.142780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:02:40.177571 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m04:02:40.178573 [debug] [MainThread]: On master: COMMIT
[0m04:02:40.179169 [debug] [MainThread]: Using postgres connection "master"
[0m04:02:40.179643 [debug] [MainThread]: On master: COMMIT
[0m04:02:40.181916 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m04:02:40.183251 [debug] [MainThread]: On master: Close
[0m04:02:40.184447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:40.185859 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m04:02:40.186330 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m04:02:40.186763 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m04:02:40.187235 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m04:02:40.187890 [info ] [MainThread]: 
[0m04:02:40.188445 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 23.64 seconds (143.64s).
[0m04:02:40.191713 [debug] [MainThread]: Command end result
[0m04:02:40.278936 [info ] [MainThread]: 
[0m04:02:40.280245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:02:40.281130 [info ] [MainThread]: 
[0m04:02:40.281870 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m04:02:40.283561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 144.88896, "process_user_time": 4.395313, "process_kernel_time": 0.245069, "process_mem_max_rss": "105976", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m04:02:40.284480 [debug] [MainThread]: Command `dbt run` succeeded at 04:02:40.284278 after 144.89 seconds
[0m04:02:40.285059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdd752e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdd54c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd874bc70>]}
[0m04:02:40.285563 [debug] [MainThread]: Flushing usage events
[0m04:02:40.909229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:00:14.710096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416298ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163a6e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4161c6e6a0>]}


============================== 05:00:14.717776 | 02c1b451-b496-4a44-9838-58a3d34e9c8b ==============================
[0m05:00:14.717776 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m05:00:14.718393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:00:15.069646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41602b8bb0>]}
[0m05:00:15.184309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4161c8c700>]}
[0m05:00:15.185988 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m05:00:15.212483 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m05:00:15.474122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:15.475006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:15.488576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m05:00:15.554458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415ff30b80>]}
[0m05:00:15.752376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415ffe1be0>]}
[0m05:00:15.753618 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m05:00:15.754453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416016cdf0>]}
[0m05:00:15.758509 [info ] [MainThread]: 
[0m05:00:15.759274 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m05:00:15.759863 [info ] [MainThread]: 
[0m05:00:15.760847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:00:15.768634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m05:00:15.778710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m05:00:15.857318 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m05:00:15.858064 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m05:00:15.858667 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m05:00:15.859443 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m05:00:15.860695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:15.861410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:15.898148 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.036 seconds
[0m05:00:15.898888 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.038 seconds
[0m05:00:15.901426 [debug] [ThreadPool]: On list_lab08_db: Close
[0m05:00:15.904052 [debug] [ThreadPool]: On list_lab08_db: Close
[0m05:00:15.907451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m05:00:15.908439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m05:00:15.924303 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m05:00:15.929351 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m05:00:15.930264 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m05:00:15.930782 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m05:00:15.931282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:15.931787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:15.971065 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m05:00:15.971698 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m05:00:15.972122 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m05:00:15.972723 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m05:00:15.973364 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m05:00:15.974089 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m05:00:15.984789 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m05:00:15.985524 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m05:00:15.988582 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m05:00:15.994001 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m05:00:15.997066 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m05:00:15.997964 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m05:00:16.008404 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.008988 [debug] [MainThread]: On master: BEGIN
[0m05:00:16.009365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:16.045499 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m05:00:16.046264 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.046891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:16.054095 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m05:00:16.056753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415fee1430>]}
[0m05:00:16.057586 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:16.060937 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.061493 [debug] [MainThread]: On master: BEGIN
[0m05:00:16.066743 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:00:16.067543 [debug] [MainThread]: On master: COMMIT
[0m05:00:16.068101 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.068583 [debug] [MainThread]: On master: COMMIT
[0m05:00:16.071137 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m05:00:16.071672 [debug] [MainThread]: On master: Close
[0m05:00:16.077505 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m05:00:16.078289 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m05:00:16.079129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m05:00:16.079745 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m05:00:16.080391 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m05:00:16.083752 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m05:00:16.084568 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m05:00:16.085630 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m05:00:16.086955 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m05:00:16.105310 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m05:00:16.106772 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m05:00:16.112858 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m05:00:16.114789 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m05:00:16.115755 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m05:00:16.116500 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m05:00:16.117207 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m05:00:16.118033 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m05:00:16.125783 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m05:00:16.139797 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m05:00:16.149853 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m05:00:16.158533 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m05:00:16.160318 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m05:00:16.167163 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m05:00:16.179126 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m05:00:16.552651 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:00:16.566501 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp050016407913"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m05:00:16.567232 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:00:16.556988 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:00:16.568435 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp050016398979"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m05:00:16.569233 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m05:00:16.565712 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:00:16.570550 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp050016451649"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m05:00:16.571297 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:00:16.565009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:00:16.573284 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp050016414305"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m05:00:16.574036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:01:21.678263 [debug] [Thread-3  ]: SQL status: SELECT 1777 in 65.107 seconds
[0m05:01:21.705767 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:21.706593 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m05:01:21.713589 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m05:01:21.714314 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:21.717054 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp050016451649'
        
      order by ordinal_position

  
[0m05:01:21.740459 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.023 seconds
[0m05:01:21.749962 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:21.750830 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:21.757266 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m05:01:21.771998 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:21.772585 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:21.780980 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.008 seconds
[0m05:01:21.799841 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m05:01:21.800813 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:21.801794 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp050016451649"
    )


  
[0m05:01:21.811975 [debug] [Thread-3  ]: SQL status: INSERT 0 1777 in 0.010 seconds
[0m05:01:21.838324 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m05:01:21.838903 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:21.839577 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m05:01:21.847086 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m05:01:21.850964 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m05:01:21.854381 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415eac86a0>]}
[0m05:01:21.855458 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 1777[0m in 65.74s]
[0m05:01:21.856291 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m05:01:30.713338 [debug] [Thread-2  ]: SQL status: SELECT 1777 in 74.144 seconds
[0m05:01:30.719852 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:30.720774 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m05:01:30.723847 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m05:01:30.724470 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:30.725053 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp050016398979'
        
      order by ordinal_position

  
[0m05:01:30.738705 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m05:01:30.833406 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:30.834132 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:30.841748 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m05:01:30.848039 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:30.848681 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:30.857073 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m05:01:30.860803 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m05:01:30.861962 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:30.862917 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp050016398979"
    )


  
[0m05:01:30.870818 [debug] [Thread-2  ]: SQL status: INSERT 0 1777 in 0.007 seconds
[0m05:01:30.874871 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m05:01:30.876081 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:30.877395 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m05:01:30.884840 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m05:01:30.886961 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m05:01:30.888045 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415ee70ca0>]}
[0m05:01:30.889579 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 1777[0m in 74.78s]
[0m05:01:30.890890 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m05:01:34.790868 [debug] [Thread-4  ]: SQL status: SELECT 1777 in 78.223 seconds
[0m05:01:34.797735 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:34.798371 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m05:01:34.801200 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m05:01:34.801976 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:34.802634 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp050016407913'
        
      order by ordinal_position

  
[0m05:01:34.821499 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.018 seconds
[0m05:01:34.829732 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:34.830436 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:34.837461 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m05:01:34.847065 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:34.848750 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:34.856994 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m05:01:34.861874 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m05:01:34.862971 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:34.863680 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp050016407913"
    )


  
[0m05:01:34.877977 [debug] [Thread-4  ]: SQL status: INSERT 0 1777 in 0.013 seconds
[0m05:01:34.881493 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m05:01:34.882273 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:34.882974 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m05:01:34.890500 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m05:01:34.892813 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m05:01:34.894016 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415eac85e0>]}
[0m05:01:34.895329 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 1777[0m in 78.78s]
[0m05:01:34.897730 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m05:01:35.560580 [debug] [Thread-1  ]: SQL status: SELECT 1777 in 78.986 seconds
[0m05:01:35.565997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:35.566847 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m05:01:35.569742 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m05:01:35.570607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:35.571086 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp050016414305'
        
      order by ordinal_position

  
[0m05:01:35.582315 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.010 seconds
[0m05:01:35.589299 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:35.589939 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:35.597465 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m05:01:35.605412 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:35.605983 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m05:01:35.613525 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m05:01:35.616796 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m05:01:35.617767 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:35.618480 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp050016414305"
    )


  
[0m05:01:35.634119 [debug] [Thread-1  ]: SQL status: INSERT 0 1777 in 0.015 seconds
[0m05:01:35.636831 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m05:01:35.637740 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:35.638210 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m05:01:35.646133 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m05:01:35.647974 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m05:01:35.649636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415eb9baf0>]}
[0m05:01:35.650853 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 1777[0m in 79.57s]
[0m05:01:35.652084 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m05:01:35.653680 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m05:01:35.654246 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m05:01:35.656395 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m05:01:35.657284 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m05:01:35.657991 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m05:01:35.655524 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m05:01:35.671647 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m05:01:35.672500 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m05:01:35.670780 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m05:01:35.680167 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m05:01:35.681609 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m05:01:35.689752 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:01:35.690772 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp050135686638"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m05:01:35.691530 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m05:01:35.692307 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m05:01:35.699989 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:01:35.701430 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp050135696803"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m05:01:35.701953 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m05:02:24.825402 [debug] [Thread-3  ]: SQL status: SELECT 1777 in 49.123 seconds
[0m05:02:24.831375 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:24.832236 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m05:02:24.836544 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m05:02:24.837138 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:24.838285 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp050135696803'
        
      order by ordinal_position

  
[0m05:02:24.857587 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.019 seconds
[0m05:02:24.863863 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:24.864507 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m05:02:24.872825 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m05:02:24.881276 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:24.882100 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m05:02:24.891239 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.008 seconds
[0m05:02:24.895124 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m05:02:24.895966 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:24.896565 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp050135696803"
    )


  
[0m05:02:24.905622 [debug] [Thread-3  ]: SQL status: INSERT 0 1777 in 0.008 seconds
[0m05:02:24.908423 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m05:02:24.909222 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:24.909769 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m05:02:24.915572 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m05:02:24.916936 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m05:02:24.918030 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4160325d00>]}
[0m05:02:24.919012 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 1777[0m in 49.25s]
[0m05:02:24.920026 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m05:02:37.047020 [debug] [Thread-2  ]: SQL status: SELECT 94 in 61.355 seconds
[0m05:02:37.053087 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:02:37.053768 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m05:02:37.058555 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m05:02:37.059213 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:02:37.060181 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp050135686638'
        
      order by ordinal_position

  
[0m05:02:37.083334 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.022 seconds
[0m05:02:37.090390 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:02:37.090980 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m05:02:37.106636 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.015 seconds
[0m05:02:37.114391 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:02:37.115261 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m05:02:37.125721 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.010 seconds
[0m05:02:37.130480 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m05:02:37.131833 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:02:37.132463 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp050135686638"
    )


  
[0m05:02:37.139096 [debug] [Thread-2  ]: SQL status: INSERT 0 94 in 0.006 seconds
[0m05:02:37.142505 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m05:02:37.143285 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:02:37.143821 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m05:02:37.149182 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m05:02:37.152151 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m05:02:37.153957 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c1b451-b496-4a44-9838-58a3d34e9c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415c1bfee0>]}
[0m05:02:37.156414 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 94[0m in 61.50s]
[0m05:02:37.157711 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m05:02:37.161674 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:37.162320 [debug] [MainThread]: On master: BEGIN
[0m05:02:37.162879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:02:37.219976 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m05:02:37.220976 [debug] [MainThread]: On master: COMMIT
[0m05:02:37.221846 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:37.222350 [debug] [MainThread]: On master: COMMIT
[0m05:02:37.224888 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m05:02:37.225890 [debug] [MainThread]: On master: Close
[0m05:02:37.226846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:02:37.227334 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m05:02:37.227754 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m05:02:37.228226 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m05:02:37.228939 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m05:02:37.229379 [info ] [MainThread]: 
[0m05:02:37.229835 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 21.47 seconds (141.47s).
[0m05:02:37.231799 [debug] [MainThread]: Command end result
[0m05:02:37.293107 [info ] [MainThread]: 
[0m05:02:37.293935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:02:37.294524 [info ] [MainThread]: 
[0m05:02:37.294969 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m05:02:37.296518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 142.67966, "process_user_time": 4.652057, "process_kernel_time": 0.343784, "process_mem_max_rss": "106044", "process_out_blocks": "2120", "process_in_blocks": "0"}
[0m05:02:37.297152 [debug] [MainThread]: Command `dbt run` succeeded at 05:02:37.297037 after 142.68 seconds
[0m05:02:37.297738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416298ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415ee87b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415eaf5d90>]}
[0m05:02:37.298275 [debug] [MainThread]: Flushing usage events
[0m05:02:37.933207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:00:17.237375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b93fbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ba4dc160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b88789d0>]}


============================== 06:00:17.246787 | fe09f3dc-880e-4f2e-a028-5f370f956a23 ==============================
[0m06:00:17.246787 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m06:00:17.247593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:17.631171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8bb79b7c0>]}
[0m06:00:17.776244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b86f7700>]}
[0m06:00:17.777732 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:00:17.807957 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m06:00:18.077959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:18.078753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:18.090729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m06:00:18.162383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b69e0bb0>]}
[0m06:00:18.382678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b69cebb0>]}
[0m06:00:18.383576 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m06:00:18.384374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b6bd9760>]}
[0m06:00:18.387074 [info ] [MainThread]: 
[0m06:00:18.387928 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m06:00:18.388528 [info ] [MainThread]: 
[0m06:00:18.389515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:00:18.397430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m06:00:18.407977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m06:00:18.528477 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m06:00:18.529359 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m06:00:18.530141 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m06:00:18.530849 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m06:00:18.531684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:18.532355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:18.575708 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.044 seconds
[0m06:00:18.578447 [debug] [ThreadPool]: On list_lab08_db: Close
[0m06:00:18.583029 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.051 seconds
[0m06:00:18.586480 [debug] [ThreadPool]: On list_lab08_db: Close
[0m06:00:18.592261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m06:00:18.604022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m06:00:18.607018 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m06:00:18.611795 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m06:00:18.612538 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m06:00:18.613424 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m06:00:18.614117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:18.614781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:18.655789 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m06:00:18.657048 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m06:00:18.657741 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m06:00:18.659190 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m06:00:18.659741 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m06:00:18.658615 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m06:00:18.670443 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m06:00:18.674533 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m06:00:18.675434 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m06:00:18.681334 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m06:00:18.684257 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m06:00:18.686875 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m06:00:18.700337 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:18.701105 [debug] [MainThread]: On master: BEGIN
[0m06:00:18.701648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:00:18.734402 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m06:00:18.735175 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:18.735691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:00:18.742370 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:00:18.745095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b589ba30>]}
[0m06:00:18.746232 [debug] [MainThread]: On master: ROLLBACK
[0m06:00:18.751311 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:18.751968 [debug] [MainThread]: On master: BEGIN
[0m06:00:18.756067 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:00:18.756670 [debug] [MainThread]: On master: COMMIT
[0m06:00:18.757107 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:18.757441 [debug] [MainThread]: On master: COMMIT
[0m06:00:18.760104 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:00:18.760730 [debug] [MainThread]: On master: Close
[0m06:00:18.765987 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m06:00:18.767003 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m06:00:18.772326 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m06:00:18.773471 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m06:00:18.770404 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m06:00:18.774378 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m06:00:18.767942 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m06:00:18.768867 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m06:00:18.776193 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m06:00:18.782609 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m06:00:18.803780 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m06:00:18.791716 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m06:00:18.790695 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m06:00:18.804563 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m06:00:18.814790 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m06:00:18.817180 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m06:00:18.822226 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m06:00:18.829731 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m06:00:18.830795 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m06:00:18.831643 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m06:00:18.832683 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m06:00:18.839780 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m06:00:18.883671 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m06:00:18.884693 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m06:00:19.152410 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:00:19.151536 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:00:19.153576 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp060018996385"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m06:00:19.156383 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:00:19.161393 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp060018979169"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m06:00:19.162092 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:00:19.160540 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:00:19.159648 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp060018988321"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m06:00:19.163446 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:00:19.158758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:00:19.164487 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp060019009764"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m06:00:19.165106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:01:26.065099 [debug] [Thread-3  ]: SQL status: SELECT 3453 in 66.901 seconds
[0m06:01:26.103130 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:26.104027 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m06:01:26.113362 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m06:01:26.114909 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:26.115520 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp060018988321'
        
      order by ordinal_position

  
[0m06:01:26.130220 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.014 seconds
[0m06:01:26.143249 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:26.144498 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:26.150751 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m06:01:26.172576 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:26.173678 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:26.180672 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m06:01:26.207062 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m06:01:26.208329 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:26.209165 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp060018988321"
    )


  
[0m06:01:26.218354 [debug] [Thread-3  ]: SQL status: INSERT 0 3453 in 0.008 seconds
[0m06:01:26.251265 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m06:01:26.252185 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:26.253052 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m06:01:26.263248 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m06:01:26.266925 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m06:01:26.270411 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b5544580>]}
[0m06:01:26.272272 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 3453[0m in 67.46s]
[0m06:01:26.274528 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m06:01:33.981680 [debug] [Thread-2  ]: SQL status: SELECT 3453 in 74.819 seconds
[0m06:01:33.987710 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:33.988421 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m06:01:33.991522 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m06:01:33.992142 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:33.992586 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp060018979169'
        
      order by ordinal_position

  
[0m06:01:34.007594 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.014 seconds
[0m06:01:34.020128 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:34.021384 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:34.029322 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m06:01:34.037460 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:34.038218 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:34.045224 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m06:01:34.049711 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m06:01:34.051109 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:34.051633 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp060018979169"
    )


  
[0m06:01:34.061000 [debug] [Thread-2  ]: SQL status: INSERT 0 3453 in 0.009 seconds
[0m06:01:34.064495 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m06:01:34.065253 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:34.065695 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m06:01:34.075469 [debug] [Thread-2  ]: SQL status: COMMIT in 0.009 seconds
[0m06:01:34.077122 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m06:01:34.078255 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b4451d30>]}
[0m06:01:34.079289 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 3453[0m in 75.30s]
[0m06:01:34.080016 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m06:01:35.416834 [debug] [Thread-4  ]: SQL status: SELECT 3453 in 76.256 seconds
[0m06:01:35.527202 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:35.528111 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m06:01:35.532144 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m06:01:35.532977 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:35.533652 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp060018996385'
        
      order by ordinal_position

  
[0m06:01:35.550699 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.016 seconds
[0m06:01:35.557124 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:35.557816 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:35.564983 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m06:01:35.571641 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:35.573103 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:35.581069 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m06:01:35.584147 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m06:01:35.585240 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:35.585737 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp060018996385"
    )


  
[0m06:01:35.595436 [debug] [Thread-4  ]: SQL status: INSERT 0 3453 in 0.009 seconds
[0m06:01:35.598191 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m06:01:35.598822 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:35.599274 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m06:01:35.610230 [debug] [Thread-4  ]: SQL status: COMMIT in 0.010 seconds
[0m06:01:35.612536 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m06:01:35.622936 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b6d7aa30>]}
[0m06:01:35.626158 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 3453[0m in 76.80s]
[0m06:01:35.628180 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m06:01:37.710791 [debug] [Thread-1  ]: SQL status: SELECT 3453 in 78.545 seconds
[0m06:01:37.716761 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:37.717780 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m06:01:37.720668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m06:01:37.721625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:37.722320 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp060019009764'
        
      order by ordinal_position

  
[0m06:01:37.735053 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m06:01:37.741763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:37.742503 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:37.748912 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m06:01:37.756992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:37.758079 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m06:01:37.765124 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m06:01:37.770350 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m06:01:37.771300 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:37.772089 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp060019009764"
    )


  
[0m06:01:37.795933 [debug] [Thread-1  ]: SQL status: INSERT 0 3453 in 0.023 seconds
[0m06:01:37.799468 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m06:01:37.800363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:37.801118 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m06:01:37.811103 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m06:01:37.812972 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m06:01:37.814227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b55448b0>]}
[0m06:01:37.815719 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 3453[0m in 79.04s]
[0m06:01:37.816847 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m06:01:37.818926 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m06:01:37.819925 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m06:01:37.822470 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m06:01:37.821110 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m06:01:37.823114 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m06:01:37.823925 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m06:01:37.824571 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m06:01:37.825373 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m06:01:37.836803 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m06:01:37.845829 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m06:01:37.847002 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m06:01:37.854159 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:01:37.855324 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp060137851743"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m06:01:37.856495 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:01:37.858022 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m06:01:37.866533 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:01:37.867432 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp060137864059"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m06:01:37.868134 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:02:30.811209 [debug] [Thread-3  ]: SQL status: SELECT 3453 in 52.943 seconds
[0m06:02:30.817405 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:30.818194 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m06:02:30.826034 [debug] [Thread-3  ]: SQL status: BEGIN in 0.007 seconds
[0m06:02:30.826711 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:30.827427 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp060137864059'
        
      order by ordinal_position

  
[0m06:02:30.843134 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.015 seconds
[0m06:02:30.849667 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:30.850474 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m06:02:30.860941 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m06:02:30.867725 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:30.868446 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m06:02:30.903373 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.034 seconds
[0m06:02:30.907311 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m06:02:30.908332 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:30.909206 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp060137864059"
    )


  
[0m06:02:30.928079 [debug] [Thread-3  ]: SQL status: INSERT 0 3453 in 0.018 seconds
[0m06:02:30.930563 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m06:02:30.931451 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:30.931985 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m06:02:30.944179 [debug] [Thread-3  ]: SQL status: COMMIT in 0.011 seconds
[0m06:02:30.945598 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m06:02:30.946679 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b441a130>]}
[0m06:02:30.947687 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 3453[0m in 53.12s]
[0m06:02:30.948421 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m06:02:41.162552 [debug] [Thread-2  ]: SQL status: SELECT 208 in 63.306 seconds
[0m06:02:41.170763 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:02:41.171565 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m06:02:41.174253 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m06:02:41.175222 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:02:41.175732 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp060137851743'
        
      order by ordinal_position

  
[0m06:02:41.187201 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.011 seconds
[0m06:02:41.194230 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:02:41.194912 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m06:02:41.201659 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m06:02:41.210103 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:02:41.211060 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m06:02:41.217754 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m06:02:41.223001 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m06:02:41.224543 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:02:41.225280 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp060137851743"
    )


  
[0m06:02:41.229156 [debug] [Thread-2  ]: SQL status: INSERT 0 208 in 0.003 seconds
[0m06:02:41.232029 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m06:02:41.232676 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:02:41.233260 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m06:02:41.239448 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m06:02:41.241468 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m06:02:41.244758 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe09f3dc-880e-4f2e-a028-5f370f956a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b5544100>]}
[0m06:02:41.246089 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 208[0m in 63.42s]
[0m06:02:41.246910 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m06:02:41.249188 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:41.249985 [debug] [MainThread]: On master: BEGIN
[0m06:02:41.250718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:41.285652 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:02:41.287283 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.287948 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:41.289355 [debug] [MainThread]: On master: COMMIT
[0m06:02:41.295529 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m06:02:41.296356 [debug] [MainThread]: On master: Close
[0m06:02:41.297552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:41.298945 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m06:02:41.299452 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m06:02:41.300252 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m06:02:41.300908 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m06:02:41.301688 [info ] [MainThread]: 
[0m06:02:41.302756 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 22.91 seconds (142.91s).
[0m06:02:41.306595 [debug] [MainThread]: Command end result
[0m06:02:41.376624 [info ] [MainThread]: 
[0m06:02:41.377769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:41.378587 [info ] [MainThread]: 
[0m06:02:41.379249 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:02:41.380733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 144.24655, "process_user_time": 4.725357, "process_kernel_time": 0.34288, "process_mem_max_rss": "106212", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m06:02:41.381694 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:41.381495 after 144.25 seconds
[0m06:02:41.383606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b93fbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b696c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b920e160>]}
[0m06:02:41.384848 [debug] [MainThread]: Flushing usage events
[0m06:02:42.023850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:00:24.196347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995a0f8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99598f67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995942a550>]}


============================== 07:00:24.206373 | 7c717ba4-5421-471e-8ffe-9a25d0af3ba2 ==============================
[0m07:00:24.206373 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m07:00:24.208013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:00:24.512134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9957a8bf10>]}
[0m07:00:24.620914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99593f2730>]}
[0m07:00:24.622212 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:00:24.646321 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m07:00:24.857388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:00:24.858085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:00:24.870141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m07:00:24.937946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99576b9b80>]}
[0m07:00:25.128842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995770ab80>]}
[0m07:00:25.129627 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m07:00:25.130285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995790af70>]}
[0m07:00:25.133132 [info ] [MainThread]: 
[0m07:00:25.133635 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m07:00:25.133957 [info ] [MainThread]: 
[0m07:00:25.134811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:25.143224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m07:00:25.154091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m07:00:25.231213 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m07:00:25.231922 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m07:00:25.232601 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m07:00:25.233195 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m07:00:25.233834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:25.234318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:25.275648 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.042 seconds
[0m07:00:25.279017 [debug] [ThreadPool]: On list_lab08_db: Close
[0m07:00:25.280754 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.046 seconds
[0m07:00:25.283577 [debug] [ThreadPool]: On list_lab08_db: Close
[0m07:00:25.287454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m07:00:25.299925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m07:00:25.301488 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m07:00:25.306565 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m07:00:25.307411 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m07:00:25.307995 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m07:00:25.308857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:25.309307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:25.344024 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m07:00:25.344810 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m07:00:25.345657 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m07:00:25.346365 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m07:00:25.347098 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m07:00:25.347718 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m07:00:25.356114 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m07:00:25.358659 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m07:00:25.359414 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m07:00:25.361216 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m07:00:25.362064 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m07:00:25.364168 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m07:00:25.373212 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:25.373867 [debug] [MainThread]: On master: BEGIN
[0m07:00:25.374369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:25.402064 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m07:00:25.402677 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:25.403138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:00:25.412199 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m07:00:25.413955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995762a040>]}
[0m07:00:25.414660 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:25.416916 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:25.417457 [debug] [MainThread]: On master: BEGIN
[0m07:00:25.422618 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:00:25.423375 [debug] [MainThread]: On master: COMMIT
[0m07:00:25.423782 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:25.424202 [debug] [MainThread]: On master: COMMIT
[0m07:00:25.426691 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m07:00:25.427337 [debug] [MainThread]: On master: Close
[0m07:00:25.432340 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m07:00:25.433507 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m07:00:25.434361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m07:00:25.435251 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m07:00:25.442019 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m07:00:25.449172 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m07:00:25.448528 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m07:00:25.450696 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m07:00:25.451258 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m07:00:25.461289 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m07:00:25.478961 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m07:00:25.480126 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m07:00:25.480664 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m07:00:25.449920 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m07:00:25.519409 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m07:00:25.520469 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m07:00:25.526053 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m07:00:25.534908 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m07:00:25.533936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m07:00:25.545307 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m07:00:25.531850 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m07:00:25.554473 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m07:00:25.544160 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m07:00:25.562620 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m07:00:25.829166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:00:25.839837 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:00:25.841617 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:00:25.844286 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:00:25.844997 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp070025718639"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m07:00:25.845842 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp070025716872"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m07:00:25.846690 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp070025778653"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m07:00:25.847708 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp070025737580"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m07:00:25.848452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:00:25.849167 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m07:00:25.849875 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:00:25.850423 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:01:46.289267 [debug] [Thread-3  ]: SQL status: SELECT 6123 in 80.439 seconds
[0m07:01:46.317682 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:46.318559 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m07:01:46.322410 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m07:01:46.323309 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:46.323927 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp070025778653'
        
      order by ordinal_position

  
[0m07:01:46.366349 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.042 seconds
[0m07:01:46.377777 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:46.378680 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:46.388985 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.009 seconds
[0m07:01:46.406847 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:46.407659 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:46.415712 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m07:01:46.441558 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m07:01:46.443298 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:46.444124 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp070025778653"
    )


  
[0m07:01:46.463632 [debug] [Thread-3  ]: SQL status: INSERT 0 6123 in 0.018 seconds
[0m07:01:46.506361 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m07:01:46.508061 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:46.508911 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m07:01:46.522329 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m07:01:46.525875 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m07:01:46.529607 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995622c670>]}
[0m07:01:46.530815 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 6123[0m in 81.01s]
[0m07:01:46.531812 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m07:01:52.677624 [debug] [Thread-2  ]: SQL status: SELECT 6123 in 86.828 seconds
[0m07:01:52.685432 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:01:52.686127 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m07:01:52.691504 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m07:01:52.692298 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:01:52.694520 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp070025716872'
        
      order by ordinal_position

  
[0m07:01:52.710507 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.015 seconds
[0m07:01:52.801268 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:01:52.802206 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:52.809700 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m07:01:52.815569 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:01:52.816148 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:52.824498 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m07:01:52.829100 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m07:01:52.831895 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:01:52.833012 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp070025716872"
    )


  
[0m07:01:52.903374 [debug] [Thread-2  ]: SQL status: INSERT 0 6123 in 0.069 seconds
[0m07:01:52.905667 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m07:01:52.906488 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:01:52.907293 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m07:01:52.921175 [debug] [Thread-2  ]: SQL status: COMMIT in 0.013 seconds
[0m07:01:52.922826 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m07:01:52.923955 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995622c550>]}
[0m07:01:52.925033 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 6123[0m in 87.47s]
[0m07:01:52.926038 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m07:01:54.971049 [debug] [Thread-4  ]: SQL status: SELECT 6123 in 89.120 seconds
[0m07:01:54.976584 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:01:54.977269 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m07:01:54.980508 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m07:01:54.981510 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:01:54.983391 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp070025737580'
        
      order by ordinal_position

  
[0m07:01:54.998184 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m07:01:55.012009 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:01:55.013802 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:55.021055 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m07:01:55.028305 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:01:55.029236 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:55.036067 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m07:01:55.040261 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m07:01:55.041925 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:01:55.043005 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp070025737580"
    )


  
[0m07:01:55.059202 [debug] [Thread-4  ]: SQL status: INSERT 0 6123 in 0.016 seconds
[0m07:01:55.062305 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m07:01:55.063374 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:01:55.064279 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m07:01:55.077863 [debug] [Thread-4  ]: SQL status: COMMIT in 0.013 seconds
[0m07:01:55.079569 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m07:01:55.081130 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9954122fd0>]}
[0m07:01:55.082427 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 6123[0m in 89.60s]
[0m07:01:55.083459 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m07:01:57.158347 [debug] [Thread-1  ]: SQL status: SELECT 6123 in 91.310 seconds
[0m07:01:57.164873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:01:57.165503 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m07:01:57.169679 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m07:01:57.170326 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:01:57.171186 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp070025718639'
        
      order by ordinal_position

  
[0m07:01:57.183180 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m07:01:57.190281 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:01:57.191187 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:57.197795 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m07:01:57.209392 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:01:57.210163 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m07:01:57.217455 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m07:01:57.220784 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m07:01:57.221753 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:01:57.222264 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp070025718639"
    )


  
[0m07:01:57.258478 [debug] [Thread-1  ]: SQL status: INSERT 0 6123 in 0.035 seconds
[0m07:01:57.261183 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m07:01:57.261856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:01:57.262421 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m07:01:57.280423 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m07:01:57.282412 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m07:01:57.283759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995409e550>]}
[0m07:01:57.284669 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 6123[0m in 91.85s]
[0m07:01:57.285876 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m07:01:57.287572 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m07:01:57.288142 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m07:01:57.289934 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m07:01:57.290555 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m07:01:57.291463 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m07:01:57.289034 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m07:01:57.300074 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m07:01:57.301512 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m07:01:57.303297 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m07:01:57.310699 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m07:01:57.311599 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m07:01:57.317769 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m07:01:57.329279 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:01:57.334257 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:01:57.335265 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp070157316427"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m07:01:57.337191 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp070157330183"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m07:01:57.338425 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m07:01:57.339240 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m07:02:47.229261 [debug] [Thread-3  ]: SQL status: SELECT 6123 in 49.890 seconds
[0m07:02:47.236317 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:02:47.237741 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m07:02:47.246496 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m07:02:47.247148 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:02:47.248368 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp070157330183'
        
      order by ordinal_position

  
[0m07:02:47.276312 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.027 seconds
[0m07:02:47.285016 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:02:47.285627 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m07:02:47.297927 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.011 seconds
[0m07:02:47.304184 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:02:47.305610 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m07:02:47.315172 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.009 seconds
[0m07:02:47.319397 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m07:02:47.320428 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:02:47.321184 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp070157330183"
    )


  
[0m07:02:47.361955 [debug] [Thread-3  ]: SQL status: INSERT 0 6123 in 0.040 seconds
[0m07:02:47.364276 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m07:02:47.365032 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:02:47.365987 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m07:02:47.385789 [debug] [Thread-3  ]: SQL status: COMMIT in 0.019 seconds
[0m07:02:47.387599 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m07:02:47.388544 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9959a1f6a0>]}
[0m07:02:47.389712 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 6123[0m in 50.09s]
[0m07:02:47.390796 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m07:03:00.633481 [debug] [Thread-2  ]: SQL status: SELECT 328 in 63.295 seconds
[0m07:03:00.640370 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:00.641699 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m07:03:00.649801 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m07:03:00.650425 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:00.650890 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp070157316427'
        
      order by ordinal_position

  
[0m07:03:00.663653 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.010 seconds
[0m07:03:00.673429 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:00.674503 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m07:03:00.681154 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m07:03:00.689610 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:00.690429 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m07:03:00.700922 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m07:03:00.706244 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m07:03:00.707854 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:00.708697 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp070157316427"
    )


  
[0m07:03:00.717543 [debug] [Thread-2  ]: SQL status: INSERT 0 328 in 0.008 seconds
[0m07:03:00.721130 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m07:03:00.721989 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:00.722602 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m07:03:00.729081 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m07:03:00.730419 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m07:03:00.731712 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c717ba4-5421-471e-8ffe-9a25d0af3ba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995942ad30>]}
[0m07:03:00.733119 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 328[0m in 63.44s]
[0m07:03:00.734091 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m07:03:00.736472 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:00.737158 [debug] [MainThread]: On master: BEGIN
[0m07:03:00.737777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:03:00.776330 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m07:03:00.776942 [debug] [MainThread]: On master: COMMIT
[0m07:03:00.777748 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:00.778091 [debug] [MainThread]: On master: COMMIT
[0m07:03:00.782427 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m07:03:00.783748 [debug] [MainThread]: On master: Close
[0m07:03:00.784830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:03:00.785239 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m07:03:00.785529 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m07:03:00.785851 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m07:03:00.786141 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m07:03:00.786871 [info ] [MainThread]: 
[0m07:03:00.787716 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 35.65 seconds (155.65s).
[0m07:03:00.789965 [debug] [MainThread]: Command end result
[0m07:03:00.849810 [info ] [MainThread]: 
[0m07:03:00.850789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:03:00.851827 [info ] [MainThread]: 
[0m07:03:00.852302 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m07:03:00.853829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 156.77708, "process_user_time": 4.361282, "process_kernel_time": 0.246302, "process_mem_max_rss": "106112", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m07:03:00.854594 [debug] [MainThread]: Command `dbt run` succeeded at 07:03:00.854408 after 156.78 seconds
[0m07:03:00.855083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995a0f8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9959f08370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9957668220>]}
[0m07:03:00.855589 [debug] [MainThread]: Flushing usage events
[0m07:03:01.534564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:00:34.634195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305b04deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305adf50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305a8582b0>]}


============================== 08:00:34.643205 | 2dab6749-8b44-47f3-b8b4-a2eaac9f0559 ==============================
[0m08:00:34.643205 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m08:00:34.644116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:00:34.950544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305a311460>]}
[0m08:00:35.073010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3058944ca0>]}
[0m08:00:35.074209 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:00:35.100502 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m08:00:35.345510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:35.346581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:35.358705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m08:00:35.430588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30585efbe0>]}
[0m08:00:35.622450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305865fbe0>]}
[0m08:00:35.623467 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m08:00:35.623960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30587df790>]}
[0m08:00:35.627213 [info ] [MainThread]: 
[0m08:00:35.627760 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m08:00:35.630137 [info ] [MainThread]: 
[0m08:00:35.630914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:00:35.640934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m08:00:35.651751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m08:00:35.726327 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m08:00:35.727283 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m08:00:35.728058 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m08:00:35.728936 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m08:00:35.729626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:35.730121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:35.767986 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.038 seconds
[0m08:00:35.770820 [debug] [ThreadPool]: On list_lab08_db: Close
[0m08:00:35.773876 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.044 seconds
[0m08:00:35.777334 [debug] [ThreadPool]: On list_lab08_db: Close
[0m08:00:35.780771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m08:00:35.791638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m08:00:35.808817 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m08:00:35.811092 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m08:00:35.812038 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m08:00:35.812855 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m08:00:35.813681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:35.814440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:35.850785 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m08:00:35.851342 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m08:00:35.851945 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m08:00:35.852918 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m08:00:35.853850 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m08:00:35.854277 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m08:00:35.862410 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m08:00:35.865060 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m08:00:35.865759 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m08:00:35.867781 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m08:00:35.869442 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m08:00:35.874202 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m08:00:35.883756 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:35.884254 [debug] [MainThread]: On master: BEGIN
[0m08:00:35.884670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:00:35.923665 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m08:00:35.924444 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:35.925001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:00:35.933005 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m08:00:35.934815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3058994580>]}
[0m08:00:35.935540 [debug] [MainThread]: On master: ROLLBACK
[0m08:00:35.938461 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:35.938942 [debug] [MainThread]: On master: BEGIN
[0m08:00:35.944080 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:00:35.944937 [debug] [MainThread]: On master: COMMIT
[0m08:00:35.945678 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:35.946200 [debug] [MainThread]: On master: COMMIT
[0m08:00:35.949563 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:00:35.950503 [debug] [MainThread]: On master: Close
[0m08:00:35.958556 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m08:00:35.959485 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m08:00:35.963344 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m08:00:35.964100 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m08:00:35.961917 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m08:00:35.964631 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m08:00:35.960753 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m08:00:35.972156 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m08:00:35.960228 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m08:00:35.965974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m08:00:35.981416 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m08:00:35.980668 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m08:00:35.973474 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m08:00:36.020742 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m08:00:36.022550 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m08:00:36.019784 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m08:00:36.024738 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m08:00:36.025571 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m08:00:36.032194 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m08:00:36.037091 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m08:00:36.048433 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m08:00:36.060231 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m08:00:36.136626 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m08:00:36.137773 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m08:00:36.307546 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:00:36.310404 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:00:36.322926 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp080036224907"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m08:00:36.321502 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:00:36.327073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:00:36.328290 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp080036184206"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m08:00:36.329427 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:00:36.330595 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp080036241113"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m08:00:36.332038 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp080036181120"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m08:00:36.332825 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:00:36.333793 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:00:36.334759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:01:45.731056 [debug] [Thread-3  ]: SQL status: SELECT 9498 in 69.397 seconds
[0m08:01:45.756969 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:01:45.757978 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m08:01:45.760981 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m08:01:45.761588 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:01:45.762052 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp080036241113'
        
      order by ordinal_position

  
[0m08:01:45.781868 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.019 seconds
[0m08:01:45.792091 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:01:45.792974 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:45.803168 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.009 seconds
[0m08:01:45.819433 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:01:45.820295 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:45.828982 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.008 seconds
[0m08:01:45.851390 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m08:01:45.853301 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:01:45.855205 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp080036241113"
    )


  
[0m08:01:45.880444 [debug] [Thread-3  ]: SQL status: INSERT 0 9498 in 0.024 seconds
[0m08:01:45.906781 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m08:01:45.907670 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:01:45.908392 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m08:01:45.925804 [debug] [Thread-3  ]: SQL status: COMMIT in 0.017 seconds
[0m08:01:45.931624 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m08:01:45.935946 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305718ec70>]}
[0m08:01:45.937800 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 9498[0m in 69.91s]
[0m08:01:45.939175 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m08:01:51.180599 [debug] [Thread-4  ]: SQL status: SELECT 9498 in 74.847 seconds
[0m08:01:51.188795 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:01:51.189645 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m08:01:51.194964 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m08:01:51.195831 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:01:51.196388 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp080036184206'
        
      order by ordinal_position

  
[0m08:01:51.221815 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.024 seconds
[0m08:01:51.230991 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:01:51.231845 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:51.244648 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m08:01:51.251386 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:01:51.252268 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:51.271345 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.018 seconds
[0m08:01:51.279503 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m08:01:51.281894 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:01:51.282947 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp080036184206"
    )


  
[0m08:01:51.320294 [debug] [Thread-4  ]: SQL status: INSERT 0 9498 in 0.036 seconds
[0m08:01:51.324187 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m08:01:51.324909 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:01:51.325293 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m08:01:51.339976 [debug] [Thread-4  ]: SQL status: COMMIT in 0.014 seconds
[0m08:01:51.341698 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m08:01:51.342630 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30571c2370>]}
[0m08:01:51.343759 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 9498[0m in 75.37s]
[0m08:01:51.344874 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m08:01:51.592844 [debug] [Thread-2  ]: SQL status: SELECT 9498 in 75.263 seconds
[0m08:01:51.678356 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:01:51.679030 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m08:01:51.682597 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m08:01:51.683379 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:01:51.683890 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp080036224907'
        
      order by ordinal_position

  
[0m08:01:51.713134 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.028 seconds
[0m08:01:51.720695 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:01:51.721557 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:51.734181 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m08:01:51.740844 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:01:51.741768 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:51.760952 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.018 seconds
[0m08:01:51.764680 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m08:01:51.765670 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:01:51.766191 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp080036224907"
    )


  
[0m08:01:51.847576 [debug] [Thread-2  ]: SQL status: INSERT 0 9498 in 0.081 seconds
[0m08:01:51.850149 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m08:01:51.850887 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:01:51.851504 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m08:01:51.872923 [debug] [Thread-2  ]: SQL status: COMMIT in 0.021 seconds
[0m08:01:51.874826 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m08:01:51.875797 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3058994310>]}
[0m08:01:51.876868 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 9498[0m in 75.91s]
[0m08:01:51.877625 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m08:01:56.526982 [debug] [Thread-1  ]: SQL status: SELECT 9498 in 80.192 seconds
[0m08:01:56.533245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:01:56.534100 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m08:01:56.537054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m08:01:56.537676 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:01:56.538100 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp080036181120'
        
      order by ordinal_position

  
[0m08:01:56.550552 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m08:01:56.557429 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:01:56.558385 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:56.564420 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m08:01:56.571475 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:01:56.572272 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m08:01:56.579045 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m08:01:56.583999 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m08:01:56.585091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:01:56.585615 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp080036181120"
    )


  
[0m08:01:56.621779 [debug] [Thread-1  ]: SQL status: INSERT 0 9498 in 0.036 seconds
[0m08:01:56.624288 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m08:01:56.625008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:01:56.625698 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m08:01:56.653310 [debug] [Thread-1  ]: SQL status: COMMIT in 0.027 seconds
[0m08:01:56.655252 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m08:01:56.656489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305718ec40>]}
[0m08:01:56.657548 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 9498[0m in 80.69s]
[0m08:01:56.658346 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m08:01:56.660089 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m08:01:56.660909 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m08:01:56.661859 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m08:01:56.664147 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m08:01:56.662900 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m08:01:56.665244 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m08:01:56.666590 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m08:01:56.672907 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m08:01:56.684320 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m08:01:56.690646 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m08:01:56.691950 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m08:01:56.697690 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m08:01:56.699639 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:01:56.707275 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:01:56.708229 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp080156696010"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m08:01:56.709758 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp080156704044"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m08:01:56.710444 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:01:56.711329 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:02:46.266949 [debug] [Thread-3  ]: SQL status: SELECT 9498 in 49.556 seconds
[0m08:02:46.272068 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:02:46.272789 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m08:02:46.276035 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m08:02:46.276742 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:02:46.277229 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp080156704044'
        
      order by ordinal_position

  
[0m08:02:46.294832 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.017 seconds
[0m08:02:46.308439 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:02:46.309948 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m08:02:46.332475 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.020 seconds
[0m08:02:46.341863 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:02:46.343108 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m08:02:46.351752 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.008 seconds
[0m08:02:46.355718 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m08:02:46.356758 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:02:46.357241 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp080156704044"
    )


  
[0m08:02:46.377681 [debug] [Thread-3  ]: SQL status: INSERT 0 9498 in 0.020 seconds
[0m08:02:46.379959 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m08:02:46.380561 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:02:46.381161 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m08:02:46.396660 [debug] [Thread-3  ]: SQL status: COMMIT in 0.015 seconds
[0m08:02:46.398192 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m08:02:46.399301 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305489df10>]}
[0m08:02:46.400524 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 9498[0m in 49.74s]
[0m08:02:46.402652 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m08:02:59.326210 [debug] [Thread-4  ]: SQL status: SELECT 536 in 62.616 seconds
[0m08:02:59.331350 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:02:59.331918 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m08:02:59.334500 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m08:02:59.335102 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:02:59.337115 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp080156696010'
        
      order by ordinal_position

  
[0m08:02:59.348774 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.011 seconds
[0m08:02:59.355451 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:02:59.356090 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m08:02:59.362792 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m08:02:59.369461 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:02:59.370032 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m08:02:59.376068 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.005 seconds
[0m08:02:59.382139 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m08:02:59.383599 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:02:59.384558 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp080156696010"
    )


  
[0m08:02:59.389831 [debug] [Thread-4  ]: SQL status: INSERT 0 536 in 0.004 seconds
[0m08:02:59.392545 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m08:02:59.393074 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:02:59.393587 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m08:02:59.400434 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m08:02:59.402147 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m08:02:59.403544 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dab6749-8b44-47f3-b8b4-a2eaac9f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30571b1d90>]}
[0m08:02:59.404548 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 536[0m in 62.74s]
[0m08:02:59.405604 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m08:02:59.408241 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:59.409013 [debug] [MainThread]: On master: BEGIN
[0m08:02:59.409511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:02:59.443624 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m08:02:59.444190 [debug] [MainThread]: On master: COMMIT
[0m08:02:59.444560 [debug] [MainThread]: Using postgres connection "master"
[0m08:02:59.444930 [debug] [MainThread]: On master: COMMIT
[0m08:02:59.448082 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m08:02:59.448971 [debug] [MainThread]: On master: Close
[0m08:02:59.450219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:59.450575 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m08:02:59.451017 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m08:02:59.451411 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m08:02:59.451837 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m08:02:59.452470 [info ] [MainThread]: 
[0m08:02:59.452894 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 23.82 seconds (143.82s).
[0m08:02:59.455609 [debug] [MainThread]: Command end result
[0m08:02:59.510865 [info ] [MainThread]: 
[0m08:02:59.511554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:59.511950 [info ] [MainThread]: 
[0m08:02:59.512371 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:02:59.513622 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 144.99995, "process_user_time": 4.423174, "process_kernel_time": 0.258987, "process_mem_max_rss": "106144", "process_out_blocks": "2120", "process_in_blocks": "0"}
[0m08:02:59.514297 [debug] [MainThread]: Command `dbt run` succeeded at 08:02:59.514172 after 145.00 seconds
[0m08:02:59.514780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305b04deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30585be130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f305ae49160>]}
[0m08:02:59.516225 [debug] [MainThread]: Flushing usage events
[0m08:03:00.148693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:00:42.327740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8b325e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8b0f09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8ab2aa00>]}


============================== 09:00:42.340941 | db866556-1905-411e-8367-9337f082195b ==============================
[0m09:00:42.340941 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m09:00:42.343405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:00:42.763228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e88c4fc70>]}
[0m09:00:42.882883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8ac3df70>]}
[0m09:00:42.885611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:00:42.910713 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m09:00:43.195312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:00:43.196020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:00:43.208788 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m09:00:43.306350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e888c9bb0>]}
[0m09:00:43.502432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e88978bb0>]}
[0m09:00:43.503357 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m09:00:43.503889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e88ab9fd0>]}
[0m09:00:43.506289 [info ] [MainThread]: 
[0m09:00:43.506801 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:00:43.507336 [info ] [MainThread]: 
[0m09:00:43.507969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:00:43.516534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m09:00:43.527345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m09:00:43.632694 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m09:00:43.633553 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m09:00:43.634302 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m09:00:43.634951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:43.633949 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m09:00:43.635805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:43.683953 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.048 seconds
[0m09:00:43.689076 [debug] [ThreadPool]: On list_lab08_db: Close
[0m09:00:43.692099 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.057 seconds
[0m09:00:43.696189 [debug] [ThreadPool]: On list_lab08_db: Close
[0m09:00:43.699975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m09:00:43.714434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m09:00:43.725760 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m09:00:43.738719 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m09:00:43.739449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:00:43.740857 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m09:00:43.742319 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m09:00:43.743765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:00:43.783067 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m09:00:43.784069 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m09:00:43.784738 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m09:00:43.793023 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m09:00:43.795295 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m09:00:43.795945 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m09:00:43.796394 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m09:00:43.796794 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m09:00:43.797914 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m09:00:43.804074 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:00:43.806166 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m09:00:43.809335 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m09:00:43.821856 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:43.822500 [debug] [MainThread]: On master: BEGIN
[0m09:00:43.822896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:00:43.851128 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m09:00:43.851899 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:43.853072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:00:43.861630 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m09:00:43.863734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e88c9f9d0>]}
[0m09:00:43.864406 [debug] [MainThread]: On master: ROLLBACK
[0m09:00:43.866455 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:43.866981 [debug] [MainThread]: On master: BEGIN
[0m09:00:43.870778 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:00:43.871735 [debug] [MainThread]: On master: COMMIT
[0m09:00:43.872129 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:43.872488 [debug] [MainThread]: On master: COMMIT
[0m09:00:43.874585 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:00:43.876024 [debug] [MainThread]: On master: Close
[0m09:00:43.880203 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m09:00:43.880953 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m09:00:43.881774 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m09:00:43.882691 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m09:00:43.886310 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m09:00:43.886983 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m09:00:43.885652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m09:00:43.884917 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m09:00:43.908615 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m09:00:43.909581 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m09:00:43.884210 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m09:00:43.910880 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m09:00:43.911545 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m09:00:43.911997 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m09:00:43.898074 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m09:00:43.910100 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m09:00:43.921605 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m09:00:43.925241 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m09:00:43.933315 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m09:00:43.940508 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m09:00:43.941943 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m09:00:43.942770 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m09:00:43.943685 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m09:00:44.008003 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m09:00:44.220198 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:00:44.226560 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:00:44.227394 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp090044109827"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m09:00:44.234228 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:00:44.234982 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:00:44.235935 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp090044107890"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m09:00:44.236567 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:00:44.237144 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp090044180841"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m09:00:44.237839 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp090044115432"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m09:00:44.238432 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:00:44.239717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:00:44.240526 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:01:58.849802 [debug] [Thread-3  ]: SQL status: SELECT 12252 in 74.609 seconds
[0m09:01:58.891071 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:01:58.893598 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m09:01:58.897546 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m09:01:58.898152 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:01:58.898968 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp090044115432'
        
      order by ordinal_position

  
[0m09:01:58.914320 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.014 seconds
[0m09:01:58.931610 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:01:58.932804 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:01:58.939967 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m09:01:58.962953 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:01:58.964356 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:01:58.977630 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m09:01:59.004835 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m09:01:59.006341 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:01:59.006998 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp090044115432"
    )


  
[0m09:01:59.038476 [debug] [Thread-3  ]: SQL status: INSERT 0 12252 in 0.031 seconds
[0m09:01:59.066464 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m09:01:59.067089 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:01:59.067707 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m09:01:59.084387 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m09:01:59.089869 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m09:01:59.094385 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8346b550>]}
[0m09:01:59.095837 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 12252[0m in 75.18s]
[0m09:01:59.096640 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m09:02:05.686556 [debug] [Thread-4  ]: SQL status: SELECT 12252 in 81.450 seconds
[0m09:02:05.693316 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:05.694423 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m09:02:05.700981 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m09:02:05.701652 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:05.702578 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp090044109827'
        
      order by ordinal_position

  
[0m09:02:05.741698 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.038 seconds
[0m09:02:05.747950 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:05.748560 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:02:05.766244 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.016 seconds
[0m09:02:05.775563 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:05.776602 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:02:05.793408 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.016 seconds
[0m09:02:05.798095 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m09:02:05.799536 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:05.800313 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp090044109827"
    )


  
[0m09:02:05.833932 [debug] [Thread-4  ]: SQL status: INSERT 0 12252 in 0.033 seconds
[0m09:02:05.836909 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m09:02:05.837830 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:05.838290 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m09:02:05.855155 [debug] [Thread-4  ]: SQL status: COMMIT in 0.016 seconds
[0m09:02:05.857129 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m09:02:05.858086 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8346b520>]}
[0m09:02:05.859038 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 12252[0m in 81.95s]
[0m09:02:05.860473 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m09:02:07.086206 [debug] [Thread-2  ]: SQL status: SELECT 12252 in 82.848 seconds
[0m09:02:07.098214 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:07.100274 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m09:02:07.104346 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m09:02:07.105090 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:07.106109 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp090044107890'
        
      order by ordinal_position

  
[0m09:02:07.125863 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.018 seconds
[0m09:02:07.222812 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:07.223794 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:02:07.231929 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m09:02:07.237761 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:07.238353 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:02:07.244464 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m09:02:07.248680 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m09:02:07.249864 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:07.250488 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp090044107890"
    )


  
[0m09:02:07.288982 [debug] [Thread-2  ]: SQL status: INSERT 0 12252 in 0.038 seconds
[0m09:02:07.293319 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m09:02:07.294590 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:07.295271 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m09:02:07.318485 [debug] [Thread-2  ]: SQL status: COMMIT in 0.021 seconds
[0m09:02:07.320899 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m09:02:07.322225 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8346b1f0>]}
[0m09:02:07.323769 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 12252[0m in 83.44s]
[0m09:02:07.327074 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m09:02:12.361735 [debug] [Thread-1  ]: SQL status: SELECT 12252 in 88.121 seconds
[0m09:02:12.368524 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:12.369201 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m09:02:12.372126 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m09:02:12.372959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:12.373580 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp090044180841'
        
      order by ordinal_position

  
[0m09:02:12.388591 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.014 seconds
[0m09:02:12.396361 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:12.397215 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:02:12.404394 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m09:02:12.410067 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:12.410752 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m09:02:12.418286 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m09:02:12.421942 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m09:02:12.422936 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:12.423808 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp090044180841"
    )


  
[0m09:02:12.554142 [debug] [Thread-1  ]: SQL status: INSERT 0 12252 in 0.129 seconds
[0m09:02:12.559092 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m09:02:12.559991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:12.560896 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m09:02:12.587716 [debug] [Thread-1  ]: SQL status: COMMIT in 0.025 seconds
[0m09:02:12.589717 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m09:02:12.591072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8346b820>]}
[0m09:02:12.592425 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 12252[0m in 88.71s]
[0m09:02:12.594108 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m09:02:12.595289 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m09:02:12.598314 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m09:02:12.599626 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m09:02:12.600474 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m09:02:12.596371 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m09:02:12.611013 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m09:02:12.612083 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m09:02:12.612668 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m09:02:12.623690 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m09:02:12.624819 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m09:02:12.635886 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m09:02:12.637120 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m09:02:12.644801 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:02:12.645809 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp090212630985"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m09:02:12.648526 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:02:12.649345 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:02:12.650179 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp090212642901"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m09:02:12.651277 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:03:21.606429 [debug] [Thread-3  ]: SQL status: SELECT 12252 in 68.957 seconds
[0m09:03:21.612139 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:03:21.612738 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m09:03:21.617176 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m09:03:21.617828 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:03:21.618391 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp090212630985'
        
      order by ordinal_position

  
[0m09:03:21.634340 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.015 seconds
[0m09:03:21.647830 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:03:21.650362 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m09:03:21.657954 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m09:03:21.674227 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:03:21.675149 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m09:03:21.683189 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m09:03:21.687938 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m09:03:21.689360 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:03:21.690320 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp090212630985"
    )


  
[0m09:03:21.724816 [debug] [Thread-3  ]: SQL status: INSERT 0 12252 in 0.025 seconds
[0m09:03:21.727907 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m09:03:21.729025 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:03:21.730962 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m09:03:21.742954 [debug] [Thread-3  ]: SQL status: COMMIT in 0.011 seconds
[0m09:03:21.745845 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m09:03:21.749117 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e80b6e2b0>]}
[0m09:03:21.750522 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 12252[0m in 69.15s]
[0m09:03:21.752452 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m09:03:33.522919 [debug] [Thread-4  ]: SQL status: SELECT 747 in 80.871 seconds
[0m09:03:33.528823 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:03:33.529639 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m09:03:33.533571 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m09:03:33.534387 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:03:33.535130 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp090212642901'
        
      order by ordinal_position

  
[0m09:03:33.546248 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.010 seconds
[0m09:03:33.553888 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:03:33.554703 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m09:03:33.561963 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m09:03:33.572928 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:03:33.573688 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m09:03:33.580442 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m09:03:33.585255 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m09:03:33.589246 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:03:33.589803 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp090212642901"
    )


  
[0m09:03:33.595084 [debug] [Thread-4  ]: SQL status: INSERT 0 747 in 0.004 seconds
[0m09:03:33.597069 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m09:03:33.597557 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:03:33.598152 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m09:03:33.605705 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m09:03:33.607213 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m09:03:33.608132 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db866556-1905-411e-8367-9337f082195b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8346b2e0>]}
[0m09:03:33.609170 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 747[0m in 81.00s]
[0m09:03:33.610057 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m09:03:33.611992 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:33.612410 [debug] [MainThread]: On master: BEGIN
[0m09:03:33.612789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:03:33.646336 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m09:03:33.647288 [debug] [MainThread]: On master: COMMIT
[0m09:03:33.647899 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:33.648524 [debug] [MainThread]: On master: COMMIT
[0m09:03:33.650931 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m09:03:33.651545 [debug] [MainThread]: On master: Close
[0m09:03:33.652557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:33.653132 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m09:03:33.653579 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m09:03:33.654036 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m09:03:33.654477 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m09:03:33.655181 [info ] [MainThread]: 
[0m09:03:33.655785 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 50.15 seconds (170.15s).
[0m09:03:33.658667 [debug] [MainThread]: Command end result
[0m09:03:33.742447 [info ] [MainThread]: 
[0m09:03:33.744200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:03:33.745319 [info ] [MainThread]: 
[0m09:03:33.746488 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:03:33.748398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 171.5584, "process_user_time": 4.860874, "process_kernel_time": 0.300767, "process_mem_max_rss": "105844", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m09:03:33.749400 [debug] [MainThread]: Command `dbt run` succeeded at 09:03:33.749227 after 171.56 seconds
[0m09:03:33.750007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8b325e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e88978cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8b1380d0>]}
[0m09:03:33.750702 [debug] [MainThread]: Flushing usage events
[0m09:03:34.386381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:40.598430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ffba1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ff9490a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ff3a42b0>]}


============================== 10:00:40.606976 | bb85f203-f6c4-4729-84a3-56488f365dc6 ==============================
[0m10:00:40.606976 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m10:00:40.608691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:00:41.006757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd56b460>]}
[0m10:00:41.155417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd498ca0>]}
[0m10:00:41.156905 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:00:41.192128 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m10:00:41.513207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:00:41.513789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:00:41.528342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m10:00:41.602756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd186be0>]}
[0m10:00:41.795853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd173be0>]}
[0m10:00:41.796916 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m10:00:41.797784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd335790>]}
[0m10:00:41.800779 [info ] [MainThread]: 
[0m10:00:41.801506 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m10:00:41.802417 [info ] [MainThread]: 
[0m10:00:41.803397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:00:41.814143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m10:00:41.835079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m10:00:41.902839 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m10:00:41.903752 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m10:00:41.904512 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m10:00:41.905350 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m10:00:41.906046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:41.906653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:41.956144 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.049 seconds
[0m10:00:41.959022 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.053 seconds
[0m10:00:41.964211 [debug] [ThreadPool]: On list_lab08_db: Close
[0m10:00:41.967853 [debug] [ThreadPool]: On list_lab08_db: Close
[0m10:00:41.979550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m10:00:41.994734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m10:00:42.003760 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m10:00:42.007586 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m10:00:42.007975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:42.006744 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m10:00:42.008842 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m10:00:42.010268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:42.068281 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m10:00:42.069635 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m10:00:42.070115 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m10:00:42.071284 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m10:00:42.072237 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m10:00:42.073239 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m10:00:42.088850 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m10:00:42.091089 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m10:00:42.092742 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.022 seconds
[0m10:00:42.096023 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m10:00:42.101187 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m10:00:42.103729 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m10:00:42.127528 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:42.128286 [debug] [MainThread]: On master: BEGIN
[0m10:00:42.136950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:00:42.179580 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m10:00:42.180450 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:42.181555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:00:42.194495 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m10:00:42.197307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc8a3c70>]}
[0m10:00:42.198262 [debug] [MainThread]: On master: ROLLBACK
[0m10:00:42.201040 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:42.201676 [debug] [MainThread]: On master: BEGIN
[0m10:00:42.206528 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:00:42.207125 [debug] [MainThread]: On master: COMMIT
[0m10:00:42.207492 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:42.208427 [debug] [MainThread]: On master: COMMIT
[0m10:00:42.211984 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:00:42.212611 [debug] [MainThread]: On master: Close
[0m10:00:42.217384 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m10:00:42.218409 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m10:00:42.219417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m10:00:42.220345 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m10:00:42.221063 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m10:00:42.230725 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m10:00:42.231648 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m10:00:42.222232 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m10:00:42.235008 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m10:00:42.236094 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m10:00:42.236628 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m10:00:42.232653 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m10:00:42.229172 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m10:00:42.238334 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m10:00:42.239644 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m10:00:42.240206 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m10:00:42.282618 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m10:00:42.301370 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m10:00:42.300533 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m10:00:42.312004 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m10:00:42.299827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m10:00:42.318589 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m10:00:42.310636 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m10:00:42.334291 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m10:00:42.633706 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:00:42.643752 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:00:42.650372 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp100042499391"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m10:00:42.644760 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp100042551339"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m10:00:42.651105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:00:42.637443 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:00:42.649355 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:00:42.652232 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:00:42.653463 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp100042493724"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m10:00:42.655710 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp100042520103"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m10:00:42.658788 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:00:42.659685 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:01:58.533911 [debug] [Thread-3  ]: SQL status: SELECT 13458 in 75.875 seconds
[0m10:01:58.572448 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:01:58.573421 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m10:01:58.576306 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m10:01:58.577248 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:01:58.577695 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp100042493724'
        
      order by ordinal_position

  
[0m10:01:58.705950 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.128 seconds
[0m10:01:58.721919 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:01:58.722589 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:01:58.740337 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.017 seconds
[0m10:01:58.765986 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:01:58.766914 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:01:58.778131 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m10:01:58.806682 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m10:01:58.808416 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:01:58.809339 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp100042493724"
    )


  
[0m10:01:58.869293 [debug] [Thread-3  ]: SQL status: INSERT 0 13458 in 0.059 seconds
[0m10:01:58.896964 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m10:01:58.897879 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:01:58.898367 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m10:01:58.910419 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m10:01:58.915547 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m10:01:58.918999 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f7cc0d90>]}
[0m10:01:58.920495 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 13458[0m in 76.68s]
[0m10:01:58.925945 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m10:02:04.669185 [debug] [Thread-4  ]: SQL status: SELECT 13458 in 82.009 seconds
[0m10:02:04.677710 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:02:04.678673 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m10:02:04.682006 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m10:02:04.682664 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:02:04.683261 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp100042520103'
        
      order by ordinal_position

  
[0m10:02:04.697013 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m10:02:04.704780 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:02:04.705434 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:02:04.712402 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m10:02:04.823601 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:02:04.825559 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:02:04.834491 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m10:02:04.855111 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m10:02:04.869166 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:02:04.869913 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp100042520103"
    )


  
[0m10:02:04.908088 [debug] [Thread-4  ]: SQL status: INSERT 0 13458 in 0.037 seconds
[0m10:02:04.910400 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m10:02:04.910964 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:02:04.921358 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m10:02:04.936002 [debug] [Thread-4  ]: SQL status: COMMIT in 0.014 seconds
[0m10:02:04.938985 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m10:02:04.940457 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f7d1e0a0>]}
[0m10:02:04.942282 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 13458[0m in 82.70s]
[0m10:02:04.950558 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m10:02:07.596433 [debug] [Thread-2  ]: SQL status: SELECT 13458 in 84.944 seconds
[0m10:02:07.603836 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:02:07.604426 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m10:02:07.607555 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m10:02:07.608223 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:02:07.609603 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp100042551339'
        
      order by ordinal_position

  
[0m10:02:07.622260 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m10:02:07.629893 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:02:07.630639 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:02:07.638599 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m10:02:07.647276 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:02:07.649729 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:02:07.658903 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m10:02:07.663001 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m10:02:07.664419 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:02:07.672942 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp100042551339"
    )


  
[0m10:02:07.723533 [debug] [Thread-2  ]: SQL status: INSERT 0 13458 in 0.049 seconds
[0m10:02:07.725763 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m10:02:07.726318 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:02:07.726703 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m10:02:07.740988 [debug] [Thread-2  ]: SQL status: COMMIT in 0.013 seconds
[0m10:02:07.742936 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m10:02:07.744173 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f7cc0a60>]}
[0m10:02:07.745236 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 13458[0m in 85.51s]
[0m10:02:07.746284 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m10:02:09.590029 [debug] [Thread-1  ]: SQL status: SELECT 13458 in 86.939 seconds
[0m10:02:09.596598 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:02:09.597191 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m10:02:09.600501 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:02:09.602559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:02:09.604629 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp100042499391'
        
      order by ordinal_position

  
[0m10:02:09.619674 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.014 seconds
[0m10:02:09.632321 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:02:09.634390 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:02:09.642173 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m10:02:09.652570 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:02:09.653503 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m10:02:09.663941 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.010 seconds
[0m10:02:09.667765 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m10:02:09.668812 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:02:09.669393 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp100042499391"
    )


  
[0m10:02:09.713045 [debug] [Thread-1  ]: SQL status: INSERT 0 13458 in 0.043 seconds
[0m10:02:09.716255 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m10:02:09.717611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:02:09.719319 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m10:02:09.746651 [debug] [Thread-1  ]: SQL status: COMMIT in 0.025 seconds
[0m10:02:09.748862 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m10:02:09.749974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f7ce0340>]}
[0m10:02:09.751123 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 13458[0m in 87.53s]
[0m10:02:09.752557 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m10:02:09.757407 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m10:02:09.762909 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m10:02:09.761654 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m10:02:09.763760 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m10:02:09.766578 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m10:02:09.767359 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m10:02:09.766001 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m10:02:09.778251 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m10:02:09.785354 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m10:02:09.789545 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m10:02:09.790937 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m10:02:09.801830 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:02:09.803299 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m10:02:09.804966 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp100209797615"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m10:02:09.817192 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:02:09.816256 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:02:09.818567 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp100209812237"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m10:02:09.819620 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:03:15.323937 [debug] [Thread-3  ]: SQL status: SELECT 13458 in 65.507 seconds
[0m10:03:15.332664 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:03:15.334585 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m10:03:15.342117 [debug] [Thread-3  ]: SQL status: BEGIN in 0.007 seconds
[0m10:03:15.343025 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:03:15.343744 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp100209797615'
        
      order by ordinal_position

  
[0m10:03:15.364244 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.019 seconds
[0m10:03:15.372154 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:03:15.372936 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m10:03:15.380973 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m10:03:15.395939 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:03:15.396666 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m10:03:15.404237 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m10:03:15.411606 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m10:03:15.413582 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:03:15.414294 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp100209797615"
    )


  
[0m10:03:15.438984 [debug] [Thread-3  ]: SQL status: INSERT 0 13458 in 0.024 seconds
[0m10:03:15.442263 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m10:03:15.443091 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:03:15.443883 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m10:03:15.460328 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m10:03:15.462090 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m10:03:15.463052 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd51b430>]}
[0m10:03:15.464027 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 13458[0m in 65.70s]
[0m10:03:15.465148 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m10:03:27.539727 [debug] [Thread-4  ]: SQL status: SELECT 750 in 77.720 seconds
[0m10:03:27.546524 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:03:27.547201 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m10:03:27.550224 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m10:03:27.550872 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:03:27.551377 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp100209812237'
        
      order by ordinal_position

  
[0m10:03:27.566454 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.014 seconds
[0m10:03:27.573083 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:03:27.573654 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m10:03:27.582072 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.008 seconds
[0m10:03:27.588983 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:03:27.589571 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m10:03:27.596539 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m10:03:27.600685 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m10:03:27.601709 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:03:27.602307 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp100209812237"
    )


  
[0m10:03:27.609908 [debug] [Thread-4  ]: SQL status: INSERT 0 750 in 0.007 seconds
[0m10:03:27.612168 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m10:03:27.612813 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:03:27.613255 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m10:03:27.619251 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m10:03:27.620690 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m10:03:27.622028 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb85f203-f6c4-4729-84a3-56488f365dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f7ce0760>]}
[0m10:03:27.623132 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 750[0m in 77.86s]
[0m10:03:27.624865 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m10:03:27.626841 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:27.627252 [debug] [MainThread]: On master: BEGIN
[0m10:03:27.627590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:27.659718 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m10:03:27.660330 [debug] [MainThread]: On master: COMMIT
[0m10:03:27.660814 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:27.661334 [debug] [MainThread]: On master: COMMIT
[0m10:03:27.663916 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:03:27.664365 [debug] [MainThread]: On master: Close
[0m10:03:27.665125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:27.665464 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m10:03:27.665732 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m10:03:27.666022 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m10:03:27.666661 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m10:03:27.667332 [info ] [MainThread]: 
[0m10:03:27.668500 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 45.86 seconds (165.86s).
[0m10:03:27.671774 [debug] [MainThread]: Command end result
[0m10:03:27.728734 [info ] [MainThread]: 
[0m10:03:27.729897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:27.732681 [info ] [MainThread]: 
[0m10:03:27.734149 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:03:27.735821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 167.25916, "process_user_time": 4.980478, "process_kernel_time": 0.268256, "process_mem_max_rss": "105980", "process_out_blocks": "2120", "process_in_blocks": "0"}
[0m10:03:27.736491 [debug] [MainThread]: Command `dbt run` succeeded at 10:03:27.736351 after 167.26 seconds
[0m10:03:27.737015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ffba1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fc8a3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60fd56b460>]}
[0m10:03:27.737479 [debug] [MainThread]: Flushing usage events
[0m10:03:28.447817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:05.206532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309678e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63094429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6308e7ea00>]}


============================== 11:01:05.215535 | fc06a2cb-02e7-4363-9bd4-07b34cdbb887 ==============================
[0m11:01:05.215535 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m11:01:05.216260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:05.548765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6306f9ec70>]}
[0m11:01:05.675683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6308f9ef70>]}
[0m11:01:05.676949 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:01:05.708755 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m11:01:05.969876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:05.970635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:05.982988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m11:01:06.055933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6306c20bb0>]}
[0m11:01:06.258007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6306c89bb0>]}
[0m11:01:06.258772 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m11:01:06.259202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6306dadfd0>]}
[0m11:01:06.261844 [info ] [MainThread]: 
[0m11:01:06.262474 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m11:01:06.263013 [info ] [MainThread]: 
[0m11:01:06.264299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:06.275840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m11:01:06.288459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m11:01:06.374055 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m11:01:06.374639 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:06.375296 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m11:01:06.376057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:06.376783 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:06.377739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:06.447142 [debug] [ThreadPool]: SQL status: SELECT 79 in 0.069 seconds
[0m11:01:06.448304 [debug] [ThreadPool]: SQL status: SELECT 79 in 0.072 seconds
[0m11:01:06.456573 [debug] [ThreadPool]: On list_lab08_db: Close
[0m11:01:06.453021 [debug] [ThreadPool]: On list_lab08_db: Close
[0m11:01:06.460667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m11:01:06.471329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m11:01:06.474274 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m11:01:06.480863 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m11:01:06.481770 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m11:01:06.482421 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m11:01:06.485953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:06.483038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:06.532635 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m11:01:06.533334 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m11:01:06.533900 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m11:01:06.534519 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m11:01:06.535120 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m11:01:06.535707 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m11:01:06.569610 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m11:01:06.571830 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m11:01:06.573612 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.037 seconds
[0m11:01:06.575985 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m11:01:06.576917 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m11:01:06.580887 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m11:01:06.594859 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:06.596173 [debug] [MainThread]: On master: BEGIN
[0m11:01:06.596696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:06.654955 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m11:01:06.656116 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:06.656834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:01:06.682830 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m11:01:06.685927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6306ff19d0>]}
[0m11:01:06.686908 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:06.692332 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:06.693252 [debug] [MainThread]: On master: BEGIN
[0m11:01:06.701579 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:01:06.702263 [debug] [MainThread]: On master: COMMIT
[0m11:01:06.703092 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:06.704038 [debug] [MainThread]: On master: COMMIT
[0m11:01:06.707033 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:01:06.707553 [debug] [MainThread]: On master: Close
[0m11:01:06.714483 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m11:01:06.715531 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m11:01:06.716582 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m11:01:06.717510 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m11:01:06.718623 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m11:01:06.719455 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m11:01:06.720402 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m11:01:06.726149 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m11:01:06.725103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m11:01:06.723821 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m11:01:06.727596 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m11:01:06.728426 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m11:01:06.729177 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m11:01:06.730103 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m11:01:06.731090 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m11:01:06.749253 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m11:01:06.794279 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m11:01:06.795197 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m11:01:06.770044 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m11:01:06.803301 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m11:01:06.850361 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m11:01:06.804935 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m11:01:06.822319 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m11:01:07.021412 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m11:01:07.048114 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m11:01:07.054518 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp110106919778"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m11:01:07.057660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m11:01:07.059212 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m11:01:07.064380 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m11:01:07.066769 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp110107030392"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m11:01:07.065805 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:01:07.067707 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp110106929765"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m11:01:07.069666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:01:07.068669 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp110107033677"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m11:01:07.072766 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:01:07.074101 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:02:42.100776 [debug] [Thread-3  ]: SQL status: SELECT 17016 in 95.026 seconds
[0m11:02:42.179597 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m11:02:42.180512 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m11:02:42.193914 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m11:02:42.194622 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m11:02:42.195396 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp110107033677'
        
      order by ordinal_position

  
[0m11:02:42.467080 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.269 seconds
[0m11:02:42.479826 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m11:02:42.480973 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:42.494527 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.011 seconds
[0m11:02:42.509617 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m11:02:42.510338 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:42.524462 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.013 seconds
[0m11:02:42.552855 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m11:02:42.554112 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m11:02:42.554665 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp110107033677"
    )


  
[0m11:02:42.623208 [debug] [Thread-3  ]: SQL status: INSERT 0 17016 in 0.068 seconds
[0m11:02:42.656625 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m11:02:42.657595 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m11:02:42.658312 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m11:02:42.754242 [debug] [Thread-3  ]: SQL status: COMMIT in 0.095 seconds
[0m11:02:42.760424 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m11:02:42.764478 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63057b09a0>]}
[0m11:02:42.766168 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 17016[0m in 96.03s]
[0m11:02:42.767055 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m11:02:51.477487 [debug] [Thread-2  ]: SQL status: SELECT 17016 in 104.412 seconds
[0m11:02:51.483402 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m11:02:51.484000 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m11:02:51.487224 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m11:02:51.487815 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m11:02:51.488220 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp110106919778'
        
      order by ordinal_position

  
[0m11:02:51.509191 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.019 seconds
[0m11:02:51.515364 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m11:02:51.516037 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:51.524960 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m11:02:51.533590 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m11:02:51.534707 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:51.550340 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.015 seconds
[0m11:02:51.555934 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m11:02:51.558243 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m11:02:51.559256 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp110106919778"
    )


  
[0m11:02:51.710752 [debug] [Thread-2  ]: SQL status: INSERT 0 17016 in 0.151 seconds
[0m11:02:51.713161 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m11:02:51.713765 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m11:02:51.718108 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m11:02:51.737780 [debug] [Thread-2  ]: SQL status: COMMIT in 0.019 seconds
[0m11:02:51.739600 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m11:02:51.741325 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63057b07f0>]}
[0m11:02:51.743541 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 17016[0m in 105.02s]
[0m11:02:51.744648 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m11:02:52.599947 [debug] [Thread-4  ]: SQL status: SELECT 17016 in 105.529 seconds
[0m11:02:52.612374 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m11:02:52.613261 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m11:02:52.616583 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m11:02:52.617382 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m11:02:52.617863 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp110106929765'
        
      order by ordinal_position

  
[0m11:02:52.633128 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m11:02:52.738441 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m11:02:52.739388 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:52.747216 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m11:02:52.756698 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m11:02:52.757670 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:52.766722 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m11:02:52.771781 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m11:02:52.773067 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m11:02:52.774253 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp110106929765"
    )


  
[0m11:02:52.808693 [debug] [Thread-4  ]: SQL status: INSERT 0 17016 in 0.033 seconds
[0m11:02:52.811940 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m11:02:52.812740 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m11:02:52.813243 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m11:02:52.833845 [debug] [Thread-4  ]: SQL status: COMMIT in 0.019 seconds
[0m11:02:52.835670 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m11:02:52.836966 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63057b05b0>]}
[0m11:02:52.838538 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 17016[0m in 106.11s]
[0m11:02:52.839313 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m11:02:54.700159 [debug] [Thread-1  ]: SQL status: SELECT 17016 in 107.630 seconds
[0m11:02:54.709542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m11:02:54.710349 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m11:02:54.714075 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m11:02:54.715048 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m11:02:54.715809 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp110107030392'
        
      order by ordinal_position

  
[0m11:02:54.728558 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m11:02:54.735585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m11:02:54.736413 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:54.743782 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m11:02:54.750455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m11:02:54.753084 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m11:02:54.760957 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m11:02:54.764768 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m11:02:54.765852 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m11:02:54.766497 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp110107030392"
    )


  
[0m11:02:54.894630 [debug] [Thread-1  ]: SQL status: INSERT 0 17016 in 0.127 seconds
[0m11:02:54.897170 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m11:02:54.897789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m11:02:54.898435 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m11:02:54.921926 [debug] [Thread-1  ]: SQL status: COMMIT in 0.023 seconds
[0m11:02:54.923728 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m11:02:54.925027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63057b0b80>]}
[0m11:02:54.926333 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 17016[0m in 108.20s]
[0m11:02:54.928490 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m11:02:54.929751 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m11:02:54.930797 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m11:02:54.932260 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m11:02:54.934197 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m11:02:54.935070 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m11:02:54.943078 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m11:02:54.933247 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m11:02:54.944987 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m11:02:54.945601 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m11:02:54.959170 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m11:02:54.960210 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m11:02:54.961296 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m11:02:54.970458 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m11:02:54.978655 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m11:02:54.982978 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp110254966960"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m11:02:54.984218 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp110254975685"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m11:02:54.985193 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:02:54.992274 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:03:56.552931 [debug] [Thread-3  ]: SQL status: SELECT 17016 in 61.567 seconds
[0m11:03:56.559744 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m11:03:56.560431 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m11:03:56.565782 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m11:03:56.566535 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m11:03:56.567068 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp110254966960'
        
      order by ordinal_position

  
[0m11:03:56.582003 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.014 seconds
[0m11:03:56.593901 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m11:03:56.594608 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m11:03:56.601392 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m11:03:56.608641 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m11:03:56.609466 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m11:03:56.615940 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.005 seconds
[0m11:03:56.620726 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m11:03:56.622238 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m11:03:56.623769 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp110254966960"
    )


  
[0m11:03:56.649052 [debug] [Thread-3  ]: SQL status: INSERT 0 17016 in 0.024 seconds
[0m11:03:56.651593 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m11:03:56.652310 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m11:03:56.652970 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m11:03:56.677392 [debug] [Thread-3  ]: SQL status: COMMIT in 0.024 seconds
[0m11:03:56.678939 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m11:03:56.679968 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630455c3d0>]}
[0m11:03:56.681249 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 17016[0m in 61.75s]
[0m11:03:56.681988 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m11:04:12.445933 [debug] [Thread-2  ]: SQL status: SELECT 970 in 77.454 seconds
[0m11:04:12.455131 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m11:04:12.455895 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m11:04:12.461223 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m11:04:12.462336 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m11:04:12.462867 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp110254975685'
        
      order by ordinal_position

  
[0m11:04:12.477653 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.013 seconds
[0m11:04:12.498287 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m11:04:12.499565 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m11:04:12.507553 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.007 seconds
[0m11:04:12.514610 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m11:04:12.515849 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m11:04:12.523072 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m11:04:12.527218 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m11:04:12.528367 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m11:04:12.528981 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp110254975685"
    )


  
[0m11:04:12.548879 [debug] [Thread-2  ]: SQL status: INSERT 0 970 in 0.019 seconds
[0m11:04:12.551991 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m11:04:12.553123 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m11:04:12.554001 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m11:04:12.562082 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m11:04:12.564959 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m11:04:12.566758 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc06a2cb-02e7-4363-9bd4-07b34cdbb887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630456fbb0>]}
[0m11:04:12.568047 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 970[0m in 77.62s]
[0m11:04:12.569441 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m11:04:12.572152 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:12.572880 [debug] [MainThread]: On master: BEGIN
[0m11:04:12.573866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:12.613122 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m11:04:12.615904 [debug] [MainThread]: On master: COMMIT
[0m11:04:12.616522 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:12.617079 [debug] [MainThread]: On master: COMMIT
[0m11:04:12.620397 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m11:04:12.621086 [debug] [MainThread]: On master: Close
[0m11:04:12.622062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:12.622875 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m11:04:12.623521 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m11:04:12.623955 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m11:04:12.624383 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m11:04:12.625068 [info ] [MainThread]: 
[0m11:04:12.625638 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 3 minutes and 6.36 seconds (186.36s).
[0m11:04:12.629305 [debug] [MainThread]: Command end result
[0m11:04:12.710384 [info ] [MainThread]: 
[0m11:04:12.711971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:12.713020 [info ] [MainThread]: 
[0m11:04:12.714193 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:04:12.717585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 187.62128, "process_user_time": 4.700083, "process_kernel_time": 0.352341, "process_mem_max_rss": "105864", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m11:04:12.718533 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:12.718322 after 187.62 seconds
[0m11:04:12.719223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309678e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6306c89b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630948a370>]}
[0m11:04:12.722404 [debug] [MainThread]: Flushing usage events
[0m11:04:13.380365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:59.377906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cc5eceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cc3940a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cbdec2b0>]}


============================== 12:00:59.388340 | b687a577-ae31-4da4-bea4-cc372ee9fad5 ==============================
[0m12:00:59.388340 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m12:00:59.388991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:00:59.744547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9fb7460>]}
[0m12:00:59.898740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9ee8ca0>]}
[0m12:00:59.900045 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:00:59.948502 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m12:01:00.299052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:00.299764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:00.314972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m12:01:00.414979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9b91be0>]}
[0m12:01:00.675483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9bffbe0>]}
[0m12:01:00.676587 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m12:01:00.677873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9d8b790>]}
[0m12:01:00.682153 [info ] [MainThread]: 
[0m12:01:00.684594 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m12:01:00.685292 [info ] [MainThread]: 
[0m12:01:00.686273 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:01:00.698947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m12:01:00.710744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m12:01:00.792948 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m12:01:00.793967 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m12:01:00.795078 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m12:01:00.795692 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m12:01:00.796595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:00.797194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:00.839179 [debug] [ThreadPool]: SQL status: SELECT 81 in 0.042 seconds
[0m12:01:00.843150 [debug] [ThreadPool]: On list_lab08_db: Close
[0m12:01:00.844658 [debug] [ThreadPool]: SQL status: SELECT 81 in 0.047 seconds
[0m12:01:00.848645 [debug] [ThreadPool]: On list_lab08_db: Close
[0m12:01:00.853515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m12:01:00.865725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m12:01:00.882603 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m12:01:00.883470 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m12:01:00.889500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:00.888921 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m12:01:00.893071 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m12:01:00.893535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:00.932097 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m12:01:00.932769 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m12:01:00.933609 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m12:01:00.935757 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m12:01:00.937453 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m12:01:00.938102 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m12:01:00.959651 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.020 seconds
[0m12:01:00.962785 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m12:01:00.963894 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m12:01:00.966597 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m12:01:00.967252 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m12:01:00.972006 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m12:01:00.982234 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:00.982811 [debug] [MainThread]: On master: BEGIN
[0m12:01:00.983417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:01.025888 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m12:01:01.027037 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:01.028048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:01:01.042663 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m12:01:01.045449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9b36ca0>]}
[0m12:01:01.046489 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:01.050881 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:01.052152 [debug] [MainThread]: On master: BEGIN
[0m12:01:01.059292 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:01:01.059968 [debug] [MainThread]: On master: COMMIT
[0m12:01:01.060399 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:01.060937 [debug] [MainThread]: On master: COMMIT
[0m12:01:01.064555 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m12:01:01.065228 [debug] [MainThread]: On master: Close
[0m12:01:01.070351 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m12:01:01.071219 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m12:01:01.072343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m12:01:01.073073 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m12:01:01.082208 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m12:01:01.083510 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m12:01:01.084467 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m12:01:01.085212 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m12:01:01.085922 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m12:01:01.086739 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m12:01:01.088854 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m12:01:01.090162 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m12:01:01.089489 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m12:01:01.090871 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m12:01:01.092228 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m12:01:01.092875 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m12:01:01.138003 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m12:01:01.150394 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m12:01:01.143384 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m12:01:01.162243 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m12:01:01.149386 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m12:01:01.180653 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m12:01:01.179030 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m12:01:01.230571 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m12:01:01.601994 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m12:01:01.609596 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp120101418626"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m12:01:01.610417 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:01:01.605936 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m12:01:01.611615 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp120101418213"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m12:01:01.612336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:01:01.613649 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m12:01:01.614114 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp120101431915"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m12:01:01.614594 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:01:01.608567 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m12:01:01.615684 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp120101447747"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m12:01:01.616430 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:02:19.437708 [debug] [Thread-3  ]: SQL status: SELECT 18448 in 77.821 seconds
[0m12:02:19.471579 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m12:02:19.472488 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m12:02:19.476682 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m12:02:19.477662 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m12:02:19.478623 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp120101447747'
        
      order by ordinal_position

  
[0m12:02:19.662720 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.183 seconds
[0m12:02:19.675184 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m12:02:19.676109 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:19.683221 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m12:02:19.704445 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m12:02:19.705507 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:19.713036 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m12:02:19.742486 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m12:02:19.743662 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m12:02:19.744208 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp120101447747"
    )


  
[0m12:02:19.790559 [debug] [Thread-3  ]: SQL status: INSERT 0 18448 in 0.045 seconds
[0m12:02:19.820058 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m12:02:19.820824 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m12:02:19.821293 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m12:02:19.837070 [debug] [Thread-3  ]: SQL status: COMMIT in 0.015 seconds
[0m12:02:19.843174 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m12:02:19.847336 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c8741e20>]}
[0m12:02:19.848737 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 18448[0m in 78.76s]
[0m12:02:19.849644 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m12:02:28.097950 [debug] [Thread-2  ]: SQL status: SELECT 18448 in 86.483 seconds
[0m12:02:28.187496 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m12:02:28.188305 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m12:02:28.191331 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m12:02:28.192137 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m12:02:28.192624 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp120101431915'
        
      order by ordinal_position

  
[0m12:02:28.207107 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.014 seconds
[0m12:02:28.213868 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m12:02:28.214641 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:28.223492 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m12:02:28.234887 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m12:02:28.235524 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:28.243271 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m12:02:28.247241 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m12:02:28.248144 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m12:02:28.248939 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp120101431915"
    )


  
[0m12:02:28.398857 [debug] [Thread-2  ]: SQL status: INSERT 0 18448 in 0.149 seconds
[0m12:02:28.402278 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m12:02:28.403125 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m12:02:28.404368 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m12:02:28.423363 [debug] [Thread-2  ]: SQL status: COMMIT in 0.018 seconds
[0m12:02:28.425454 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m12:02:28.426450 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c8741cd0>]}
[0m12:02:28.427518 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 18448[0m in 87.34s]
[0m12:02:28.429268 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m12:02:29.648476 [debug] [Thread-4  ]: SQL status: SELECT 18448 in 88.038 seconds
[0m12:02:29.656260 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m12:02:29.657353 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m12:02:29.660292 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m12:02:29.661035 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m12:02:29.661749 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp120101418626'
        
      order by ordinal_position

  
[0m12:02:29.675927 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m12:02:29.683052 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m12:02:29.683863 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:29.692130 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m12:02:29.699701 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m12:02:29.700362 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:29.708953 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m12:02:29.712831 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m12:02:29.713743 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m12:02:29.714382 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp120101418626"
    )


  
[0m12:02:29.760627 [debug] [Thread-4  ]: SQL status: INSERT 0 18448 in 0.045 seconds
[0m12:02:29.765116 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m12:02:29.766161 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m12:02:29.766647 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m12:02:29.784318 [debug] [Thread-4  ]: SQL status: COMMIT in 0.017 seconds
[0m12:02:29.787403 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m12:02:29.788562 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c8726160>]}
[0m12:02:29.790060 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 18448[0m in 88.70s]
[0m12:02:29.791308 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m12:02:31.860177 [debug] [Thread-1  ]: SQL status: SELECT 18448 in 90.248 seconds
[0m12:02:31.866856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m12:02:31.868273 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m12:02:31.872430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m12:02:31.873781 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m12:02:31.874640 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp120101418213'
        
      order by ordinal_position

  
[0m12:02:31.888628 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.013 seconds
[0m12:02:31.898443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m12:02:31.899344 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:31.906192 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m12:02:31.916222 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m12:02:31.917373 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m12:02:31.925990 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m12:02:31.931254 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m12:02:31.932589 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m12:02:31.933469 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp120101418213"
    )


  
[0m12:02:32.097680 [debug] [Thread-1  ]: SQL status: INSERT 0 18448 in 0.163 seconds
[0m12:02:32.100671 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m12:02:32.102127 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m12:02:32.104468 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m12:02:32.129905 [debug] [Thread-1  ]: SQL status: COMMIT in 0.024 seconds
[0m12:02:32.133840 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m12:02:32.135653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c8590c10>]}
[0m12:02:32.137804 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 18448[0m in 91.06s]
[0m12:02:32.138673 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m12:02:32.140828 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m12:02:32.141750 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m12:02:32.144026 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m12:02:32.146684 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m12:02:32.147308 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m12:02:32.145474 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m12:02:32.155858 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m12:02:32.156808 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m12:02:32.158377 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m12:02:32.168364 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m12:02:32.170187 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m12:02:32.176452 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m12:02:32.185528 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m12:02:32.186668 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp120232175121"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m12:02:32.191717 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:02:32.192746 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:02:32.194063 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp120232188479"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m12:02:32.195320 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:03:33.821421 [debug] [Thread-3  ]: SQL status: SELECT 18448 in 61.629 seconds
[0m12:03:33.827743 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m12:03:33.828538 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m12:03:33.831718 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m12:03:33.832587 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m12:03:33.833133 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp120232175121'
        
      order by ordinal_position

  
[0m12:03:33.846778 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.012 seconds
[0m12:03:33.856294 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m12:03:33.857328 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m12:03:33.868147 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m12:03:33.875955 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m12:03:33.877772 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m12:03:33.891608 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m12:03:33.895068 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m12:03:33.896024 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m12:03:33.896532 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp120232175121"
    )


  
[0m12:03:33.932773 [debug] [Thread-3  ]: SQL status: INSERT 0 18448 in 0.036 seconds
[0m12:03:33.935133 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m12:03:33.935870 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m12:03:33.936526 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m12:03:33.950589 [debug] [Thread-3  ]: SQL status: COMMIT in 0.014 seconds
[0m12:03:33.952901 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m12:03:33.954900 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9f22a90>]}
[0m12:03:33.956101 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 18448[0m in 61.81s]
[0m12:03:33.957976 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m12:03:50.713132 [debug] [Thread-2  ]: SQL status: SELECT 1054 in 78.518 seconds
[0m12:03:50.720046 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:03:50.720636 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m12:03:50.728665 [debug] [Thread-2  ]: SQL status: BEGIN in 0.007 seconds
[0m12:03:50.729997 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:03:50.730794 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp120232188479'
        
      order by ordinal_position

  
[0m12:03:50.748212 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.016 seconds
[0m12:03:50.754365 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:03:50.755282 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m12:03:50.763529 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.007 seconds
[0m12:03:50.776189 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:03:50.777366 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m12:03:50.786609 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.008 seconds
[0m12:03:50.790944 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m12:03:50.791798 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:03:50.792317 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp120232188479"
    )


  
[0m12:03:50.842179 [debug] [Thread-2  ]: SQL status: INSERT 0 1054 in 0.049 seconds
[0m12:03:50.845371 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m12:03:50.846176 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m12:03:50.847735 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m12:03:50.856147 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m12:03:50.857534 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m12:03:50.859835 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b687a577-ae31-4da4-bea4-cc372ee9fad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c9f228b0>]}
[0m12:03:50.860811 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1054[0m in 78.70s]
[0m12:03:50.861728 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m12:03:50.864108 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:50.864676 [debug] [MainThread]: On master: BEGIN
[0m12:03:50.865168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:50.942803 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m12:03:50.943710 [debug] [MainThread]: On master: COMMIT
[0m12:03:50.944079 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:50.944465 [debug] [MainThread]: On master: COMMIT
[0m12:03:50.948570 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:03:50.949196 [debug] [MainThread]: On master: Close
[0m12:03:50.950100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:50.950679 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m12:03:50.951042 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m12:03:50.951596 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m12:03:50.951888 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m12:03:50.952612 [info ] [MainThread]: 
[0m12:03:50.953149 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 50.27 seconds (170.27s).
[0m12:03:50.954966 [debug] [MainThread]: Command end result
[0m12:03:51.016863 [info ] [MainThread]: 
[0m12:03:51.018765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:51.019324 [info ] [MainThread]: 
[0m12:03:51.019937 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:03:51.021579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 171.7671, "process_user_time": 4.959289, "process_kernel_time": 0.322243, "process_mem_max_rss": "106392", "process_out_blocks": "2096", "process_in_blocks": "0"}
[0m12:03:51.022520 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:51.022330 after 171.77 seconds
[0m12:03:51.023482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cc5eceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cc3ed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c87606a0>]}
[0m12:03:51.024039 [debug] [MainThread]: Flushing usage events
[0m12:03:51.670131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:01.140428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702614deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7025ef50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70259582b0>]}


============================== 13:01:01.151241 | d4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6 ==============================
[0m13:01:01.151241 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m13:01:01.152383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:01.681383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023b18460>]}
[0m13:01:01.878171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023a45d30>]}
[0m13:01:01.880910 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:01.937508 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m13:01:02.323464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:02.324443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:02.340039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m13:01:02.441313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023733be0>]}
[0m13:01:02.739088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023720be0>]}
[0m13:01:02.740895 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m13:01:02.741998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70238e2790>]}
[0m13:01:02.745597 [info ] [MainThread]: 
[0m13:01:02.746332 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:01:02.746857 [info ] [MainThread]: 
[0m13:01:02.747768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:02.762377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m13:01:02.776154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m13:01:02.871588 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m13:01:02.872557 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m13:01:02.873136 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m13:01:02.874043 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m13:01:02.874972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:02.875643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:02.930241 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.054 seconds
[0m13:01:02.933695 [debug] [ThreadPool]: On list_lab08_db: Close
[0m13:01:02.937360 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.062 seconds
[0m13:01:02.941033 [debug] [ThreadPool]: On list_lab08_db: Close
[0m13:01:02.945134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m13:01:02.955997 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m13:01:02.957183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m13:01:02.958710 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m13:01:02.967496 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m13:01:02.968348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:02.969213 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m13:01:02.971459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:03.028140 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m13:01:03.029265 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m13:01:03.029968 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m13:01:03.030725 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m13:01:03.031621 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m13:01:03.032216 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m13:01:03.060831 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.028 seconds
[0m13:01:03.062331 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m13:01:03.064950 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m13:01:03.067187 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m13:01:03.071079 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m13:01:03.073025 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m13:01:03.089343 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.090332 [debug] [MainThread]: On master: BEGIN
[0m13:01:03.090968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:03.131924 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m13:01:03.132918 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.133665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:03.153923 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m13:01:03.156951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7023a95580>]}
[0m13:01:03.159882 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:03.163132 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.165524 [debug] [MainThread]: On master: BEGIN
[0m13:01:03.172177 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:01:03.174865 [debug] [MainThread]: On master: COMMIT
[0m13:01:03.175740 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.176323 [debug] [MainThread]: On master: COMMIT
[0m13:01:03.179330 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:01:03.180117 [debug] [MainThread]: On master: Close
[0m13:01:03.193375 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m13:01:03.194960 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m13:01:03.196191 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m13:01:03.197078 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m13:01:03.199437 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m13:01:03.212385 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m13:01:03.214099 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m13:01:03.213576 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m13:01:03.230935 [info ] [Thread-3  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m13:01:03.207166 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m13:01:03.235159 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m13:01:03.200593 [info ] [Thread-4  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m13:01:03.236078 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m13:01:03.237434 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m13:01:03.233327 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m13:01:03.238844 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m13:01:03.352980 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m13:01:03.359647 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m13:01:03.360549 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m13:01:03.362645 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m13:01:03.364010 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m13:01:03.358518 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m13:01:03.392959 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m13:01:03.421697 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m13:01:03.735266 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:01:03.737482 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:01:03.741942 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:01:03.742632 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:01:03.744090 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp130103595330"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m13:01:03.745029 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp130103605729"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m13:01:03.746022 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp130103576551"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m13:01:03.746843 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp130103603922"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m13:01:03.747675 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:01:03.748302 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:01:03.749158 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:01:03.749854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:21.575278 [debug] [Thread-4  ]: SQL status: SELECT 19971 in 77.827 seconds
[0m13:02:21.601374 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:02:21.602260 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m13:02:21.605466 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m13:02:21.606226 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:02:21.606917 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp130103595330'
        
      order by ordinal_position

  
[0m13:02:21.770050 [debug] [Thread-4  ]: SQL status: SELECT 8 in 0.162 seconds
[0m13:02:21.796701 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:02:21.797905 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:21.808199 [debug] [Thread-4  ]: SQL status: SELECT 8 in 0.007 seconds
[0m13:02:21.835736 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:02:21.837149 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:21.845559 [debug] [Thread-4  ]: SQL status: SELECT 8 in 0.007 seconds
[0m13:02:21.887271 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m13:02:21.889829 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:02:21.890827 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp130103595330"
    )


  
[0m13:02:21.959957 [debug] [Thread-4  ]: SQL status: INSERT 0 19971 in 0.068 seconds
[0m13:02:21.994508 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m13:02:21.995271 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m13:02:21.995833 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m13:02:22.011955 [debug] [Thread-4  ]: SQL status: COMMIT in 0.013 seconds
[0m13:02:22.019267 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m13:02:22.024541 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7022295fa0>]}
[0m13:02:22.026316 [info ] [Thread-4  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 19971[0m in 78.79s]
[0m13:02:22.027587 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m13:02:27.839537 [debug] [Thread-3  ]: SQL status: SELECT 19971 in 84.091 seconds
[0m13:02:27.862869 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:02:27.863984 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m13:02:27.867585 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m13:02:27.868412 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:02:27.869234 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp130103605729'
        
      order by ordinal_position

  
[0m13:02:27.882776 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.013 seconds
[0m13:02:28.012058 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:02:28.013077 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:28.023225 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.009 seconds
[0m13:02:28.031083 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:02:28.032011 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:28.039852 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.007 seconds
[0m13:02:28.045137 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m13:02:28.046554 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:02:28.047264 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp130103605729"
    )


  
[0m13:02:28.127500 [debug] [Thread-3  ]: SQL status: INSERT 0 19971 in 0.079 seconds
[0m13:02:28.132221 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m13:02:28.133313 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m13:02:28.134307 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m13:02:28.162000 [debug] [Thread-3  ]: SQL status: COMMIT in 0.025 seconds
[0m13:02:28.164078 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m13:02:28.165470 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7022280ac0>]}
[0m13:02:28.166963 [info ] [Thread-3  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 19971[0m in 84.93s]
[0m13:02:28.169286 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m13:02:29.114951 [debug] [Thread-2  ]: SQL status: SELECT 19971 in 85.366 seconds
[0m13:02:29.122182 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:02:29.123159 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m13:02:29.126842 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m13:02:29.127550 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:02:29.128041 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp130103576551'
        
      order by ordinal_position

  
[0m13:02:29.158362 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.030 seconds
[0m13:02:29.165734 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:02:29.166401 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:29.174968 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m13:02:29.183947 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:02:29.184920 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:29.193484 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m13:02:29.198090 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m13:02:29.199470 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:02:29.200465 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp130103576551"
    )


  
[0m13:02:29.285877 [debug] [Thread-2  ]: SQL status: INSERT 0 19971 in 0.084 seconds
[0m13:02:29.289544 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m13:02:29.290444 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m13:02:29.291731 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m13:02:29.312166 [debug] [Thread-2  ]: SQL status: COMMIT in 0.020 seconds
[0m13:02:29.314294 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m13:02:29.315641 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7022295f10>]}
[0m13:02:29.317003 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 19971[0m in 86.10s]
[0m13:02:29.317879 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m13:02:34.797004 [debug] [Thread-1  ]: SQL status: SELECT 19971 in 91.047 seconds
[0m13:02:34.803161 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:02:34.804020 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m13:02:34.806432 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m13:02:34.807087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:02:34.807576 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp130103603922'
        
      order by ordinal_position

  
[0m13:02:34.820302 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m13:02:34.828681 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:02:34.830066 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:34.837966 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m13:02:34.846766 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:02:34.847549 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m13:02:34.855003 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m13:02:34.859273 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m13:02:34.860436 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:02:34.861096 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp130103603922"
    )


  
[0m13:02:34.928424 [debug] [Thread-1  ]: SQL status: INSERT 0 19971 in 0.067 seconds
[0m13:02:34.931340 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m13:02:34.932213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m13:02:34.932941 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m13:02:34.960109 [debug] [Thread-1  ]: SQL status: COMMIT in 0.026 seconds
[0m13:02:34.966708 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m13:02:34.968413 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70200f7a60>]}
[0m13:02:34.970057 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 19971[0m in 91.76s]
[0m13:02:34.971258 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m13:02:34.973278 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_events
[0m13:02:34.974144 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m13:02:34.975261 [info ] [Thread-4  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m13:02:34.977752 [info ] [Thread-3  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m13:02:34.979522 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m13:02:34.980672 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m13:02:34.982725 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m13:02:34.981641 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m13:02:35.001516 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m13:02:35.006207 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m13:02:35.008149 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m13:02:35.037029 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_events
[0m13:02:35.051363 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:02:35.057895 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp130235015849"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m13:02:35.059544 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:02:35.060482 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:02:35.061655 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp130235054053"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m13:02:35.063233 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:03:32.066965 [debug] [Thread-4  ]: SQL status: SELECT 19971 in 57.004 seconds
[0m13:03:32.073560 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:03:32.074573 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m13:03:32.084338 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m13:03:32.085235 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:03:32.086193 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp130235054053'
        
      order by ordinal_position

  
[0m13:03:32.126159 [debug] [Thread-4  ]: SQL status: SELECT 7 in 0.039 seconds
[0m13:03:32.134280 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:03:32.134931 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:03:32.156434 [debug] [Thread-4  ]: SQL status: SELECT 7 in 0.020 seconds
[0m13:03:32.164998 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:03:32.165865 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:03:32.177745 [debug] [Thread-4  ]: SQL status: SELECT 7 in 0.011 seconds
[0m13:03:32.182648 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m13:03:32.184070 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:03:32.185478 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp130235054053"
    )


  
[0m13:03:32.256483 [debug] [Thread-4  ]: SQL status: INSERT 0 19971 in 0.070 seconds
[0m13:03:32.259331 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m13:03:32.260274 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m13:03:32.261014 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m13:03:32.279460 [debug] [Thread-4  ]: SQL status: COMMIT in 0.018 seconds
[0m13:03:32.282053 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_events: Close
[0m13:03:32.283219 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702369aca0>]}
[0m13:03:32.284972 [info ] [Thread-4  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 19971[0m in 57.30s]
[0m13:03:32.286320 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_events
[0m13:03:46.650331 [debug] [Thread-3  ]: SQL status: SELECT 1117 in 71.590 seconds
[0m13:03:46.656619 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:03:46.657258 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m13:03:46.660602 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m13:03:46.661981 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:03:46.662473 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp130235015849'
        
      order by ordinal_position

  
[0m13:03:46.675477 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.012 seconds
[0m13:03:46.685095 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:03:46.686133 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:03:46.693402 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.007 seconds
[0m13:03:46.701897 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:03:46.702515 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m13:03:46.710623 [debug] [Thread-3  ]: SQL status: SELECT 17 in 0.007 seconds
[0m13:03:46.716980 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m13:03:46.719595 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:03:46.721166 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp130235015849"
    )


  
[0m13:03:46.735717 [debug] [Thread-3  ]: SQL status: INSERT 0 1117 in 0.014 seconds
[0m13:03:46.740238 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m13:03:46.741071 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m13:03:46.745031 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m13:03:46.754348 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m13:03:46.756332 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m13:03:46.757993 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4eaa17a-247a-4dd9-bfc7-ea88c2c8a5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7020182760>]}
[0m13:03:46.759074 [info ] [Thread-3  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1117[0m in 71.78s]
[0m13:03:46.760620 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m13:03:46.763082 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:46.763842 [debug] [MainThread]: On master: BEGIN
[0m13:03:46.764693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:46.801492 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m13:03:46.803231 [debug] [MainThread]: On master: COMMIT
[0m13:03:46.803949 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:46.804633 [debug] [MainThread]: On master: COMMIT
[0m13:03:46.807150 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:03:46.808231 [debug] [MainThread]: On master: Close
[0m13:03:46.810498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:46.811213 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m13:03:46.811927 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m13:03:46.812535 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m13:03:46.813657 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m13:03:46.815276 [info ] [MainThread]: 
[0m13:03:46.819100 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 44.07 seconds (164.07s).
[0m13:03:46.823894 [debug] [MainThread]: Command end result
[0m13:03:46.905081 [info ] [MainThread]: 
[0m13:03:46.906734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:46.907676 [info ] [MainThread]: 
[0m13:03:46.908502 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:03:46.910426 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 165.88087, "process_user_time": 5.129119, "process_kernel_time": 0.465144, "process_mem_max_rss": "106064", "process_in_blocks": "4336", "process_out_blocks": "2104"}
[0m13:03:46.911295 [debug] [MainThread]: Command `dbt run` succeeded at 13:03:46.911147 after 165.88 seconds
[0m13:03:46.911928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702614deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7025f566d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70236bf220>]}
[0m13:03:46.912423 [debug] [MainThread]: Flushing usage events
[0m13:03:47.574721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:04.923580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff648499e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff649579130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6477826a0>]}


============================== 14:01:04.933056 | fa476235-1bd2-49d0-b383-b62a0af73a64 ==============================
[0m14:01:04.933056 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m14:01:04.934080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:01:05.255070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645dc2bb0>]}
[0m14:01:05.387584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff647797700>]}
[0m14:01:05.389435 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:01:05.451240 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m14:01:05.931483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:05.932264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:05.944551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m14:01:06.022828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645a3cb80>]}
[0m14:01:06.270980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645aacb80>]}
[0m14:01:06.272232 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m14:01:06.272807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645c6cdf0>]}
[0m14:01:06.275870 [info ] [MainThread]: 
[0m14:01:06.276526 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:01:06.276925 [info ] [MainThread]: 
[0m14:01:06.277720 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:06.288835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m14:01:06.302718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m14:01:06.403858 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m14:01:06.404683 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m14:01:06.405356 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m14:01:06.406555 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m14:01:06.407252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:06.408176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:06.452006 [debug] [ThreadPool]: SQL status: SELECT 85 in 0.044 seconds
[0m14:01:06.456882 [debug] [ThreadPool]: On list_lab08_db: Close
[0m14:01:06.477201 [debug] [ThreadPool]: SQL status: SELECT 85 in 0.070 seconds
[0m14:01:06.480988 [debug] [ThreadPool]: On list_lab08_db: Close
[0m14:01:06.487136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m14:01:06.494990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m14:01:06.510165 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m14:01:06.513942 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m14:01:06.514999 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m14:01:06.515652 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m14:01:06.516325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:06.516864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:06.558389 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m14:01:06.559430 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m14:01:06.560448 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m14:01:06.569556 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m14:01:06.570641 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m14:01:06.571838 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m14:01:06.572781 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m14:01:06.575461 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m14:01:06.579561 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m14:01:06.584644 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m14:01:06.587453 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m14:01:06.591326 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m14:01:06.602646 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.603590 [debug] [MainThread]: On master: BEGIN
[0m14:01:06.604207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:06.663455 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m14:01:06.664358 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.664972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:06.684808 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m14:01:06.688157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645e15f40>]}
[0m14:01:06.689618 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:06.693012 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.694402 [debug] [MainThread]: On master: BEGIN
[0m14:01:06.704550 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:01:06.705382 [debug] [MainThread]: On master: COMMIT
[0m14:01:06.705833 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:06.706423 [debug] [MainThread]: On master: COMMIT
[0m14:01:06.712378 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:01:06.713284 [debug] [MainThread]: On master: Close
[0m14:01:06.719408 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m14:01:06.721388 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m14:01:06.725954 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m14:01:06.720613 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m14:01:06.728934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_browser_events)
[0m14:01:06.722569 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m14:01:06.731245 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m14:01:06.723610 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m14:01:06.729535 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m14:01:06.727977 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_device_events)
[0m14:01:06.743319 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m14:01:06.733833 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m14:01:06.735387 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m14:01:06.744668 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m14:01:06.772331 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m14:01:06.795055 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m14:01:06.821903 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m14:01:06.801216 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m14:01:06.820360 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m14:01:06.814763 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m14:01:06.850335 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m14:01:06.858942 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m14:01:06.866365 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m14:01:06.890205 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m14:01:07.273521 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:01:07.274553 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp140107174217"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m14:01:07.288120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:01:07.287275 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:01:07.292515 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:01:07.294300 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp140107084125"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m14:01:07.297998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:01:07.296428 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp140107057727"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m14:01:07.295220 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:01:07.300950 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:01:07.301812 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp140107141595"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m14:01:07.303411 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:02:21.442777 [debug] [Thread-3  ]: SQL status: SELECT 19877 in 74.142 seconds
[0m14:02:21.472597 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:21.473507 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m14:02:21.477958 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m14:02:21.479095 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:21.479828 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp140107057727'
        
      order by ordinal_position

  
[0m14:02:21.520634 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.040 seconds
[0m14:02:21.534551 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:21.535220 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:21.543099 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m14:02:21.558540 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:21.559187 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:21.566941 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m14:02:21.594885 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m14:02:21.596232 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:21.596863 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp140107057727"
    )


  
[0m14:02:21.640330 [debug] [Thread-3  ]: SQL status: INSERT 0 19877 in 0.042 seconds
[0m14:02:21.667568 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m14:02:21.669087 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m14:02:21.669880 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m14:02:21.689985 [debug] [Thread-3  ]: SQL status: COMMIT in 0.020 seconds
[0m14:02:21.693141 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m14:02:21.697384 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6445e57c0>]}
[0m14:02:21.698628 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 19877[0m in 74.96s]
[0m14:02:21.699880 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m14:02:27.209527 [debug] [Thread-4  ]: SQL status: SELECT 19877 in 79.906 seconds
[0m14:02:27.220651 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:27.222145 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m14:02:27.229096 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m14:02:27.230163 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:27.231537 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp140107141595'
        
      order by ordinal_position

  
[0m14:02:27.276811 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.045 seconds
[0m14:02:27.290288 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:27.291562 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:27.423241 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.021 seconds
[0m14:02:27.432372 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:27.433386 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:27.449653 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.015 seconds
[0m14:02:27.455978 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m14:02:27.457210 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:27.457934 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp140107141595"
    )


  
[0m14:02:27.549714 [debug] [Thread-4  ]: SQL status: INSERT 0 19877 in 0.091 seconds
[0m14:02:27.552184 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m14:02:27.553176 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m14:02:27.553706 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m14:02:27.568421 [debug] [Thread-4  ]: SQL status: COMMIT in 0.014 seconds
[0m14:02:27.571382 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m14:02:27.572944 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645d4da30>]}
[0m14:02:27.574640 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 19877[0m in 80.80s]
[0m14:02:27.575969 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m14:02:27.662709 [debug] [Thread-2  ]: SQL status: SELECT 19877 in 80.375 seconds
[0m14:02:27.668072 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:27.668814 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m14:02:27.672245 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m14:02:27.673271 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:27.673879 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp140107174217'
        
      order by ordinal_position

  
[0m14:02:27.690561 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.016 seconds
[0m14:02:27.697689 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:27.698362 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:27.706977 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m14:02:27.717166 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:27.718118 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:27.726822 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m14:02:27.732528 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m14:02:27.734203 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:27.735541 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp140107174217"
    )


  
[0m14:02:27.844915 [debug] [Thread-2  ]: SQL status: INSERT 0 19877 in 0.108 seconds
[0m14:02:27.847232 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m14:02:27.848034 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m14:02:27.849067 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m14:02:27.874483 [debug] [Thread-2  ]: SQL status: COMMIT in 0.025 seconds
[0m14:02:27.876254 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m14:02:27.877340 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6445e5dc0>]}
[0m14:02:27.878490 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 19877[0m in 81.15s]
[0m14:02:27.880392 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m14:02:33.023958 [debug] [Thread-1  ]: SQL status: SELECT 19877 in 85.726 seconds
[0m14:02:33.033699 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:33.034704 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m14:02:33.038304 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m14:02:33.039248 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:33.039924 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp140107084125'
        
      order by ordinal_position

  
[0m14:02:33.057603 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.017 seconds
[0m14:02:33.063628 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:33.064866 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:33.074315 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.008 seconds
[0m14:02:33.082097 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:33.082763 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m14:02:33.091029 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m14:02:33.098500 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m14:02:33.099957 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:33.100777 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp140107084125"
    )


  
[0m14:02:33.173685 [debug] [Thread-1  ]: SQL status: INSERT 0 19877 in 0.072 seconds
[0m14:02:33.176562 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m14:02:33.177690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m14:02:33.178639 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m14:02:33.193702 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m14:02:33.195569 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m14:02:33.198558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6445a09a0>]}
[0m14:02:33.200056 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 19877[0m in 86.47s]
[0m14:02:33.202708 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m14:02:33.205313 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m14:02:33.207112 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m14:02:33.210175 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m14:02:33.210935 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m14:02:33.209143 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m14:02:33.211517 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m14:02:33.212365 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m14:02:33.222299 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m14:02:33.223318 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m14:02:33.224767 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m14:02:33.252877 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:02:33.254126 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp140233243728"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m14:02:33.255373 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:02:33.260349 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m14:02:33.261529 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m14:02:33.271883 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:02:33.274698 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp140233267183"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m14:02:33.275243 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:03:33.810094 [debug] [Thread-3  ]: SQL status: SELECT 19877 in 60.535 seconds
[0m14:03:33.816512 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:33.817567 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m14:03:33.821075 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m14:03:33.821731 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:33.822345 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp140233267183'
        
      order by ordinal_position

  
[0m14:03:33.836070 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.012 seconds
[0m14:03:33.842906 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:33.843740 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:33.850274 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.005 seconds
[0m14:03:33.860777 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:33.861617 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:33.870862 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.008 seconds
[0m14:03:33.875680 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m14:03:33.876786 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:33.877575 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp140233267183"
    )


  
[0m14:03:33.914585 [debug] [Thread-3  ]: SQL status: INSERT 0 19877 in 0.036 seconds
[0m14:03:33.918062 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m14:03:33.918902 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m14:03:33.919852 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m14:03:33.937776 [debug] [Thread-3  ]: SQL status: COMMIT in 0.017 seconds
[0m14:03:33.939598 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m14:03:33.941133 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645d2fd90>]}
[0m14:03:33.942157 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 19877[0m in 60.73s]
[0m14:03:33.942888 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m14:03:51.046482 [debug] [Thread-4  ]: SQL status: SELECT 1144 in 77.791 seconds
[0m14:03:51.054063 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:51.055073 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m14:03:51.061467 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m14:03:51.063235 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:51.064379 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp140233243728'
        
      order by ordinal_position

  
[0m14:03:51.082407 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.017 seconds
[0m14:03:51.090310 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:51.091340 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:51.100450 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.008 seconds
[0m14:03:51.106716 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:51.107437 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m14:03:51.114377 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m14:03:51.119918 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m14:03:51.121513 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:51.122325 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp140233243728"
    )


  
[0m14:03:51.147620 [debug] [Thread-4  ]: SQL status: INSERT 0 1144 in 0.024 seconds
[0m14:03:51.150873 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m14:03:51.151937 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m14:03:51.152819 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m14:03:51.161177 [debug] [Thread-4  ]: SQL status: COMMIT in 0.008 seconds
[0m14:03:51.163414 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m14:03:51.165061 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa476235-1bd2-49d0-b383-b62a0af73a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6443ba490>]}
[0m14:03:51.166615 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1144[0m in 77.95s]
[0m14:03:51.167698 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m14:03:51.169964 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:51.170482 [debug] [MainThread]: On master: BEGIN
[0m14:03:51.170908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:51.238117 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m14:03:51.238952 [debug] [MainThread]: On master: COMMIT
[0m14:03:51.239401 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:51.239925 [debug] [MainThread]: On master: COMMIT
[0m14:03:51.245903 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m14:03:51.247076 [debug] [MainThread]: On master: Close
[0m14:03:51.248550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:51.250046 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m14:03:51.250709 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m14:03:51.251209 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m14:03:51.252053 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m14:03:51.252775 [info ] [MainThread]: 
[0m14:03:51.254654 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 44.98 seconds (164.98s).
[0m14:03:51.259107 [debug] [MainThread]: Command end result
[0m14:03:51.341459 [info ] [MainThread]: 
[0m14:03:51.342755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:51.343645 [info ] [MainThread]: 
[0m14:03:51.344133 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:03:51.345395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 166.55893, "process_user_time": 5.249767, "process_kernel_time": 0.414415, "process_mem_max_rss": "106044", "process_in_blocks": "1168", "process_out_blocks": "2096"}
[0m14:03:51.346329 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:51.346185 after 166.56 seconds
[0m14:03:51.347006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff648499e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6482aa0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645aacca0>]}
[0m14:03:51.347993 [debug] [MainThread]: Flushing usage events
[0m14:03:51.983031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:00.048741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb0b6be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb09359d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb0375a00>]}


============================== 15:01:00.058045 | 9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0 ==============================
[0m15:01:00.058045 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m15:01:00.059147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:00.418595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bae492c70>]}
[0m15:01:00.535029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb048ef70>]}
[0m15:01:00.536458 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:01:00.562120 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m15:01:00.818686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:00.819635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:00.832823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m15:01:00.917104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bae152bb0>]}
[0m15:01:01.164271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bae13ec10>]}
[0m15:01:01.165412 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m15:01:01.166628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bae305fd0>]}
[0m15:01:01.170072 [info ] [MainThread]: 
[0m15:01:01.170810 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:01:01.171205 [info ] [MainThread]: 
[0m15:01:01.171873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:01.181150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m15:01:01.182497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m15:01:01.305096 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m15:01:01.307809 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m15:01:01.309345 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m15:01:01.310583 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m15:01:01.312562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:01.311344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:01.358700 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.046 seconds
[0m15:01:01.360526 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.049 seconds
[0m15:01:01.371969 [debug] [ThreadPool]: On list_lab08_db: Close
[0m15:01:01.366787 [debug] [ThreadPool]: On list_lab08_db: Close
[0m15:01:01.380833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m15:01:01.394681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m15:01:01.415804 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m15:01:01.416852 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m15:01:01.428270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:01.424959 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m15:01:01.430395 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m15:01:01.430925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:01.474345 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:01:01.475847 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m15:01:01.478062 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m15:01:01.483571 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m15:01:01.485117 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m15:01:01.485774 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m15:01:01.488140 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m15:01:01.491091 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m15:01:01.494328 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m15:01:01.496827 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m15:01:01.499175 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m15:01:01.502197 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m15:01:01.513990 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:01.515799 [debug] [MainThread]: On master: BEGIN
[0m15:01:01.516801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:01.557158 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m15:01:01.558152 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:01.559568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:01:01.573424 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m15:01:01.575935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bae4e59d0>]}
[0m15:01:01.577046 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:01.579800 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:01.580635 [debug] [MainThread]: On master: BEGIN
[0m15:01:01.586378 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:01:01.587444 [debug] [MainThread]: On master: COMMIT
[0m15:01:01.588461 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:01.589380 [debug] [MainThread]: On master: COMMIT
[0m15:01:01.592150 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:01:01.592840 [debug] [MainThread]: On master: Close
[0m15:01:01.600469 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m15:01:01.601862 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m15:01:01.607303 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m15:01:01.608567 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m15:01:01.606193 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m15:01:01.610600 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m15:01:01.609389 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m15:01:01.603193 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m15:01:01.605408 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m15:01:01.639669 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m15:01:01.620150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m15:01:01.642429 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m15:01:01.612694 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m15:01:01.650606 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m15:01:01.658675 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m15:01:01.657584 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m15:01:01.660286 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m15:01:01.669779 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m15:01:01.688891 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m15:01:01.694303 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m15:01:01.694753 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m15:01:01.695926 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m15:01:01.708813 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m15:01:01.897697 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m15:01:02.035871 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:01:02.041180 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:01:02.042902 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp150101848793"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m15:01:02.053409 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:01:02.051523 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:01:02.046768 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:01:02.052475 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp150101999418"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m15:01:02.054461 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp150101865011"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m15:01:02.055342 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp150101933963"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m15:01:02.056892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:02.056157 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:01:02.058214 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:02:35.126916 [debug] [Thread-3  ]: SQL status: SELECT 18059 in 93.069 seconds
[0m15:02:35.166882 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:35.168351 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m15:02:35.172739 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m15:02:35.173550 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:35.175203 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp150101933963'
        
      order by ordinal_position

  
[0m15:02:35.195373 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.019 seconds
[0m15:02:35.210333 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:35.212939 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:35.223097 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.009 seconds
[0m15:02:35.242036 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:35.243158 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:35.255711 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.012 seconds
[0m15:02:35.280264 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m15:02:35.281422 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:35.282018 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp150101933963"
    )


  
[0m15:02:35.311954 [debug] [Thread-3  ]: SQL status: INSERT 0 18059 in 0.029 seconds
[0m15:02:35.346371 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m15:02:35.347452 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m15:02:35.348155 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m15:02:35.365225 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m15:02:35.369534 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m15:02:35.373899 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baccbdd00>]}
[0m15:02:35.375522 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 18059[0m in 93.73s]
[0m15:02:35.380471 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m15:02:38.359858 [debug] [Thread-2  ]: SQL status: SELECT 18059 in 96.306 seconds
[0m15:02:38.367306 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:38.368664 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m15:02:38.372234 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m15:02:38.373005 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:38.373577 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp150101848793'
        
      order by ordinal_position

  
[0m15:02:38.395121 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.021 seconds
[0m15:02:38.401609 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:38.402451 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:38.411341 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m15:02:38.418947 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:38.420012 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:38.436190 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.015 seconds
[0m15:02:38.441454 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m15:02:38.443691 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:38.444726 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp150101848793"
    )


  
[0m15:02:38.500119 [debug] [Thread-2  ]: SQL status: INSERT 0 18059 in 0.055 seconds
[0m15:02:38.502392 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m15:02:38.502960 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m15:02:38.503379 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m15:02:38.524279 [debug] [Thread-2  ]: SQL status: COMMIT in 0.020 seconds
[0m15:02:38.527054 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m15:02:38.528444 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bac393640>]}
[0m15:02:38.531036 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 18059[0m in 96.92s]
[0m15:02:38.532663 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m15:02:38.758670 [debug] [Thread-4  ]: SQL status: SELECT 18059 in 96.702 seconds
[0m15:02:38.853870 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:38.854559 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m15:02:38.860741 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m15:02:38.861953 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:38.862679 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp150101999418'
        
      order by ordinal_position

  
[0m15:02:38.874395 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.011 seconds
[0m15:02:38.881917 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:38.882686 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:38.890968 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m15:02:38.897562 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:38.899186 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:38.906285 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m15:02:38.911656 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m15:02:38.913163 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:38.913818 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp150101999418"
    )


  
[0m15:02:38.954533 [debug] [Thread-4  ]: SQL status: INSERT 0 18059 in 0.040 seconds
[0m15:02:38.957361 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m15:02:38.957932 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m15:02:38.958393 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m15:02:38.985050 [debug] [Thread-4  ]: SQL status: COMMIT in 0.026 seconds
[0m15:02:38.986926 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m15:02:38.988051 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bac38f3d0>]}
[0m15:02:38.990254 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 18059[0m in 97.38s]
[0m15:02:38.992983 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m15:02:42.068489 [debug] [Thread-1  ]: SQL status: SELECT 18059 in 100.011 seconds
[0m15:02:42.074559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:42.075839 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m15:02:42.080042 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m15:02:42.080775 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:42.081462 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp150101865011'
        
      order by ordinal_position

  
[0m15:02:42.093695 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m15:02:42.101367 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:42.102316 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:42.108864 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m15:02:42.118281 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:42.119240 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m15:02:42.125895 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m15:02:42.132907 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m15:02:42.134436 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:42.135886 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp150101865011"
    )


  
[0m15:02:42.232878 [debug] [Thread-1  ]: SQL status: INSERT 0 18059 in 0.096 seconds
[0m15:02:42.246263 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m15:02:42.250447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m15:02:42.252084 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m15:02:42.283864 [debug] [Thread-1  ]: SQL status: COMMIT in 0.027 seconds
[0m15:02:42.286139 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m15:02:42.288679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baccbdcd0>]}
[0m15:02:42.289713 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 18059[0m in 100.67s]
[0m15:02:42.290702 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m15:02:42.293358 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m15:02:42.294278 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m15:02:42.295467 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m15:02:42.296397 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m15:02:42.297726 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m15:02:42.299099 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m15:02:42.299883 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m15:02:42.300801 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m15:02:42.309918 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m15:02:42.322174 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m15:02:42.323938 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m15:02:42.337080 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:02:42.338402 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp150242332860"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m15:02:42.339339 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:02:42.340700 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m15:02:42.348327 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:02:42.349243 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp150242345909"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m15:02:42.349929 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:03:42.036313 [debug] [Thread-3  ]: SQL status: SELECT 18059 in 59.697 seconds
[0m15:03:42.042164 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:42.042946 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m15:03:42.048492 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m15:03:42.049157 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:42.049622 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp150242332860'
        
      order by ordinal_position

  
[0m15:03:42.066460 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.016 seconds
[0m15:03:42.074644 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:42.075622 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:42.082213 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m15:03:42.088940 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:42.089754 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:42.106812 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.016 seconds
[0m15:03:42.111926 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m15:03:42.113727 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:42.114804 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp150242332860"
    )


  
[0m15:03:42.152571 [debug] [Thread-3  ]: SQL status: INSERT 0 18059 in 0.037 seconds
[0m15:03:42.154988 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m15:03:42.156154 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m15:03:42.157092 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m15:03:42.177768 [debug] [Thread-3  ]: SQL status: COMMIT in 0.020 seconds
[0m15:03:42.179542 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m15:03:42.180590 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bacbe7a00>]}
[0m15:03:42.181781 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 18059[0m in 59.88s]
[0m15:03:42.183206 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m15:03:55.449148 [debug] [Thread-2  ]: SQL status: SELECT 1060 in 73.099 seconds
[0m15:03:55.459147 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:55.460119 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m15:03:55.466295 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m15:03:55.467143 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:55.467840 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp150242345909'
        
      order by ordinal_position

  
[0m15:03:55.482403 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.014 seconds
[0m15:03:55.493646 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:55.494415 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:55.502429 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.007 seconds
[0m15:03:55.516581 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:55.517759 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m15:03:55.526802 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.008 seconds
[0m15:03:55.537742 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m15:03:55.539374 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:55.541277 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp150242345909"
    )


  
[0m15:03:55.558671 [debug] [Thread-2  ]: SQL status: INSERT 0 1060 in 0.017 seconds
[0m15:03:55.561711 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m15:03:55.562832 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m15:03:55.564086 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m15:03:55.571888 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m15:03:55.574156 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m15:03:55.575956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8740fe-2eb3-42ce-aa4f-e0e6df33d4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baccbd7c0>]}
[0m15:03:55.577180 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1060[0m in 73.28s]
[0m15:03:55.579159 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m15:03:55.582197 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.582819 [debug] [MainThread]: On master: BEGIN
[0m15:03:55.583478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:55.631247 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m15:03:55.631910 [debug] [MainThread]: On master: COMMIT
[0m15:03:55.632312 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:55.632667 [debug] [MainThread]: On master: COMMIT
[0m15:03:55.635693 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m15:03:55.636305 [debug] [MainThread]: On master: Close
[0m15:03:55.637041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:55.637532 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m15:03:55.637848 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m15:03:55.638160 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m15:03:55.638429 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m15:03:55.638853 [info ] [MainThread]: 
[0m15:03:55.640179 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 54.47 seconds (174.47s).
[0m15:03:55.642828 [debug] [MainThread]: Command end result
[0m15:03:55.735810 [info ] [MainThread]: 
[0m15:03:55.737557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:55.738715 [info ] [MainThread]: 
[0m15:03:55.740106 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:03:55.741838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 175.81096, "process_user_time": 5.116117, "process_kernel_time": 0.323958, "process_mem_max_rss": "106116", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m15:03:55.742827 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:55.742524 after 175.81 seconds
[0m15:03:55.743952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb0b6be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb0965370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bae492c70>]}
[0m15:03:55.744532 [debug] [MainThread]: Flushing usage events
[0m15:03:56.408037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:48.706249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45e24a8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45e22500a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45e1cb32b0>]}


============================== 16:00:48.713380 | 10b2feb4-63b5-439d-913f-9da93bbb07b3 ==============================
[0m16:00:48.713380 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m16:00:48.714090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:00:49.107124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfe73460>]}
[0m16:00:49.259656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfda4ca0>]}
[0m16:00:49.261636 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:00:49.295573 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m16:00:49.511839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:49.512424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:49.525393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m16:00:49.587404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfa8dbe0>]}
[0m16:00:49.868207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfa7bbe0>]}
[0m16:00:49.869115 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m16:00:49.870067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfc4a790>]}
[0m16:00:49.872617 [info ] [MainThread]: 
[0m16:00:49.873510 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:00:49.873859 [info ] [MainThread]: 
[0m16:00:49.874563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:49.885442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m16:00:49.896686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m16:00:50.002565 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m16:00:50.003152 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:50.004754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:50.003829 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m16:00:50.006092 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:50.006768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:50.055242 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.050 seconds
[0m16:00:50.055971 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.049 seconds
[0m16:00:50.060624 [debug] [ThreadPool]: On list_lab08_db: Close
[0m16:00:50.064269 [debug] [ThreadPool]: On list_lab08_db: Close
[0m16:00:50.068837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m16:00:50.070736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m16:00:50.088521 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m16:00:50.095863 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m16:00:50.097346 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m16:00:50.101692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:50.102617 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m16:00:50.103964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:50.143134 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m16:00:50.143742 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m16:00:50.144256 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m16:00:50.150790 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m16:00:50.152148 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m16:00:50.152782 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m16:00:50.153898 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m16:00:50.156734 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m16:00:50.159837 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m16:00:50.162035 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m16:00:50.164325 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m16:00:50.168507 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m16:00:50.182132 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:50.182880 [debug] [MainThread]: On master: BEGIN
[0m16:00:50.183400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:50.227788 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m16:00:50.229177 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:50.230107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:00:50.244332 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m16:00:50.246782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de99c220>]}
[0m16:00:50.247634 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:50.251000 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:50.251875 [debug] [MainThread]: On master: BEGIN
[0m16:00:50.257656 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:00:50.258495 [debug] [MainThread]: On master: COMMIT
[0m16:00:50.258995 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:50.259380 [debug] [MainThread]: On master: COMMIT
[0m16:00:50.262163 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:00:50.262938 [debug] [MainThread]: On master: Close
[0m16:00:50.270325 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m16:00:50.271416 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m16:00:50.274314 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m16:00:50.277681 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m16:00:50.278694 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m16:00:50.279426 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m16:00:50.274911 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m16:00:50.276525 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m16:00:50.295828 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m16:00:50.287407 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m16:00:50.273212 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m16:00:50.301873 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m16:00:50.313139 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m16:00:50.334063 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m16:00:50.326349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m16:00:50.346577 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m16:00:50.344966 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m16:00:50.323188 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m16:00:50.343342 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m16:00:50.362836 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m16:00:50.361287 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m16:00:50.365423 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m16:00:50.359913 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m16:00:50.409636 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m16:00:50.720565 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:00:50.730426 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:00:50.733972 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp160050609439"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m16:00:50.734807 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:00:50.726266 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:00:50.736487 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp160050620411"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m16:00:50.737152 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:00:50.733244 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp160050616112"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m16:00:50.738465 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:00:50.732006 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:00:50.740235 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp160050584813"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m16:00:50.742244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:02:05.737947 [debug] [Thread-3  ]: SQL status: SELECT 15966 in 75.001 seconds
[0m16:02:05.767746 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:05.768572 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m16:02:05.775575 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m16:02:05.776386 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:05.777170 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp160050620411'
        
      order by ordinal_position

  
[0m16:02:05.794372 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.016 seconds
[0m16:02:05.807303 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:05.808458 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:05.819779 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m16:02:05.837209 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:05.838138 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:05.845740 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m16:02:05.874410 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m16:02:05.875604 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:05.876182 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp160050620411"
    )


  
[0m16:02:05.905341 [debug] [Thread-3  ]: SQL status: INSERT 0 15966 in 0.028 seconds
[0m16:02:05.931976 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m16:02:05.932679 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m16:02:05.933276 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m16:02:05.950841 [debug] [Thread-3  ]: SQL status: COMMIT in 0.017 seconds
[0m16:02:05.958481 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m16:02:05.961336 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de5df190>]}
[0m16:02:05.964569 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 15966[0m in 75.68s]
[0m16:02:05.965883 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m16:02:13.622625 [debug] [Thread-4  ]: SQL status: SELECT 15966 in 82.884 seconds
[0m16:02:13.630145 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:13.631220 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m16:02:13.634618 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m16:02:13.636942 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:13.637798 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp160050616112'
        
      order by ordinal_position

  
[0m16:02:13.651350 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m16:02:13.783989 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:13.785556 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:13.792941 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m16:02:13.801076 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:13.801735 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:13.808497 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m16:02:13.812947 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m16:02:13.814473 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:13.815158 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp160050616112"
    )


  
[0m16:02:13.857964 [debug] [Thread-4  ]: SQL status: INSERT 0 15966 in 0.042 seconds
[0m16:02:13.861076 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m16:02:13.862143 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m16:02:13.866124 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m16:02:13.885964 [debug] [Thread-4  ]: SQL status: COMMIT in 0.019 seconds
[0m16:02:13.887667 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m16:02:13.889070 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de9905b0>]}
[0m16:02:13.890882 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 15966[0m in 83.58s]
[0m16:02:13.892865 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m16:02:14.896633 [debug] [Thread-2  ]: SQL status: SELECT 15966 in 84.162 seconds
[0m16:02:14.902826 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:14.903571 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m16:02:14.906851 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m16:02:14.907656 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:14.908304 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp160050609439'
        
      order by ordinal_position

  
[0m16:02:14.921239 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m16:02:14.927662 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:14.928653 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:14.935943 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m16:02:14.947911 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:14.949243 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:14.957203 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m16:02:14.966376 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m16:02:14.969402 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:14.970085 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp160050609439"
    )


  
[0m16:02:14.997247 [debug] [Thread-2  ]: SQL status: INSERT 0 15966 in 0.025 seconds
[0m16:02:15.000697 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m16:02:15.001960 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m16:02:15.002863 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m16:02:15.025450 [debug] [Thread-2  ]: SQL status: COMMIT in 0.020 seconds
[0m16:02:15.028215 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m16:02:15.030805 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de5df880>]}
[0m16:02:15.032533 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 15966[0m in 84.74s]
[0m16:02:15.034564 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m16:02:17.609660 [debug] [Thread-1  ]: SQL status: SELECT 15966 in 86.867 seconds
[0m16:02:17.624337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:17.625675 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m16:02:17.629031 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m16:02:17.629900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:17.630727 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp160050584813'
        
      order by ordinal_position

  
[0m16:02:17.646878 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.015 seconds
[0m16:02:17.652292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:17.653147 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:17.660231 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m16:02:17.668991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:17.669754 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m16:02:17.678300 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m16:02:17.684114 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m16:02:17.685224 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:17.685865 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp160050584813"
    )


  
[0m16:02:17.785537 [debug] [Thread-1  ]: SQL status: INSERT 0 15966 in 0.099 seconds
[0m16:02:17.788739 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m16:02:17.789440 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m16:02:17.790115 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m16:02:17.813248 [debug] [Thread-1  ]: SQL status: COMMIT in 0.022 seconds
[0m16:02:17.815832 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m16:02:17.817840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de58e250>]}
[0m16:02:17.819133 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 15966[0m in 87.49s]
[0m16:02:17.820971 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m16:02:17.822215 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m16:02:17.823352 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m16:02:17.824280 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m16:02:17.825007 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m16:02:17.830948 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m16:02:17.832108 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m16:02:17.833022 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m16:02:17.833727 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m16:02:17.847022 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m16:02:17.853047 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m16:02:17.852081 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m16:02:17.865438 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m16:02:17.875020 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:02:17.879451 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:02:17.884931 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp160217861532"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m16:02:17.885896 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:02:17.883274 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp160217871539"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m16:02:17.886902 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:03:15.006390 [debug] [Thread-3  ]: SQL status: SELECT 15966 in 57.120 seconds
[0m16:03:15.012648 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:15.013482 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m16:03:15.020752 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m16:03:15.021793 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:15.022611 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp160217861532'
        
      order by ordinal_position

  
[0m16:03:15.057171 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.034 seconds
[0m16:03:15.064866 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:15.065816 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:15.081207 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.014 seconds
[0m16:03:15.092551 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:15.093379 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:15.102711 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.009 seconds
[0m16:03:15.108331 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m16:03:15.109582 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:15.110524 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp160217861532"
    )


  
[0m16:03:15.161732 [debug] [Thread-3  ]: SQL status: INSERT 0 15966 in 0.050 seconds
[0m16:03:15.164566 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m16:03:15.165131 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m16:03:15.165725 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m16:03:15.221225 [debug] [Thread-3  ]: SQL status: COMMIT in 0.055 seconds
[0m16:03:15.223082 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m16:03:15.224606 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfdd33d0>]}
[0m16:03:15.225996 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 15966[0m in 57.40s]
[0m16:03:15.226966 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m16:03:28.714835 [debug] [Thread-4  ]: SQL status: SELECT 904 in 70.828 seconds
[0m16:03:28.723435 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:28.724790 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m16:03:28.728836 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m16:03:28.729661 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:28.730480 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp160217871539'
        
      order by ordinal_position

  
[0m16:03:28.750364 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.019 seconds
[0m16:03:28.757458 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:28.758416 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:28.768769 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.010 seconds
[0m16:03:28.778158 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:28.779435 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m16:03:28.789581 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.009 seconds
[0m16:03:28.793895 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m16:03:28.795977 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:28.797085 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp160217871539"
    )


  
[0m16:03:28.812145 [debug] [Thread-4  ]: SQL status: INSERT 0 904 in 0.014 seconds
[0m16:03:28.816622 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m16:03:28.817843 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m16:03:28.818639 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m16:03:28.826998 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m16:03:28.831285 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m16:03:28.833207 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10b2feb4-63b5-439d-913f-9da93bbb07b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45e1c4f280>]}
[0m16:03:28.834701 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 904[0m in 71.00s]
[0m16:03:28.837536 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m16:03:28.839968 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:28.840859 [debug] [MainThread]: On master: BEGIN
[0m16:03:28.841632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:28.886070 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m16:03:28.886971 [debug] [MainThread]: On master: COMMIT
[0m16:03:28.888037 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:28.889071 [debug] [MainThread]: On master: COMMIT
[0m16:03:28.892061 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:03:28.893289 [debug] [MainThread]: On master: Close
[0m16:03:28.894305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:28.894790 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m16:03:28.895189 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m16:03:28.896171 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m16:03:28.896698 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m16:03:28.897654 [info ] [MainThread]: 
[0m16:03:28.899340 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 39.02 seconds (159.02s).
[0m16:03:28.903351 [debug] [MainThread]: Command end result
[0m16:03:28.980347 [info ] [MainThread]: 
[0m16:03:28.983385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:28.985451 [info ] [MainThread]: 
[0m16:03:28.987133 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:03:28.991380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 160.37093, "process_user_time": 4.566505, "process_kernel_time": 0.382253, "process_mem_max_rss": "105976", "process_in_blocks": "6160", "process_out_blocks": "2112"}
[0m16:03:28.992833 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:28.992276 after 160.37 seconds
[0m16:03:28.993615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45e24a8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfe73460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfa1a220>]}
[0m16:03:28.994284 [debug] [MainThread]: Flushing usage events
[0m16:03:29.724440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:02.357862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9761be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a973e59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a96e24a00>]}


============================== 17:01:02.369715 | d43c31fe-502c-4c74-9da5-5ff38492014e ==============================
[0m17:01:02.369715 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m17:01:02.373398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:01:02.794701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a94f3fc70>]}
[0m17:01:02.995030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a96f41f70>]}
[0m17:01:02.997791 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:01:03.056362 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m17:01:03.454377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:03.455014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:03.466186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.ods.meta
- models.dbt_lab08_project.dm.meta
[0m17:01:03.538635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a94bbdbb0>]}
[0m17:01:03.765057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a94c2cbb0>]}
[0m17:01:03.766094 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m17:01:03.767576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a94deafd0>]}
[0m17:01:03.771169 [info ] [MainThread]: 
[0m17:01:03.772010 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m17:01:03.772609 [info ] [MainThread]: 
[0m17:01:03.773684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:01:03.784934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:01:03.807024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m17:01:03.903040 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:01:03.903713 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m17:01:03.906042 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:01:03.906714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:03.905572 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m17:01:03.907654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:03.973398 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.066 seconds
[0m17:01:03.976172 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:01:03.983198 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.075 seconds
[0m17:01:03.987572 [debug] [ThreadPool]: On list_lab08_db: Close
[0m17:01:03.993775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m17:01:04.008065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m17:01:04.022876 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:01:04.028734 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:01:04.030377 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m17:01:04.030971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:04.029794 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m17:01:04.033364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:04.083760 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m17:01:04.085195 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m17:01:04.085899 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m17:01:04.086475 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m17:01:04.087053 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m17:01:04.087509 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m17:01:04.102366 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m17:01:04.105742 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m17:01:04.106735 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.020 seconds
[0m17:01:04.112694 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m17:01:04.116784 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m17:01:04.119062 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m17:01:04.138667 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.139708 [debug] [MainThread]: On master: BEGIN
[0m17:01:04.140941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:04.174868 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m17:01:04.176027 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.177056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:01:04.192968 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m17:01:04.195353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a943109a0>]}
[0m17:01:04.196133 [debug] [MainThread]: On master: ROLLBACK
[0m17:01:04.198963 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.200084 [debug] [MainThread]: On master: BEGIN
[0m17:01:04.206847 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:01:04.207998 [debug] [MainThread]: On master: COMMIT
[0m17:01:04.208594 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:04.209398 [debug] [MainThread]: On master: COMMIT
[0m17:01:04.211953 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:01:04.212693 [debug] [MainThread]: On master: Close
[0m17:01:04.220224 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m17:01:04.221095 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m17:01:04.224166 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m17:01:04.226816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m17:01:04.227471 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m17:01:04.221863 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m17:01:04.225719 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m17:01:04.241051 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m17:01:04.244080 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m17:01:04.234756 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m17:01:04.251192 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m17:01:04.222474 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m17:01:04.268509 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m17:01:04.280761 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m17:01:04.290379 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m17:01:04.281819 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m17:01:04.288581 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m17:01:04.299119 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m17:01:04.301170 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m17:01:04.332748 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m17:01:04.374818 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m17:01:04.385126 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m17:01:04.436280 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m17:01:04.443527 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m17:01:04.529553 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:01:04.533911 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:01:04.536110 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:01:04.539376 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:01:04.540224 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp170104451292"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m17:01:04.542462 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp170104432581"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m17:01:04.544368 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp170104382031"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m17:01:04.545703 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp170104395373"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m17:01:04.547159 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:01:04.548203 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:01:04.549334 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:01:04.550026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:02:21.378613 [debug] [Thread-3  ]: SQL status: SELECT 18621 in 76.830 seconds
[0m17:02:21.410592 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:02:21.411400 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m17:02:21.414697 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m17:02:21.415417 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:02:21.418191 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp170104432581'
        
      order by ordinal_position

  
[0m17:02:21.544368 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.125 seconds
[0m17:02:21.556463 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:02:21.557702 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:21.575541 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.017 seconds
[0m17:02:21.593459 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:02:21.595198 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:21.606236 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m17:02:21.635525 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m17:02:21.637269 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:02:21.638158 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp170104432581"
    )


  
[0m17:02:21.704576 [debug] [Thread-3  ]: SQL status: INSERT 0 18621 in 0.066 seconds
[0m17:02:21.761848 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m17:02:21.762849 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m17:02:21.763482 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m17:02:21.799677 [debug] [Thread-3  ]: SQL status: COMMIT in 0.034 seconds
[0m17:02:21.803017 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m17:02:21.806218 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8f717a90>]}
[0m17:02:21.809578 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 18621[0m in 77.55s]
[0m17:02:21.810940 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m17:02:29.664653 [debug] [Thread-2  ]: SQL status: SELECT 18621 in 85.115 seconds
[0m17:02:29.671540 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:02:29.672461 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m17:02:29.676475 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m17:02:29.677374 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:02:29.678230 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp170104382031'
        
      order by ordinal_position

  
[0m17:02:29.691190 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m17:02:29.697279 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:02:29.698189 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:29.707241 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m17:02:29.715556 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:02:29.716306 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:29.723068 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m17:02:29.728067 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m17:02:29.729270 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:02:29.729874 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp170104382031"
    )


  
[0m17:02:29.765830 [debug] [Thread-2  ]: SQL status: INSERT 0 18621 in 0.035 seconds
[0m17:02:29.769227 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m17:02:29.770075 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m17:02:29.770694 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m17:02:29.795643 [debug] [Thread-2  ]: SQL status: COMMIT in 0.023 seconds
[0m17:02:29.797629 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m17:02:29.798801 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8f717a30>]}
[0m17:02:29.799970 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 18621[0m in 85.56s]
[0m17:02:29.801182 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m17:02:29.815866 [debug] [Thread-4  ]: SQL status: SELECT 18621 in 85.268 seconds
[0m17:02:29.825299 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:02:29.826227 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m17:02:29.829380 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m17:02:29.830125 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:02:29.830628 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp170104451292'
        
      order by ordinal_position

  
[0m17:02:29.845593 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m17:02:29.936640 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:02:29.937277 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:29.944534 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m17:02:29.952137 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:02:29.953068 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:29.960450 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m17:02:29.965053 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m17:02:29.968943 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:02:29.969628 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp170104451292"
    )


  
[0m17:02:30.006555 [debug] [Thread-4  ]: SQL status: INSERT 0 18621 in 0.036 seconds
[0m17:02:30.008985 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m17:02:30.009643 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m17:02:30.010738 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m17:02:30.028801 [debug] [Thread-4  ]: SQL status: COMMIT in 0.017 seconds
[0m17:02:30.030661 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m17:02:30.032277 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8f679430>]}
[0m17:02:30.034038 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 18621[0m in 85.73s]
[0m17:02:30.035107 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m17:02:35.388901 [debug] [Thread-1  ]: SQL status: SELECT 18621 in 90.839 seconds
[0m17:02:35.398107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:02:35.399168 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m17:02:35.403283 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m17:02:35.404057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:02:35.404783 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp170104395373'
        
      order by ordinal_position

  
[0m17:02:35.416687 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m17:02:35.423097 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:02:35.424059 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:35.430869 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m17:02:35.437202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:02:35.438027 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m17:02:35.444760 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m17:02:35.450642 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m17:02:35.452758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:02:35.454194 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp170104395373"
    )


  
[0m17:02:35.529126 [debug] [Thread-1  ]: SQL status: INSERT 0 18621 in 0.074 seconds
[0m17:02:35.532662 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m17:02:35.533515 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m17:02:35.534000 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m17:02:35.562472 [debug] [Thread-1  ]: SQL status: COMMIT in 0.027 seconds
[0m17:02:35.564081 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m17:02:35.565668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8f662a00>]}
[0m17:02:35.566729 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 18621[0m in 91.34s]
[0m17:02:35.567677 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m17:02:35.569762 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m17:02:35.570526 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m17:02:35.573482 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m17:02:35.574188 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m17:02:35.574835 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m17:02:35.571744 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m17:02:35.584135 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m17:02:35.585980 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m17:02:35.587324 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m17:02:35.588813 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m17:02:35.599071 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:02:35.607981 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m17:02:35.609069 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp170235593922"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m17:02:35.610456 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m17:02:35.611051 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:02:35.621521 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:02:35.622853 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp170235618005"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m17:02:35.624107 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:03:38.858559 [debug] [Thread-3  ]: SQL status: SELECT 18621 in 63.234 seconds
[0m17:03:38.866807 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:03:38.867979 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m17:03:38.873881 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m17:03:38.875066 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:03:38.875609 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp170235618005'
        
      order by ordinal_position

  
[0m17:03:38.891009 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.014 seconds
[0m17:03:38.899233 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:03:38.899991 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:03:38.907359 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m17:03:38.917469 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:03:38.918253 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:03:38.928761 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m17:03:38.933986 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m17:03:38.935794 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:03:38.937019 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp170235618005"
    )


  
[0m17:03:38.966757 [debug] [Thread-3  ]: SQL status: INSERT 0 18621 in 0.029 seconds
[0m17:03:38.971762 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m17:03:38.972856 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m17:03:38.974261 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m17:03:38.990115 [debug] [Thread-3  ]: SQL status: COMMIT in 0.015 seconds
[0m17:03:38.991713 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m17:03:38.993355 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8f717b20>]}
[0m17:03:38.994436 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 18621[0m in 63.41s]
[0m17:03:38.995178 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m17:03:53.162528 [debug] [Thread-2  ]: SQL status: SELECT 1092 in 77.551 seconds
[0m17:03:53.170671 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:03:53.171564 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m17:03:53.174505 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m17:03:53.175760 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:03:53.176849 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp170235593922'
        
      order by ordinal_position

  
[0m17:03:53.190375 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.013 seconds
[0m17:03:53.199374 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:03:53.200370 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:03:53.207393 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m17:03:53.224232 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:03:53.225383 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m17:03:53.232292 [debug] [Thread-2  ]: SQL status: SELECT 17 in 0.006 seconds
[0m17:03:53.237685 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m17:03:53.238975 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:03:53.239639 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp170235593922"
    )


  
[0m17:03:53.248366 [debug] [Thread-2  ]: SQL status: INSERT 0 1092 in 0.008 seconds
[0m17:03:53.251437 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m17:03:53.252342 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m17:03:53.253763 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m17:03:53.260911 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m17:03:53.263653 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m17:03:53.265996 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43c31fe-502c-4c74-9da5-5ff38492014e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8cc7e940>]}
[0m17:03:53.267515 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1092[0m in 77.69s]
[0m17:03:53.270209 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m17:03:53.274377 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:53.275190 [debug] [MainThread]: On master: BEGIN
[0m17:03:53.275855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:53.312197 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m17:03:53.313335 [debug] [MainThread]: On master: COMMIT
[0m17:03:53.313856 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:53.314244 [debug] [MainThread]: On master: COMMIT
[0m17:03:53.317069 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:03:53.317912 [debug] [MainThread]: On master: Close
[0m17:03:53.318880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:53.319607 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m17:03:53.320051 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m17:03:53.320521 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m17:03:53.320967 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m17:03:53.321696 [info ] [MainThread]: 
[0m17:03:53.322911 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 49.55 seconds (169.55s).
[0m17:03:53.325802 [debug] [MainThread]: Command end result
[0m17:03:53.378305 [info ] [MainThread]: 
[0m17:03:53.380059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:53.381366 [info ] [MainThread]: 
[0m17:03:53.382569 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:03:53.385125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 171.37717, "process_user_time": 4.993791, "process_kernel_time": 0.409976, "process_mem_max_rss": "105908", "process_out_blocks": "2104", "process_in_blocks": "0"}
[0m17:03:53.386100 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:53.385889 after 171.38 seconds
[0m17:03:53.386785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9761be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9742d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a94b8a2e0>]}
[0m17:03:53.387452 [debug] [MainThread]: Flushing usage events
[0m17:03:54.025065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:07.047176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78b305e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78c3e4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a5f25b0>]}


============================== 18:01:07.055726 | a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23 ==============================
[0m18:01:07.055726 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m18:01:07.056812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:07.371073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb788c2cbb0>]}
[0m18:01:07.517976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a602700>]}
[0m18:01:07.520545 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:01:07.596398 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m18:01:07.921312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:07.922262 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:07.940031 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_lab08_project.dm.meta
- models.dbt_lab08_project.ods.meta
[0m18:01:08.022582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7888a7b80>]}
[0m18:01:08.232181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb788916b80>]}
[0m18:01:08.233276 [info ] [MainThread]: Found 6 models, 4 sources, 424 macros
[0m18:01:08.233850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb788ad5df0>]}
[0m18:01:08.238733 [info ] [MainThread]: 
[0m18:01:08.239284 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m18:01:08.239728 [info ] [MainThread]: 
[0m18:01:08.240599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:01:08.249485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m18:01:08.266495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m18:01:08.349698 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m18:01:08.350902 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m18:01:08.351844 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m18:01:08.353497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:08.352439 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m18:01:08.354499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:08.393041 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.039 seconds
[0m18:01:08.395943 [debug] [ThreadPool]: On list_lab08_db: Close
[0m18:01:08.397006 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.042 seconds
[0m18:01:08.402314 [debug] [ThreadPool]: On list_lab08_db: Close
[0m18:01:08.405738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm_dev)
[0m18:01:08.418592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods_dev)
[0m18:01:08.429814 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m18:01:08.433675 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m18:01:08.434799 [debug] [ThreadPool]: On list_lab08_db_dm_dev: BEGIN
[0m18:01:08.435546 [debug] [ThreadPool]: On list_lab08_db_ods_dev: BEGIN
[0m18:01:08.436247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:08.437050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:08.467035 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m18:01:08.467782 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm_dev"
[0m18:01:08.468379 [debug] [ThreadPool]: On list_lab08_db_dm_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm_dev'
  
[0m18:01:08.476458 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m18:01:08.479413 [debug] [ThreadPool]: On list_lab08_db_dm_dev: ROLLBACK
[0m18:01:08.480854 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m18:01:08.481392 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods_dev"
[0m18:01:08.481912 [debug] [ThreadPool]: On list_lab08_db_dm_dev: Close
[0m18:01:08.482529 [debug] [ThreadPool]: On list_lab08_db_ods_dev: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods_dev"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods_dev'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods_dev'
  
[0m18:01:08.491190 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m18:01:08.494483 [debug] [ThreadPool]: On list_lab08_db_ods_dev: ROLLBACK
[0m18:01:08.498082 [debug] [ThreadPool]: On list_lab08_db_ods_dev: Close
[0m18:01:08.508454 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:08.509015 [debug] [MainThread]: On master: BEGIN
[0m18:01:08.509852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:08.541731 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m18:01:08.542367 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:08.543322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:01:08.553612 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m18:01:08.555792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb788c7ef40>]}
[0m18:01:08.556569 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:08.558949 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:08.559873 [debug] [MainThread]: On master: BEGIN
[0m18:01:08.563790 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:01:08.564582 [debug] [MainThread]: On master: COMMIT
[0m18:01:08.565150 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:08.565686 [debug] [MainThread]: On master: COMMIT
[0m18:01:08.567652 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:01:08.568573 [debug] [MainThread]: On master: Close
[0m18:01:08.573175 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m18:01:08.573926 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods_dev.ods_browser_events .................. [RUN]
[0m18:01:08.575305 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods_dev, now model.dbt_lab08_project.ods_browser_events)
[0m18:01:08.576039 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m18:01:08.577900 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods_dev.ods_device_events ................... [RUN]
[0m18:01:08.578605 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm_dev, now model.dbt_lab08_project.ods_device_events)
[0m18:01:08.579142 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m18:01:08.576437 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m18:01:08.576949 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m18:01:08.586140 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m18:01:08.588841 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods_dev.ods_location_events ................. [RUN]
[0m18:01:08.589598 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m18:01:08.590606 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m18:01:08.587183 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods_dev.ods_geo_events ...................... [RUN]
[0m18:01:08.592408 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m18:01:08.592924 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m18:01:08.650389 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m18:01:08.652300 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m18:01:08.657622 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m18:01:08.656248 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m18:01:08.653288 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m18:01:08.670010 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m18:01:08.707265 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m18:01:08.708196 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m18:01:09.062876 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:01:09.065472 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:01:09.081028 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp180108885453"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'event_id')::uuid event_id,
        json_data->>'page_url' page_url,
        json_data->>'page_url_path' page_url_path,
        json_data->>'referer_url' referer_url,
        json_data->>'referer_medium' referer_medium,
        json_data->>'utm_medium' utm_medium,
        json_data->>'utm_source' utm_source,
        json_data->>'utm_content' utm_content,
        json_data->>'utm_campaign' utm_campaign
  from "lab08_db"."stg"."stg_location_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_location_events")

  );
  
  
[0m18:01:09.079331 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp180108896135"
  
  
    as
  
  (
    select  load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        json_data->>'os' os,
        json_data->>'os_name' os_name,
        json_data->>'os_timezone' os_timezone,
        json_data->>'device_type' device_type,
        (json_data->>'device_is_mobile')::bool device_is_mobile,
        json_data->>'user_custom_id' user_custom_id,
        (json_data->>'user_domain_id')::uuid user_domain_id
  from "lab08_db"."stg"."stg_device_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_device_events")

  );
  
  
[0m18:01:09.087493 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:01:09.078013 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:01:09.089974 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp180108880788"
  
  
    as
  
  (
    select load_dttm load_hour,
       (json_data->>'click_id')::uuid click_id,
        (json_data->>'geo_latitude')::float geo_latitude,
        (json_data->>'geo_longitude')::float geo_longitude,
        json_data->>'geo_country' geo_country,
        json_data->>'geo_timezone' geo_timezone,
        json_data->>'geo_region_name' geo_region_name,
        json_data->>'ip_address' ip_address
  from "lab08_db"."stg"."stg_geo_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_geo_events")

  );
  
  
[0m18:01:09.090993 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:01:09.074473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:01:09.093322 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp180108871426"
  
  
    as
  
  (
    select load_dttm as load_hour,
       (json_data->>'event_id')::uuid event_id,
       (json_data->>'event_timestamp')::timestamp event_timestamp,
       json_data->>'event_type' event_type,
       (json_data->>'click_id')::uuid click_id,
       json_data->>'browser_name' browser_name,
       json_data->>'browser_user_agent' browser_user_agent,
       json_data->>'browser_language' browser_language
  from "lab08_db"."stg"."stg_browser_events"


WHERE load_dttm > (select coalesce(max(load_hour), '1900-01-01')
 FROM "lab08_db"."ods_dev"."ods_browser_events")

  );
  
  
[0m18:01:09.094342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:09.083494 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:02:19.817527 [debug] [Thread-3  ]: SQL status: SELECT 20440 in 70.726 seconds
[0m18:02:19.845722 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:19.846437 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m18:02:19.850748 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m18:02:19.851399 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:19.851964 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp180108880788'
        
      order by ordinal_position

  
[0m18:02:19.870948 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.018 seconds
[0m18:02:19.882412 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:19.883161 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:19.891466 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.008 seconds
[0m18:02:19.905706 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:19.906404 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:19.915885 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.009 seconds
[0m18:02:19.934425 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m18:02:19.935392 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:19.935890 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods_dev"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp180108880788"
    )


  
[0m18:02:19.978464 [debug] [Thread-3  ]: SQL status: INSERT 0 20440 in 0.042 seconds
[0m18:02:20.014897 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m18:02:20.016144 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m18:02:20.016887 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m18:02:20.041197 [debug] [Thread-3  ]: SQL status: COMMIT in 0.024 seconds
[0m18:02:20.045863 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m18:02:20.049484 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb783426a60>]}
[0m18:02:20.050647 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods_dev.ods_geo_events ................. [[32mINSERT 0 20440[0m in 71.45s]
[0m18:02:20.051658 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m18:02:30.185099 [debug] [Thread-4  ]: SQL status: SELECT 20440 in 81.102 seconds
[0m18:02:30.191010 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:30.191650 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m18:02:30.197490 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m18:02:30.198348 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:30.199326 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp180108885453'
        
      order by ordinal_position

  
[0m18:02:30.228516 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.029 seconds
[0m18:02:30.237975 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:30.238838 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:30.250326 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.011 seconds
[0m18:02:30.345672 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:30.346688 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:30.355871 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m18:02:30.359991 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m18:02:30.361535 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:30.362204 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods_dev"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp180108885453"
    )


  
[0m18:02:30.407399 [debug] [Thread-4  ]: SQL status: INSERT 0 20440 in 0.044 seconds
[0m18:02:30.411157 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m18:02:30.412279 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m18:02:30.413324 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m18:02:30.435660 [debug] [Thread-4  ]: SQL status: COMMIT in 0.021 seconds
[0m18:02:30.437205 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m18:02:30.438200 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb788bf9970>]}
[0m18:02:30.439124 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods_dev.ods_location_events ............ [[32mINSERT 0 20440[0m in 81.85s]
[0m18:02:30.440075 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m18:02:31.594385 [debug] [Thread-2  ]: SQL status: SELECT 20440 in 82.507 seconds
[0m18:02:31.600973 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:31.601567 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m18:02:31.604588 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m18:02:31.605214 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:31.605648 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp180108896135'
        
      order by ordinal_position

  
[0m18:02:31.621359 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.015 seconds
[0m18:02:31.628375 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:31.629107 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:31.636280 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m18:02:31.643268 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:31.643856 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:31.650672 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m18:02:31.654581 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m18:02:31.655752 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:31.656450 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods_dev"."ods_device_events" ("load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id")
    (
        select "load_hour", "click_id", "os", "os_name", "os_timezone", "device_type", "device_is_mobile", "user_custom_id", "user_domain_id"
        from "ods_device_events__dbt_tmp180108896135"
    )


  
[0m18:02:31.698126 [debug] [Thread-2  ]: SQL status: INSERT 0 20440 in 0.040 seconds
[0m18:02:31.701116 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m18:02:31.701910 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m18:02:31.702597 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m18:02:31.728212 [debug] [Thread-2  ]: SQL status: COMMIT in 0.025 seconds
[0m18:02:31.730255 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m18:02:31.731600 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb783426820>]}
[0m18:02:31.732991 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods_dev.ods_device_events .............. [[32mINSERT 0 20440[0m in 83.15s]
[0m18:02:31.733965 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m18:02:33.062644 [debug] [Thread-1  ]: SQL status: SELECT 20440 in 83.968 seconds
[0m18:02:33.069072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:33.069662 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m18:02:33.076502 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m18:02:33.077583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:33.079191 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp180108871426'
        
      order by ordinal_position

  
[0m18:02:33.101273 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.021 seconds
[0m18:02:33.107525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:33.108553 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:33.118809 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m18:02:33.128427 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:33.129750 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods_dev'
        
      order by ordinal_position

  
[0m18:02:33.136918 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m18:02:33.142749 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m18:02:33.145704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:33.146513 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods_dev"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "event_type", "click_id", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp180108871426"
    )


  
[0m18:02:33.204909 [debug] [Thread-1  ]: SQL status: INSERT 0 20440 in 0.058 seconds
[0m18:02:33.209268 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m18:02:33.209865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m18:02:33.210353 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m18:02:33.237050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.025 seconds
[0m18:02:33.239192 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m18:02:33.240418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb783373430>]}
[0m18:02:33.241835 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods_dev.ods_browser_events ............. [[32mINSERT 0 20440[0m in 84.67s]
[0m18:02:33.245225 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m18:02:33.247070 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m18:02:33.248373 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm_dev.dm_events ............................ [RUN]
[0m18:02:33.247635 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m18:02:33.250804 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm_dev.dm_sales ............................. [RUN]
[0m18:02:33.251989 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m18:02:33.252494 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m18:02:33.249677 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m18:02:33.262402 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m18:02:33.273255 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m18:02:33.274555 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m18:02:33.276128 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m18:02:33.285483 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:02:33.286883 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m18:02:33.288400 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp180233282065"
  
  
    as
  
  (
    WITH unique_devices AS (
    SELECT DISTINCT
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    FROM "lab08_db"."ods_dev"."ods_device_events"
),

unique_geo AS (
    SELECT DISTINCT
        click_id,
        geo_country,
        geo_region_name
    FROM "lab08_db"."ods_dev"."ods_geo_events"
),

cte_lead AS (
    SELECT
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        LEAD(page_url_path, 1) OVER w AS next_page_lead1,
        LEAD(page_url_path, 2) OVER w AS next_page_lead2,
        LEAD(page_url_path, 3) OVER w AS next_page_lead3,
        LEAD(event_timestamp, 3) OVER w AS confirmation_timestamp
    FROM "lab08_db"."ods_dev"."ods_location_events" AS ole
    INNER JOIN
        "lab08_db"."ods_dev"."ods_browser_events" AS obe
        ON ole.event_id = obe.event_id
    INNER JOIN unique_devices AS ud ON obe.click_id = ud.click_id
    INNER JOIN unique_geo AS ug ON obe.click_id = ug.click_id
    WHERE
        ole.page_url_path != '/home'
        
            AND ole.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
            AND obe.load_hour
            > (SELECT COALESCE(MAX(load_hour), '1900-01-01') FROM "lab08_db"."dm_dev"."dm_sales")
        
    WINDOW w AS (
        PARTITION BY user_custom_id
        ORDER BY event_timestamp
    )
)

SELECT
    load_hour,
    user_custom_id AS sale_custom_id,
    event_timestamp,
    confirmation_timestamp AS sale_timestamp,
    1 AS sale_item_cnt,
    browser_name AS sale_browser,
    device_type AS sale_platform,
    page_url_path AS sale_page_before,
    utm_source AS sale_source,
    utm_campaign AS sale_utm_campaign,
    referer_url AS sale_referer_url,
    referer_medium AS sale_referer_medium,
    utm_content AS sale_utm_content,
    geo_country AS sale_geo_country,
    geo_region_name AS sale_geo_region_name,
    EXTRACT(HOUR FROM confirmation_timestamp) AS sale_hour,
    REPLACE(page_url_path, '/product_', '') AS clear_sale_page_before
FROM cte_lead
WHERE
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    AND page_url_path NOT IN ('/payment', '/cart')
  );
  
  
[0m18:02:33.298055 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:02:33.302791 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:02:33.311225 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp180233294562"
  
  
    as
  
  (
    WITH distinct_clicks AS (
    SELECT DISTINCT
        click_id,
        device_type
    FROM "lab08_db"."ods_dev"."ods_device_events"
)

SELECT
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(HOUR FROM e.event_timestamp) AS event_hour
FROM "lab08_db"."ods_dev"."ods_browser_events" AS e
INNER JOIN distinct_clicks AS d ON e.click_id = d.click_id

    WHERE load_hour > (
        SELECT COALESCE(MAX(load_hour), '1900-01-01')
        FROM "lab08_db"."dm_dev"."dm_events"
    )

  );
  
  
[0m18:02:33.312554 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:03:34.114322 [debug] [Thread-3  ]: SQL status: SELECT 20440 in 60.802 seconds
[0m18:03:34.120553 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:34.121317 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m18:03:34.124916 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m18:03:34.125904 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:34.126766 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp180233294562'
        
      order by ordinal_position

  
[0m18:03:34.141079 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.013 seconds
[0m18:03:34.154893 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:34.156268 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:34.163227 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m18:03:34.173488 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:34.175158 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:34.183105 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m18:03:34.188062 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m18:03:34.190251 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:34.191214 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm_dev"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp180233294562"
    )


  
[0m18:03:34.277637 [debug] [Thread-3  ]: SQL status: INSERT 0 20440 in 0.085 seconds
[0m18:03:34.280607 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m18:03:34.281393 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m18:03:34.282575 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m18:03:34.381625 [debug] [Thread-3  ]: SQL status: COMMIT in 0.098 seconds
[0m18:03:34.384392 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m18:03:34.385911 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb780b2ad90>]}
[0m18:03:34.387181 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm_dev.dm_events ....................... [[32mINSERT 0 20440[0m in 61.14s]
[0m18:03:34.390039 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m18:03:47.359234 [debug] [Thread-4  ]: SQL status: SELECT 1171 in 74.057 seconds
[0m18:03:47.365766 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:47.366644 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m18:03:47.369441 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m18:03:47.370395 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:47.371337 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp180233282065'
        
      order by ordinal_position

  
[0m18:03:47.383249 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.011 seconds
[0m18:03:47.391991 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:47.392670 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:47.399423 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.006 seconds
[0m18:03:47.409749 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:47.410714 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm_dev'
        
      order by ordinal_position

  
[0m18:03:47.419850 [debug] [Thread-4  ]: SQL status: SELECT 17 in 0.008 seconds
[0m18:03:47.426551 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m18:03:47.427722 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:47.428481 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm_dev"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_hour", "clear_sale_page_before"
        from "dm_sales__dbt_tmp180233282065"
    )


  
[0m18:03:47.446658 [debug] [Thread-4  ]: SQL status: INSERT 0 1171 in 0.017 seconds
[0m18:03:47.449885 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m18:03:47.450616 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m18:03:47.451150 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m18:03:47.458953 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m18:03:47.460928 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m18:03:47.463406 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bbc2a2-71e6-4e1b-b80d-8c18d3e3bc23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7834f0910>]}
[0m18:03:47.465158 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm_dev.dm_sales ........................ [[32mINSERT 0 1171[0m in 74.21s]
[0m18:03:47.467477 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m18:03:47.470082 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:47.470603 [debug] [MainThread]: On master: BEGIN
[0m18:03:47.471186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:47.508637 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m18:03:47.509794 [debug] [MainThread]: On master: COMMIT
[0m18:03:47.512500 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:47.513207 [debug] [MainThread]: On master: COMMIT
[0m18:03:47.515709 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:03:47.516405 [debug] [MainThread]: On master: Close
[0m18:03:47.517333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:47.517837 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m18:03:47.518498 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m18:03:47.519138 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m18:03:47.519788 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m18:03:47.520408 [info ] [MainThread]: 
[0m18:03:47.522074 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 39.28 seconds (159.28s).
[0m18:03:47.525577 [debug] [MainThread]: Command end result
[0m18:03:47.592617 [info ] [MainThread]: 
[0m18:03:47.594758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:47.596480 [info ] [MainThread]: 
[0m18:03:47.597953 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:03:47.600880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 160.6524, "process_user_time": 4.693837, "process_kernel_time": 0.333951, "process_mem_max_rss": "105840", "process_in_blocks": "8", "process_out_blocks": "2104"}
[0m18:03:47.601760 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:47.601574 after 160.65 seconds
[0m18:03:47.602655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78b305e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a602700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78a60f070>]}
[0m18:03:47.603465 [debug] [MainThread]: Flushing usage events
[0m18:03:48.426298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:59.779641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9017902fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9017aa10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9016cf1340>]}


============================== 18:16:59.810570 | 55c17bdf-cda2-4c2f-9f75-2130a104e796 ==============================
[0m18:16:59.810570 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m18:16:59.821653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8088', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:17:00.243515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c17bdf-cda2-4c2f-9f75-2130a104e796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9018a088b0>]}
[0m18:17:00.399262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c17bdf-cda2-4c2f-9f75-2130a104e796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f901529d340>]}
[0m18:46:59.854642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81ba3f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb819962170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb819962f80>]}


============================== 18:46:59.859315 | 4cb21c15-d62e-4d06-b516-0b77d09a1cbb ==============================
[0m18:46:59.859315 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:46:59.860361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ubuntu/project_lab08/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:46:59.872027 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m18:46:59.873359 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.094731316, "process_in_blocks": "0", "process_kernel_time": 0.12361, "process_mem_max_rss": "91476", "process_out_blocks": "16", "process_user_time": 2.513646}
[0m18:46:59.874173 [debug] [MainThread]: Command `dbt docs generate` failed at 18:46:59.874013 after 0.10 seconds
[0m18:46:59.874654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb81ba3f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8197e9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8197ea740>]}
[0m18:46:59.875582 [debug] [MainThread]: Flushing usage events
[0m18:47:48.975218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38c593250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38a4ab9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38a4a9c30>]}


============================== 18:47:48.979094 | 15ac9db1-fa18-4184-ac6b-70c8ad571143 ==============================
[0m18:47:48.979094 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:47:48.980158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir ./', 'send_anonymous_usage_stats': 'True'}
[0m18:47:48.988983 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m18:47:48.990928 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.108418524, "process_in_blocks": "0", "process_kernel_time": 0.12677, "process_mem_max_rss": "91548", "process_out_blocks": "8", "process_user_time": 2.141369}
[0m18:47:48.991966 [debug] [MainThread]: Command `dbt docs generate` failed at 18:47:48.991801 after 0.11 seconds
[0m18:47:48.992628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38c593250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38a4f1840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38a4f2680>]}
[0m18:47:48.993417 [debug] [MainThread]: Flushing usage events
[0m18:48:27.219985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f5513250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f342b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f342b580>]}


============================== 18:48:27.223769 | 0cfd6ed3-cebd-4beb-a058-404c16318b8a ==============================
[0m18:48:27.223769 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:48:27.224444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/ubuntu/project_lab08/dbt', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /home/ubuntu/project_lab08/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:27.232529 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m18:48:27.233968 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.09107838, "process_in_blocks": "0", "process_kernel_time": 0.135764, "process_mem_max_rss": "91508", "process_out_blocks": "8", "process_user_time": 2.235608}
[0m18:48:27.234709 [debug] [MainThread]: Command `dbt docs generate` failed at 18:48:27.234524 after 0.09 seconds
[0m18:48:27.235415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f5513250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f32ad870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f32ae6b0>]}
[0m18:48:27.236020 [debug] [MainThread]: Flushing usage events
[0m18:51:48.708801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e0d97250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59dec76530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59dec77370>]}


============================== 18:51:48.712679 | 64dec9c0-d6db-4610-b370-10c926717135 ==============================
[0m18:51:48.712679 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:51:48.713496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'profiles_dir': '/home/ubuntu/project_lab08/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /home/ubuntu/project_lab08/dbt --project-dir /home/ubuntu/project_lab08/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:48.721287 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m18:51:48.722548 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.08432541, "process_in_blocks": "0", "process_kernel_time": 0.10836, "process_mem_max_rss": "91488", "process_out_blocks": "16", "process_user_time": 2.203436}
[0m18:51:48.723287 [debug] [MainThread]: Command `dbt docs generate` failed at 18:51:48.723149 after 0.09 seconds
[0m18:51:48.723748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e0d97250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59decb98a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59decba6e0>]}
[0m18:51:48.724235 [debug] [MainThread]: Flushing usage events
[0m18:53:38.468910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cda631c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb98a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb98b3a0>]}


============================== 18:53:38.474033 | 167b032d-4d06-4588-a4b9-8963cdcc29e8 ==============================
[0m18:53:38.474033 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:53:38.475807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/ubuntu/project_lab08/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /home/ubuntu/project_lab08/dbt --project-dir /home/ubuntu/project_lab08/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:53:38.487686 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m18:53:38.488879 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_lab08_project", target "prod" invalid: Runtime Error
    Could not find adapter type postgres!
[0m18:53:38.490448 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.13801472, "process_in_blocks": "0", "process_kernel_time": 0.143311, "process_mem_max_rss": "91392", "process_out_blocks": "8", "process_user_time": 2.342882}
[0m18:53:38.491519 [debug] [MainThread]: Command `dbt docs generate` failed at 18:53:38.491334 after 0.14 seconds
[0m18:53:38.492212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cda631c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb807310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb804dc0>]}
[0m18:53:38.492948 [debug] [MainThread]: Flushing usage events
[0m18:54:45.337673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984bfb7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9849ede4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9849edf3a0>]}


============================== 18:54:45.342648 | 8c88131e-7bf6-4437-b733-348dc385eb99 ==============================
[0m18:54:45.342648 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:54:45.345166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ubuntu/project_lab08/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /home/ubuntu/project_lab08/dbt --project-dir /home/ubuntu/project_lab08/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:54:45.412298 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_lab08_project", target "prod" invalid: 'schema' is a required property
[0m18:54:45.413804 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.15242533, "process_in_blocks": "0", "process_kernel_time": 0.087992, "process_mem_max_rss": "95840", "process_out_blocks": "16", "process_user_time": 2.292071}
[0m18:54:45.414444 [debug] [MainThread]: Command `dbt docs generate` failed at 18:54:45.414321 after 0.15 seconds
[0m18:54:45.415059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984bfb7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984ab03010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9849ede740>]}
[0m18:54:45.415565 [debug] [MainThread]: Flushing usage events
[0m18:55:04.979063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943239b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94302bf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94302bf280>]}


============================== 18:55:04.982927 | 1cb17cfd-cc22-4fa2-aab5-3cd90d46b7fe ==============================
[0m18:55:04.982927 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:55:04.983721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ubuntu/project_lab08/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /home/ubuntu/project_lab08/dbt --project-dir /home/ubuntu/project_lab08/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:55:05.261485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb17cfd-cc22-4fa2-aab5-3cd90d46b7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94322714b0>]}
[0m18:55:05.365774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb17cfd-cc22-4fa2-aab5-3cd90d46b7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94303d2950>]}
[0m18:55:05.368957 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:05.507576 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:55:05.722787 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:55:05.725333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cb17cfd-cc22-4fa2-aab5-3cd90d46b7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9430eecac0>]}
[0m18:55:07.829723 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:55:07.831386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1cb17cfd-cc22-4fa2-aab5-3cd90d46b7fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f942e12a410>]}
[0m18:55:08.552435 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/home/ubuntu/project_lab08/dbt/target/partial_parse.msgpack'
[0m18:55:08.553474 [error] [MainThread]: Traceback (most recent call last):
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 525, in load
    self.write_manifest_for_partial_parse()
  File "/home/ubuntu/venv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 813, in write_manifest_for_partial_parse
    with open(path, "wb") as fp:
PermissionError: [Errno 13] Permission denied: '/home/ubuntu/project_lab08/dbt/target/partial_parse.msgpack'

[0m18:55:08.554767 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 3.6563349, "process_in_blocks": "0", "process_kernel_time": 0.227347, "process_mem_max_rss": "114164", "process_out_blocks": "8", "process_user_time": 5.658442}
[0m18:55:08.555406 [debug] [MainThread]: Command `dbt docs generate` failed at 18:55:08.555275 after 3.66 seconds
[0m18:55:08.556043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f943239b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9430eec8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f942db54fa0>]}
[0m18:55:08.556539 [debug] [MainThread]: Flushing usage events
[0m18:56:27.834376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf822b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6156530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6157370>]}


============================== 18:56:27.838203 | 7b232a44-763c-4925-ae98-264da7e6b36e ==============================
[0m18:56:27.838203 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:56:27.838932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ubuntu/project_lab08/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/ubuntu/project_lab08/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /home/ubuntu/project_lab08/dbt --project-dir /home/ubuntu/project_lab08/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:56:28.102417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6262230>]}
[0m18:56:28.197588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6262950>]}
[0m18:56:28.199137 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:56:28.360660 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:56:28.514725 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:56:28.515692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6d7ca60>]}
[0m18:56:30.470454 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:56:30.471446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf4747790>]}
[0m18:56:31.206049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf3aee3e0>]}
[0m18:56:31.228657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf3ae9d20>]}
[0m18:56:31.230092 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 434 macros
[0m18:56:31.230849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf3ae9ab0>]}
[0m18:56:31.235681 [info ] [MainThread]: 
[0m18:56:31.238269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:56:31.249771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db_dm'
[0m18:56:31.262397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db_ods'
[0m18:56:31.391049 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m18:56:31.391849 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m18:56:31.392826 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m18:56:31.393483 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m18:56:31.393979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:31.394533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:31.426476 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m18:56:31.427415 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m18:56:31.429042 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m18:56:31.435760 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m18:56:31.436442 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m18:56:31.437062 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m18:56:31.437760 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m18:56:31.442288 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m18:56:31.444686 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m18:56:31.445379 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m18:56:31.448374 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m18:56:31.452413 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m18:56:31.463509 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:31.465251 [debug] [MainThread]: On master: BEGIN
[0m18:56:31.465901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:31.496406 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m18:56:31.497619 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:31.498629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:31.509742 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m18:56:31.511483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b232a44-763c-4925-ae98-264da7e6b36e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf3ae9870>]}
[0m18:56:31.512183 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:31.514254 [debug] [MainThread]: On master: Close
[0m18:56:31.515130 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m18:56:31.515591 [info ] [MainThread]: 
[0m18:56:31.518873 [debug] [Thread-1 (]: Began running node model.dbt_lab08_project.ods_browser_events
[0m18:56:31.519938 [debug] [Thread-2 (]: Began running node model.dbt_lab08_project.ods_device_events
[0m18:56:31.523508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m18:56:31.521848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m18:56:31.520773 [debug] [Thread-3 (]: Began running node model.dbt_lab08_project.ods_geo_events
[0m18:56:31.525678 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m18:56:31.524667 [debug] [Thread-1 (]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m18:56:31.524098 [debug] [Thread-2 (]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m18:56:31.526536 [debug] [Thread-3 (]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m18:56:31.522709 [debug] [Thread-4 (]: Began running node model.dbt_lab08_project.ods_location_events
[0m18:56:31.558781 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m18:56:31.560248 [debug] [Thread-4 (]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m18:56:31.570503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m18:56:31.581063 [debug] [Thread-1 (]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m18:56:31.582688 [debug] [Thread-1 (]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m18:56:31.583877 [debug] [Thread-1 (]: Began running node seed.dbt_lab08_project.italian_cities
[0m18:56:31.566935 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m18:56:31.587377 [debug] [Thread-2 (]: Began executing node model.dbt_lab08_project.ods_device_events
[0m18:56:31.588788 [debug] [Thread-2 (]: Finished running node model.dbt_lab08_project.ods_device_events
[0m18:56:31.589626 [debug] [Thread-2 (]: Began running node seed.dbt_lab08_project.items
[0m18:56:31.590456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now seed.dbt_lab08_project.items)
[0m18:56:31.590991 [debug] [Thread-2 (]: Began compiling node seed.dbt_lab08_project.items
[0m18:56:31.585771 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m18:56:31.598009 [debug] [Thread-3 (]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m18:56:31.599278 [debug] [Thread-3 (]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m18:56:31.585023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_browser_events, now seed.dbt_lab08_project.italian_cities)
[0m18:56:31.600280 [debug] [Thread-1 (]: Began compiling node seed.dbt_lab08_project.italian_cities
[0m18:56:31.579694 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m18:56:31.607134 [debug] [Thread-4 (]: Began executing node model.dbt_lab08_project.ods_location_events
[0m18:56:31.608229 [debug] [Thread-4 (]: Finished running node model.dbt_lab08_project.ods_location_events
[0m18:56:31.608983 [debug] [Thread-3 (]: Began running node model.dbt_lab08_project.dm_events
[0m18:56:31.609856 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m18:56:31.610737 [debug] [Thread-3 (]: Began compiling node model.dbt_lab08_project.dm_events
[0m18:56:31.596910 [debug] [Thread-2 (]: Began executing node seed.dbt_lab08_project.items
[0m18:56:31.620812 [debug] [Thread-2 (]: Finished running node seed.dbt_lab08_project.items
[0m18:56:31.605331 [debug] [Thread-1 (]: Began executing node seed.dbt_lab08_project.italian_cities
[0m18:56:31.623088 [debug] [Thread-1 (]: Finished running node seed.dbt_lab08_project.italian_cities
[0m18:56:31.621996 [debug] [Thread-4 (]: Began running node test.dbt_lab08_project.not_null_items_item_en.7defa41d39
[0m18:56:31.624789 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now test.dbt_lab08_project.not_null_items_item_en.7defa41d39)
[0m18:56:31.625605 [debug] [Thread-4 (]: Began compiling node test.dbt_lab08_project.not_null_items_item_en.7defa41d39
[0m18:56:31.623699 [debug] [Thread-1 (]: Began running node test.dbt_lab08_project.not_null_items_item_ru.a59df9a33f
[0m18:56:31.634825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_lab08_project.italian_cities, now test.dbt_lab08_project.not_null_items_item_ru.a59df9a33f)
[0m18:56:31.634075 [debug] [Thread-2 (]: Began running node test.dbt_lab08_project.unique_items_item_en.daaf4aab41
[0m18:56:31.636424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_lab08_project.items, now test.dbt_lab08_project.unique_items_item_en.daaf4aab41)
[0m18:56:31.637069 [debug] [Thread-2 (]: Began compiling node test.dbt_lab08_project.unique_items_item_en.daaf4aab41
[0m18:56:31.635582 [debug] [Thread-1 (]: Began compiling node test.dbt_lab08_project.not_null_items_item_ru.a59df9a33f
[0m18:56:31.616653 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m18:56:31.665932 [debug] [Thread-3 (]: Began executing node model.dbt_lab08_project.dm_events
[0m18:56:31.667392 [debug] [Thread-3 (]: Finished running node model.dbt_lab08_project.dm_events
[0m18:56:31.668119 [debug] [Thread-3 (]: Began running node model.dbt_lab08_project.dm_sales
[0m18:56:31.683659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.dm_events, now model.dbt_lab08_project.dm_sales)
[0m18:56:31.684297 [debug] [Thread-3 (]: Began compiling node model.dbt_lab08_project.dm_sales
[0m18:56:31.680249 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_items_item_ru.a59df9a33f"
[0m18:56:31.695173 [debug] [Thread-1 (]: Began executing node test.dbt_lab08_project.not_null_items_item_ru.a59df9a33f
[0m18:56:31.682707 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_items_item_en.7defa41d39"
[0m18:56:31.699484 [debug] [Thread-4 (]: Began executing node test.dbt_lab08_project.not_null_items_item_en.7defa41d39
[0m18:56:31.698740 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_lab08_project.unique_items_item_en.daaf4aab41"
[0m18:56:31.692276 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m18:56:31.696443 [debug] [Thread-1 (]: Finished running node test.dbt_lab08_project.not_null_items_item_ru.a59df9a33f
[0m18:56:31.701469 [debug] [Thread-2 (]: Began executing node test.dbt_lab08_project.unique_items_item_en.daaf4aab41
[0m18:56:31.700471 [debug] [Thread-4 (]: Finished running node test.dbt_lab08_project.not_null_items_item_en.7defa41d39
[0m18:56:31.702325 [debug] [Thread-3 (]: Began executing node model.dbt_lab08_project.dm_sales
[0m18:56:31.703165 [debug] [Thread-1 (]: Began running node test.dbt_lab08_project.not_null_italian_cities_city_en.e617837c19
[0m18:56:31.706363 [debug] [Thread-2 (]: Finished running node test.dbt_lab08_project.unique_items_item_en.daaf4aab41
[0m18:56:31.707755 [debug] [Thread-4 (]: Began running node test.dbt_lab08_project.not_null_italian_cities_city_ru.fc76b01b8e
[0m18:56:31.709099 [debug] [Thread-3 (]: Finished running node model.dbt_lab08_project.dm_sales
[0m18:56:31.709804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_items_item_ru.a59df9a33f, now test.dbt_lab08_project.not_null_italian_cities_city_en.e617837c19)
[0m18:56:31.715801 [debug] [Thread-1 (]: Began compiling node test.dbt_lab08_project.not_null_italian_cities_city_en.e617837c19
[0m18:56:31.710581 [debug] [Thread-2 (]: Began running node test.dbt_lab08_project.unique_italian_cities_city_en.3f06df14de
[0m18:56:31.724167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.unique_items_item_en.daaf4aab41, now test.dbt_lab08_project.unique_italian_cities_city_en.3f06df14de)
[0m18:56:31.725135 [debug] [Thread-2 (]: Began compiling node test.dbt_lab08_project.unique_italian_cities_city_en.3f06df14de
[0m18:56:31.713751 [debug] [Thread-3 (]: Began running node test.dbt_lab08_project.not_null_dm_events_event_id.7117e7ca0e
[0m18:56:31.734116 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.dm_sales, now test.dbt_lab08_project.not_null_dm_events_event_id.7117e7ca0e)
[0m18:56:31.733028 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_lab08_project.unique_italian_cities_city_en.3f06df14de"
[0m18:56:31.712775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_items_item_en.7defa41d39, now test.dbt_lab08_project.not_null_italian_cities_city_ru.fc76b01b8e)
[0m18:56:31.734905 [debug] [Thread-3 (]: Began compiling node test.dbt_lab08_project.not_null_dm_events_event_id.7117e7ca0e
[0m18:56:31.737830 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_italian_cities_city_en.e617837c19"
[0m18:56:31.738751 [debug] [Thread-4 (]: Began compiling node test.dbt_lab08_project.not_null_italian_cities_city_ru.fc76b01b8e
[0m18:56:31.745683 [debug] [Thread-2 (]: Began executing node test.dbt_lab08_project.unique_italian_cities_city_en.3f06df14de
[0m18:56:31.746816 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_events_event_id.7117e7ca0e"
[0m18:56:31.754013 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_italian_cities_city_ru.fc76b01b8e"
[0m18:56:31.755280 [debug] [Thread-1 (]: Began executing node test.dbt_lab08_project.not_null_italian_cities_city_en.e617837c19
[0m18:56:31.757058 [debug] [Thread-2 (]: Finished running node test.dbt_lab08_project.unique_italian_cities_city_en.3f06df14de
[0m18:56:31.758100 [debug] [Thread-3 (]: Began executing node test.dbt_lab08_project.not_null_dm_events_event_id.7117e7ca0e
[0m18:56:31.762951 [debug] [Thread-3 (]: Finished running node test.dbt_lab08_project.not_null_dm_events_event_id.7117e7ca0e
[0m18:56:31.763790 [debug] [Thread-3 (]: Began running node test.dbt_lab08_project.not_null_dm_events_event_type.def37a1822
[0m18:56:31.764651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_dm_events_event_id.7117e7ca0e, now test.dbt_lab08_project.not_null_dm_events_event_type.def37a1822)
[0m18:56:31.765397 [debug] [Thread-3 (]: Began compiling node test.dbt_lab08_project.not_null_dm_events_event_type.def37a1822
[0m18:56:31.759258 [debug] [Thread-4 (]: Began executing node test.dbt_lab08_project.not_null_italian_cities_city_ru.fc76b01b8e
[0m18:56:31.760517 [debug] [Thread-1 (]: Finished running node test.dbt_lab08_project.not_null_italian_cities_city_en.e617837c19
[0m18:56:31.773575 [debug] [Thread-4 (]: Finished running node test.dbt_lab08_project.not_null_italian_cities_city_ru.fc76b01b8e
[0m18:56:31.761350 [debug] [Thread-2 (]: Began running node test.dbt_lab08_project.not_null_dm_events_event_timestamp.0af9e43698
[0m18:56:31.779455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.unique_italian_cities_city_en.3f06df14de, now test.dbt_lab08_project.not_null_dm_events_event_timestamp.0af9e43698)
[0m18:56:31.780529 [debug] [Thread-2 (]: Began compiling node test.dbt_lab08_project.not_null_dm_events_event_timestamp.0af9e43698
[0m18:56:31.776833 [debug] [Thread-4 (]: Began running node test.dbt_lab08_project.not_null_dm_sales_event_timestamp.eab9edfa8e
[0m18:56:31.788136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_italian_cities_city_ru.fc76b01b8e, now test.dbt_lab08_project.not_null_dm_sales_event_timestamp.eab9edfa8e)
[0m18:56:31.775000 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_events_event_type.def37a1822"
[0m18:56:31.792087 [debug] [Thread-3 (]: Began executing node test.dbt_lab08_project.not_null_dm_events_event_type.def37a1822
[0m18:56:31.789001 [debug] [Thread-4 (]: Began compiling node test.dbt_lab08_project.not_null_dm_sales_event_timestamp.eab9edfa8e
[0m18:56:31.791026 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_events_event_timestamp.0af9e43698"
[0m18:56:31.804060 [debug] [Thread-2 (]: Began executing node test.dbt_lab08_project.not_null_dm_events_event_timestamp.0af9e43698
[0m18:56:31.805468 [debug] [Thread-2 (]: Finished running node test.dbt_lab08_project.not_null_dm_events_event_timestamp.0af9e43698
[0m18:56:31.802727 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_sales_event_timestamp.eab9edfa8e"
[0m18:56:31.807367 [debug] [Thread-4 (]: Began executing node test.dbt_lab08_project.not_null_dm_sales_event_timestamp.eab9edfa8e
[0m18:56:31.776084 [debug] [Thread-1 (]: Began running node test.dbt_lab08_project.not_null_dm_events_load_hour.2ec80c1ecf
[0m18:56:31.809853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_italian_cities_city_en.e617837c19, now test.dbt_lab08_project.not_null_dm_events_load_hour.2ec80c1ecf)
[0m18:56:31.810713 [debug] [Thread-1 (]: Began compiling node test.dbt_lab08_project.not_null_dm_events_load_hour.2ec80c1ecf
[0m18:56:31.808962 [debug] [Thread-4 (]: Finished running node test.dbt_lab08_project.not_null_dm_sales_event_timestamp.eab9edfa8e
[0m18:56:31.793212 [debug] [Thread-3 (]: Finished running node test.dbt_lab08_project.not_null_dm_events_event_type.def37a1822
[0m18:56:31.821685 [debug] [Thread-3 (]: Began running node test.dbt_lab08_project.not_null_dm_sales_sale_timestamp.e79e2bd4db
[0m18:56:31.822549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_dm_events_event_type.def37a1822, now test.dbt_lab08_project.not_null_dm_sales_sale_timestamp.e79e2bd4db)
[0m18:56:31.823377 [debug] [Thread-3 (]: Began compiling node test.dbt_lab08_project.not_null_dm_sales_sale_timestamp.e79e2bd4db
[0m18:56:31.806292 [debug] [Thread-2 (]: Began running node test.dbt_lab08_project.not_null_dm_sales_load_hour.b4ddbe5276
[0m18:56:31.830897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_dm_events_event_timestamp.0af9e43698, now test.dbt_lab08_project.not_null_dm_sales_load_hour.b4ddbe5276)
[0m18:56:31.819654 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_events_load_hour.2ec80c1ecf"
[0m18:56:31.831612 [debug] [Thread-2 (]: Began compiling node test.dbt_lab08_project.not_null_dm_sales_load_hour.b4ddbe5276
[0m18:56:31.820699 [debug] [Thread-4 (]: Began running node test.dbt_lab08_project.not_null_dm_sales_sale_custom_id.dc5755202f
[0m18:56:31.838632 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_dm_sales_event_timestamp.eab9edfa8e, now test.dbt_lab08_project.not_null_dm_sales_sale_custom_id.dc5755202f)
[0m18:56:31.839219 [debug] [Thread-4 (]: Began compiling node test.dbt_lab08_project.not_null_dm_sales_sale_custom_id.dc5755202f
[0m18:56:31.830125 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_sales_sale_timestamp.e79e2bd4db"
[0m18:56:31.837799 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_sales_load_hour.b4ddbe5276"
[0m18:56:31.846306 [debug] [Thread-3 (]: Began executing node test.dbt_lab08_project.not_null_dm_sales_sale_timestamp.e79e2bd4db
[0m18:56:31.849056 [debug] [Thread-3 (]: Finished running node test.dbt_lab08_project.not_null_dm_sales_sale_timestamp.e79e2bd4db
[0m18:56:31.847536 [debug] [Thread-1 (]: Began executing node test.dbt_lab08_project.not_null_dm_events_load_hour.2ec80c1ecf
[0m18:56:31.851362 [debug] [Thread-1 (]: Finished running node test.dbt_lab08_project.not_null_dm_events_load_hour.2ec80c1ecf
[0m18:56:31.845361 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_lab08_project.not_null_dm_sales_sale_custom_id.dc5755202f"
[0m18:56:31.853032 [debug] [Thread-4 (]: Began executing node test.dbt_lab08_project.not_null_dm_sales_sale_custom_id.dc5755202f
[0m18:56:31.852125 [debug] [Thread-2 (]: Began executing node test.dbt_lab08_project.not_null_dm_sales_load_hour.b4ddbe5276
[0m18:56:31.854206 [debug] [Thread-4 (]: Finished running node test.dbt_lab08_project.not_null_dm_sales_sale_custom_id.dc5755202f
[0m18:56:31.849683 [debug] [Thread-3 (]: Began running node test.dbt_lab08_project.unique_dm_sales_sale_custom_id.bad36ecfda
[0m18:56:31.858547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_lab08_project.not_null_dm_sales_sale_timestamp.e79e2bd4db, now test.dbt_lab08_project.unique_dm_sales_sale_custom_id.bad36ecfda)
[0m18:56:31.859078 [debug] [Thread-3 (]: Began compiling node test.dbt_lab08_project.unique_dm_sales_sale_custom_id.bad36ecfda
[0m18:56:31.857574 [debug] [Thread-2 (]: Finished running node test.dbt_lab08_project.not_null_dm_sales_load_hour.b4ddbe5276
[0m18:56:31.864501 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_lab08_project.unique_dm_sales_sale_custom_id.bad36ecfda"
[0m18:56:31.865663 [debug] [Thread-3 (]: Began executing node test.dbt_lab08_project.unique_dm_sales_sale_custom_id.bad36ecfda
[0m18:56:31.866700 [debug] [Thread-3 (]: Finished running node test.dbt_lab08_project.unique_dm_sales_sale_custom_id.bad36ecfda
[0m18:56:31.868261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:31.868751 [debug] [MainThread]: Connection 'test.dbt_lab08_project.not_null_dm_events_load_hour.2ec80c1ecf' was properly closed.
[0m18:56:31.869128 [debug] [MainThread]: Connection 'test.dbt_lab08_project.not_null_dm_sales_load_hour.b4ddbe5276' was properly closed.
[0m18:56:31.869459 [debug] [MainThread]: Connection 'test.dbt_lab08_project.unique_dm_sales_sale_custom_id.bad36ecfda' was properly closed.
[0m18:56:31.869815 [debug] [MainThread]: Connection 'test.dbt_lab08_project.not_null_dm_sales_sale_custom_id.dc5755202f' was properly closed.
[0m18:56:31.874303 [debug] [MainThread]: Command end result
[0m18:56:32.091769 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:56:32.092330 [info ] [MainThread]: Building catalog
[0m18:56:32.107991 [debug] [ThreadPool]: Acquiring new postgres connection 'lab08_db.information_schema'
[0m18:56:32.129503 [debug] [ThreadPool]: Using postgres connection "lab08_db.information_schema"
[0m18:56:32.130534 [debug] [ThreadPool]: On lab08_db.information_schema: BEGIN
[0m18:56:32.131400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:32.164664 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m18:56:32.165469 [debug] [ThreadPool]: Using postgres connection "lab08_db.information_schema"
[0m18:56:32.166083 [debug] [ThreadPool]: On lab08_db.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "lab08_db.information_schema"} */

    
    

    select
        'lab08_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('ods') and
           upper(tbl.relname) = upper('items')) or (upper(sch.nspname) = upper('ods') and
           upper(tbl.relname) = upper('ods_location_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_location_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_device_events')) or (upper(sch.nspname) = upper('dm') and
           upper(tbl.relname) = upper('dm_sales')) or (upper(sch.nspname) = upper('ods') and
           upper(tbl.relname) = upper('italian_cities')) or (upper(sch.nspname) = upper('ods') and
           upper(tbl.relname) = upper('ods_geo_events')) or (upper(sch.nspname) = upper('ods') and
           upper(tbl.relname) = upper('ods_device_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_geo_events')) or (upper(sch.nspname) = upper('ods') and
           upper(tbl.relname) = upper('ods_browser_events')) or (upper(sch.nspname) = upper('dm') and
           upper(tbl.relname) = upper('dm_events')) or (upper(sch.nspname) = upper('stg') and
           upper(tbl.relname) = upper('stg_browser_events')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:56:32.176098 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.009 seconds
[0m18:56:32.190066 [debug] [ThreadPool]: On lab08_db.information_schema: ROLLBACK
[0m18:56:32.193091 [debug] [ThreadPool]: On lab08_db.information_schema: Close
[0m18:56:32.268782 [info ] [MainThread]: Catalog written to /home/ubuntu/project_lab08/dbt/target/catalog.json
[0m18:56:32.270362 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.5199366, "process_in_blocks": "0", "process_kernel_time": 0.287847, "process_mem_max_rss": "124064", "process_out_blocks": "6336", "process_user_time": 6.476686}
[0m18:56:32.271120 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:56:32.270897 after 4.52 seconds
[0m18:56:32.271633 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:56:32.272238 [debug] [MainThread]: Connection 'lab08_db.information_schema' was properly closed.
[0m18:56:32.272791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf822b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6262950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf7fb2560>]}
[0m18:56:32.273292 [debug] [MainThread]: Flushing usage events
[0m19:01:07.750327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc98b7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc800af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc800a880>]}


============================== 19:01:07.764389 | ac5e1da1-0604-466e-9d51-fbf0e12acb1e ==============================
[0m19:01:07.764389 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:01:07.765408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:01:08.043671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc65fd310>]}
[0m19:01:08.174424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc65f3a90>]}
[0m19:01:08.177150 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:01:08.206319 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:01:08.453468 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:01:08.455285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc8aa7a00>]}
[0m19:01:10.645609 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:01:10.646431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc623bc10>]}
[0m19:01:11.273866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc5f576d0>]}
[0m19:01:11.519842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc5e2ab20>]}
[0m19:01:11.521058 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m19:01:11.521920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc5e6cc40>]}
[0m19:01:11.525661 [info ] [MainThread]: 
[0m19:01:11.526957 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:11.535512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m19:01:11.541705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m19:01:11.624658 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m19:01:11.625435 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m19:01:11.626378 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m19:01:11.627056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:11.627842 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m19:01:11.629187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:11.667716 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.038 seconds
[0m19:01:11.668729 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.042 seconds
[0m19:01:11.672526 [debug] [ThreadPool]: On list_lab08_db: Close
[0m19:01:11.674908 [debug] [ThreadPool]: On list_lab08_db: Close
[0m19:01:11.679000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m19:01:11.691625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m19:01:11.697662 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m19:01:11.698323 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m19:01:11.698812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:11.699763 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m19:01:11.700286 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m19:01:11.700871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:11.729588 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m19:01:11.730784 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m19:01:11.731496 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m19:01:11.732461 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m19:01:11.733242 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m19:01:11.733858 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m19:01:11.739223 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m19:01:11.742110 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m19:01:11.743016 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m19:01:11.745238 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m19:01:11.747251 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m19:01:11.747814 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m19:01:11.760506 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:11.761366 [debug] [MainThread]: On master: BEGIN
[0m19:01:11.761874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:11.794422 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m19:01:11.795188 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:11.804456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:11.816006 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m19:01:11.818584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc5ff0490>]}
[0m19:01:11.819667 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:11.824877 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:11.825540 [debug] [MainThread]: On master: BEGIN
[0m19:01:11.833161 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m19:01:11.834030 [debug] [MainThread]: On master: COMMIT
[0m19:01:11.834873 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:11.835490 [debug] [MainThread]: On master: COMMIT
[0m19:01:11.838059 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:01:11.838946 [debug] [MainThread]: On master: Close
[0m19:01:11.840187 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m19:01:11.841132 [info ] [MainThread]: 
[0m19:01:11.846077 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m19:01:11.846833 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m19:01:11.848023 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m19:01:11.853871 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m19:01:11.857304 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m19:01:11.859528 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m19:01:11.853414 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m19:01:11.861624 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m19:01:11.852127 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m19:01:11.863442 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m19:01:11.864281 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m19:01:11.860280 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m19:01:11.862393 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m19:01:11.849255 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m19:01:11.906656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m19:01:11.908094 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m19:01:11.905936 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m19:01:11.917430 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m19:01:11.900024 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m19:01:11.890172 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m19:01:11.926233 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m19:01:11.927110 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m19:01:11.914826 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m19:01:12.154696 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m19:01:12.334745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:01:12.345043 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:01:12.348375 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:01:12.349712 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp190112217280"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m19:01:12.350841 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:01:12.351882 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp190112215371"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m19:01:12.352652 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp190112223295"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m19:01:12.353643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:12.354700 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp190112230082"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m19:01:12.355532 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:01:12.356432 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:01:12.357524 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:02:31.002901 [debug] [Thread-3  ]: SQL status: SELECT 171247 in 78.647 seconds
[0m19:02:31.032685 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:31.034090 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m19:02:31.040105 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m19:02:31.040780 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:31.041421 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp190112215371'
        
      order by ordinal_position

  
[0m19:02:31.083992 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.042 seconds
[0m19:02:31.098838 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:31.099767 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:31.116248 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.016 seconds
[0m19:02:31.136454 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:31.137531 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:31.147967 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m19:02:31.170300 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m19:02:31.171838 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:31.172645 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp190112215371"
    )


  
[0m19:02:32.147384 [debug] [Thread-3  ]: SQL status: INSERT 0 171247 in 0.974 seconds
[0m19:02:32.175205 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m19:02:32.176189 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m19:02:32.176993 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m19:02:32.209156 [debug] [Thread-3  ]: SQL status: COMMIT in 0.031 seconds
[0m19:02:32.213432 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m19:02:32.215869 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc49b1e20>]}
[0m19:02:32.217131 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 171247[0m in 80.35s]
[0m19:02:32.217890 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m19:02:36.669309 [debug] [Thread-4  ]: SQL status: SELECT 171247 in 84.312 seconds
[0m19:02:36.675428 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:36.676088 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m19:02:36.679131 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m19:02:36.679761 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:36.680217 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp190112230082'
        
      order by ordinal_position

  
[0m19:02:36.694073 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m19:02:36.700661 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:36.701721 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:36.712454 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m19:02:36.721168 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:36.721813 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:36.729089 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m19:02:36.734331 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m19:02:36.736391 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:36.737783 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp190112230082"
    )


  
[0m19:02:40.780329 [debug] [Thread-2  ]: SQL status: SELECT 171247 in 88.424 seconds
[0m19:02:40.785833 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:40.786680 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m19:02:40.789240 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m19:02:40.789716 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:40.790320 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp190112223295'
        
      order by ordinal_position

  
[0m19:02:40.803307 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m19:02:40.811871 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:40.812494 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:40.818806 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m19:02:40.826686 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:40.827956 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:40.834979 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m19:02:40.839166 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m19:02:40.840110 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:40.840625 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp190112223295"
    )


  
[0m19:02:42.195310 [debug] [Thread-2  ]: SQL status: INSERT 0 171247 in 1.354 seconds
[0m19:02:42.202911 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m19:02:42.203600 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m19:02:42.204076 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m19:02:42.215404 [debug] [Thread-2  ]: SQL status: COMMIT in 0.011 seconds
[0m19:02:42.217214 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m19:02:42.219747 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc61adc70>]}
[0m19:02:42.222243 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 171247[0m in 90.36s]
[0m19:02:42.233792 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m19:02:43.675900 [debug] [Thread-1  ]: SQL status: SELECT 171247 in 91.322 seconds
[0m19:02:43.681674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:43.682460 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m19:02:43.686118 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m19:02:43.686686 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:43.687469 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp190112217280'
        
      order by ordinal_position

  
[0m19:02:43.704936 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.017 seconds
[0m19:02:43.711413 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:43.712415 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:43.719105 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m19:02:43.725929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:43.726889 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m19:02:43.733371 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m19:02:43.737249 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m19:02:43.738195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:43.738723 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp190112217280"
    )


  
[0m19:02:44.391196 [debug] [Thread-4  ]: SQL status: INSERT 0 171247 in 7.652 seconds
[0m19:02:44.394324 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m19:02:44.394885 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m19:02:44.395637 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m19:02:44.410058 [debug] [Thread-4  ]: SQL status: COMMIT in 0.013 seconds
[0m19:02:44.412246 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m19:02:44.413526 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc49b1cd0>]}
[0m19:02:44.414943 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 171247[0m in 92.55s]
[0m19:02:44.416268 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m19:02:47.889257 [debug] [Thread-1  ]: SQL status: INSERT 0 171247 in 4.149 seconds
[0m19:02:47.891627 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m19:02:47.892532 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m19:02:47.893607 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m19:02:47.913490 [debug] [Thread-1  ]: SQL status: COMMIT in 0.019 seconds
[0m19:02:47.915643 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m19:02:47.917392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc49b1fd0>]}
[0m19:02:47.918435 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 171247[0m in 96.01s]
[0m19:02:47.920168 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m19:02:47.921412 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m19:02:47.923249 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m19:02:47.922168 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m19:02:47.924655 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m19:02:47.926054 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m19:02:47.929261 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m19:02:47.930173 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m19:02:47.928270 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m19:02:47.947614 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m19:02:47.939772 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m19:02:47.949600 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m19:02:47.957659 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m19:02:47.973806 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:02:47.971936 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:02:47.975397 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp190247964499"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m19:02:47.976518 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp190247967633"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m19:02:47.978086 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:02:47.978832 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:03:54.504866 [debug] [Thread-3  ]: SQL status: SELECT 171247 in 66.526 seconds
[0m19:03:54.511127 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:03:54.511991 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m19:03:54.514710 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m19:03:54.515531 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:03:54.515982 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp190247964499'
        
      order by ordinal_position

  
[0m19:03:54.556030 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.039 seconds
[0m19:03:54.562796 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:03:54.564204 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m19:03:54.570354 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.005 seconds
[0m19:03:54.577602 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:03:54.578437 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m19:03:54.589372 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m19:03:54.594351 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m19:03:54.595480 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:03:54.596002 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp190247964499"
    )


  
[0m19:04:00.185055 [debug] [Thread-3  ]: SQL status: INSERT 0 171247 in 5.588 seconds
[0m19:04:00.188739 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m19:04:00.190169 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m19:04:00.190753 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m19:04:00.206511 [debug] [Thread-3  ]: SQL status: COMMIT in 0.014 seconds
[0m19:04:00.208004 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m19:04:00.209997 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc65fbfa0>]}
[0m19:04:00.211266 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 171247[0m in 72.29s]
[0m19:04:00.212430 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m19:04:09.623686 [debug] [Thread-2  ]: SQL status: SELECT 9875 in 81.644 seconds
[0m19:04:09.632501 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:09.633333 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m19:04:09.636588 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m19:04:09.637562 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:09.638254 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp190247967633'
        
      order by ordinal_position

  
[0m19:04:09.652095 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.013 seconds
[0m19:04:09.658995 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:09.659651 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m19:04:09.666582 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.006 seconds
[0m19:04:09.674990 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:09.675686 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m19:04:09.683957 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.008 seconds
[0m19:04:09.688079 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m19:04:09.689123 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:09.689666 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp190247967633"
    )


  
[0m19:04:09.949710 [debug] [Thread-2  ]: SQL status: INSERT 0 9875 in 0.259 seconds
[0m19:04:09.952925 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m19:04:09.954015 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m19:04:09.954679 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m19:04:09.982955 [debug] [Thread-2  ]: SQL status: COMMIT in 0.028 seconds
[0m19:04:09.984549 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m19:04:09.985599 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac5e1da1-0604-466e-9d51-fbf0e12acb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc610c9d0>]}
[0m19:04:09.988256 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 9875[0m in 82.06s]
[0m19:04:09.989576 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m19:04:09.992059 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:09.992699 [debug] [MainThread]: On master: BEGIN
[0m19:04:09.993139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:10.034767 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m19:04:10.035665 [debug] [MainThread]: On master: COMMIT
[0m19:04:10.036544 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:10.037013 [debug] [MainThread]: On master: COMMIT
[0m19:04:10.039437 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:04:10.039847 [debug] [MainThread]: On master: Close
[0m19:04:10.041207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:10.041610 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m19:04:10.041908 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m19:04:10.042270 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m19:04:10.042596 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m19:04:10.043102 [info ] [MainThread]: 
[0m19:04:10.044507 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 58.52 seconds (178.52s).
[0m19:04:10.047219 [debug] [MainThread]: Command end result
[0m19:04:10.120145 [info ] [MainThread]: 
[0m19:04:10.121648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:10.122589 [info ] [MainThread]: 
[0m19:04:10.123337 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:04:10.126692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 182.50922, "process_user_time": 7.106603, "process_kernel_time": 0.452371, "process_mem_max_rss": "115636", "process_in_blocks": "10632", "process_out_blocks": "3520"}
[0m19:04:10.127593 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:10.127441 after 182.51 seconds
[0m19:04:10.128161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc98b7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc9031250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bc9458190>]}
[0m19:04:10.128646 [debug] [MainThread]: Flushing usage events
[0m20:01:04.845206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda767428e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda74ee7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda75044ac0>]}


============================== 20:01:04.858886 | baac52eb-c727-474e-be6b-552c683664a7 ==============================
[0m20:01:04.858886 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:01:04.860360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:01:05.257907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda7349d370>]}
[0m20:01:05.362939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda74ee77f0>]}
[0m20:01:05.364251 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:01:05.416865 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:01:05.726654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:05.727218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:05.850303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda73105910>]}
[0m20:01:06.231495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda731b5e20>]}
[0m20:01:06.233019 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m20:01:06.234270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda73135c10>]}
[0m20:01:06.237312 [info ] [MainThread]: 
[0m20:01:06.239089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:01:06.247661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m20:01:06.282688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m20:01:06.334591 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m20:01:06.335334 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m20:01:06.336822 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m20:01:06.337586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:06.336167 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m20:01:06.338720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:06.391087 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.054 seconds
[0m20:01:06.394558 [debug] [ThreadPool]: On list_lab08_db: Close
[0m20:01:06.396265 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.057 seconds
[0m20:01:06.399422 [debug] [ThreadPool]: On list_lab08_db: Close
[0m20:01:06.404031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m20:01:06.416309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m20:01:06.427719 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m20:01:06.428842 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m20:01:06.429512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:06.433222 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m20:01:06.433931 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m20:01:06.434817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:06.468585 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m20:01:06.469354 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m20:01:06.470229 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m20:01:06.473429 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m20:01:06.473910 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m20:01:06.474283 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m20:01:06.480059 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m20:01:06.483100 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m20:01:06.484426 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m20:01:06.487077 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m20:01:06.487869 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m20:01:06.489538 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m20:01:06.500014 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:06.500644 [debug] [MainThread]: On master: BEGIN
[0m20:01:06.501895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:06.533739 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m20:01:06.534383 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:06.535063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:01:06.546328 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m20:01:06.548543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda764a7dc0>]}
[0m20:01:06.549381 [debug] [MainThread]: On master: ROLLBACK
[0m20:01:06.551986 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:06.552722 [debug] [MainThread]: On master: BEGIN
[0m20:01:06.556879 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:01:06.557489 [debug] [MainThread]: On master: COMMIT
[0m20:01:06.557983 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:06.558597 [debug] [MainThread]: On master: COMMIT
[0m20:01:06.560659 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:01:06.561158 [debug] [MainThread]: On master: Close
[0m20:01:06.562015 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m20:01:06.562644 [info ] [MainThread]: 
[0m20:01:06.567263 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m20:01:06.568279 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m20:01:06.569313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m20:01:06.570054 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m20:01:06.571041 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m20:01:06.578794 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m20:01:06.572231 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m20:01:06.571740 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m20:01:06.583390 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m20:01:06.584449 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m20:01:06.584935 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m20:01:06.582219 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m20:01:06.585629 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m20:01:06.587003 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m20:01:06.580572 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m20:01:06.587495 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m20:01:06.645957 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m20:01:06.659733 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m20:01:06.658067 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m20:01:06.666709 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m20:01:06.652111 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m20:01:06.705436 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m20:01:06.683546 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m20:01:06.713046 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m20:01:07.053104 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:01:07.062567 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:01:07.064971 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp200107018283"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m20:01:07.065646 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:01:07.063353 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:01:07.066581 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp200106962850"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m20:01:07.067170 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:01:07.064080 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp200106969554"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m20:01:07.068178 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:01:07.073792 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:01:07.074394 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp200107069811"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m20:01:07.075293 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:02:32.451981 [debug] [Thread-3  ]: SQL status: SELECT 20886 in 85.386 seconds
[0m20:02:32.521657 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:32.522614 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m20:02:32.533223 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m20:02:32.534170 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:32.534952 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp200107018283'
        
      order by ordinal_position

  
[0m20:02:32.576767 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.041 seconds
[0m20:02:32.591536 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:32.592146 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:32.604375 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.012 seconds
[0m20:02:32.635244 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:32.635992 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:32.648176 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.012 seconds
[0m20:02:32.810119 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m20:02:32.811555 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:32.812188 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp200107018283"
    )


  
[0m20:02:32.891335 [debug] [Thread-3  ]: SQL status: INSERT 0 20886 in 0.078 seconds
[0m20:02:32.921234 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m20:02:32.922581 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m20:02:32.923755 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m20:02:32.947260 [debug] [Thread-3  ]: SQL status: COMMIT in 0.023 seconds
[0m20:02:32.950243 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m20:02:32.952597 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda764c29a0>]}
[0m20:02:32.953519 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 20886[0m in 86.37s]
[0m20:02:32.954446 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m20:02:36.519038 [debug] [Thread-4  ]: SQL status: SELECT 20886 in 89.452 seconds
[0m20:02:36.529413 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:36.530135 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m20:02:36.533048 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:02:36.533661 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:36.534513 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp200106962850'
        
      order by ordinal_position

  
[0m20:02:36.560892 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.026 seconds
[0m20:02:36.567627 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:36.568222 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:36.581228 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m20:02:36.597128 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:36.598199 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:36.606742 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m20:02:36.610304 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m20:02:36.611688 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:36.612328 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp200106962850"
    )


  
[0m20:02:36.681437 [debug] [Thread-4  ]: SQL status: INSERT 0 20886 in 0.068 seconds
[0m20:02:36.684724 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m20:02:36.685276 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m20:02:36.685706 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m20:02:36.710955 [debug] [Thread-4  ]: SQL status: COMMIT in 0.025 seconds
[0m20:02:36.712610 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m20:02:36.713567 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda71bafdf0>]}
[0m20:02:36.714588 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 20886[0m in 90.13s]
[0m20:02:36.718563 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m20:02:38.122990 [debug] [Thread-2  ]: SQL status: SELECT 20886 in 91.047 seconds
[0m20:02:38.131540 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:38.132693 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m20:02:38.136526 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:02:38.137369 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:38.138060 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp200107069811'
        
      order by ordinal_position

  
[0m20:02:38.153820 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.015 seconds
[0m20:02:38.160540 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:38.161399 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:38.169282 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m20:02:38.175115 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:38.175880 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:38.183575 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m20:02:38.190061 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m20:02:38.192384 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:38.193919 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp200107069811"
    )


  
[0m20:02:38.296222 [debug] [Thread-2  ]: SQL status: INSERT 0 20886 in 0.101 seconds
[0m20:02:38.299329 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m20:02:38.300305 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m20:02:38.301254 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m20:02:38.322547 [debug] [Thread-2  ]: SQL status: COMMIT in 0.020 seconds
[0m20:02:38.324867 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m20:02:38.326501 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda71baf970>]}
[0m20:02:38.327853 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 20886[0m in 91.75s]
[0m20:02:38.330296 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m20:02:41.206369 [debug] [Thread-1  ]: SQL status: SELECT 20886 in 94.138 seconds
[0m20:02:41.213993 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:41.215036 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m20:02:41.218079 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:02:41.219098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:41.220230 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp200106969554'
        
      order by ordinal_position

  
[0m20:02:41.232591 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m20:02:41.251637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:41.256673 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:41.275200 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.016 seconds
[0m20:02:41.281054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:41.286767 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m20:02:41.293236 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m20:02:41.298143 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m20:02:41.300050 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:41.301089 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp200106969554"
    )


  
[0m20:02:41.438271 [debug] [Thread-1  ]: SQL status: INSERT 0 20886 in 0.136 seconds
[0m20:02:41.442298 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m20:02:41.444084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m20:02:41.445419 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m20:02:41.471126 [debug] [Thread-1  ]: SQL status: COMMIT in 0.025 seconds
[0m20:02:41.474505 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m20:02:41.475519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda71baf6a0>]}
[0m20:02:41.476340 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 20886[0m in 94.91s]
[0m20:02:41.477094 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m20:02:41.478180 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m20:02:41.479666 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m20:02:41.480288 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m20:02:41.478758 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m20:02:41.485322 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m20:02:41.486745 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m20:02:41.487199 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m20:02:41.482361 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m20:02:41.500820 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m20:02:41.501810 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m20:02:41.509087 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:02:41.512353 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m20:02:41.513787 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m20:02:41.513001 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp200241506700"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m20:02:41.523596 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:02:41.528967 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:02:41.530145 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp200241520789"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m20:02:41.532431 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:03:38.992340 [debug] [Thread-3  ]: SQL status: SELECT 20886 in 57.469 seconds
[0m20:03:38.997804 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:38.998542 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m20:03:39.005719 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m20:03:39.006664 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:39.007641 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp200241506700'
        
      order by ordinal_position

  
[0m20:03:39.020043 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.011 seconds
[0m20:03:39.027660 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:39.028928 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m20:03:39.036057 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m20:03:39.043076 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:39.044130 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m20:03:39.052124 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m20:03:39.056069 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m20:03:39.057980 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:39.058775 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp200241506700"
    )


  
[0m20:03:39.383373 [debug] [Thread-3  ]: SQL status: INSERT 0 20886 in 0.323 seconds
[0m20:03:39.386153 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m20:03:39.386951 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m20:03:39.387589 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m20:03:39.437313 [debug] [Thread-3  ]: SQL status: COMMIT in 0.040 seconds
[0m20:03:39.440340 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m20:03:39.442005 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda73483400>]}
[0m20:03:39.443852 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 20886[0m in 57.96s]
[0m20:03:39.445999 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m20:03:56.656081 [debug] [Thread-4  ]: SQL status: SELECT 1187 in 75.124 seconds
[0m20:03:56.661552 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:56.662291 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m20:03:56.665020 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:03:56.665760 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:56.666521 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp200241520789'
        
      order by ordinal_position

  
[0m20:03:56.677664 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.010 seconds
[0m20:03:56.685552 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:56.686517 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m20:03:56.692890 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.006 seconds
[0m20:03:56.698807 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:56.699593 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m20:03:56.705941 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.006 seconds
[0m20:03:56.710315 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m20:03:56.711696 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:56.712672 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp200241520789"
    )


  
[0m20:03:56.722254 [debug] [Thread-4  ]: SQL status: INSERT 0 1187 in 0.009 seconds
[0m20:03:56.729834 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m20:03:56.731362 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m20:03:56.733857 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m20:03:56.743193 [debug] [Thread-4  ]: SQL status: COMMIT in 0.008 seconds
[0m20:03:56.745792 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m20:03:56.747410 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baac52eb-c727-474e-be6b-552c683664a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda734b2fa0>]}
[0m20:03:56.748906 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 1187[0m in 75.26s]
[0m20:03:56.751547 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m20:03:56.756193 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:56.757969 [debug] [MainThread]: On master: BEGIN
[0m20:03:56.758713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:03:56.791980 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m20:03:56.792859 [debug] [MainThread]: On master: COMMIT
[0m20:03:56.793453 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:56.794016 [debug] [MainThread]: On master: COMMIT
[0m20:03:56.796417 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:03:56.797295 [debug] [MainThread]: On master: Close
[0m20:03:56.798207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:56.798610 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m20:03:56.798940 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m20:03:56.799231 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m20:03:56.799715 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m20:03:56.800398 [info ] [MainThread]: 
[0m20:03:56.801408 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 50.56 seconds (170.56s).
[0m20:03:56.805469 [debug] [MainThread]: Command end result
[0m20:03:56.909918 [info ] [MainThread]: 
[0m20:03:56.912526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:56.914150 [info ] [MainThread]: 
[0m20:03:56.915795 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:03:56.917437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 172.20074, "process_user_time": 4.534861, "process_kernel_time": 0.36558, "process_mem_max_rss": "115588", "process_out_blocks": "2600", "process_in_blocks": "0"}
[0m20:03:56.918802 [debug] [MainThread]: Command `dbt run` succeeded at 20:03:56.918636 after 172.20 seconds
[0m20:03:56.919505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda767428e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda762f11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda734063d0>]}
[0m20:03:56.920437 [debug] [MainThread]: Flushing usage events
[0m21:01:02.636157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6fcca850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6f629190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6e3e3cd0>]}


============================== 21:01:02.642865 | 9389cd5a-c3bd-48ac-8068-0646cd05bdf2 ==============================
[0m21:01:02.642865 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:01:02.644269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:02.877411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6ca38400>]}
[0m21:01:02.960265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6e530a90>]}
[0m21:01:02.961783 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:01:03.001405 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:01:03.429994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:03.431840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:03.613367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6c6927f0>]}
[0m21:01:04.031481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6c67d070>]}
[0m21:01:04.032776 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m21:01:04.034495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6c6b65b0>]}
[0m21:01:04.038459 [info ] [MainThread]: 
[0m21:01:04.041274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:01:04.051535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m21:01:04.066458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m21:01:04.157684 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m21:01:04.158418 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m21:01:04.159870 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m21:01:04.160442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:04.159182 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m21:01:04.161772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:04.217563 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.057 seconds
[0m21:01:04.229069 [debug] [ThreadPool]: On list_lab08_db: Close
[0m21:01:04.230219 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.068 seconds
[0m21:01:04.236798 [debug] [ThreadPool]: On list_lab08_db: Close
[0m21:01:04.255120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m21:01:04.256254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m21:01:04.282041 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m21:01:04.290327 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m21:01:04.290973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:04.289384 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m21:01:04.301072 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m21:01:04.301803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:04.335103 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m21:01:04.335969 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m21:01:04.336665 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m21:01:04.347788 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m21:01:04.350908 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m21:01:04.353760 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m21:01:04.362020 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m21:01:04.362742 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m21:01:04.363360 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m21:01:04.374927 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m21:01:04.377790 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m21:01:04.386553 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m21:01:04.423333 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:04.427474 [debug] [MainThread]: On master: BEGIN
[0m21:01:04.435758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:04.515395 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m21:01:04.516367 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:04.517395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:01:04.531724 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m21:01:04.534124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6c5ee6d0>]}
[0m21:01:04.534900 [debug] [MainThread]: On master: ROLLBACK
[0m21:01:04.537718 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:04.538169 [debug] [MainThread]: On master: BEGIN
[0m21:01:04.543121 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:01:04.543810 [debug] [MainThread]: On master: COMMIT
[0m21:01:04.544313 [debug] [MainThread]: Using postgres connection "master"
[0m21:01:04.544777 [debug] [MainThread]: On master: COMMIT
[0m21:01:04.547521 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m21:01:04.548053 [debug] [MainThread]: On master: Close
[0m21:01:04.549017 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m21:01:04.549440 [info ] [MainThread]: 
[0m21:01:04.562660 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m21:01:04.563576 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m21:01:04.564340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m21:01:04.564987 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m21:01:04.577458 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m21:01:04.578255 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m21:01:04.579034 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m21:01:04.579505 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m21:01:04.580224 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m21:01:04.581391 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m21:01:04.582285 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m21:01:04.583694 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m21:01:04.587055 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m21:01:04.580836 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m21:01:04.587914 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m21:01:04.588433 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m21:01:04.643451 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m21:01:04.650704 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m21:01:04.651870 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m21:01:04.649461 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m21:01:04.666809 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m21:01:04.665650 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m21:01:04.680144 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m21:01:04.681255 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m21:01:05.002290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:01:05.018274 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp210104859784"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m21:01:05.019063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:01:05.017288 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:01:05.020242 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp210104879300"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m21:01:05.020768 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m21:01:05.006477 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:01:05.028921 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp210104844194"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m21:01:05.030180 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m21:01:05.001499 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:01:05.031647 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp210104969701"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m21:01:05.036160 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:02:20.331460 [debug] [Thread-3  ]: SQL status: SELECT 22104 in 75.301 seconds
[0m21:02:20.366640 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:20.367370 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m21:02:20.369871 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m21:02:20.370524 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:20.371077 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp210104844194'
        
      order by ordinal_position

  
[0m21:02:20.391283 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.019 seconds
[0m21:02:20.404752 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:20.405870 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:20.414449 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m21:02:20.435723 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:20.436811 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:20.444014 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m21:02:20.563231 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m21:02:20.579700 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:20.580514 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp210104844194"
    )


  
[0m21:02:20.616962 [debug] [Thread-3  ]: SQL status: INSERT 0 22104 in 0.033 seconds
[0m21:02:20.656439 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m21:02:20.657687 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m21:02:20.658358 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m21:02:20.681565 [debug] [Thread-3  ]: SQL status: COMMIT in 0.023 seconds
[0m21:02:20.684608 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m21:02:20.686950 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6fa0c910>]}
[0m21:02:20.687856 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 22104[0m in 76.10s]
[0m21:02:20.688666 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m21:02:26.178793 [debug] [Thread-4  ]: SQL status: SELECT 22104 in 81.158 seconds
[0m21:02:26.185167 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:26.186169 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m21:02:26.191463 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m21:02:26.192696 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:26.193463 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp210104879300'
        
      order by ordinal_position

  
[0m21:02:26.206753 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m21:02:26.213400 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:26.214135 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:26.222546 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m21:02:26.237449 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:26.238518 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:26.244875 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.005 seconds
[0m21:02:26.251930 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m21:02:26.253733 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:26.254699 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp210104879300"
    )


  
[0m21:02:26.291350 [debug] [Thread-4  ]: SQL status: INSERT 0 22104 in 0.036 seconds
[0m21:02:26.294259 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m21:02:26.295169 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m21:02:26.295741 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m21:02:26.319949 [debug] [Thread-4  ]: SQL status: COMMIT in 0.023 seconds
[0m21:02:26.321980 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m21:02:26.323686 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6b1ae490>]}
[0m21:02:26.325904 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 22104[0m in 81.74s]
[0m21:02:26.327250 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m21:02:27.774088 [debug] [Thread-2  ]: SQL status: SELECT 22104 in 82.738 seconds
[0m21:02:27.779972 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:27.781064 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m21:02:27.783778 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m21:02:27.784528 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:27.786183 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp210104969701'
        
      order by ordinal_position

  
[0m21:02:27.799199 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m21:02:27.805294 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:27.806200 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:27.813635 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m21:02:27.819065 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:27.819773 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:27.826484 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m21:02:27.830289 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m21:02:27.831766 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:27.832480 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp210104969701"
    )


  
[0m21:02:27.893330 [debug] [Thread-2  ]: SQL status: INSERT 0 22104 in 0.060 seconds
[0m21:02:27.895943 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m21:02:27.896657 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m21:02:27.897322 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m21:02:27.933161 [debug] [Thread-2  ]: SQL status: COMMIT in 0.035 seconds
[0m21:02:27.934857 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m21:02:27.935933 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6b1c5b50>]}
[0m21:02:27.937258 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 22104[0m in 83.36s]
[0m21:02:27.938339 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m21:02:30.429229 [debug] [Thread-1  ]: SQL status: SELECT 22104 in 85.410 seconds
[0m21:02:30.436293 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:30.437110 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m21:02:30.440243 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m21:02:30.440850 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:30.441300 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp210104859784'
        
      order by ordinal_position

  
[0m21:02:30.452623 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m21:02:30.461533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:30.462459 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:30.469298 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m21:02:30.477155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:30.477879 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m21:02:30.484002 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m21:02:30.487741 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m21:02:30.488578 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:30.489083 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp210104859784"
    )


  
[0m21:02:30.657584 [debug] [Thread-1  ]: SQL status: INSERT 0 22104 in 0.168 seconds
[0m21:02:30.660483 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m21:02:30.661188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m21:02:30.661692 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m21:02:30.679704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m21:02:30.681293 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m21:02:30.682363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6b1c53d0>]}
[0m21:02:30.683387 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 22104[0m in 86.12s]
[0m21:02:30.684301 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m21:02:30.692097 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m21:02:30.693149 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m21:02:30.695287 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m21:02:30.695956 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m21:02:30.694410 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m21:02:30.705232 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m21:02:30.706156 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m21:02:30.707217 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m21:02:30.703643 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m21:02:30.720426 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m21:02:30.719186 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m21:02:30.730667 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m21:02:30.729496 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:02:30.740999 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp210230725882"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m21:02:30.741775 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m21:02:30.739983 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:02:30.742983 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp210230736646"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m21:02:30.743596 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m21:03:31.443587 [debug] [Thread-3  ]: SQL status: SELECT 22104 in 60.702 seconds
[0m21:03:31.455677 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:31.461112 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m21:03:31.466496 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m21:03:31.467666 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:31.468608 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp210230725882'
        
      order by ordinal_position

  
[0m21:03:31.496087 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.023 seconds
[0m21:03:31.501671 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:31.502416 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m21:03:31.518389 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.015 seconds
[0m21:03:31.524268 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:31.525060 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m21:03:31.536605 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.011 seconds
[0m21:03:31.544701 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m21:03:31.546523 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:31.547418 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp210230725882"
    )


  
[0m21:03:32.308734 [debug] [Thread-3  ]: SQL status: INSERT 0 22104 in 0.760 seconds
[0m21:03:32.311386 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m21:03:32.312092 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m21:03:32.312856 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m21:03:32.339378 [debug] [Thread-3  ]: SQL status: COMMIT in 0.026 seconds
[0m21:03:32.340819 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m21:03:32.342106 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f68850370>]}
[0m21:03:32.343583 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 22104[0m in 61.65s]
[0m21:03:32.344882 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m21:03:45.195115 [debug] [Thread-4  ]: SQL status: SELECT 1231 in 74.451 seconds
[0m21:03:45.200212 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:45.208940 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m21:03:45.213498 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m21:03:45.214194 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:45.214726 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp210230736646'
        
      order by ordinal_position

  
[0m21:03:45.226438 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.011 seconds
[0m21:03:45.241595 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:45.242472 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m21:03:45.249882 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.007 seconds
[0m21:03:45.256602 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:45.265551 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m21:03:45.272306 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.006 seconds
[0m21:03:45.277538 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m21:03:45.278716 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:45.279557 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp210230736646"
    )


  
[0m21:03:45.288822 [debug] [Thread-4  ]: SQL status: INSERT 0 1231 in 0.008 seconds
[0m21:03:45.290808 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m21:03:45.291423 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m21:03:45.291926 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m21:03:45.300066 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m21:03:45.301669 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m21:03:45.302745 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9389cd5a-c3bd-48ac-8068-0646cd05bdf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6ca38e80>]}
[0m21:03:45.303695 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 1231[0m in 74.60s]
[0m21:03:45.304930 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m21:03:45.314380 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:45.315164 [debug] [MainThread]: On master: BEGIN
[0m21:03:45.315836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:45.353201 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m21:03:45.353836 [debug] [MainThread]: On master: COMMIT
[0m21:03:45.354258 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:45.354768 [debug] [MainThread]: On master: COMMIT
[0m21:03:45.356970 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m21:03:45.357447 [debug] [MainThread]: On master: Close
[0m21:03:45.358148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:45.358610 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m21:03:45.359034 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m21:03:45.359648 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m21:03:45.360210 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m21:03:45.360881 [info ] [MainThread]: 
[0m21:03:45.361426 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 41.32 seconds (161.32s).
[0m21:03:45.363619 [debug] [MainThread]: Command end result
[0m21:03:45.503585 [info ] [MainThread]: 
[0m21:03:45.508981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:45.515570 [info ] [MainThread]: 
[0m21:03:45.517779 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:03:45.524165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 162.97026, "process_user_time": 4.282624, "process_kernel_time": 0.338181, "process_mem_max_rss": "115584", "process_out_blocks": "2280", "process_in_blocks": "0"}
[0m21:03:45.524908 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:45.524769 after 162.97 seconds
[0m21:03:45.525392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6fcca850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6eec3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f6e3fd7f0>]}
[0m21:03:45.525923 [debug] [MainThread]: Flushing usage events
[0m22:00:39.122235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868611760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868fe2d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb866d12f70>]}


============================== 22:00:39.131670 | c8d105eb-5c00-4544-8bfb-62549c763498 ==============================
[0m22:00:39.131670 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:00:39.132726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:00:39.499307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868359d00>]}
[0m22:00:39.596055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb867f3ca30>]}
[0m22:00:39.597530 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:00:39.636925 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:00:40.128760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:40.129538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:40.241826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb864fce7f0>]}
[0m22:00:40.509222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb864ec36a0>]}
[0m22:00:40.510087 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m22:00:40.511720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb864ff3880>]}
[0m22:00:40.515682 [info ] [MainThread]: 
[0m22:00:40.517985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:40.526122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m22:00:40.538689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m22:00:40.605284 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m22:00:40.605757 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m22:00:40.606700 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m22:00:40.607312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:40.606272 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m22:00:40.608526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:40.644407 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.037 seconds
[0m22:00:40.646854 [debug] [ThreadPool]: On list_lab08_db: Close
[0m22:00:40.650415 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.042 seconds
[0m22:00:40.652762 [debug] [ThreadPool]: On list_lab08_db: Close
[0m22:00:40.655526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m22:00:40.665737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m22:00:40.670249 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m22:00:40.670841 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m22:00:40.671241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:40.666611 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m22:00:40.671971 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m22:00:40.672417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:40.712051 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m22:00:40.713018 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m22:00:40.713615 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m22:00:40.716773 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m22:00:40.717225 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m22:00:40.717699 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m22:00:40.720905 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m22:00:40.722600 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m22:00:40.724168 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m22:00:40.725756 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m22:00:40.726201 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m22:00:40.727864 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m22:00:40.736299 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:40.736894 [debug] [MainThread]: On master: BEGIN
[0m22:00:40.737407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:40.765018 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m22:00:40.765569 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:40.766020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:40.775634 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m22:00:40.777345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb864f457f0>]}
[0m22:00:40.778171 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:40.780223 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:40.780855 [debug] [MainThread]: On master: BEGIN
[0m22:00:40.784204 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:00:40.784613 [debug] [MainThread]: On master: COMMIT
[0m22:00:40.785232 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:40.785729 [debug] [MainThread]: On master: COMMIT
[0m22:00:40.787672 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:00:40.788125 [debug] [MainThread]: On master: Close
[0m22:00:40.788941 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m22:00:40.789498 [info ] [MainThread]: 
[0m22:00:40.792829 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m22:00:40.793598 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m22:00:40.794251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m22:00:40.794667 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m22:00:40.802199 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m22:00:40.803258 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m22:00:40.803893 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m22:00:40.804393 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m22:00:40.805047 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m22:00:40.805790 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m22:00:40.806748 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m22:00:40.807239 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m22:00:40.808023 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m22:00:40.808794 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m22:00:40.809449 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m22:00:40.810003 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m22:00:40.853465 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m22:00:40.855490 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m22:00:40.859167 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m22:00:40.858251 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m22:00:40.868984 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m22:00:40.846785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m22:00:40.899004 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m22:00:40.868181 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m22:00:41.085502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:00:41.100277 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp220041039252"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m22:00:41.101397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:41.092318 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:00:41.106345 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp220041019058"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m22:00:41.107255 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:00:41.105438 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:00:41.108354 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp220040997264"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m22:00:41.109460 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:00:41.099406 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:00:41.111398 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp220041075199"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m22:00:41.114457 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:01:56.088738 [debug] [Thread-3  ]: SQL status: SELECT 13292 in 74.974 seconds
[0m22:01:56.112455 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:01:56.113289 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m22:01:56.115881 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m22:01:56.116696 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:01:56.117344 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp220041075199'
        
      order by ordinal_position

  
[0m22:01:56.130399 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.012 seconds
[0m22:01:56.142145 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:01:56.142949 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:01:56.148621 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m22:01:56.163342 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:01:56.164108 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:01:56.169534 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.005 seconds
[0m22:01:56.280088 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m22:01:56.282279 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:01:56.283169 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp220041075199"
    )


  
[0m22:01:56.311775 [debug] [Thread-3  ]: SQL status: INSERT 0 13292 in 0.028 seconds
[0m22:01:56.336206 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m22:01:56.337119 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m22:01:56.337866 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m22:01:56.352344 [debug] [Thread-3  ]: SQL status: COMMIT in 0.014 seconds
[0m22:01:56.356484 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m22:01:56.360184 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb86834a880>]}
[0m22:01:56.361628 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 13292[0m in 75.55s]
[0m22:01:56.364038 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m22:01:59.971605 [debug] [Thread-2  ]: SQL status: SELECT 13292 in 78.864 seconds
[0m22:01:59.978845 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:01:59.979667 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m22:01:59.982708 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m22:01:59.983362 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:01:59.983951 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp220041019058'
        
      order by ordinal_position

  
[0m22:02:00.031866 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.047 seconds
[0m22:02:00.039890 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:00.040952 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:02:00.062690 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.021 seconds
[0m22:02:00.069518 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:00.070289 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:02:00.081682 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m22:02:00.085910 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m22:02:00.087559 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:00.088382 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp220041019058"
    )


  
[0m22:02:00.165858 [debug] [Thread-2  ]: SQL status: INSERT 0 13292 in 0.077 seconds
[0m22:02:00.169669 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m22:02:00.170781 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m22:02:00.171534 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m22:02:00.186532 [debug] [Thread-2  ]: SQL status: COMMIT in 0.014 seconds
[0m22:02:00.188261 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m22:02:00.189792 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb864301940>]}
[0m22:02:00.191354 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 13292[0m in 79.39s]
[0m22:02:00.193306 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m22:02:01.401782 [debug] [Thread-4  ]: SQL status: SELECT 13292 in 80.292 seconds
[0m22:02:01.407084 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:01.407932 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m22:02:01.411271 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m22:02:01.412132 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:01.412765 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp220040997264'
        
      order by ordinal_position

  
[0m22:02:01.428839 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.015 seconds
[0m22:02:01.435328 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:01.448110 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:02:01.461948 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m22:02:01.468357 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:01.472105 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:02:01.479836 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m22:02:01.484832 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m22:02:01.485751 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:01.486344 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp220040997264"
    )


  
[0m22:02:01.515400 [debug] [Thread-4  ]: SQL status: INSERT 0 13292 in 0.028 seconds
[0m22:02:01.517616 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m22:02:01.518350 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m22:02:01.519011 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m22:02:01.536763 [debug] [Thread-4  ]: SQL status: COMMIT in 0.017 seconds
[0m22:02:01.538128 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m22:02:01.539119 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8642eb490>]}
[0m22:02:01.539917 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 13292[0m in 80.73s]
[0m22:02:01.541316 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m22:02:04.910584 [debug] [Thread-1  ]: SQL status: SELECT 13292 in 83.809 seconds
[0m22:02:04.921616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:04.922888 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m22:02:04.926547 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m22:02:04.928226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:04.929178 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp220041039252'
        
      order by ordinal_position

  
[0m22:02:04.944987 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.015 seconds
[0m22:02:04.951854 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:04.953528 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:02:04.960124 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m22:02:04.966349 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:04.967204 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m22:02:04.974125 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m22:02:04.978651 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m22:02:04.980333 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:04.981164 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp220041039252"
    )


  
[0m22:02:05.049411 [debug] [Thread-1  ]: SQL status: INSERT 0 13292 in 0.067 seconds
[0m22:02:05.051818 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m22:02:05.052519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m22:02:05.053118 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m22:02:05.070241 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m22:02:05.071655 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m22:02:05.072652 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb864315fa0>]}
[0m22:02:05.073619 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 13292[0m in 84.28s]
[0m22:02:05.075245 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m22:02:05.076334 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m22:02:05.077847 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m22:02:05.079462 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m22:02:05.080375 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m22:02:05.076960 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m22:02:05.086584 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m22:02:05.088037 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m22:02:05.088670 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m22:02:05.110315 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m22:02:05.112080 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m22:02:05.124913 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m22:02:05.126330 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m22:02:05.137845 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:02:05.138958 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp220205135214"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m22:02:05.145181 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:02:05.144641 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:02:05.148735 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp220205133921"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m22:02:05.149535 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:03:04.277716 [debug] [Thread-3  ]: SQL status: SELECT 13292 in 59.132 seconds
[0m22:03:04.283037 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:03:04.283708 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m22:03:04.286869 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:03:04.287440 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:03:04.288019 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp220205135214'
        
      order by ordinal_position

  
[0m22:03:04.311970 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.023 seconds
[0m22:03:04.318066 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:03:04.318866 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m22:03:04.324263 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.005 seconds
[0m22:03:04.331167 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:03:04.331982 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m22:03:04.338616 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m22:03:04.342884 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m22:03:04.344362 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:03:04.345164 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp220205135214"
    )


  
[0m22:03:04.567716 [debug] [Thread-3  ]: SQL status: INSERT 0 13292 in 0.222 seconds
[0m22:03:04.570629 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m22:03:04.571552 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m22:03:04.572279 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m22:03:04.612497 [debug] [Thread-3  ]: SQL status: COMMIT in 0.039 seconds
[0m22:03:04.614598 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m22:03:04.616099 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8641903a0>]}
[0m22:03:04.617112 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 13292[0m in 59.54s]
[0m22:03:04.618579 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m22:03:19.375636 [debug] [Thread-2  ]: SQL status: SELECT 783 in 74.226 seconds
[0m22:03:19.380820 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:03:19.381371 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m22:03:19.384601 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m22:03:19.385615 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:03:19.386313 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp220205133921'
        
      order by ordinal_position

  
[0m22:03:19.399145 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.012 seconds
[0m22:03:19.407301 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:03:19.408166 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m22:03:19.421217 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.012 seconds
[0m22:03:19.432558 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:03:19.433591 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m22:03:19.441070 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.006 seconds
[0m22:03:19.445794 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m22:03:19.447239 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:03:19.448103 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp220205133921"
    )


  
[0m22:03:19.457223 [debug] [Thread-2  ]: SQL status: INSERT 0 783 in 0.008 seconds
[0m22:03:19.464118 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m22:03:19.465005 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m22:03:19.465798 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m22:03:19.472910 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m22:03:19.474331 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m22:03:19.475423 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d105eb-5c00-4544-8bfb-62549c763498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb864f4a4c0>]}
[0m22:03:19.476478 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 783[0m in 74.39s]
[0m22:03:19.477704 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m22:03:19.479560 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:19.480254 [debug] [MainThread]: On master: BEGIN
[0m22:03:19.480632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:19.517938 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m22:03:19.518727 [debug] [MainThread]: On master: COMMIT
[0m22:03:19.519080 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:19.519466 [debug] [MainThread]: On master: COMMIT
[0m22:03:19.521364 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:03:19.521862 [debug] [MainThread]: On master: Close
[0m22:03:19.522507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:19.522869 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m22:03:19.523159 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m22:03:19.523421 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m22:03:19.523788 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m22:03:19.524284 [info ] [MainThread]: 
[0m22:03:19.525701 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 39.01 seconds (159.01s).
[0m22:03:19.528319 [debug] [MainThread]: Command end result
[0m22:03:19.584147 [info ] [MainThread]: 
[0m22:03:19.585549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:19.587078 [info ] [MainThread]: 
[0m22:03:19.588230 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:03:19.590069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 160.56265, "process_user_time": 3.724855, "process_kernel_time": 0.259968, "process_mem_max_rss": "115588", "process_in_blocks": "184", "process_out_blocks": "2288"}
[0m22:03:19.591055 [debug] [MainThread]: Command `dbt run` succeeded at 22:03:19.590904 after 160.56 seconds
[0m22:03:19.591926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb868611760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8650f54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb867f3ca30>]}
[0m22:03:19.592524 [debug] [MainThread]: Flushing usage events
[0m23:00:31.794652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9970a167f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996fc05a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996f291cd0>]}


============================== 23:00:31.802045 | 516410a8-8435-4e88-9aec-127c1496a2e7 ==============================
[0m23:00:31.802045 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:00:31.803976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:00:32.039192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99701811f0>]}
[0m23:00:32.140894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996f277940>]}
[0m23:00:32.142561 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:00:32.184195 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:00:32.502968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:32.503588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:32.614612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d3d47c0>]}
[0m23:00:32.904342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d779e20>]}
[0m23:00:32.905660 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m23:00:32.907446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d3f7610>]}
[0m23:00:32.911457 [info ] [MainThread]: 
[0m23:00:32.913298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:32.920461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m23:00:32.933878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m23:00:32.990602 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m23:00:32.991661 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m23:00:32.992853 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m23:00:32.993319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:32.992255 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m23:00:32.994418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:33.033687 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.039 seconds
[0m23:00:33.034494 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.041 seconds
[0m23:00:33.039415 [debug] [ThreadPool]: On list_lab08_db: Close
[0m23:00:33.036774 [debug] [ThreadPool]: On list_lab08_db: Close
[0m23:00:33.043123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m23:00:33.053343 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m23:00:33.054265 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m23:00:33.054759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:33.056294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m23:00:33.061313 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m23:00:33.062364 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m23:00:33.063324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:33.090853 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m23:00:33.091468 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m23:00:33.092244 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m23:00:33.096329 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m23:00:33.096975 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m23:00:33.097554 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m23:00:33.099768 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m23:00:33.101708 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m23:00:33.103624 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m23:00:33.105343 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m23:00:33.105960 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m23:00:33.107674 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m23:00:33.115522 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:33.116237 [debug] [MainThread]: On master: BEGIN
[0m23:00:33.116884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:33.145960 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m23:00:33.146833 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:33.147512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:00:33.159100 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m23:00:33.160920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d32d130>]}
[0m23:00:33.161695 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:33.164014 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:33.164528 [debug] [MainThread]: On master: BEGIN
[0m23:00:33.168443 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:00:33.169054 [debug] [MainThread]: On master: COMMIT
[0m23:00:33.169500 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:33.169951 [debug] [MainThread]: On master: COMMIT
[0m23:00:33.171989 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:00:33.172677 [debug] [MainThread]: On master: Close
[0m23:00:33.173608 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:00:33.175069 [info ] [MainThread]: 
[0m23:00:33.180499 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m23:00:33.183157 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m23:00:33.181649 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m23:00:33.185261 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m23:00:33.186730 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m23:00:33.187375 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m23:00:33.182477 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m23:00:33.193598 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m23:00:33.195288 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m23:00:33.195957 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m23:00:33.184441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m23:00:33.196647 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m23:00:33.181215 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m23:00:33.197744 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m23:00:33.199066 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m23:00:33.199616 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m23:00:33.224007 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m23:00:33.226382 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m23:00:33.241091 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m23:00:33.232677 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m23:00:33.238732 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m23:00:33.252670 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m23:00:33.253905 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m23:00:33.254562 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m23:00:33.495970 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:00:33.509872 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp230033435985"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m23:00:33.510486 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:00:33.509234 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:00:33.514826 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp230033506737"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m23:00:33.515368 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:00:33.514094 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:00:33.516669 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp230033427721"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m23:00:33.521106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:00:33.520632 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:00:33.522925 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp230033518512"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m23:00:33.523561 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:01:52.974833 [debug] [Thread-3  ]: SQL status: SELECT 10487 in 79.464 seconds
[0m23:01:52.997610 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:52.998461 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m23:01:53.001397 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m23:01:53.001968 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:53.002437 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp230033435985'
        
      order by ordinal_position

  
[0m23:01:53.017204 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.014 seconds
[0m23:01:53.025858 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:53.026521 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:01:53.034126 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m23:01:53.046824 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:53.047497 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:01:53.054333 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m23:01:53.076360 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m23:01:53.077352 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:53.077854 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp230033435985"
    )


  
[0m23:01:53.099055 [debug] [Thread-3  ]: SQL status: INSERT 0 10487 in 0.021 seconds
[0m23:01:53.187246 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m23:01:53.187905 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m23:01:53.188338 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m23:01:53.205140 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m23:01:53.207987 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m23:01:53.210341 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967f01b20>]}
[0m23:01:53.211691 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 10487[0m in 80.02s]
[0m23:01:53.217080 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m23:01:54.460992 [debug] [Thread-2  ]: SQL status: SELECT 10487 in 80.937 seconds
[0m23:01:54.465845 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:54.466494 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m23:01:54.470721 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m23:01:54.471357 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:54.471858 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp230033518512'
        
      order by ordinal_position

  
[0m23:01:54.485624 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m23:01:54.491354 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:54.492043 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:01:54.499927 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m23:01:54.505718 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:54.508038 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:01:54.514084 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.005 seconds
[0m23:01:54.517443 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m23:01:54.518607 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:54.519130 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp230033518512"
    )


  
[0m23:01:54.557168 [debug] [Thread-2  ]: SQL status: INSERT 0 10487 in 0.037 seconds
[0m23:01:54.559640 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m23:01:54.560233 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m23:01:54.560837 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m23:01:54.575304 [debug] [Thread-2  ]: SQL status: COMMIT in 0.014 seconds
[0m23:01:54.576856 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m23:01:54.577876 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967f12e80>]}
[0m23:01:54.578863 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 10487[0m in 81.38s]
[0m23:01:54.579965 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m23:01:58.168930 [debug] [Thread-4  ]: SQL status: SELECT 10487 in 84.653 seconds
[0m23:01:58.173932 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:58.174856 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m23:01:58.177776 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m23:01:58.178696 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:58.179460 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp230033506737'
        
      order by ordinal_position

  
[0m23:01:58.193551 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m23:01:58.199168 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:58.201080 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:01:58.207664 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m23:01:58.212764 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:58.213370 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:01:58.219941 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m23:01:58.223199 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m23:01:58.224183 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:58.224748 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp230033506737"
    )


  
[0m23:01:58.246932 [debug] [Thread-4  ]: SQL status: INSERT 0 10487 in 0.022 seconds
[0m23:01:58.249059 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m23:01:58.249632 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m23:01:58.250105 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m23:01:58.266463 [debug] [Thread-4  ]: SQL status: COMMIT in 0.016 seconds
[0m23:01:58.268230 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m23:01:58.269302 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967f01400>]}
[0m23:01:58.270123 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 10487[0m in 85.07s]
[0m23:01:58.271673 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m23:02:03.198835 [debug] [Thread-1  ]: SQL status: SELECT 10487 in 89.677 seconds
[0m23:02:03.209764 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:02:03.210562 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m23:02:03.215518 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m23:02:03.216201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:02:03.216733 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp230033427721'
        
      order by ordinal_position

  
[0m23:02:03.234994 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.018 seconds
[0m23:02:03.243621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:02:03.253064 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:02:03.260630 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m23:02:03.265652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:02:03.266370 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m23:02:03.273289 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m23:02:03.276513 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m23:02:03.277519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:02:03.278007 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp230033427721"
    )


  
[0m23:02:03.349252 [debug] [Thread-1  ]: SQL status: INSERT 0 10487 in 0.071 seconds
[0m23:02:03.351597 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m23:02:03.352696 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m23:02:03.353335 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m23:02:03.371276 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m23:02:03.373202 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m23:02:03.374492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967f65b20>]}
[0m23:02:03.376036 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 10487[0m in 90.19s]
[0m23:02:03.377913 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m23:02:03.379517 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m23:02:03.381693 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m23:02:03.380579 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m23:02:03.384174 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m23:02:03.385532 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m23:02:03.386355 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m23:02:03.383324 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m23:02:03.395292 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m23:02:03.401293 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m23:02:03.402754 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m23:02:03.401868 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m23:02:03.410319 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m23:02:03.416343 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:02:03.417289 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp230203413928"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m23:02:03.418169 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:02:03.409056 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:02:03.419080 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp230203406499"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m23:02:03.419609 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:03:13.695887 [debug] [Thread-3  ]: SQL status: SELECT 10487 in 70.276 seconds
[0m23:03:13.702450 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:13.703178 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m23:03:13.708012 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m23:03:13.708786 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:13.710027 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp230203406499'
        
      order by ordinal_position

  
[0m23:03:13.720875 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.010 seconds
[0m23:03:13.729081 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:13.730142 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m23:03:13.736930 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m23:03:13.743967 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:13.744693 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m23:03:13.754225 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m23:03:13.757854 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m23:03:13.760430 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:13.763602 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp230203406499"
    )


  
[0m23:03:13.986346 [debug] [Thread-3  ]: SQL status: INSERT 0 10487 in 0.222 seconds
[0m23:03:13.988979 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m23:03:13.989871 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m23:03:13.990384 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m23:03:14.072024 [debug] [Thread-3  ]: SQL status: COMMIT in 0.081 seconds
[0m23:03:14.073586 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m23:03:14.074851 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996f68c310>]}
[0m23:03:14.075802 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 10487[0m in 70.69s]
[0m23:03:14.077392 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m23:03:28.171421 [debug] [Thread-2  ]: SQL status: SELECT 627 in 84.753 seconds
[0m23:03:28.179986 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:28.181194 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m23:03:28.185422 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m23:03:28.186311 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:28.187255 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp230203413928'
        
      order by ordinal_position

  
[0m23:03:28.208464 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.020 seconds
[0m23:03:28.214137 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:28.215199 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m23:03:28.223323 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.007 seconds
[0m23:03:28.230970 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:28.231703 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m23:03:28.239212 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.007 seconds
[0m23:03:28.245083 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m23:03:28.246338 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:28.247157 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp230203413928"
    )


  
[0m23:03:28.253700 [debug] [Thread-2  ]: SQL status: INSERT 0 627 in 0.006 seconds
[0m23:03:28.257078 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m23:03:28.258387 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m23:03:28.258983 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m23:03:28.265420 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m23:03:28.266977 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m23:03:28.267921 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516410a8-8435-4e88-9aec-127c1496a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996f262a60>]}
[0m23:03:28.268831 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 627[0m in 84.88s]
[0m23:03:28.269618 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m23:03:28.271712 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:28.272203 [debug] [MainThread]: On master: BEGIN
[0m23:03:28.272805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:28.304609 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m23:03:28.305506 [debug] [MainThread]: On master: COMMIT
[0m23:03:28.306085 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:28.306584 [debug] [MainThread]: On master: COMMIT
[0m23:03:28.308625 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:03:28.309191 [debug] [MainThread]: On master: Close
[0m23:03:28.310210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:28.310683 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m23:03:28.311262 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m23:03:28.311712 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m23:03:28.312179 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m23:03:28.312738 [info ] [MainThread]: 
[0m23:03:28.313941 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 55.40 seconds (175.40s).
[0m23:03:28.316604 [debug] [MainThread]: Command end result
[0m23:03:28.379384 [info ] [MainThread]: 
[0m23:03:28.381257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:28.382473 [info ] [MainThread]: 
[0m23:03:28.383540 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:03:28.385395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 176.67499, "process_user_time": 3.699794, "process_kernel_time": 0.359474, "process_mem_max_rss": "115596", "process_out_blocks": "2280", "process_in_blocks": "0"}
[0m23:03:28.386252 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:28.386101 after 176.68 seconds
[0m23:03:28.386879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9970a167f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99701811f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996d3f75b0>]}
[0m23:03:28.387670 [debug] [MainThread]: Flushing usage events
[0m00:00:28.594459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f6178e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5ef30700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5de78190>]}


============================== 00:00:28.601094 | 5203f6b4-9aff-4085-a5c0-d84ecfb24828 ==============================
[0m00:00:28.601094 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:00:28.601857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:00:28.838831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5c3664c0>]}
[0m00:00:28.923741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5de787f0>]}
[0m00:00:28.929432 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:00:28.962556 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:00:29.299658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:29.300307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:29.420371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5bfd4a00>]}
[0m00:00:29.677796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5bf0c1f0>]}
[0m00:00:29.678663 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m00:00:29.679726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5c37c760>]}
[0m00:00:29.682991 [info ] [MainThread]: 
[0m00:00:29.685277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:29.692696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m00:00:29.713999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m00:00:29.760775 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m00:00:29.761404 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m00:00:29.763168 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:29.763705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:29.762485 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:29.765004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:29.805726 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.042 seconds
[0m00:00:29.808044 [debug] [ThreadPool]: On list_lab08_db: Close
[0m00:00:29.812634 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.048 seconds
[0m00:00:29.814753 [debug] [ThreadPool]: On list_lab08_db: Close
[0m00:00:29.818021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m00:00:29.829557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m00:00:29.830382 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m00:00:29.834446 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m00:00:29.835022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:29.833706 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m00:00:29.835899 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m00:00:29.836437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:29.863949 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m00:00:29.869062 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m00:00:29.869674 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m00:00:29.864891 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m00:00:29.870571 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m00:00:29.871090 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m00:00:29.880687 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m00:00:29.882964 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m00:00:29.883714 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m00:00:29.886207 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m00:00:29.886845 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m00:00:29.890222 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m00:00:29.900537 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:29.901505 [debug] [MainThread]: On master: BEGIN
[0m00:00:29.902204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:29.935721 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m00:00:29.936520 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:29.937261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:29.952915 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m00:00:29.955170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5bf55490>]}
[0m00:00:29.956228 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:29.959215 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:29.959848 [debug] [MainThread]: On master: BEGIN
[0m00:00:29.964348 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:29.964950 [debug] [MainThread]: On master: COMMIT
[0m00:00:29.965369 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:29.965708 [debug] [MainThread]: On master: COMMIT
[0m00:00:29.967934 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:00:29.968376 [debug] [MainThread]: On master: Close
[0m00:00:29.969551 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m00:00:29.970827 [info ] [MainThread]: 
[0m00:00:29.975836 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m00:00:29.976782 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m00:00:29.977513 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m00:00:29.978060 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m00:00:29.986169 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m00:00:29.987228 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m00:00:29.988214 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m00:00:29.988881 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m00:00:29.989954 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m00:00:29.990800 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m00:00:29.991513 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m00:00:29.991916 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m00:00:29.992838 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m00:00:29.993488 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m00:00:29.994597 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m00:00:29.995137 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m00:00:30.029042 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m00:00:30.047573 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m00:00:30.046790 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m00:00:30.054958 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m00:00:30.038139 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m00:00:30.062655 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m00:00:30.045952 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m00:00:30.074447 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m00:00:30.354216 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:00:30.356508 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:00:30.363570 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp000030209388"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m00:00:30.364213 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:00:30.357399 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:00:30.365162 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp000030205168"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m00:00:30.365682 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:00:30.359282 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:00:30.366542 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp000030234514"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m00:00:30.367912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:30.362063 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp000030245126"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m00:00:30.370849 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:01:49.467475 [debug] [Thread-2  ]: SQL status: SELECT 9149 in 79.097 seconds
[0m00:01:49.493116 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:49.493870 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m00:01:49.503537 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m00:01:49.504558 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:49.505617 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp000030245126'
        
      order by ordinal_position

  
[0m00:01:49.544084 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.038 seconds
[0m00:01:49.554340 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:49.555103 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:49.567778 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m00:01:49.583725 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:49.584429 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:49.601622 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.016 seconds
[0m00:01:49.683566 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m00:01:49.684916 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:49.685580 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp000030245126"
    )


  
[0m00:01:49.811055 [debug] [Thread-2  ]: SQL status: INSERT 0 9149 in 0.125 seconds
[0m00:01:49.833758 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m00:01:49.834603 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m00:01:49.835261 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m00:01:49.865028 [debug] [Thread-2  ]: SQL status: COMMIT in 0.029 seconds
[0m00:01:49.868304 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m00:01:49.871095 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f34f9a0>]}
[0m00:01:49.872166 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 9149[0m in 79.88s]
[0m00:01:49.873311 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m00:01:50.202267 [debug] [Thread-3  ]: SQL status: SELECT 9149 in 79.836 seconds
[0m00:01:50.209555 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:50.210155 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m00:01:50.213720 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m00:01:50.214231 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:50.214649 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp000030205168'
        
      order by ordinal_position

  
[0m00:01:50.249552 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.034 seconds
[0m00:01:50.255028 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:50.255816 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:50.272525 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.016 seconds
[0m00:01:50.278830 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:50.279474 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:50.298214 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.018 seconds
[0m00:01:50.301885 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m00:01:50.302811 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:50.303343 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp000030205168"
    )


  
[0m00:01:50.350796 [debug] [Thread-3  ]: SQL status: INSERT 0 9149 in 0.047 seconds
[0m00:01:50.353390 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m00:01:50.353904 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m00:01:50.354362 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m00:01:50.370515 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m00:01:50.371913 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m00:01:50.372884 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5aa85df0>]}
[0m00:01:50.373919 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 9149[0m in 80.38s]
[0m00:01:50.375605 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m00:01:52.950278 [debug] [Thread-4  ]: SQL status: SELECT 9149 in 82.586 seconds
[0m00:01:52.955687 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:52.956798 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m00:01:52.959901 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m00:01:52.960826 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:52.961515 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp000030209388'
        
      order by ordinal_position

  
[0m00:01:52.981784 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.020 seconds
[0m00:01:52.988545 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:52.989598 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:53.003371 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.012 seconds
[0m00:01:53.010356 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:53.011167 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:53.017991 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m00:01:53.022631 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m00:01:53.024406 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:53.025317 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp000030209388"
    )


  
[0m00:01:53.049731 [debug] [Thread-4  ]: SQL status: INSERT 0 9149 in 0.024 seconds
[0m00:01:53.052554 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m00:01:53.053491 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m00:01:53.054261 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m00:01:53.073559 [debug] [Thread-4  ]: SQL status: COMMIT in 0.019 seconds
[0m00:01:53.075234 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m00:01:53.077506 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5ab44460>]}
[0m00:01:53.078605 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 9149[0m in 83.08s]
[0m00:01:53.079912 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m00:01:55.902913 [debug] [Thread-1  ]: SQL status: SELECT 9149 in 85.535 seconds
[0m00:01:55.919816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:01:55.920532 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m00:01:55.923870 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m00:01:55.924492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:01:55.925109 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp000030234514'
        
      order by ordinal_position

  
[0m00:01:55.937451 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.012 seconds
[0m00:01:55.944739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:01:55.945545 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:55.953385 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m00:01:55.962735 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:01:55.963663 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m00:01:55.972549 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.008 seconds
[0m00:01:55.975550 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m00:01:55.976489 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:01:55.977094 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp000030234514"
    )


  
[0m00:01:56.032131 [debug] [Thread-1  ]: SQL status: INSERT 0 9149 in 0.054 seconds
[0m00:01:56.036205 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m00:01:56.037331 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m00:01:56.038952 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m00:01:56.055072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.015 seconds
[0m00:01:56.056639 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m00:01:56.058176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda581aed60>]}
[0m00:01:56.059034 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 9149[0m in 86.08s]
[0m00:01:56.060699 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m00:01:56.061914 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_events
[0m00:01:56.062968 [info ] [Thread-2  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m00:01:56.063709 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_events)
[0m00:01:56.064454 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m00:01:56.078494 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m00:01:56.079294 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m00:01:56.080734 [info ] [Thread-3  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m00:01:56.083056 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_sales)
[0m00:01:56.083718 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m00:01:56.105065 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m00:01:56.105977 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_events
[0m00:01:56.117256 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:01:56.118105 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp000156110645"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m00:01:56.118648 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:01:56.120902 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m00:01:56.135756 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:01:56.136620 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp000156127842"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m00:01:56.137421 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:02:57.617883 [debug] [Thread-2  ]: SQL status: SELECT 9149 in 61.499 seconds
[0m00:02:57.623376 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:02:57.623977 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m00:02:57.629268 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m00:02:57.629883 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:02:57.630505 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp000156110645'
        
      order by ordinal_position

  
[0m00:02:57.648459 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.017 seconds
[0m00:02:57.656128 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:02:57.656760 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m00:02:57.667678 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.010 seconds
[0m00:02:57.674084 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:02:57.674711 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m00:02:57.684152 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.009 seconds
[0m00:02:57.687322 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m00:02:57.688361 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:02:57.688863 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp000156110645"
    )


  
[0m00:02:57.780482 [debug] [Thread-2  ]: SQL status: INSERT 0 9149 in 0.091 seconds
[0m00:02:57.783018 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m00:02:57.783631 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m00:02:57.784128 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m00:02:57.804349 [debug] [Thread-2  ]: SQL status: COMMIT in 0.020 seconds
[0m00:02:57.806029 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: Close
[0m00:02:57.807085 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5ae872b0>]}
[0m00:02:57.808079 [info ] [Thread-2  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 9149[0m in 61.74s]
[0m00:02:57.809586 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_events
[0m00:03:11.212606 [debug] [Thread-3  ]: SQL status: SELECT 568 in 75.075 seconds
[0m00:03:11.217850 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:11.218452 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m00:03:11.221218 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m00:03:11.221791 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:11.222261 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp000156127842'
        
      order by ordinal_position

  
[0m00:03:11.233073 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.010 seconds
[0m00:03:11.241741 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:11.242657 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m00:03:11.250218 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.007 seconds
[0m00:03:11.255692 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:11.256338 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m00:03:11.262699 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.006 seconds
[0m00:03:11.266530 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m00:03:11.267671 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:11.268262 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp000156127842"
    )


  
[0m00:03:11.274577 [debug] [Thread-3  ]: SQL status: INSERT 0 568 in 0.006 seconds
[0m00:03:11.276679 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m00:03:11.277485 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m00:03:11.278028 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m00:03:11.286080 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m00:03:11.287572 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m00:03:11.288536 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5203f6b4-9aff-4085-a5c0-d84ecfb24828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5bf30220>]}
[0m00:03:11.289507 [info ] [Thread-3  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 568[0m in 75.21s]
[0m00:03:11.292059 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m00:03:11.293906 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:11.294430 [debug] [MainThread]: On master: BEGIN
[0m00:03:11.295086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:11.327989 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m00:03:11.328939 [debug] [MainThread]: On master: COMMIT
[0m00:03:11.329672 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:11.330157 [debug] [MainThread]: On master: COMMIT
[0m00:03:11.332251 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:03:11.333020 [debug] [MainThread]: On master: Close
[0m00:03:11.334267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:11.334852 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m00:03:11.335498 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m00:03:11.336277 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m00:03:11.336914 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m00:03:11.338066 [info ] [MainThread]: 
[0m00:03:11.339486 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 41.65 seconds (161.65s).
[0m00:03:11.342206 [debug] [MainThread]: Command end result
[0m00:03:11.406219 [info ] [MainThread]: 
[0m00:03:11.407903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:11.409146 [info ] [MainThread]: 
[0m00:03:11.410254 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:03:11.411964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 162.8955, "process_user_time": 3.69289, "process_kernel_time": 0.286373, "process_mem_max_rss": "115600", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m00:03:11.412929 [debug] [MainThread]: Command `dbt run` succeeded at 00:03:11.412752 after 162.90 seconds
[0m00:03:11.413593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f6178e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f1be1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5bf0cfd0>]}
[0m00:03:11.414159 [debug] [MainThread]: Flushing usage events
[0m01:00:31.634866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa093a98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa07c0a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa09d7adf0>]}


============================== 01:00:31.641910 | f77d399e-a3bf-44b7-b55c-4784c3cc1206 ==============================
[0m01:00:31.641910 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:00:31.643754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:00:31.936685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa060fc4c0>]}
[0m01:00:32.066977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa07ab42b0>]}
[0m01:00:32.068135 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:00:32.122276 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:00:32.459228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:32.459849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:32.639480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa05d659d0>]}
[0m01:00:32.900192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa061005e0>]}
[0m01:00:32.901084 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m01:00:32.902378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa06100b20>]}
[0m01:00:32.905334 [info ] [MainThread]: 
[0m01:00:32.907050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:00:32.915628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m01:00:32.929415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m01:00:33.007294 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m01:00:33.007916 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m01:00:33.009520 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m01:00:33.010276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:33.008600 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m01:00:33.011553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:33.078661 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.067 seconds
[0m01:00:33.079725 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.069 seconds
[0m01:00:33.084606 [debug] [ThreadPool]: On list_lab08_db: Close
[0m01:00:33.082290 [debug] [ThreadPool]: On list_lab08_db: Close
[0m01:00:33.088392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m01:00:33.099369 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m01:00:33.100319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m01:00:33.104876 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m01:00:33.105588 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m01:00:33.106148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:33.101230 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m01:00:33.107246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:33.147407 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m01:00:33.148176 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m01:00:33.148801 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m01:00:33.149569 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m01:00:33.150084 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m01:00:33.150957 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m01:00:33.160994 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m01:00:33.162937 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m01:00:33.163586 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m01:00:33.165161 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m01:00:33.165625 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m01:00:33.167809 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m01:00:33.176115 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:33.176637 [debug] [MainThread]: On master: BEGIN
[0m01:00:33.181114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:33.221271 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m01:00:33.222223 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:33.222671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:00:33.237194 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m01:00:33.239666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa05cc0e50>]}
[0m01:00:33.240588 [debug] [MainThread]: On master: ROLLBACK
[0m01:00:33.243625 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:33.244262 [debug] [MainThread]: On master: BEGIN
[0m01:00:33.248851 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:00:33.249489 [debug] [MainThread]: On master: COMMIT
[0m01:00:33.249893 [debug] [MainThread]: Using postgres connection "master"
[0m01:00:33.250451 [debug] [MainThread]: On master: COMMIT
[0m01:00:33.252859 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:00:33.253290 [debug] [MainThread]: On master: Close
[0m01:00:33.254155 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m01:00:33.255167 [info ] [MainThread]: 
[0m01:00:33.260785 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m01:00:33.263731 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m01:00:33.261468 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m01:00:33.265381 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m01:00:33.266245 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m01:00:33.266717 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m01:00:33.262655 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m01:00:33.275099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m01:00:33.275720 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m01:00:33.264565 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m01:00:33.276477 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m01:00:33.277775 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m01:00:33.278471 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m01:00:33.291543 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m01:00:33.321995 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m01:00:33.331403 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m01:00:33.333436 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m01:00:33.332449 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m01:00:33.346616 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m01:00:33.328558 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m01:00:33.354267 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m01:00:33.353183 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m01:00:33.370814 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m01:00:33.361205 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m01:00:33.607110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:00:33.616015 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp010033492581"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m01:00:33.616557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:33.614567 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:00:33.617357 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp010033481306"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m01:00:33.617802 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:00:33.612020 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:00:33.618472 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp010033509006"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m01:00:33.618980 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:00:33.615353 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:00:33.619666 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp010033586935"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m01:00:33.620119 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:01:50.923170 [debug] [Thread-2  ]: SQL status: SELECT 8710 in 77.305 seconds
[0m01:01:50.968238 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:01:50.968930 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m01:01:50.974691 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m01:01:50.975190 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:01:50.975610 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp010033481306'
        
      order by ordinal_position

  
[0m01:01:50.993453 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.017 seconds
[0m01:01:51.007383 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:01:51.007992 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:01:51.014539 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m01:01:51.048929 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:01:51.049658 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:01:51.057857 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m01:01:51.191089 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m01:01:51.192550 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:01:51.193222 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp010033481306"
    )


  
[0m01:01:51.210638 [debug] [Thread-2  ]: SQL status: INSERT 0 8710 in 0.016 seconds
[0m01:01:51.276339 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m01:01:51.278124 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m01:01:51.281901 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m01:01:51.299218 [debug] [Thread-2  ]: SQL status: COMMIT in 0.016 seconds
[0m01:01:51.302082 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m01:01:51.304484 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa090e0970>]}
[0m01:01:51.306706 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 8710[0m in 78.04s]
[0m01:01:51.309939 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m01:01:51.566606 [debug] [Thread-3  ]: SQL status: SELECT 8710 in 77.947 seconds
[0m01:01:51.571751 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:51.572616 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m01:01:51.575604 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m01:01:51.576277 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:51.576823 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp010033509006'
        
      order by ordinal_position

  
[0m01:01:51.588750 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.011 seconds
[0m01:01:51.595131 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:51.596074 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:01:51.602395 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m01:01:51.608410 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:51.609095 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:01:51.615253 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m01:01:51.618676 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m01:01:51.619923 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:51.620945 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp010033509006"
    )


  
[0m01:01:51.635594 [debug] [Thread-3  ]: SQL status: INSERT 0 8710 in 0.014 seconds
[0m01:01:51.637978 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m01:01:51.638625 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m01:01:51.639188 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m01:01:51.652448 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m01:01:51.654273 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m01:01:51.655349 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa048609d0>]}
[0m01:01:51.656387 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 8710[0m in 78.38s]
[0m01:01:51.658062 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m01:01:58.900038 [debug] [Thread-4  ]: SQL status: SELECT 8710 in 85.280 seconds
[0m01:01:58.905824 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:01:58.906844 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m01:01:58.910243 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m01:01:58.911241 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:01:58.911851 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp010033586935'
        
      order by ordinal_position

  
[0m01:01:58.925775 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m01:01:58.931949 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:01:58.937156 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:01:58.951458 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m01:01:58.981686 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:01:58.986939 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:01:59.002672 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.010 seconds
[0m01:01:59.013907 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m01:01:59.018402 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:01:59.024296 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp010033586935"
    )


  
[0m01:01:59.056081 [debug] [Thread-4  ]: SQL status: INSERT 0 8710 in 0.022 seconds
[0m01:01:59.059252 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m01:01:59.060053 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m01:01:59.060631 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m01:01:59.073353 [debug] [Thread-4  ]: SQL status: COMMIT in 0.012 seconds
[0m01:01:59.074733 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m01:01:59.075630 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa048c7400>]}
[0m01:01:59.076830 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 8710[0m in 85.74s]
[0m01:01:59.077740 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m01:02:00.619269 [debug] [Thread-1  ]: SQL status: SELECT 8710 in 87.003 seconds
[0m01:02:00.625634 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:00.626303 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m01:02:00.633190 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m01:02:00.633883 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:00.634358 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp010033492581'
        
      order by ordinal_position

  
[0m01:02:00.650013 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.015 seconds
[0m01:02:00.655289 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:00.656147 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:02:00.662973 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m01:02:00.677260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:00.678142 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m01:02:00.687925 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m01:02:00.691201 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m01:02:00.692099 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:00.692576 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp010033492581"
    )


  
[0m01:02:00.757801 [debug] [Thread-1  ]: SQL status: INSERT 0 8710 in 0.065 seconds
[0m01:02:00.760035 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m01:02:00.760635 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m01:02:00.761079 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m01:02:00.783451 [debug] [Thread-1  ]: SQL status: COMMIT in 0.022 seconds
[0m01:02:00.784809 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m01:02:00.786057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa060eaa60>]}
[0m01:02:00.787024 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 8710[0m in 87.51s]
[0m01:02:00.789039 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m01:02:00.790273 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_events
[0m01:02:00.792378 [info ] [Thread-2  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m01:02:00.794211 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_events)
[0m01:02:00.791372 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m01:02:00.795810 [info ] [Thread-3  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m01:02:00.797491 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_sales)
[0m01:02:00.798060 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m01:02:00.795040 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m01:02:00.812236 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m01:02:00.814095 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_events
[0m01:02:00.813176 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m01:02:00.821278 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m01:02:00.828154 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:02:00.819941 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:02:00.830190 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp010200817651"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m01:02:00.830744 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:02:00.829434 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp010200825673"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m01:02:00.831986 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:02:59.755411 [debug] [Thread-2  ]: SQL status: SELECT 8710 in 58.924 seconds
[0m01:02:59.763787 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:02:59.773109 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m01:02:59.777062 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m01:02:59.777835 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:02:59.778583 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp010200817651'
        
      order by ordinal_position

  
[0m01:02:59.797832 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.018 seconds
[0m01:02:59.805255 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:02:59.813086 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m01:02:59.820659 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.007 seconds
[0m01:02:59.829441 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:02:59.833113 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m01:02:59.841179 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.007 seconds
[0m01:02:59.843988 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m01:02:59.845497 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:02:59.846201 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp010200817651"
    )


  
[0m01:03:00.116911 [debug] [Thread-2  ]: SQL status: INSERT 0 8710 in 0.270 seconds
[0m01:03:00.120583 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m01:03:00.121752 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m01:03:00.123342 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m01:03:00.145055 [debug] [Thread-2  ]: SQL status: COMMIT in 0.021 seconds
[0m01:03:00.147334 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: Close
[0m01:03:00.148833 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa047c15b0>]}
[0m01:03:00.150729 [info ] [Thread-2  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 8710[0m in 59.35s]
[0m01:03:00.153383 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_events
[0m01:03:12.548247 [debug] [Thread-3  ]: SQL status: SELECT 477 in 71.716 seconds
[0m01:03:12.553595 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:12.556092 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m01:03:12.561676 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m01:03:12.562361 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:12.563072 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp010200825673'
        
      order by ordinal_position

  
[0m01:03:12.575076 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.011 seconds
[0m01:03:12.583107 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:12.584166 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m01:03:12.591457 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.006 seconds
[0m01:03:12.607718 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:12.611539 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m01:03:12.619145 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.007 seconds
[0m01:03:12.623603 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m01:03:12.624899 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:12.625737 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp010200825673"
    )


  
[0m01:03:12.633866 [debug] [Thread-3  ]: SQL status: INSERT 0 477 in 0.005 seconds
[0m01:03:12.636354 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m01:03:12.645218 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m01:03:12.648324 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m01:03:12.662625 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m01:03:12.666791 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m01:03:12.671601 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77d399e-a3bf-44b7-b55c-4784c3cc1206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa047c1ca0>]}
[0m01:03:12.678767 [info ] [Thread-3  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 477[0m in 71.87s]
[0m01:03:12.689324 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m01:03:12.696784 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:12.697392 [debug] [MainThread]: On master: BEGIN
[0m01:03:12.697849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:03:12.739244 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m01:03:12.740097 [debug] [MainThread]: On master: COMMIT
[0m01:03:12.740638 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:12.741541 [debug] [MainThread]: On master: COMMIT
[0m01:03:12.744297 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:03:12.744868 [debug] [MainThread]: On master: Close
[0m01:03:12.745730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:12.746141 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m01:03:12.746542 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m01:03:12.746844 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m01:03:12.747299 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m01:03:12.747909 [info ] [MainThread]: 
[0m01:03:12.748394 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 39.84 seconds (159.84s).
[0m01:03:12.750208 [debug] [MainThread]: Command end result
[0m01:03:12.862051 [info ] [MainThread]: 
[0m01:03:12.862955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:03:12.872540 [info ] [MainThread]: 
[0m01:03:12.873335 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:03:12.875397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 161.34283, "process_user_time": 3.923379, "process_kernel_time": 0.284211, "process_mem_max_rss": "115604", "process_in_blocks": "1720", "process_out_blocks": "2280"}
[0m01:03:12.876790 [debug] [MainThread]: Command `dbt run` succeeded at 01:03:12.876181 after 161.34 seconds
[0m01:03:12.877323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa093a98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa05d8ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa05d53640>]}
[0m01:03:12.877912 [debug] [MainThread]: Flushing usage events
[0m02:00:23.341630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c90448b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c78aa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c9a20df0>]}


============================== 02:00:23.351149 | adff5fef-eef5-4fce-9526-d85386247c7d ==============================
[0m02:00:23.351149 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:00:23.352918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:00:23.614800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c5d97490>]}
[0m02:00:23.700581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c77552b0>]}
[0m02:00:23.701939 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:00:23.745085 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:00:24.086979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:24.087643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:24.216009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c5a059d0>]}
[0m02:00:24.462342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c5da05e0>]}
[0m02:00:24.463180 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m02:00:24.464446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c5da0b20>]}
[0m02:00:24.467153 [info ] [MainThread]: 
[0m02:00:24.468693 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:00:24.477979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m02:00:24.494812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m02:00:24.560199 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m02:00:24.560882 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m02:00:24.562210 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:24.562701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:24.561613 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m02:00:24.563666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:24.608816 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.046 seconds
[0m02:00:24.611322 [debug] [ThreadPool]: On list_lab08_db: Close
[0m02:00:24.612605 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.049 seconds
[0m02:00:24.614840 [debug] [ThreadPool]: On list_lab08_db: Close
[0m02:00:24.617584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m02:00:24.627083 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m02:00:24.627921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m02:00:24.632540 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m02:00:24.633316 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m02:00:24.633935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:24.628356 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m02:00:24.635083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:24.675278 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m02:00:24.676107 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m02:00:24.676858 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m02:00:24.677299 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m02:00:24.677932 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m02:00:24.678365 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m02:00:24.689952 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m02:00:24.692476 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m02:00:24.693125 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m02:00:24.694981 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m02:00:24.696128 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m02:00:24.698223 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m02:00:24.707575 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:24.708224 [debug] [MainThread]: On master: BEGIN
[0m02:00:24.708658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:24.745167 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m02:00:24.746276 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:24.748763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:00:24.765833 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m02:00:24.768408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c903dd90>]}
[0m02:00:24.769650 [debug] [MainThread]: On master: ROLLBACK
[0m02:00:24.772673 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:24.773572 [debug] [MainThread]: On master: BEGIN
[0m02:00:24.779550 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m02:00:24.780324 [debug] [MainThread]: On master: COMMIT
[0m02:00:24.780953 [debug] [MainThread]: Using postgres connection "master"
[0m02:00:24.781523 [debug] [MainThread]: On master: COMMIT
[0m02:00:24.784348 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:00:24.785364 [debug] [MainThread]: On master: Close
[0m02:00:24.786279 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m02:00:24.787797 [info ] [MainThread]: 
[0m02:00:24.798171 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m02:00:24.800327 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m02:00:24.801797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m02:00:24.799042 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m02:00:24.803919 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m02:00:24.806996 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m02:00:24.807662 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m02:00:24.799589 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m02:00:24.814016 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m02:00:24.815585 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m02:00:24.816409 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m02:00:24.803098 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m02:00:24.802604 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m02:00:24.817391 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m02:00:24.818859 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m02:00:24.819433 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m02:00:24.841598 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m02:00:24.858509 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m02:00:24.857155 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m02:00:24.848438 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m02:00:24.867569 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m02:00:24.868733 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m02:00:24.855951 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m02:00:24.960509 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m02:00:25.064477 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:00:25.065895 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:00:25.073403 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp020024990287"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m02:00:25.073914 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:00:25.072792 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp020024987375"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m02:00:25.074776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:00:25.077618 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:00:25.071990 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:00:25.078617 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp020025017889"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m02:00:25.080314 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:00:25.079363 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp020025000974"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m02:00:25.081548 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:01:42.660777 [debug] [Thread-2  ]: SQL status: SELECT 5543 in 77.587 seconds
[0m02:01:42.708526 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:42.713067 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m02:01:42.719233 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m02:01:42.720130 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:42.720864 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp020024990287'
        
      order by ordinal_position

  
[0m02:01:42.734717 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m02:01:42.750402 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:42.751232 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:42.757312 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.005 seconds
[0m02:01:42.780318 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:42.781240 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:42.789665 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m02:01:42.809951 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m02:01:42.827052 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:42.828195 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp020024990287"
    )


  
[0m02:01:42.857137 [debug] [Thread-2  ]: SQL status: INSERT 0 5543 in 0.028 seconds
[0m02:01:43.025018 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m02:01:43.026166 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m02:01:43.027000 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m02:01:43.039868 [debug] [Thread-2  ]: SQL status: COMMIT in 0.012 seconds
[0m02:01:43.043039 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m02:01:43.046089 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c8d80970>]}
[0m02:01:43.047485 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 5543[0m in 78.24s]
[0m02:01:43.049370 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m02:01:43.698912 [debug] [Thread-3  ]: SQL status: SELECT 5543 in 78.617 seconds
[0m02:01:43.704255 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:43.705351 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m02:01:43.708925 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m02:01:43.709566 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:43.710175 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp020025000974'
        
      order by ordinal_position

  
[0m02:01:43.724541 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.013 seconds
[0m02:01:43.732037 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:43.733247 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:43.740637 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m02:01:43.745855 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:43.746567 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:43.753176 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m02:01:43.756616 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m02:01:43.757863 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:43.758488 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp020025000974"
    )


  
[0m02:01:43.770970 [debug] [Thread-3  ]: SQL status: INSERT 0 5543 in 0.012 seconds
[0m02:01:43.773651 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m02:01:43.774291 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m02:01:43.774799 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m02:01:43.785249 [debug] [Thread-3  ]: SQL status: COMMIT in 0.010 seconds
[0m02:01:43.787419 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m02:01:43.788491 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c4540220>]}
[0m02:01:43.789589 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 5543[0m in 78.97s]
[0m02:01:43.791237 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m02:01:48.168193 [debug] [Thread-4  ]: SQL status: SELECT 5543 in 83.088 seconds
[0m02:01:48.173624 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:48.174401 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m02:01:48.177284 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m02:01:48.177893 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:48.178405 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp020025017889'
        
      order by ordinal_position

  
[0m02:01:48.190057 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.011 seconds
[0m02:01:48.196015 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:48.196981 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:48.203502 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m02:01:48.209404 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:48.210758 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:48.217294 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m02:01:48.220490 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m02:01:48.221400 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:48.222030 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp020025017889"
    )


  
[0m02:01:48.234374 [debug] [Thread-4  ]: SQL status: INSERT 0 5543 in 0.011 seconds
[0m02:01:48.236906 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m02:01:48.237649 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m02:01:48.238152 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m02:01:48.249019 [debug] [Thread-4  ]: SQL status: COMMIT in 0.010 seconds
[0m02:01:48.250732 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m02:01:48.251887 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c4540820>]}
[0m02:01:48.252893 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 5543[0m in 83.43s]
[0m02:01:48.254170 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m02:01:51.217332 [debug] [Thread-1  ]: SQL status: SELECT 5543 in 86.142 seconds
[0m02:01:51.225184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:51.226268 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m02:01:51.229246 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m02:01:51.229993 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:51.230660 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp020024987375'
        
      order by ordinal_position

  
[0m02:01:51.242923 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m02:01:51.252780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:51.253681 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:51.261117 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m02:01:51.268046 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:51.268977 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m02:01:51.275277 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m02:01:51.279025 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m02:01:51.280512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:51.281389 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp020024987375"
    )


  
[0m02:01:51.319136 [debug] [Thread-1  ]: SQL status: INSERT 0 5543 in 0.037 seconds
[0m02:01:51.321639 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m02:01:51.322352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m02:01:51.322892 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m02:01:51.342991 [debug] [Thread-1  ]: SQL status: COMMIT in 0.019 seconds
[0m02:01:51.344765 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m02:01:51.346034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c446c4c0>]}
[0m02:01:51.347380 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 5543[0m in 86.54s]
[0m02:01:51.349092 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m02:01:51.350483 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_events
[0m02:01:51.351378 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m02:01:51.353917 [info ] [Thread-3  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m02:01:51.355370 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_sales)
[0m02:01:51.352427 [info ] [Thread-2  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m02:01:51.356747 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_events)
[0m02:01:51.357300 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m02:01:51.356101 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m02:01:51.372102 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m02:01:51.373080 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m02:01:51.374704 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_events
[0m02:01:51.382152 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:01:51.383314 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m02:01:51.384071 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp020151379165"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m02:01:51.391936 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:01:51.391214 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:01:51.393019 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp020151388954"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m02:01:51.393714 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:02:47.049286 [debug] [Thread-2  ]: SQL status: SELECT 5543 in 55.657 seconds
[0m02:02:47.058911 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:47.059524 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m02:02:47.064905 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m02:02:47.065483 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:47.065922 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp020151379165'
        
      order by ordinal_position

  
[0m02:02:47.082356 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.016 seconds
[0m02:02:47.089798 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:47.090503 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m02:02:47.102265 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.011 seconds
[0m02:02:47.110322 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:47.110986 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m02:02:47.120138 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.008 seconds
[0m02:02:47.123047 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m02:02:47.123949 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:47.124450 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp020151379165"
    )


  
[0m02:02:47.200000 [debug] [Thread-2  ]: SQL status: INSERT 0 5543 in 0.075 seconds
[0m02:02:47.202181 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m02:02:47.202768 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m02:02:47.203221 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m02:02:47.223824 [debug] [Thread-2  ]: SQL status: COMMIT in 0.020 seconds
[0m02:02:47.225870 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: Close
[0m02:02:47.227040 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c5db4670>]}
[0m02:02:47.228460 [info ] [Thread-2  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 5543[0m in 55.87s]
[0m02:02:47.230660 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_events
[0m02:03:06.478711 [debug] [Thread-3  ]: SQL status: SELECT 317 in 75.085 seconds
[0m02:03:06.484847 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:03:06.485613 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m02:03:06.492191 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m02:03:06.492983 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:03:06.493733 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp020151388954'
        
      order by ordinal_position

  
[0m02:03:06.510825 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.016 seconds
[0m02:03:06.519616 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:03:06.520552 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m02:03:06.527712 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.006 seconds
[0m02:03:06.536658 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:03:06.537640 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m02:03:06.545929 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.007 seconds
[0m02:03:06.551395 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m02:03:06.553545 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:03:06.554514 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp020151388954"
    )


  
[0m02:03:06.559722 [debug] [Thread-3  ]: SQL status: INSERT 0 317 in 0.004 seconds
[0m02:03:06.563443 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m02:03:06.564928 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m02:03:06.565713 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m02:03:06.572460 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m02:03:06.574073 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m02:03:06.575794 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adff5fef-eef5-4fce-9526-d85386247c7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c5d973d0>]}
[0m02:03:06.577334 [info ] [Thread-3  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 317[0m in 75.22s]
[0m02:03:06.578766 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m02:03:06.582168 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:06.583054 [debug] [MainThread]: On master: BEGIN
[0m02:03:06.583800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:03:06.616507 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m02:03:06.617290 [debug] [MainThread]: On master: COMMIT
[0m02:03:06.617769 [debug] [MainThread]: Using postgres connection "master"
[0m02:03:06.618248 [debug] [MainThread]: On master: COMMIT
[0m02:03:06.620817 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:03:06.622038 [debug] [MainThread]: On master: Close
[0m02:03:06.623064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:06.624006 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m02:03:06.624872 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m02:03:06.625324 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m02:03:06.625979 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m02:03:06.626736 [info ] [MainThread]: 
[0m02:03:06.627624 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 42.16 seconds (162.16s).
[0m02:03:06.630876 [debug] [MainThread]: Command end result
[0m02:03:06.693822 [info ] [MainThread]: 
[0m02:03:06.694531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:06.695358 [info ] [MainThread]: 
[0m02:03:06.696368 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:03:06.697865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 163.48245, "process_user_time": 3.83064, "process_kernel_time": 0.246906, "process_mem_max_rss": "115592", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m02:03:06.698640 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:06.698442 after 163.48 seconds
[0m02:03:06.699407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c90448b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c5de9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c59f2400>]}
[0m02:03:06.700140 [debug] [MainThread]: Flushing usage events
[0m03:00:17.660615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19de4e1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19deebbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19dcbf5790>]}


============================== 03:00:17.667815 | bfaa23e6-8173-411a-aa6c-f417fb2743cf ==============================
[0m03:00:17.667815 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:00:17.669222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:00:17.948211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19db24d460>]}
[0m03:00:18.038585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19db2037f0>]}
[0m03:00:18.039879 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:00:18.083848 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:00:18.423510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:18.424272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:18.610554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19daea79a0>]}
[0m03:00:18.876803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19db252910>]}
[0m03:00:18.877805 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m03:00:18.879355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19daecfca0>]}
[0m03:00:18.882805 [info ] [MainThread]: 
[0m03:00:18.884793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:18.892885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m03:00:18.905383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m03:00:18.996577 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m03:00:18.997152 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m03:00:18.997574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:18.999039 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m03:00:18.999515 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m03:00:18.999903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:19.032945 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.033 seconds
[0m03:00:19.035915 [debug] [ThreadPool]: On list_lab08_db: Close
[0m03:00:19.042040 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.044 seconds
[0m03:00:19.044323 [debug] [ThreadPool]: On list_lab08_db: Close
[0m03:00:19.047134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m03:00:19.056652 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m03:00:19.057679 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m03:00:19.058126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:19.059161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m03:00:19.064243 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m03:00:19.064990 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m03:00:19.065588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:19.088298 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m03:00:19.089191 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m03:00:19.089577 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m03:00:19.097189 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m03:00:19.099084 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m03:00:19.101355 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m03:00:19.106447 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m03:00:19.107222 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m03:00:19.107672 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m03:00:19.115024 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m03:00:19.117238 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m03:00:19.120085 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m03:00:19.129604 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:19.130355 [debug] [MainThread]: On master: BEGIN
[0m03:00:19.131088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:19.175506 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m03:00:19.176167 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:19.176757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:19.186829 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m03:00:19.188844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19dae03b20>]}
[0m03:00:19.189590 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:19.191999 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:19.192462 [debug] [MainThread]: On master: BEGIN
[0m03:00:19.196188 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m03:00:19.196871 [debug] [MainThread]: On master: COMMIT
[0m03:00:19.197462 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:19.198002 [debug] [MainThread]: On master: COMMIT
[0m03:00:19.200968 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m03:00:19.201587 [debug] [MainThread]: On master: Close
[0m03:00:19.202676 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m03:00:19.203182 [info ] [MainThread]: 
[0m03:00:19.233615 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m03:00:19.234330 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m03:00:19.235003 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m03:00:19.235446 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m03:00:19.236336 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m03:00:19.237014 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m03:00:19.240118 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m03:00:19.240688 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m03:00:19.237590 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m03:00:19.260863 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m03:00:19.261611 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m03:00:19.238083 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m03:00:19.262792 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m03:00:19.263441 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m03:00:19.239307 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m03:00:19.280373 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m03:00:19.328416 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m03:00:19.335851 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m03:00:19.339011 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m03:00:19.337962 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m03:00:19.349511 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m03:00:19.333499 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m03:00:19.357178 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m03:00:19.348225 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m03:00:19.678903 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:00:19.685925 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:00:19.682567 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:00:19.690841 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp030019558206"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m03:00:19.691567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:00:19.690112 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp030019552731"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m03:00:19.692587 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:00:19.689341 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp030019568339"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m03:00:19.693561 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:00:19.688402 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:00:19.695478 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp030019581941"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m03:00:19.696612 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:01:31.442049 [debug] [Thread-2  ]: SQL status: SELECT 3555 in 71.749 seconds
[0m03:01:31.481886 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:31.484542 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m03:01:31.492435 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m03:01:31.493227 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:31.493866 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp030019552731'
        
      order by ordinal_position

  
[0m03:01:31.512602 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.018 seconds
[0m03:01:31.524555 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:31.527196 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:31.537612 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m03:01:31.689085 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:31.689914 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:31.699013 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m03:01:31.718940 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m03:01:31.720601 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:31.721320 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp030019552731"
    )


  
[0m03:01:31.745442 [debug] [Thread-2  ]: SQL status: INSERT 0 3555 in 0.024 seconds
[0m03:01:31.806984 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m03:01:31.811695 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m03:01:31.812840 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m03:01:31.822925 [debug] [Thread-2  ]: SQL status: COMMIT in 0.009 seconds
[0m03:01:31.826017 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m03:01:31.832652 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19de221940>]}
[0m03:01:31.837527 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 3555[0m in 72.59s]
[0m03:01:31.842728 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m03:01:32.937731 [debug] [Thread-3  ]: SQL status: SELECT 3555 in 73.241 seconds
[0m03:01:32.948851 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:32.953148 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m03:01:32.956537 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m03:01:32.957125 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:32.957549 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp030019581941'
        
      order by ordinal_position

  
[0m03:01:32.970877 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.013 seconds
[0m03:01:32.982820 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:32.983946 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:32.990672 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m03:01:33.007632 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:33.009098 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:33.016228 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m03:01:33.020576 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m03:01:33.022004 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:33.022636 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp030019581941"
    )


  
[0m03:01:33.033037 [debug] [Thread-3  ]: SQL status: INSERT 0 3555 in 0.010 seconds
[0m03:01:33.036042 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m03:01:33.036772 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m03:01:33.037840 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m03:01:33.047619 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m03:01:33.049405 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m03:01:33.050652 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d99dda90>]}
[0m03:01:33.052114 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 3555[0m in 73.79s]
[0m03:01:33.053801 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m03:01:40.013460 [debug] [Thread-4  ]: SQL status: SELECT 3555 in 80.320 seconds
[0m03:01:40.036914 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:40.037530 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m03:01:40.040435 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m03:01:40.041136 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:40.041608 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp030019568339'
        
      order by ordinal_position

  
[0m03:01:40.056619 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m03:01:40.061938 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:40.062519 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:40.069821 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m03:01:40.076744 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:40.077313 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:40.083088 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.005 seconds
[0m03:01:40.086580 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m03:01:40.088502 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:40.089748 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp030019568339"
    )


  
[0m03:01:40.101520 [debug] [Thread-4  ]: SQL status: INSERT 0 3555 in 0.011 seconds
[0m03:01:40.103542 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m03:01:40.104134 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m03:01:40.104614 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m03:01:40.113862 [debug] [Thread-4  ]: SQL status: COMMIT in 0.009 seconds
[0m03:01:40.115354 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m03:01:40.116249 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19dae239a0>]}
[0m03:01:40.117212 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 3555[0m in 80.85s]
[0m03:01:40.118250 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m03:01:40.278534 [debug] [Thread-1  ]: SQL status: SELECT 3555 in 80.587 seconds
[0m03:01:40.284162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:40.285090 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m03:01:40.288363 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m03:01:40.289232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:40.289925 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp030019558206'
        
      order by ordinal_position

  
[0m03:01:40.301435 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m03:01:40.307871 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:40.308475 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:40.315300 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m03:01:40.324649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:40.325743 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m03:01:40.332318 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m03:01:40.335675 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m03:01:40.336807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:40.337716 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp030019558206"
    )


  
[0m03:01:40.349195 [debug] [Thread-1  ]: SQL status: INSERT 0 3555 in 0.011 seconds
[0m03:01:40.354742 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m03:01:40.355792 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m03:01:40.356517 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m03:01:40.363733 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m03:01:40.365602 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m03:01:40.366669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d99ddc40>]}
[0m03:01:40.367950 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 3555[0m in 81.13s]
[0m03:01:40.369341 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m03:01:40.370938 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_events
[0m03:01:40.371867 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m03:01:40.374310 [info ] [Thread-3  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m03:01:40.375539 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_sales)
[0m03:01:40.376116 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m03:01:40.372760 [info ] [Thread-2  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m03:01:40.382298 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_events)
[0m03:01:40.382935 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m03:01:40.390318 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m03:01:40.395710 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_events
[0m03:01:40.394068 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m03:01:40.402986 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m03:01:40.411535 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:01:40.413583 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:01:40.415034 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp030140400655"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m03:01:40.415586 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:01:40.414225 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp030140409161"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m03:01:40.416478 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:02:39.148296 [debug] [Thread-2  ]: SQL status: SELECT 3555 in 58.733 seconds
[0m03:02:39.153519 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:39.154226 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m03:02:39.159586 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m03:02:39.160401 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:39.161495 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp030140400655'
        
      order by ordinal_position

  
[0m03:02:39.176823 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.014 seconds
[0m03:02:39.182339 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:39.183234 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m03:02:39.197874 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.012 seconds
[0m03:02:39.202953 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:39.203701 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m03:02:39.211159 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.007 seconds
[0m03:02:39.215010 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m03:02:39.216264 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:39.216879 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp030140400655"
    )


  
[0m03:02:39.282509 [debug] [Thread-2  ]: SQL status: INSERT 0 3555 in 0.065 seconds
[0m03:02:39.284967 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m03:02:39.285958 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m03:02:39.286644 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m03:02:39.304895 [debug] [Thread-2  ]: SQL status: COMMIT in 0.017 seconds
[0m03:02:39.306968 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: Close
[0m03:02:39.308185 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d9a30ca0>]}
[0m03:02:39.309524 [info ] [Thread-2  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 3555[0m in 58.93s]
[0m03:02:39.310723 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_events
[0m03:02:57.727233 [debug] [Thread-3  ]: SQL status: SELECT 210 in 77.311 seconds
[0m03:02:57.733153 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:57.733800 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m03:02:57.736631 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m03:02:57.737632 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:57.738295 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp030140409161'
        
      order by ordinal_position

  
[0m03:02:57.749930 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.011 seconds
[0m03:02:57.757792 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:57.758642 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m03:02:57.769097 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.010 seconds
[0m03:02:57.775938 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:57.776699 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m03:02:57.783834 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.006 seconds
[0m03:02:57.789847 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m03:02:57.790863 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:57.791466 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp030140409161"
    )


  
[0m03:02:57.801750 [debug] [Thread-3  ]: SQL status: INSERT 0 210 in 0.010 seconds
[0m03:02:57.804010 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m03:02:57.804666 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m03:02:57.805207 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m03:02:57.809096 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m03:02:57.810499 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m03:02:57.811753 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfaa23e6-8173-411a-aa6c-f417fb2743cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c2ec7be0>]}
[0m03:02:57.812831 [info ] [Thread-3  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 210[0m in 77.44s]
[0m03:02:57.814259 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m03:02:57.816067 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:57.816691 [debug] [MainThread]: On master: BEGIN
[0m03:02:57.817265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:02:57.852608 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m03:02:57.853592 [debug] [MainThread]: On master: COMMIT
[0m03:02:57.854278 [debug] [MainThread]: Using postgres connection "master"
[0m03:02:57.854914 [debug] [MainThread]: On master: COMMIT
[0m03:02:57.856984 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m03:02:57.857698 [debug] [MainThread]: On master: Close
[0m03:02:57.858925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:02:57.859545 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m03:02:57.860143 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m03:02:57.860774 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m03:02:57.861242 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m03:02:57.861829 [info ] [MainThread]: 
[0m03:02:57.862340 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 38.98 seconds (158.98s).
[0m03:02:57.864742 [debug] [MainThread]: Command end result
[0m03:02:57.921799 [info ] [MainThread]: 
[0m03:02:57.922742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:02:57.923969 [info ] [MainThread]: 
[0m03:02:57.925144 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m03:02:57.926601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 160.3837, "process_user_time": 4.150518, "process_kernel_time": 0.398359, "process_mem_max_rss": "115596", "process_out_blocks": "2280", "process_in_blocks": "0"}
[0m03:02:57.927542 [debug] [MainThread]: Command `dbt run` succeeded at 03:02:57.927386 after 160.38 seconds
[0m03:02:57.928350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19de4e1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19db215fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19db2153a0>]}
[0m03:02:57.928971 [debug] [MainThread]: Flushing usage events
[0m04:00:19.905054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad89c2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9399dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad70cf790>]}


============================== 04:00:19.914947 | 1e3a3158-a6c9-4620-92d3-058b14cc8b0e ==============================
[0m04:00:19.914947 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:00:19.919390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:00:20.249872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad5725460>]}
[0m04:00:20.350879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad56db7f0>]}
[0m04:00:20.352397 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:00:20.410358 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:00:21.006187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:00:21.006913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:00:21.331762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad537c850>]}
[0m04:00:21.630719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad572d910>]}
[0m04:00:21.631875 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m04:00:21.632900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad53a0d00>]}
[0m04:00:21.636108 [info ] [MainThread]: 
[0m04:00:21.637257 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:00:21.645808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m04:00:21.662256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m04:00:21.728864 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m04:00:21.729611 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m04:00:21.730897 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m04:00:21.731438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:21.730277 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m04:00:21.733037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:00:21.779107 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.046 seconds
[0m04:00:21.779722 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.048 seconds
[0m04:00:21.785748 [debug] [ThreadPool]: On list_lab08_db: Close
[0m04:00:21.782874 [debug] [ThreadPool]: On list_lab08_db: Close
[0m04:00:21.791614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m04:00:21.802773 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m04:00:21.803316 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m04:00:21.803980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:21.805063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m04:00:21.809273 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m04:00:21.810113 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m04:00:21.810682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:00:21.838778 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m04:00:21.839778 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m04:00:21.840493 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m04:00:21.845808 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m04:00:21.848213 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m04:00:21.848762 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m04:00:21.849657 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m04:00:21.851719 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m04:00:21.854642 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m04:00:21.857649 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m04:00:21.859952 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m04:00:21.862039 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m04:00:21.871758 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:21.872447 [debug] [MainThread]: On master: BEGIN
[0m04:00:21.872908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:00:21.905419 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m04:00:21.906378 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:21.907213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:00:21.922125 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m04:00:21.924873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacfdf5ac0>]}
[0m04:00:21.925942 [debug] [MainThread]: On master: ROLLBACK
[0m04:00:21.928796 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:21.929442 [debug] [MainThread]: On master: BEGIN
[0m04:00:21.934272 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m04:00:21.934967 [debug] [MainThread]: On master: COMMIT
[0m04:00:21.935884 [debug] [MainThread]: Using postgres connection "master"
[0m04:00:21.938049 [debug] [MainThread]: On master: COMMIT
[0m04:00:21.940810 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m04:00:21.941579 [debug] [MainThread]: On master: Close
[0m04:00:21.942867 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m04:00:21.943572 [info ] [MainThread]: 
[0m04:00:21.949905 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m04:00:21.951000 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m04:00:21.953650 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m04:00:21.954598 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m04:00:21.955875 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m04:00:21.955406 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m04:00:21.952389 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m04:00:21.963650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m04:00:21.964459 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m04:00:21.951558 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m04:00:21.965338 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m04:00:21.966091 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m04:00:21.966765 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m04:00:21.962601 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m04:00:21.967571 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m04:00:21.968186 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m04:00:22.076633 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m04:00:22.088525 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m04:00:22.092920 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m04:00:22.091193 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m04:00:22.105474 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m04:00:22.082076 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m04:00:22.125686 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m04:00:22.106403 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m04:00:22.625964 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:00:22.638829 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp040022484978"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m04:00:22.632317 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:00:22.640484 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp040022521747"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m04:00:22.641503 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m04:00:22.630835 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:00:22.642973 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp040022508880"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m04:00:22.644034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:00:22.639794 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:00:22.637593 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:00:22.645933 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp040022490541"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m04:00:22.647481 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:01:36.395238 [debug] [Thread-2  ]: SQL status: SELECT 3365 in 73.754 seconds
[0m04:01:36.439136 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:36.439773 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m04:01:36.443717 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m04:01:36.445191 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:36.446107 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp040022521747'
        
      order by ordinal_position

  
[0m04:01:36.477392 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.031 seconds
[0m04:01:36.495561 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:36.496246 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:36.508811 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m04:01:36.621905 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:36.622552 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:36.631919 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m04:01:36.658782 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m04:01:36.660620 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:36.662098 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp040022521747"
    )


  
[0m04:01:36.673462 [debug] [Thread-2  ]: SQL status: INSERT 0 3365 in 0.010 seconds
[0m04:01:36.704577 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m04:01:36.705348 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m04:01:36.705766 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m04:01:36.718345 [debug] [Thread-2  ]: SQL status: COMMIT in 0.011 seconds
[0m04:01:36.723499 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m04:01:36.726546 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacfe8bfa0>]}
[0m04:01:36.727590 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 3365[0m in 74.77s]
[0m04:01:36.729119 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m04:01:37.662734 [debug] [Thread-3  ]: SQL status: SELECT 3365 in 75.015 seconds
[0m04:01:37.669894 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:37.670699 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m04:01:37.675911 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m04:01:37.681733 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:37.685262 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp040022490541'
        
      order by ordinal_position

  
[0m04:01:37.705380 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.019 seconds
[0m04:01:37.711820 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:37.721065 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:37.732352 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m04:01:37.739268 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:37.749087 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:37.755720 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m04:01:37.759042 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m04:01:37.760273 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:37.760883 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp040022490541"
    )


  
[0m04:01:37.768485 [debug] [Thread-3  ]: SQL status: INSERT 0 3365 in 0.007 seconds
[0m04:01:37.770636 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m04:01:37.771351 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m04:01:37.771887 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m04:01:37.785176 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m04:01:37.787006 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m04:01:37.788283 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacfe7b1f0>]}
[0m04:01:37.789595 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 3365[0m in 75.82s]
[0m04:01:37.791057 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m04:01:41.880973 [debug] [Thread-4  ]: SQL status: SELECT 3365 in 79.241 seconds
[0m04:01:41.886317 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:41.886981 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m04:01:41.890768 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m04:01:41.891371 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:41.891849 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp040022484978'
        
      order by ordinal_position

  
[0m04:01:41.911818 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.019 seconds
[0m04:01:41.918878 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:41.919734 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:41.929950 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.009 seconds
[0m04:01:41.941298 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:41.942684 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:41.950111 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m04:01:41.953932 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m04:01:41.955685 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:41.956429 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp040022484978"
    )


  
[0m04:01:41.967839 [debug] [Thread-4  ]: SQL status: INSERT 0 3365 in 0.010 seconds
[0m04:01:41.971950 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m04:01:41.972912 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m04:01:41.973785 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m04:01:41.985526 [debug] [Thread-4  ]: SQL status: COMMIT in 0.011 seconds
[0m04:01:41.987568 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m04:01:41.988780 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacd5430a0>]}
[0m04:01:41.989892 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 3365[0m in 80.02s]
[0m04:01:41.990999 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m04:01:44.462170 [debug] [Thread-1  ]: SQL status: SELECT 3365 in 81.818 seconds
[0m04:01:44.467797 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:44.468603 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m04:01:44.470882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m04:01:44.471821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:44.472443 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp040022508880'
        
      order by ordinal_position

  
[0m04:01:44.490448 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.017 seconds
[0m04:01:44.503600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:44.504214 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:44.509941 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m04:01:44.525702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:44.526363 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m04:01:44.533132 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m04:01:44.536674 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m04:01:44.538071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:44.538670 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp040022508880"
    )


  
[0m04:01:44.553408 [debug] [Thread-1  ]: SQL status: INSERT 0 3365 in 0.014 seconds
[0m04:01:44.556124 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m04:01:44.556904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m04:01:44.557470 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m04:01:44.568423 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m04:01:44.570003 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m04:01:44.570971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacd54b430>]}
[0m04:01:44.571840 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 3365[0m in 82.61s]
[0m04:01:44.572693 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m04:01:44.573753 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_events
[0m04:01:44.574365 [info ] [Thread-2  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m04:01:44.575155 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_events)
[0m04:01:44.575932 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m04:01:44.582391 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m04:01:44.583166 [info ] [Thread-3  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m04:01:44.583757 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_sales)
[0m04:01:44.584411 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m04:01:44.590928 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m04:01:44.591878 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_events
[0m04:01:44.602627 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m04:01:44.604011 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m04:01:44.613361 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:01:44.614650 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp040144596412"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m04:01:44.615445 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m04:01:44.619791 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:01:44.620764 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp040144611231"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m04:01:44.621882 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m04:02:48.804203 [debug] [Thread-2  ]: SQL status: SELECT 3365 in 64.189 seconds
[0m04:02:48.810624 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:48.811256 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m04:02:48.815801 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m04:02:48.816663 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:48.817147 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp040144596412'
        
      order by ordinal_position

  
[0m04:02:48.828694 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.011 seconds
[0m04:02:48.838034 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:48.838730 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m04:02:48.848905 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.005 seconds
[0m04:02:48.853795 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:48.854382 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m04:02:48.860311 [debug] [Thread-2  ]: SQL status: SELECT 7 in 0.005 seconds
[0m04:02:48.864477 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m04:02:48.865433 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:48.866082 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp040144596412"
    )


  
[0m04:02:48.974553 [debug] [Thread-2  ]: SQL status: INSERT 0 3365 in 0.107 seconds
[0m04:02:48.977058 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m04:02:48.977695 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m04:02:48.978176 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m04:02:48.993105 [debug] [Thread-2  ]: SQL status: COMMIT in 0.014 seconds
[0m04:02:48.994375 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_events: Close
[0m04:02:48.995292 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacfed5340>]}
[0m04:02:48.996133 [info ] [Thread-2  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 3365[0m in 64.42s]
[0m04:02:48.997018 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_events
[0m04:03:02.908887 [debug] [Thread-3  ]: SQL status: SELECT 201 in 78.287 seconds
[0m04:03:02.916646 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:03:02.918847 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m04:03:02.923291 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m04:03:02.924197 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:03:02.924828 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp040144611231'
        
      order by ordinal_position

  
[0m04:03:02.936864 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.011 seconds
[0m04:03:02.947522 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:03:02.948291 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m04:03:02.960442 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.011 seconds
[0m04:03:02.974449 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:03:02.978004 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m04:03:02.989572 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.008 seconds
[0m04:03:03.006637 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m04:03:03.018434 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:03:03.022768 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp040144611231"
    )


  
[0m04:03:03.034546 [debug] [Thread-3  ]: SQL status: INSERT 0 201 in 0.008 seconds
[0m04:03:03.039246 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m04:03:03.043223 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m04:03:03.044510 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m04:03:03.052246 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m04:03:03.054371 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m04:03:03.055621 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e3a3158-a6c9-4620-92d3-058b14cc8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad531afa0>]}
[0m04:03:03.057353 [info ] [Thread-3  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 201[0m in 78.47s]
[0m04:03:03.059205 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m04:03:03.061969 [debug] [MainThread]: Using postgres connection "master"
[0m04:03:03.062571 [debug] [MainThread]: On master: BEGIN
[0m04:03:03.063555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:03:03.099907 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m04:03:03.100834 [debug] [MainThread]: On master: COMMIT
[0m04:03:03.101477 [debug] [MainThread]: Using postgres connection "master"
[0m04:03:03.102097 [debug] [MainThread]: On master: COMMIT
[0m04:03:03.104334 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m04:03:03.105716 [debug] [MainThread]: On master: Close
[0m04:03:03.106604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:03:03.107105 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m04:03:03.107521 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m04:03:03.107997 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m04:03:03.108513 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m04:03:03.109500 [info ] [MainThread]: 
[0m04:03:03.110950 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 41.47 seconds (161.47s).
[0m04:03:03.114607 [debug] [MainThread]: Command end result
[0m04:03:03.182725 [info ] [MainThread]: 
[0m04:03:03.184297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:03:03.185473 [info ] [MainThread]: 
[0m04:03:03.186482 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m04:03:03.188150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 163.38683, "process_user_time": 4.267064, "process_kernel_time": 0.395999, "process_mem_max_rss": "115592", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m04:03:03.189029 [debug] [MainThread]: Command `dbt run` succeeded at 04:03:03.188888 after 163.39 seconds
[0m04:03:03.189673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad89c2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad53a0d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad5317730>]}
[0m04:03:03.190257 [debug] [MainThread]: Flushing usage events
[0m05:00:15.093354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdda28b77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdda1132d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdda1103ac0>]}


============================== 05:00:15.099943 | d2476520-c293-4260-81c7-0e6c6561326e ==============================
[0m05:00:15.099943 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:00:15.101313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:00:15.422944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9f6045b0>]}
[0m05:00:15.683139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdda1117a90>]}
[0m05:00:15.684278 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m05:00:15.790669 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:00:16.211989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:16.212609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:16.328741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9f2727f0>]}
[0m05:00:16.648250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9f2610a0>]}
[0m05:00:16.649495 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m05:00:16.650857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9f29c3d0>]}
[0m05:00:16.654785 [info ] [MainThread]: 
[0m05:00:16.656555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:00:16.676526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m05:00:16.714064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m05:00:16.761514 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m05:00:16.762036 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m05:00:16.763133 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m05:00:16.763532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:16.762436 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m05:00:16.764558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:16.802305 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.039 seconds
[0m05:00:16.804766 [debug] [ThreadPool]: On list_lab08_db: Close
[0m05:00:16.806057 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.042 seconds
[0m05:00:16.808770 [debug] [ThreadPool]: On list_lab08_db: Close
[0m05:00:16.812199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m05:00:16.822384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m05:00:16.831469 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m05:00:16.831978 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m05:00:16.832305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:16.830514 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m05:00:16.833242 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m05:00:16.833550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:16.873934 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m05:00:16.874639 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m05:00:16.875613 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m05:00:16.876586 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m05:00:16.875070 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m05:00:16.877223 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m05:00:16.885226 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m05:00:16.891694 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m05:00:16.892400 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m05:00:16.895793 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m05:00:16.898586 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m05:00:16.899188 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m05:00:16.910869 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.911613 [debug] [MainThread]: On master: BEGIN
[0m05:00:16.912299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:16.947126 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m05:00:16.948266 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.949623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:16.961997 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m05:00:16.964015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9f20dac0>]}
[0m05:00:16.965516 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:16.968083 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.968556 [debug] [MainThread]: On master: BEGIN
[0m05:00:16.973103 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m05:00:16.973789 [debug] [MainThread]: On master: COMMIT
[0m05:00:16.974313 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:16.974700 [debug] [MainThread]: On master: COMMIT
[0m05:00:16.976911 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m05:00:16.977325 [debug] [MainThread]: On master: Close
[0m05:00:16.978183 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m05:00:16.979452 [info ] [MainThread]: 
[0m05:00:16.983945 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m05:00:16.984885 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m05:00:16.985773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m05:00:16.986931 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m05:00:16.989253 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m05:00:16.987986 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m05:00:16.991133 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m05:00:16.991824 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m05:00:16.992283 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m05:00:16.987547 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m05:00:16.998790 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m05:00:16.999751 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m05:00:16.990513 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m05:00:17.001902 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m05:00:16.988422 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m05:00:17.000471 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m05:00:17.090976 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m05:00:17.102780 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m05:00:17.099326 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m05:00:17.108827 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m05:00:17.097042 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m05:00:17.117107 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m05:00:17.101962 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m05:00:17.134146 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m05:00:17.455325 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:00:17.461945 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:00:17.469093 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp050017310719"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m05:00:17.469733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:17.461009 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:00:17.470702 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp050017303455"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m05:00:17.471164 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:00:17.453436 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:00:17.472063 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp050017315434"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m05:00:17.472622 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:00:17.474042 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp050017333688"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m05:00:17.474709 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m05:01:38.617584 [debug] [Thread-2  ]: SQL status: SELECT 1751 in 81.142 seconds
[0m05:01:38.650595 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:38.651177 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m05:01:38.658554 [debug] [Thread-2  ]: SQL status: BEGIN in 0.007 seconds
[0m05:01:38.659242 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:38.660190 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp050017333688'
        
      order by ordinal_position

  
[0m05:01:38.686770 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.026 seconds
[0m05:01:38.697815 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:38.698702 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:38.707810 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m05:01:38.728250 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:38.729198 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:38.738841 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.009 seconds
[0m05:01:38.960770 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m05:01:38.961992 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:38.962691 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp050017333688"
    )


  
[0m05:01:38.976105 [debug] [Thread-2  ]: SQL status: INSERT 0 1751 in 0.013 seconds
[0m05:01:39.015071 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m05:01:39.015939 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m05:01:39.016500 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m05:01:39.024744 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m05:01:39.028120 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m05:01:39.030932 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdda25f08e0>]}
[0m05:01:39.031833 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 1751[0m in 82.04s]
[0m05:01:39.032591 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m05:01:39.189354 [debug] [Thread-3  ]: SQL status: SELECT 1751 in 81.718 seconds
[0m05:01:39.196209 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:39.197125 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m05:01:39.200135 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m05:01:39.200870 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:39.201479 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp050017303455'
        
      order by ordinal_position

  
[0m05:01:39.224683 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.022 seconds
[0m05:01:39.233219 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:39.233914 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:39.251379 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.017 seconds
[0m05:01:39.259270 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:39.259888 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:39.270034 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.009 seconds
[0m05:01:39.274807 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m05:01:39.276330 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:39.277123 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp050017303455"
    )


  
[0m05:01:39.283883 [debug] [Thread-3  ]: SQL status: INSERT 0 1751 in 0.006 seconds
[0m05:01:39.286171 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m05:01:39.287086 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m05:01:39.287742 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m05:01:39.294113 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m05:01:39.296010 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m05:01:39.297022 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9dd70460>]}
[0m05:01:39.298193 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 1751[0m in 82.30s]
[0m05:01:39.300200 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m05:01:42.234459 [debug] [Thread-4  ]: SQL status: SELECT 1751 in 84.759 seconds
[0m05:01:42.252367 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:42.253277 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m05:01:42.257666 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m05:01:42.258464 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:42.267422 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp050017315434'
        
      order by ordinal_position

  
[0m05:01:42.300894 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.029 seconds
[0m05:01:42.313856 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:42.314553 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:42.333987 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.019 seconds
[0m05:01:42.352354 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:42.361449 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:42.373252 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.011 seconds
[0m05:01:42.379063 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m05:01:42.380095 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:42.380644 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp050017315434"
    )


  
[0m05:01:42.396080 [debug] [Thread-4  ]: SQL status: INSERT 0 1751 in 0.006 seconds
[0m05:01:42.398781 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m05:01:42.399445 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m05:01:42.400037 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m05:01:42.407299 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m05:01:42.408828 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m05:01:42.409983 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9dd70df0>]}
[0m05:01:42.411515 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 1751[0m in 85.42s]
[0m05:01:42.421597 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m05:01:46.020683 [debug] [Thread-1  ]: SQL status: SELECT 1751 in 88.551 seconds
[0m05:01:46.032746 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:46.038434 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m05:01:46.042902 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m05:01:46.043958 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:46.044577 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp050017310719'
        
      order by ordinal_position

  
[0m05:01:46.061074 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.016 seconds
[0m05:01:46.072459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:46.074690 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:46.082544 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m05:01:46.091905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:46.093005 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m05:01:46.099524 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m05:01:46.102400 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m05:01:46.103395 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:46.104065 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp050017310719"
    )


  
[0m05:01:46.117440 [debug] [Thread-1  ]: SQL status: INSERT 0 1751 in 0.013 seconds
[0m05:01:46.120278 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m05:01:46.120923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m05:01:46.121445 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m05:01:46.131235 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m05:01:46.133603 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m05:01:46.134808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9c46f1c0>]}
[0m05:01:46.136768 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 1751[0m in 89.15s]
[0m05:01:46.138535 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m05:01:46.139815 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.dm_events
[0m05:01:46.140560 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m05:01:46.141469 [info ] [Thread-1  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m05:01:46.142150 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m05:01:46.145182 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m05:01:46.145985 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m05:01:46.144209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_browser_events, now model.dbt_lab08_project.dm_events)
[0m05:01:46.156190 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m05:01:46.162175 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m05:01:46.162940 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.dm_events
[0m05:01:46.155424 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m05:01:46.169259 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m05:01:46.177497 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:01:46.178172 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp050146173098"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m05:01:46.178951 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m05:01:46.168433 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:01:46.179816 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp050146166459"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m05:01:46.180247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:02:46.231232 [debug] [Thread-1  ]: SQL status: SELECT 1751 in 60.051 seconds
[0m05:02:46.240300 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:46.241352 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m05:02:46.244462 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m05:02:46.245758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:46.246955 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp050146166459'
        
      order by ordinal_position

  
[0m05:02:46.260458 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.013 seconds
[0m05:02:46.270320 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:46.271615 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m05:02:46.279579 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.007 seconds
[0m05:02:46.285490 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:46.286081 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m05:02:46.293333 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.007 seconds
[0m05:02:46.297840 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m05:02:46.298773 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:46.299363 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp050146166459"
    )


  
[0m05:02:46.352294 [debug] [Thread-1  ]: SQL status: INSERT 0 1751 in 0.052 seconds
[0m05:02:46.355052 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m05:02:46.355683 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m05:02:46.356210 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m05:02:46.367658 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m05:02:46.369992 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: Close
[0m05:02:46.371019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9e036280>]}
[0m05:02:46.372539 [info ] [Thread-1  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 1751[0m in 60.23s]
[0m05:02:46.374143 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.dm_events
[0m05:03:04.929018 [debug] [Thread-2  ]: SQL status: SELECT 110 in 78.750 seconds
[0m05:03:04.936046 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:03:04.936927 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m05:03:04.941241 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m05:03:04.942067 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:03:04.942781 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp050146173098'
        
      order by ordinal_position

  
[0m05:03:04.953794 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.010 seconds
[0m05:03:04.960116 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:03:04.960892 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m05:03:04.967337 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.006 seconds
[0m05:03:04.973317 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:03:04.973938 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m05:03:04.980657 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.006 seconds
[0m05:03:04.986398 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m05:03:04.987851 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:03:04.988658 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp050146173098"
    )


  
[0m05:03:04.994381 [debug] [Thread-2  ]: SQL status: INSERT 0 110 in 0.005 seconds
[0m05:03:04.996494 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m05:03:04.997335 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m05:03:04.998090 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m05:03:05.002671 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m05:03:05.005025 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m05:03:05.006284 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2476520-c293-4260-81c7-0e6c6561326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9dd111f0>]}
[0m05:03:05.007494 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 110[0m in 78.86s]
[0m05:03:05.009121 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m05:03:05.011707 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:05.012747 [debug] [MainThread]: On master: BEGIN
[0m05:03:05.013225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:03:05.046109 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m05:03:05.047027 [debug] [MainThread]: On master: COMMIT
[0m05:03:05.047931 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:05.048621 [debug] [MainThread]: On master: COMMIT
[0m05:03:05.050942 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m05:03:05.051641 [debug] [MainThread]: On master: Close
[0m05:03:05.052692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:05.053094 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m05:03:05.053367 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m05:03:05.053779 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m05:03:05.054052 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_geo_events' was properly closed.
[0m05:03:05.054686 [info ] [MainThread]: 
[0m05:03:05.056064 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 48.40 seconds (168.40s).
[0m05:03:05.059104 [debug] [MainThread]: Command end result
[0m05:03:05.117746 [info ] [MainThread]: 
[0m05:03:05.119550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:03:05.120657 [info ] [MainThread]: 
[0m05:03:05.121984 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m05:03:05.123611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 170.16145, "process_user_time": 4.259992, "process_kernel_time": 0.332634, "process_mem_max_rss": "115592", "process_out_blocks": "2280", "process_in_blocks": "0"}
[0m05:03:05.124578 [debug] [MainThread]: Command `dbt run` succeeded at 05:03:05.124223 after 170.16 seconds
[0m05:03:05.125205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdda28b77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9f654ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd9f207b50>]}
[0m05:03:05.125843 [debug] [MainThread]: Flushing usage events
[0m06:00:20.919916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07fb457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07e3cbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07e39cac0>]}


============================== 06:00:20.929562 | c457d1d8-5519-4dc1-a9b9-9c444c95cc11 ==============================
[0m06:00:20.929562 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:00:20.931203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:21.334335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07c89c5b0>]}
[0m06:00:21.498037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07e3b0a90>]}
[0m06:00:21.499921 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:00:21.600647 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:00:21.974090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:21.974796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:22.079649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07c50a7f0>]}
[0m06:00:22.353746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07c4fa0a0>]}
[0m06:00:22.354711 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m06:00:22.355937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07c5353d0>]}
[0m06:00:22.359339 [info ] [MainThread]: 
[0m06:00:22.360917 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:00:22.369861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m06:00:22.382347 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m06:00:22.453657 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m06:00:22.454403 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m06:00:22.455427 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m06:00:22.455950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:22.455014 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m06:00:22.456982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:22.495658 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.040 seconds
[0m06:00:22.498261 [debug] [ThreadPool]: On list_lab08_db: Close
[0m06:00:22.505132 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.048 seconds
[0m06:00:22.507969 [debug] [ThreadPool]: On list_lab08_db: Close
[0m06:00:22.511823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m06:00:22.524482 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m06:00:22.525052 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m06:00:22.525371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:22.526472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m06:00:22.530824 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m06:00:22.532428 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m06:00:22.533449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:22.561766 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m06:00:22.562589 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m06:00:22.563220 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m06:00:22.570486 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m06:00:22.573470 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m06:00:22.581024 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m06:00:22.583767 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m06:00:22.585002 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m06:00:22.585665 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m06:00:22.592678 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m06:00:22.594525 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m06:00:22.597568 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m06:00:22.607830 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.608691 [debug] [MainThread]: On master: BEGIN
[0m06:00:22.609086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:00:22.652161 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m06:00:22.653019 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.654195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:00:22.669532 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m06:00:22.671874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07c4696d0>]}
[0m06:00:22.672491 [debug] [MainThread]: On master: ROLLBACK
[0m06:00:22.675332 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.675761 [debug] [MainThread]: On master: BEGIN
[0m06:00:22.679974 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:00:22.680458 [debug] [MainThread]: On master: COMMIT
[0m06:00:22.680897 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:22.681223 [debug] [MainThread]: On master: COMMIT
[0m06:00:22.683544 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:00:22.684125 [debug] [MainThread]: On master: Close
[0m06:00:22.685080 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m06:00:22.686892 [info ] [MainThread]: 
[0m06:00:22.691217 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m06:00:22.693222 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m06:00:22.694343 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m06:00:22.695863 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m06:00:22.692628 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m06:00:22.697696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m06:00:22.698481 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m06:00:22.693886 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m06:00:22.706672 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m06:00:22.707220 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m06:00:22.695254 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m06:00:22.708790 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m06:00:22.709373 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m06:00:22.696432 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m06:00:22.710123 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m06:00:22.710652 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m06:00:22.759874 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m06:00:22.796192 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m06:00:22.779491 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m06:00:22.802629 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m06:00:22.783922 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m06:00:22.795082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m06:00:22.822807 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m06:00:22.864976 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m06:00:23.250803 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:00:23.262371 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp060023127690"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m06:00:23.262942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:00:23.261624 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:00:23.263758 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp060023058757"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m06:00:23.264245 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:00:23.266845 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:00:23.267391 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp060023078468"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m06:00:23.267972 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:00:23.258365 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:00:23.269132 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp060023107351"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m06:00:23.269614 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:01:41.761609 [debug] [Thread-3  ]: SQL status: SELECT 3363 in 78.492 seconds
[0m06:01:41.785936 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:41.786819 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m06:01:41.793273 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m06:01:41.794145 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:41.794867 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp060023107351'
        
      order by ordinal_position

  
[0m06:01:41.821302 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.026 seconds
[0m06:01:41.830102 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:41.830814 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:41.841484 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m06:01:41.940021 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:41.940673 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:41.951769 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m06:01:41.982486 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m06:01:41.983885 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:41.984394 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp060023107351"
    )


  
[0m06:01:42.006435 [debug] [Thread-3  ]: SQL status: INSERT 0 3363 in 0.015 seconds
[0m06:01:42.074501 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m06:01:42.075531 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m06:01:42.078467 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m06:01:42.088366 [debug] [Thread-3  ]: SQL status: COMMIT in 0.009 seconds
[0m06:01:42.091661 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m06:01:42.102626 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07f8888e0>]}
[0m06:01:42.103882 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 3363[0m in 79.38s]
[0m06:01:42.105315 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m06:01:45.575987 [debug] [Thread-2  ]: SQL status: SELECT 3363 in 82.308 seconds
[0m06:01:45.580548 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:45.581138 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m06:01:45.584655 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m06:01:45.585362 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:45.586086 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp060023078468'
        
      order by ordinal_position

  
[0m06:01:45.602136 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.015 seconds
[0m06:01:45.609586 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:45.610247 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:45.621609 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.011 seconds
[0m06:01:45.627632 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:45.628289 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:45.637922 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.009 seconds
[0m06:01:45.641499 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m06:01:45.642642 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:45.643192 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp060023078468"
    )


  
[0m06:01:45.669035 [debug] [Thread-2  ]: SQL status: INSERT 0 3363 in 0.025 seconds
[0m06:01:45.671328 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m06:01:45.671843 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m06:01:45.672510 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m06:01:45.687074 [debug] [Thread-2  ]: SQL status: COMMIT in 0.013 seconds
[0m06:01:45.688479 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m06:01:45.689508 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07b0416d0>]}
[0m06:01:45.690484 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 3363[0m in 82.98s]
[0m06:01:45.692455 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m06:01:46.984316 [debug] [Thread-4  ]: SQL status: SELECT 3363 in 83.720 seconds
[0m06:01:46.990423 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:46.991026 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m06:01:47.001162 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m06:01:47.001979 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:47.002407 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp060023058757'
        
      order by ordinal_position

  
[0m06:01:47.031683 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.028 seconds
[0m06:01:47.039748 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:47.040427 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:47.050395 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.009 seconds
[0m06:01:47.061719 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:47.062589 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:47.071033 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m06:01:47.074868 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m06:01:47.076006 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:47.076577 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp060023058757"
    )


  
[0m06:01:47.091858 [debug] [Thread-4  ]: SQL status: INSERT 0 3363 in 0.014 seconds
[0m06:01:47.094107 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m06:01:47.094764 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m06:01:47.095463 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m06:01:47.105356 [debug] [Thread-4  ]: SQL status: COMMIT in 0.009 seconds
[0m06:01:47.106876 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m06:01:47.107869 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078778fd0>]}
[0m06:01:47.108937 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 3363[0m in 84.40s]
[0m06:01:47.110591 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m06:01:51.416157 [debug] [Thread-1  ]: SQL status: SELECT 3363 in 88.153 seconds
[0m06:01:51.421190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:51.421964 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m06:01:51.424903 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m06:01:51.425456 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:51.425936 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp060023127690'
        
      order by ordinal_position

  
[0m06:01:51.439221 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m06:01:51.447074 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:51.447952 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:51.455241 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m06:01:51.461341 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:51.462095 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m06:01:51.471855 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m06:01:51.475918 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m06:01:51.477121 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:51.477880 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp060023127690"
    )


  
[0m06:01:51.499268 [debug] [Thread-1  ]: SQL status: INSERT 0 3363 in 0.020 seconds
[0m06:01:51.502444 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m06:01:51.503068 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m06:01:51.503666 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m06:01:51.516327 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m06:01:51.520015 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m06:01:51.521323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07b041430>]}
[0m06:01:51.522222 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 3363[0m in 88.82s]
[0m06:01:51.523608 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m06:01:51.525028 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m06:01:51.527377 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m06:01:51.526446 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m06:01:51.529423 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m06:01:51.530198 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m06:01:51.528165 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m06:01:51.538673 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m06:01:51.540068 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m06:01:51.566620 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m06:01:51.567839 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m06:01:51.580982 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m06:01:51.582756 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m06:01:51.599105 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:01:51.616267 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp060151572638"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m06:01:51.617214 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:01:51.619908 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:01:51.622772 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp060151606061"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m06:01:51.629830 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:02:48.571289 [debug] [Thread-3  ]: SQL status: SELECT 3363 in 56.954 seconds
[0m06:02:48.577733 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:48.578525 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m06:02:48.589031 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m06:02:48.589925 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:48.590548 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp060151572638'
        
      order by ordinal_position

  
[0m06:02:48.603885 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.013 seconds
[0m06:02:48.610200 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:48.611282 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m06:02:48.618345 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m06:02:48.625206 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:48.625920 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m06:02:48.633197 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m06:02:48.641398 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m06:02:48.642500 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:48.643268 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp060151572638"
    )


  
[0m06:02:48.752424 [debug] [Thread-3  ]: SQL status: INSERT 0 3363 in 0.108 seconds
[0m06:02:48.755190 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m06:02:48.755812 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m06:02:48.756212 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m06:02:48.768360 [debug] [Thread-3  ]: SQL status: COMMIT in 0.011 seconds
[0m06:02:48.770921 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m06:02:48.772629 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0786ddd00>]}
[0m06:02:48.773893 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 3363[0m in 57.24s]
[0m06:02:48.775596 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m06:03:09.626479 [debug] [Thread-2  ]: SQL status: SELECT 182 in 77.997 seconds
[0m06:03:09.632804 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:03:09.633872 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m06:03:09.636984 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m06:03:09.637614 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:03:09.638111 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp060151606061'
        
      order by ordinal_position

  
[0m06:03:09.651200 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.012 seconds
[0m06:03:09.657446 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:03:09.658167 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m06:03:09.665617 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.007 seconds
[0m06:03:09.672454 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:03:09.673112 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m06:03:09.679827 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.006 seconds
[0m06:03:09.684483 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m06:03:09.686024 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:03:09.687016 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp060151606061"
    )


  
[0m06:03:09.691056 [debug] [Thread-2  ]: SQL status: INSERT 0 182 in 0.003 seconds
[0m06:03:09.693102 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m06:03:09.693621 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m06:03:09.694059 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m06:03:09.699531 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m06:03:09.700849 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m06:03:09.701692 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c457d1d8-5519-4dc1-a9b9-9c444c95cc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078730c10>]}
[0m06:03:09.702645 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 182[0m in 78.16s]
[0m06:03:09.703881 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m06:03:09.705821 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:09.706465 [debug] [MainThread]: On master: BEGIN
[0m06:03:09.706972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:09.749798 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m06:03:09.750634 [debug] [MainThread]: On master: COMMIT
[0m06:03:09.751208 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:09.751712 [debug] [MainThread]: On master: COMMIT
[0m06:03:09.754270 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:03:09.754851 [debug] [MainThread]: On master: Close
[0m06:03:09.755813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:09.758118 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m06:03:09.758617 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m06:03:09.759095 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m06:03:09.760328 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m06:03:09.761119 [info ] [MainThread]: 
[0m06:03:09.762896 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 47.40 seconds (167.40s).
[0m06:03:09.766593 [debug] [MainThread]: Command end result
[0m06:03:09.843484 [info ] [MainThread]: 
[0m06:03:09.845072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:09.846455 [info ] [MainThread]: 
[0m06:03:09.847234 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:03:09.848772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 169.09029, "process_user_time": 4.513024, "process_kernel_time": 0.374488, "process_mem_max_rss": "115600", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m06:03:09.849784 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:09.849628 after 169.09 seconds
[0m06:03:09.850280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07fb457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07f6f7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07c535d60>]}
[0m06:03:09.850723 [debug] [MainThread]: Flushing usage events
[0m07:00:28.574773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5486b4d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548751ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54862fff70>]}


============================== 07:00:28.583439 | 654490d0-20ca-421d-821f-bad62141e17a ==============================
[0m07:00:28.583439 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:00:28.584808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:00:28.990485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548688abb0>]}
[0m07:00:29.138020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54853968b0>]}
[0m07:00:29.139451 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:00:29.222847 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:00:29.715189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:00:29.715928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:00:29.858885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54834c7820>]}
[0m07:00:30.258078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54835330a0>]}
[0m07:00:30.259221 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m07:00:30.260519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54862c4d00>]}
[0m07:00:30.264494 [info ] [MainThread]: 
[0m07:00:30.266286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:30.274515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m07:00:30.290271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m07:00:30.384492 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m07:00:30.385134 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m07:00:30.386017 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m07:00:30.386350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:30.385640 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m07:00:30.387620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:30.461243 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.075 seconds
[0m07:00:30.464539 [debug] [ThreadPool]: On list_lab08_db: Close
[0m07:00:30.473615 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.086 seconds
[0m07:00:30.477733 [debug] [ThreadPool]: On list_lab08_db: Close
[0m07:00:30.484352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m07:00:30.503789 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m07:00:30.504493 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m07:00:30.507320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:30.506539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m07:00:30.512299 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m07:00:30.513223 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m07:00:30.513817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:30.563650 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m07:00:30.564320 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m07:00:30.564693 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m07:00:30.570995 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m07:00:30.571622 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m07:00:30.572339 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m07:00:30.602879 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.037 seconds
[0m07:00:30.605882 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m07:00:30.606794 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m07:00:30.609367 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m07:00:30.609956 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m07:00:30.614936 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m07:00:30.624767 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:30.625514 [debug] [MainThread]: On master: BEGIN
[0m07:00:30.626061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:30.659617 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m07:00:30.660173 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:30.660890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:00:30.694391 [debug] [MainThread]: SQL status: SELECT 0 in 0.033 seconds
[0m07:00:30.697228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5483463c40>]}
[0m07:00:30.698329 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:30.700956 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:30.701507 [debug] [MainThread]: On master: BEGIN
[0m07:00:30.705686 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:00:30.706398 [debug] [MainThread]: On master: COMMIT
[0m07:00:30.706881 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:30.707218 [debug] [MainThread]: On master: COMMIT
[0m07:00:30.709612 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m07:00:30.710300 [debug] [MainThread]: On master: Close
[0m07:00:30.711257 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m07:00:30.713147 [info ] [MainThread]: 
[0m07:00:30.721140 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m07:00:30.723633 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m07:00:30.725376 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m07:00:30.722254 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m07:00:30.727627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m07:00:30.724614 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m07:00:30.733709 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m07:00:30.734583 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m07:00:30.726460 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m07:00:30.741147 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m07:00:30.741969 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m07:00:30.732591 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m07:00:30.743021 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m07:00:30.744800 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m07:00:30.746251 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m07:00:30.731693 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m07:00:30.809086 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m07:00:30.820045 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m07:00:30.810583 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m07:00:30.826724 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m07:00:30.808056 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m07:00:30.842747 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m07:00:30.818342 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m07:00:30.850542 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m07:00:31.256664 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:00:31.282181 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp070031016033"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m07:00:31.282953 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:00:31.268765 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:00:31.283799 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp070031066200"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m07:00:31.284352 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:00:31.281127 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:00:31.285719 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp070031086682"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m07:00:31.286410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:00:31.289372 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:00:31.291284 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp070031055919"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m07:00:31.292063 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m07:01:58.226961 [debug] [Thread-3  ]: SQL status: SELECT 6275 in 86.942 seconds
[0m07:01:58.260305 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:58.261271 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m07:01:58.264295 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m07:01:58.265057 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:58.265816 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp070031066200'
        
      order by ordinal_position

  
[0m07:01:58.485379 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.218 seconds
[0m07:01:58.498713 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:58.499763 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:01:58.507393 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m07:01:58.609612 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:58.610425 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:01:58.618021 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m07:01:58.637373 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m07:01:58.638450 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:58.639008 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp070031066200"
    )


  
[0m07:01:58.686236 [debug] [Thread-3  ]: SQL status: INSERT 0 6275 in 0.046 seconds
[0m07:01:58.725855 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m07:01:58.726719 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m07:01:58.727512 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m07:01:58.743276 [debug] [Thread-3  ]: SQL status: COMMIT in 0.015 seconds
[0m07:01:58.747041 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m07:01:58.749548 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5486881910>]}
[0m07:01:58.750447 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 6275[0m in 88.01s]
[0m07:01:58.752472 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m07:02:02.634514 [debug] [Thread-2  ]: SQL status: SELECT 6275 in 91.342 seconds
[0m07:02:02.649795 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:02:02.650537 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m07:02:02.653343 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m07:02:02.653995 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:02:02.654637 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp070031055919'
        
      order by ordinal_position

  
[0m07:02:02.668618 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.013 seconds
[0m07:02:02.675413 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:02:02.676309 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:02:02.692617 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m07:02:02.698882 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:02:02.709233 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:02:02.719295 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.009 seconds
[0m07:02:02.722806 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m07:02:02.724020 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:02:02.724809 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp070031055919"
    )


  
[0m07:02:02.780100 [debug] [Thread-2  ]: SQL status: INSERT 0 6275 in 0.055 seconds
[0m07:02:02.783069 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m07:02:02.783863 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m07:02:02.784458 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m07:02:02.795203 [debug] [Thread-2  ]: SQL status: COMMIT in 0.010 seconds
[0m07:02:02.797190 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m07:02:02.798585 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5482051dc0>]}
[0m07:02:02.800183 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 6275[0m in 92.07s]
[0m07:02:02.804296 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m07:02:03.901478 [debug] [Thread-4  ]: SQL status: SELECT 6275 in 92.619 seconds
[0m07:02:03.908522 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:02:03.909229 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m07:02:03.913655 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m07:02:03.914268 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:02:03.914707 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp070031016033'
        
      order by ordinal_position

  
[0m07:02:03.927961 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.013 seconds
[0m07:02:03.935548 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:02:03.936272 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:02:03.943603 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m07:02:03.955849 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:02:03.956957 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:02:03.965109 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m07:02:03.970221 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m07:02:03.972020 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:02:03.972756 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp070031016033"
    )


  
[0m07:02:03.990897 [debug] [Thread-4  ]: SQL status: INSERT 0 6275 in 0.017 seconds
[0m07:02:03.993533 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m07:02:03.994378 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m07:02:03.994802 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m07:02:04.007986 [debug] [Thread-4  ]: SQL status: COMMIT in 0.013 seconds
[0m07:02:04.010474 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m07:02:04.011477 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548071e940>]}
[0m07:02:04.013106 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 6275[0m in 93.27s]
[0m07:02:04.014805 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m07:02:08.398062 [debug] [Thread-1  ]: SQL status: SELECT 6275 in 97.112 seconds
[0m07:02:08.407644 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:02:08.408234 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m07:02:08.413694 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m07:02:08.414432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:02:08.415511 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp070031086682'
        
      order by ordinal_position

  
[0m07:02:08.437206 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.021 seconds
[0m07:02:08.449876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:02:08.450783 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:02:08.458599 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.007 seconds
[0m07:02:08.466987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:02:08.467927 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m07:02:08.474948 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m07:02:08.479977 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m07:02:08.481234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:02:08.482025 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp070031086682"
    )


  
[0m07:02:08.554981 [debug] [Thread-1  ]: SQL status: INSERT 0 6275 in 0.072 seconds
[0m07:02:08.557667 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m07:02:08.558371 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m07:02:08.558819 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m07:02:08.572974 [debug] [Thread-1  ]: SQL status: COMMIT in 0.014 seconds
[0m07:02:08.575048 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m07:02:08.576818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5482051e50>]}
[0m07:02:08.578759 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 6275[0m in 97.85s]
[0m07:02:08.581243 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m07:02:08.582668 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m07:02:08.585209 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m07:02:08.583987 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m07:02:08.587541 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m07:02:08.588359 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m07:02:08.585877 [info ] [Thread-2  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m07:02:08.595917 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_device_events, now model.dbt_lab08_project.dm_sales)
[0m07:02:08.597843 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m07:02:08.611861 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m07:02:08.612989 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m07:02:08.622244 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m07:02:08.623455 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m07:02:08.634143 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:02:08.634977 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp070208619836"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m07:02:08.635662 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m07:02:08.640005 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:02:08.640960 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp070208631755"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m07:02:08.642091 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m07:03:23.389678 [debug] [Thread-3  ]: SQL status: SELECT 6275 in 74.754 seconds
[0m07:03:23.395948 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:03:23.396870 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m07:03:23.400866 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m07:03:23.402098 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:03:23.402873 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp070208619836'
        
      order by ordinal_position

  
[0m07:03:23.421961 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.018 seconds
[0m07:03:23.428500 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:03:23.429174 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m07:03:23.436025 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m07:03:23.444645 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:03:23.445805 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m07:03:23.452318 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m07:03:23.455636 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m07:03:23.457190 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:03:23.457703 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp070208619836"
    )


  
[0m07:03:23.570578 [debug] [Thread-3  ]: SQL status: INSERT 0 6275 in 0.112 seconds
[0m07:03:23.573693 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m07:03:23.574832 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m07:03:23.575625 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m07:03:23.604040 [debug] [Thread-3  ]: SQL status: COMMIT in 0.028 seconds
[0m07:03:23.605578 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m07:03:23.606958 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5482051ca0>]}
[0m07:03:23.608025 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 6275[0m in 75.02s]
[0m07:03:23.609513 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m07:03:42.319880 [debug] [Thread-2  ]: SQL status: SELECT 371 in 93.678 seconds
[0m07:03:42.325752 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:42.326446 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m07:03:42.330421 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m07:03:42.331006 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:42.331740 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp070208631755'
        
      order by ordinal_position

  
[0m07:03:42.344138 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.012 seconds
[0m07:03:42.350850 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:42.351460 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m07:03:42.363541 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.012 seconds
[0m07:03:42.393986 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:42.395014 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m07:03:42.402646 [debug] [Thread-2  ]: SQL status: SELECT 21 in 0.007 seconds
[0m07:03:42.408675 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m07:03:42.422961 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:42.423681 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp070208631755"
    )


  
[0m07:03:42.435537 [debug] [Thread-2  ]: SQL status: INSERT 0 371 in 0.011 seconds
[0m07:03:42.438255 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m07:03:42.442032 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m07:03:42.442528 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m07:03:42.448361 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m07:03:42.449902 [debug] [Thread-2  ]: On model.dbt_lab08_project.dm_sales: Close
[0m07:03:42.451002 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654490d0-20ca-421d-821f-bad62141e17a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5483829160>]}
[0m07:03:42.452227 [info ] [Thread-2  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 371[0m in 93.86s]
[0m07:03:42.453900 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m07:03:42.455596 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:42.455972 [debug] [MainThread]: On master: BEGIN
[0m07:03:42.456361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:03:42.490357 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m07:03:42.490906 [debug] [MainThread]: On master: COMMIT
[0m07:03:42.491251 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:42.491548 [debug] [MainThread]: On master: COMMIT
[0m07:03:42.495743 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m07:03:42.496284 [debug] [MainThread]: On master: Close
[0m07:03:42.497072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:03:42.497906 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m07:03:42.498424 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m07:03:42.498850 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m07:03:42.500649 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m07:03:42.501425 [info ] [MainThread]: 
[0m07:03:42.502831 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 3 minutes and 12.24 seconds (192.24s).
[0m07:03:42.507481 [debug] [MainThread]: Command end result
[0m07:03:42.566764 [info ] [MainThread]: 
[0m07:03:42.568936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:03:42.569747 [info ] [MainThread]: 
[0m07:03:42.570971 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m07:03:42.572854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 194.10329, "process_user_time": 4.837796, "process_kernel_time": 0.298041, "process_mem_max_rss": "115608", "process_out_blocks": "2296", "process_in_blocks": "0"}
[0m07:03:42.573774 [debug] [MainThread]: Command `dbt run` succeeded at 07:03:42.573575 after 194.10 seconds
[0m07:03:42.574470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5486b4d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5485cd10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5485d39a90>]}
[0m07:03:42.575368 [debug] [MainThread]: Flushing usage events
[0m08:00:38.968261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4debd0b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dec6dcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deb4bdf70>]}


============================== 08:00:38.975996 | 2913ebbb-e1ac-4882-be65-f99240c0d61b ==============================
[0m08:00:38.975996 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:00:38.977247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:00:39.342979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deba53bb0>]}
[0m08:00:39.493760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dea5578b0>]}
[0m08:00:39.494947 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:00:39.579585 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:00:40.197737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:40.198351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:40.490645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de8687820>]}
[0m08:00:40.890552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de86f3070>]}
[0m08:00:40.891702 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m08:00:40.892739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deb487d00>]}
[0m08:00:40.896965 [info ] [MainThread]: 
[0m08:00:40.898562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:00:40.911939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m08:00:40.930675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m08:00:41.026554 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m08:00:41.027110 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m08:00:41.027924 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m08:00:41.028288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:41.027536 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m08:00:41.029067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:41.064996 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.036 seconds
[0m08:00:41.068386 [debug] [ThreadPool]: On list_lab08_db: Close
[0m08:00:41.069770 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.041 seconds
[0m08:00:41.072620 [debug] [ThreadPool]: On list_lab08_db: Close
[0m08:00:41.076315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m08:00:41.086199 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m08:00:41.086710 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m08:00:41.087054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:41.088112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m08:00:41.091977 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m08:00:41.093033 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m08:00:41.093413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:41.130896 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m08:00:41.131613 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m08:00:41.132150 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m08:00:41.133032 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m08:00:41.133548 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m08:00:41.134307 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m08:00:41.147166 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m08:00:41.149999 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m08:00:41.151404 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m08:00:41.153714 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m08:00:41.157348 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m08:00:41.162116 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m08:00:41.175337 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:41.176072 [debug] [MainThread]: On master: BEGIN
[0m08:00:41.176609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:00:41.214926 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m08:00:41.215915 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:41.217014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:00:41.227125 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m08:00:41.229106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de8624c40>]}
[0m08:00:41.229999 [debug] [MainThread]: On master: ROLLBACK
[0m08:00:41.233198 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:41.233719 [debug] [MainThread]: On master: BEGIN
[0m08:00:41.237592 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:00:41.238276 [debug] [MainThread]: On master: COMMIT
[0m08:00:41.238678 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:41.239019 [debug] [MainThread]: On master: COMMIT
[0m08:00:41.241052 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m08:00:41.241853 [debug] [MainThread]: On master: Close
[0m08:00:41.245343 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m08:00:41.246353 [info ] [MainThread]: 
[0m08:00:41.250220 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m08:00:41.253393 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m08:00:41.254555 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m08:00:41.251436 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m08:00:41.256373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m08:00:41.256905 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m08:00:41.266316 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m08:00:41.254125 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m08:00:41.269122 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m08:00:41.269991 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m08:00:41.255493 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m08:00:41.278589 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m08:00:41.279173 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m08:00:41.268500 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m08:00:41.306555 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m08:00:41.307727 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m08:00:41.321110 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m08:00:41.323192 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m08:00:41.328937 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m08:00:41.324276 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m08:00:41.338786 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m08:00:41.327425 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m08:00:41.351294 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m08:00:41.350289 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m08:00:41.569209 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:00:41.573108 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:00:41.585750 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp080041446945"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m08:00:41.586654 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:00:41.584049 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:00:41.587883 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp080041520753"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m08:00:41.588658 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:00:41.584955 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp080041543109"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m08:00:41.590110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:00:41.580898 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:00:41.591672 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp080041554250"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m08:00:41.592470 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:02:08.790507 [debug] [Thread-3  ]: SQL status: SELECT 9384 in 87.198 seconds
[0m08:02:08.847598 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:02:08.848271 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m08:02:08.856874 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m08:02:08.857508 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:02:08.858002 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp080041554250'
        
      order by ordinal_position

  
[0m08:02:08.881111 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.022 seconds
[0m08:02:08.898778 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:02:08.900215 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:08.909734 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.008 seconds
[0m08:02:08.931598 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:02:08.932410 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:08.939211 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.006 seconds
[0m08:02:08.963028 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m08:02:08.964138 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:02:08.964675 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp080041554250"
    )


  
[0m08:02:08.982333 [debug] [Thread-3  ]: SQL status: INSERT 0 9384 in 0.017 seconds
[0m08:02:09.017382 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m08:02:09.018250 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m08:02:09.019058 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m08:02:09.035532 [debug] [Thread-3  ]: SQL status: COMMIT in 0.016 seconds
[0m08:02:09.040144 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m08:02:09.044230 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deba43910>]}
[0m08:02:09.045739 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 9384[0m in 87.76s]
[0m08:02:09.047731 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m08:02:16.540057 [debug] [Thread-2  ]: SQL status: SELECT 9384 in 94.954 seconds
[0m08:02:16.628513 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:02:16.629373 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m08:02:16.634145 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m08:02:16.634997 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:02:16.635453 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp080041446945'
        
      order by ordinal_position

  
[0m08:02:16.651734 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.016 seconds
[0m08:02:16.659275 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:02:16.659937 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:16.668828 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m08:02:16.674361 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:02:16.675140 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:16.682373 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.007 seconds
[0m08:02:16.686914 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m08:02:16.688145 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:02:16.688959 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp080041446945"
    )


  
[0m08:02:16.727951 [debug] [Thread-2  ]: SQL status: INSERT 0 9384 in 0.038 seconds
[0m08:02:16.730219 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m08:02:16.731054 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m08:02:16.731585 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m08:02:16.748511 [debug] [Thread-2  ]: SQL status: COMMIT in 0.016 seconds
[0m08:02:16.749920 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m08:02:16.750986 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de71e5670>]}
[0m08:02:16.751998 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 9384[0m in 95.48s]
[0m08:02:16.753364 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m08:02:20.535206 [debug] [Thread-4  ]: SQL status: SELECT 9384 in 98.946 seconds
[0m08:02:20.560404 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:02:20.561249 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m08:02:20.564672 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m08:02:20.565948 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:02:20.566581 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp080041520753'
        
      order by ordinal_position

  
[0m08:02:20.583232 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.016 seconds
[0m08:02:20.595093 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:02:20.596014 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:20.603916 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m08:02:20.616865 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:02:20.617705 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:20.626550 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m08:02:20.631537 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m08:02:20.637594 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:02:20.638709 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp080041520753"
    )


  
[0m08:02:20.661730 [debug] [Thread-4  ]: SQL status: INSERT 0 9384 in 0.022 seconds
[0m08:02:20.665207 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m08:02:20.666358 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m08:02:20.667002 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m08:02:20.688186 [debug] [Thread-4  ]: SQL status: COMMIT in 0.020 seconds
[0m08:02:20.689874 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m08:02:20.690984 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de71e5550>]}
[0m08:02:20.692089 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 9384[0m in 99.38s]
[0m08:02:20.693780 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m08:02:22.682330 [debug] [Thread-1  ]: SQL status: SELECT 9384 in 101.092 seconds
[0m08:02:22.689816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:02:22.690545 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m08:02:22.693187 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m08:02:22.693876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:02:22.694467 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp080041543109'
        
      order by ordinal_position

  
[0m08:02:22.710282 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.015 seconds
[0m08:02:22.724881 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:02:22.725780 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:22.739264 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.013 seconds
[0m08:02:22.745432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:02:22.746231 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m08:02:22.752300 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.005 seconds
[0m08:02:22.755770 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m08:02:22.756956 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:02:22.760429 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp080041543109"
    )


  
[0m08:02:22.829779 [debug] [Thread-1  ]: SQL status: INSERT 0 9384 in 0.068 seconds
[0m08:02:22.833143 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m08:02:22.833962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m08:02:22.834483 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m08:02:22.850680 [debug] [Thread-1  ]: SQL status: COMMIT in 0.015 seconds
[0m08:02:22.852687 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m08:02:22.853925 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de48e2bb0>]}
[0m08:02:22.855302 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 9384[0m in 101.60s]
[0m08:02:22.856738 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m08:02:22.857955 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.dm_events
[0m08:02:22.858869 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_sales
[0m08:02:22.859653 [info ] [Thread-1  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m08:02:22.860436 [info ] [Thread-3  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m08:02:22.862187 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_sales)
[0m08:02:22.862603 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m08:02:22.861505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_browser_events, now model.dbt_lab08_project.dm_events)
[0m08:02:22.877717 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m08:02:22.877116 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m08:02:22.885493 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m08:02:22.884255 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m08:02:22.894716 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.dm_events
[0m08:02:22.901294 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:02:22.901903 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp080222899089"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m08:02:22.902323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:02:22.893858 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:02:22.903187 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp080222890739"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m08:02:22.903780 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:03:30.233708 [debug] [Thread-1  ]: SQL status: SELECT 9384 in 67.331 seconds
[0m08:03:30.242849 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:03:30.243791 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m08:03:30.249594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m08:03:30.250367 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:03:30.251012 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp080222899089'
        
      order by ordinal_position

  
[0m08:03:30.265472 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.013 seconds
[0m08:03:30.271791 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:03:30.272521 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m08:03:30.279194 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.006 seconds
[0m08:03:30.287061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:03:30.287902 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m08:03:30.296168 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.007 seconds
[0m08:03:30.299979 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m08:03:30.300971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:03:30.301680 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp080222899089"
    )


  
[0m08:03:30.445224 [debug] [Thread-1  ]: SQL status: INSERT 0 9384 in 0.143 seconds
[0m08:03:30.448023 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m08:03:30.448903 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m08:03:30.449504 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m08:03:30.467381 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m08:03:30.469672 [debug] [Thread-1  ]: On model.dbt_lab08_project.dm_events: Close
[0m08:03:30.471096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de7251850>]}
[0m08:03:30.472652 [info ] [Thread-1  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 9384[0m in 67.61s]
[0m08:03:30.478135 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.dm_events
[0m08:03:45.680767 [debug] [Thread-3  ]: SQL status: SELECT 539 in 82.776 seconds
[0m08:03:45.718415 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:03:45.719093 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m08:03:45.725651 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m08:03:45.726524 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:03:45.727072 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp080222890739'
        
      order by ordinal_position

  
[0m08:03:45.744178 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.016 seconds
[0m08:03:45.785930 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:03:45.787072 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m08:03:45.797164 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.009 seconds
[0m08:03:45.821414 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:03:45.822316 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m08:03:45.833148 [debug] [Thread-3  ]: SQL status: SELECT 21 in 0.010 seconds
[0m08:03:45.846649 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m08:03:45.848014 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:03:45.861059 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp080222890739"
    )


  
[0m08:03:45.869325 [debug] [Thread-3  ]: SQL status: INSERT 0 539 in 0.008 seconds
[0m08:03:45.871728 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m08:03:45.872527 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m08:03:45.881448 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m08:03:45.887751 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m08:03:45.889622 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_sales: Close
[0m08:03:45.891045 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2913ebbb-e1ac-4882-be65-f99240c0d61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de72513a0>]}
[0m08:03:45.892249 [info ] [Thread-3  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 539[0m in 83.03s]
[0m08:03:45.901565 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m08:03:45.906094 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:45.906835 [debug] [MainThread]: On master: BEGIN
[0m08:03:45.907605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:03:45.947917 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m08:03:45.948670 [debug] [MainThread]: On master: COMMIT
[0m08:03:45.949251 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:45.951126 [debug] [MainThread]: On master: COMMIT
[0m08:03:45.953365 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m08:03:45.954083 [debug] [MainThread]: On master: Close
[0m08:03:45.954801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:45.955490 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m08:03:45.955977 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m08:03:45.956395 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m08:03:45.956680 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m08:03:45.958641 [info ] [MainThread]: 
[0m08:03:45.961672 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 3 minutes and 5.06 seconds (185.06s).
[0m08:03:45.965271 [debug] [MainThread]: Command end result
[0m08:03:46.082370 [info ] [MainThread]: 
[0m08:03:46.084243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:46.085605 [info ] [MainThread]: 
[0m08:03:46.087198 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:03:46.089239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 187.22441, "process_user_time": 4.614977, "process_kernel_time": 0.372436, "process_mem_max_rss": "115604", "process_out_blocks": "2304", "process_in_blocks": "0"}
[0m08:03:46.090191 [debug] [MainThread]: Command `dbt run` succeeded at 08:03:46.090008 after 187.23 seconds
[0m08:03:46.091102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4debd0b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4deba53bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dea96a8e0>]}
[0m08:03:46.091625 [debug] [MainThread]: Flushing usage events
[0m09:00:56.281606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da6a527f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da5c40a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da52cdcd0>]}


============================== 09:00:56.291514 | 306671c2-6232-403d-bfde-75adc0a0a583 ==============================
[0m09:00:56.291514 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:00:56.293441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:00:56.656615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da61bb1f0>]}
[0m09:00:56.837679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da52b4940>]}
[0m09:00:56.843245 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:00:56.939191 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:00:57.565249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:00:57.566188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:00:57.712870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da340c7c0>]}
[0m09:00:58.055021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da37b5e20>]}
[0m09:00:58.056609 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m09:00:58.060163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da3433610>]}
[0m09:00:58.065807 [info ] [MainThread]: 
[0m09:00:58.068166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:00:58.077969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m09:00:58.110531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m09:00:58.198911 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m09:00:58.199633 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m09:00:58.201268 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m09:00:58.201788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:58.200670 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m09:00:58.203163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:58.264804 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.061 seconds
[0m09:00:58.267824 [debug] [ThreadPool]: On list_lab08_db: Close
[0m09:00:58.269425 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.068 seconds
[0m09:00:58.271680 [debug] [ThreadPool]: On list_lab08_db: Close
[0m09:00:58.275007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m09:00:58.286696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m09:00:58.294924 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m09:00:58.295594 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m09:00:58.296030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:00:58.299283 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m09:00:58.300297 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m09:00:58.301114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:00:58.340387 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m09:00:58.341528 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m09:00:58.342128 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m09:00:58.343042 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m09:00:58.343447 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m09:00:58.343973 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m09:00:58.375909 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.033 seconds
[0m09:00:58.378965 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m09:00:58.380260 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.036 seconds
[0m09:00:58.383185 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m09:00:58.389019 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m09:00:58.401034 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m09:00:58.461534 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:58.462557 [debug] [MainThread]: On master: BEGIN
[0m09:00:58.463503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:00:58.545767 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m09:00:58.547101 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:58.548100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:00:58.573211 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m09:00:58.575240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da338b7c0>]}
[0m09:00:58.576194 [debug] [MainThread]: On master: ROLLBACK
[0m09:00:58.579565 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:58.580802 [debug] [MainThread]: On master: BEGIN
[0m09:00:58.587290 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:00:58.589374 [debug] [MainThread]: On master: COMMIT
[0m09:00:58.590938 [debug] [MainThread]: Using postgres connection "master"
[0m09:00:58.591748 [debug] [MainThread]: On master: COMMIT
[0m09:00:58.595321 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:00:58.596851 [debug] [MainThread]: On master: Close
[0m09:00:58.598240 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:00:58.600608 [info ] [MainThread]: 
[0m09:00:58.623367 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m09:00:58.624384 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m09:00:58.630824 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m09:00:58.645745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m09:00:58.638304 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m09:00:58.650081 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m09:00:58.651346 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m09:00:58.648997 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m09:00:58.658720 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m09:00:58.682957 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m09:00:58.660245 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m09:00:58.692739 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m09:00:58.713233 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m09:00:58.710304 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m09:00:58.742603 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m09:00:58.771271 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m09:00:58.769943 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m09:00:58.799376 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m09:00:58.805139 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m09:00:58.801672 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m09:00:58.803136 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m09:00:58.795474 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m09:00:58.831170 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m09:00:58.822178 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m09:00:59.245187 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:00:59.258660 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:00:59.260368 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp090059049319"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m09:00:59.261084 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:00:59.256397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:00:59.262110 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp090059089720"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m09:00:59.263240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:00:59.259461 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp090059067292"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m09:00:59.264390 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:00:59.253655 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:00:59.266617 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp090059060894"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m09:00:59.267241 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:02:26.221376 [debug] [Thread-3  ]: SQL status: SELECT 13612 in 86.954 seconds
[0m09:02:26.286165 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:02:26.287229 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m09:02:26.291330 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m09:02:26.292395 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:02:26.293275 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp090059060894'
        
      order by ordinal_position

  
[0m09:02:26.712162 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.418 seconds
[0m09:02:26.736157 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:02:26.739250 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:26.762369 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.022 seconds
[0m09:02:27.085965 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:02:27.086793 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:27.120861 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.033 seconds
[0m09:02:27.169257 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m09:02:27.171006 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:02:27.174533 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp090059060894"
    )


  
[0m09:02:27.248678 [debug] [Thread-3  ]: SQL status: INSERT 0 13612 in 0.072 seconds
[0m09:02:27.280178 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m09:02:27.280975 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:02:27.281587 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m09:02:27.320373 [debug] [Thread-3  ]: SQL status: COMMIT in 0.038 seconds
[0m09:02:27.324654 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m09:02:27.328630 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da1f2b910>]}
[0m09:02:27.330305 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 13612[0m in 88.63s]
[0m09:02:27.332492 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m09:02:33.260553 [debug] [Thread-4  ]: SQL status: SELECT 13612 in 93.999 seconds
[0m09:02:33.270343 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:33.271490 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m09:02:33.277997 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m09:02:33.279274 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:33.280356 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp090059049319'
        
      order by ordinal_position

  
[0m09:02:33.469033 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.187 seconds
[0m09:02:33.487247 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:33.489581 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:33.500918 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.006 seconds
[0m09:02:33.517041 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:33.518233 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:33.527106 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.008 seconds
[0m09:02:33.533115 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m09:02:33.537861 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:33.539576 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp090059049319"
    )


  
[0m09:02:33.587712 [debug] [Thread-4  ]: SQL status: INSERT 0 13612 in 0.047 seconds
[0m09:02:33.591226 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m09:02:33.592877 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:02:33.593880 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m09:02:33.614489 [debug] [Thread-4  ]: SQL status: COMMIT in 0.019 seconds
[0m09:02:33.616649 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m09:02:33.618557 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da1f2bb80>]}
[0m09:02:33.619923 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 13612[0m in 94.88s]
[0m09:02:33.622111 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m09:02:35.506327 [debug] [Thread-2  ]: SQL status: SELECT 13612 in 96.241 seconds
[0m09:02:35.514121 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:35.515339 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m09:02:35.521589 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m09:02:35.522770 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:35.524107 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp090059067292'
        
      order by ordinal_position

  
[0m09:02:35.622437 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.097 seconds
[0m09:02:35.630713 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:35.631568 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:35.641312 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.009 seconds
[0m09:02:35.653646 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:35.654437 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:35.662961 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m09:02:35.667043 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m09:02:35.668645 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:35.670108 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp090059067292"
    )


  
[0m09:02:35.708394 [debug] [Thread-2  ]: SQL status: INSERT 0 13612 in 0.036 seconds
[0m09:02:35.711317 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m09:02:35.712477 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:02:35.713206 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m09:02:35.729404 [debug] [Thread-2  ]: SQL status: COMMIT in 0.015 seconds
[0m09:02:35.731211 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m09:02:35.732374 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da05927c0>]}
[0m09:02:35.733773 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 13612[0m in 97.08s]
[0m09:02:35.737213 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m09:02:39.068326 [debug] [Thread-1  ]: SQL status: SELECT 13612 in 99.805 seconds
[0m09:02:39.077720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:39.079500 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m09:02:39.082250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m09:02:39.083702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:39.084656 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp090059089720'
        
      order by ordinal_position

  
[0m09:02:39.122658 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.037 seconds
[0m09:02:39.138654 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:39.139735 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:39.149781 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m09:02:39.162205 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:39.163114 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:02:39.172597 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.008 seconds
[0m09:02:39.180671 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m09:02:39.182659 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:39.183774 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp090059089720"
    )


  
[0m09:02:39.256648 [debug] [Thread-1  ]: SQL status: INSERT 0 13612 in 0.071 seconds
[0m09:02:39.260248 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m09:02:39.261216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:02:39.261897 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m09:02:39.284643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.022 seconds
[0m09:02:39.287239 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m09:02:39.288963 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da1f50ee0>]}
[0m09:02:39.290550 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 13612[0m in 100.65s]
[0m09:02:39.293637 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m09:02:39.295251 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m09:02:39.297332 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m09:02:39.298241 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m09:02:39.299512 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m09:02:39.296200 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m09:02:39.310184 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m09:02:39.311064 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m09:02:39.311817 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m09:02:39.309073 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m09:02:39.321016 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m09:02:39.331026 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:02:39.333094 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m09:02:39.335410 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m09:02:39.333802 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp090239326965"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m09:02:39.351189 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:02:39.392150 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:02:39.403608 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp090239374199"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m09:02:39.408286 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:04:02.368835 [debug] [Thread-3  ]: SQL status: SELECT 13612 in 83.018 seconds
[0m09:04:02.384463 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:04:02.392559 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m09:04:02.398611 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m09:04:02.399922 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:04:02.404284 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp090239326965'
        
      order by ordinal_position

  
[0m09:04:02.910791 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.506 seconds
[0m09:04:02.917764 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:04:02.918717 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:04:02.933790 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.014 seconds
[0m09:04:02.948246 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:04:02.950112 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:04:02.958028 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m09:04:02.963460 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m09:04:02.967681 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:04:02.969488 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp090239326965"
    )


  
[0m09:04:03.285475 [debug] [Thread-3  ]: SQL status: INSERT 0 13612 in 0.315 seconds
[0m09:04:03.288599 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m09:04:03.289442 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:04:03.290097 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m09:04:03.308932 [debug] [Thread-3  ]: SQL status: COMMIT in 0.018 seconds
[0m09:04:03.310408 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m09:04:03.311615 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da0585850>]}
[0m09:04:03.312797 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 13612[0m in 84.01s]
[0m09:04:03.313978 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m09:04:21.757696 [debug] [Thread-4  ]: SQL status: SELECT 786 in 102.349 seconds
[0m09:04:21.771690 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:04:21.774856 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m09:04:21.783596 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m09:04:21.784642 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:04:21.785532 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp090239374199'
        
      order by ordinal_position

  
[0m09:04:21.813523 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.027 seconds
[0m09:04:21.822051 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:04:21.823600 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:04:21.850748 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.025 seconds
[0m09:04:21.859284 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:04:21.860336 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:04:21.878587 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.017 seconds
[0m09:04:21.886752 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m09:04:21.889023 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:04:21.891073 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp090239374199"
    )


  
[0m09:04:21.911707 [debug] [Thread-4  ]: SQL status: INSERT 0 786 in 0.019 seconds
[0m09:04:21.916448 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m09:04:21.918306 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:04:21.919855 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m09:04:21.933639 [debug] [Thread-4  ]: SQL status: COMMIT in 0.012 seconds
[0m09:04:21.935968 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m09:04:21.937721 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306671c2-6232-403d-bfde-75adc0a0a583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da0601160>]}
[0m09:04:21.939401 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 786[0m in 102.63s]
[0m09:04:21.942202 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m09:04:21.944631 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:21.945231 [debug] [MainThread]: On master: BEGIN
[0m09:04:21.945639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:04:22.016876 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m09:04:22.017745 [debug] [MainThread]: On master: COMMIT
[0m09:04:22.018326 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:22.018834 [debug] [MainThread]: On master: COMMIT
[0m09:04:22.027943 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m09:04:22.028847 [debug] [MainThread]: On master: Close
[0m09:04:22.029855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:04:22.030484 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m09:04:22.033166 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m09:04:22.033753 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m09:04:22.034346 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m09:04:22.035007 [info ] [MainThread]: 
[0m09:04:22.038037 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 3 minutes and 23.97 seconds (203.97s).
[0m09:04:22.042260 [debug] [MainThread]: Command end result
[0m09:04:22.109020 [info ] [MainThread]: 
[0m09:04:22.111263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:04:22.113407 [info ] [MainThread]: 
[0m09:04:22.115228 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:04:22.117824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 205.95784, "process_user_time": 5.257087, "process_kernel_time": 0.440989, "process_mem_max_rss": "115596", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m09:04:22.119237 [debug] [MainThread]: Command `dbt run` succeeded at 09:04:22.119065 after 205.96 seconds
[0m09:04:22.120057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da6a527f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da5c1ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da56b1d90>]}
[0m09:04:22.120774 [debug] [MainThread]: Flushing usage events
[0m09:42:02.029353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877ab8f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877b560d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877a343f70>]}


============================== 09:42:02.038318 | 24540e62-7b86-4145-a7ae-4ecc91f34577 ==============================
[0m09:42:02.038318 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:42:02.040195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:42:02.360669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877a8cfbb0>]}
[0m09:42:02.524614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87793db8b0>]}
[0m09:42:02.530632 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:42:02.597039 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:42:03.259381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:42:03.260507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:42:03.547079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8777548910>]}
[0m09:42:03.968764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8777538070>]}
[0m09:42:03.969854 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m09:42:03.970368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877a2f7d00>]}
[0m09:42:03.973709 [info ] [MainThread]: 
[0m09:42:03.974737 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:03.983235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m09:42:03.997510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m09:42:04.194367 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m09:42:04.195219 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m09:42:04.196165 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m09:42:04.196939 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m09:42:04.197524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:04.198052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:04.284170 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.086 seconds
[0m09:42:04.287560 [debug] [ThreadPool]: On list_lab08_db: Close
[0m09:42:04.288124 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.091 seconds
[0m09:42:04.291319 [debug] [ThreadPool]: On list_lab08_db: Close
[0m09:42:04.295412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m09:42:04.309399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m09:42:04.315541 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m09:42:04.316077 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m09:42:04.316440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:04.310533 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m09:42:04.317270 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m09:42:04.317668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:04.366422 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m09:42:04.368515 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m09:42:04.369074 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m09:42:04.367652 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m09:42:04.370711 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m09:42:04.371319 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m09:42:04.384905 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m09:42:04.387405 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m09:42:04.390507 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.018 seconds
[0m09:42:04.393858 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m09:42:04.394974 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m09:42:04.398411 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m09:42:04.409575 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:04.410378 [debug] [MainThread]: On master: BEGIN
[0m09:42:04.410920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:04.452642 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m09:42:04.453373 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:04.453923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:04.473182 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m09:42:04.475943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87774e2f70>]}
[0m09:42:04.477120 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:04.483528 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:04.486860 [debug] [MainThread]: On master: BEGIN
[0m09:42:04.491628 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:42:04.492499 [debug] [MainThread]: On master: COMMIT
[0m09:42:04.493203 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:04.493713 [debug] [MainThread]: On master: COMMIT
[0m09:42:04.496110 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m09:42:04.496960 [debug] [MainThread]: On master: Close
[0m09:42:04.498251 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m09:42:04.499083 [info ] [MainThread]: 
[0m09:42:04.504329 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m09:42:04.507242 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m09:42:04.508807 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m09:42:04.511439 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m09:42:04.505788 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m09:42:04.514333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m09:42:04.515194 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m09:42:04.508310 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m09:42:04.522735 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m09:42:04.523907 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m09:42:04.510339 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m09:42:04.524947 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m09:42:04.525689 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m09:42:04.513137 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m09:42:04.526914 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m09:42:04.527374 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m09:42:04.568841 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m09:42:04.572236 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m09:42:04.588374 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m09:42:04.586671 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m09:42:04.603711 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m09:42:04.581025 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m09:42:04.602488 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m09:42:04.610730 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m09:42:04.970187 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:42:04.971720 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:42:04.974180 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp094204851308"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_device_events"
    )

  );
  
  
[0m09:42:04.974673 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:42:04.972906 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:42:04.975560 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp094204945275"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_location_events"
    )

  );
  
  
[0m09:42:04.978563 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:42:04.973561 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp094204861485"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm > (
        select coalesce(max(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_geo_events"
    )

  );
  
  
[0m09:42:04.986301 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:42:04.987399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:42:04.988259 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp094204895061"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."ods"."ods_browser_events"
    )

  );
  
  
[0m09:42:04.989419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:43:58.144660 [debug] [Thread-3  ]: SQL status: SELECT 0 in 113.158 seconds
[0m09:43:58.183563 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:43:58.184640 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m09:43:58.188618 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m09:43:58.189762 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:43:58.191065 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp094204861485'
        
      order by ordinal_position

  
[0m09:43:58.237943 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.046 seconds
[0m09:43:58.250036 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:43:58.250903 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:43:58.260364 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.009 seconds
[0m09:43:58.275821 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:43:58.276807 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:43:58.284938 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.007 seconds
[0m09:43:58.403755 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m09:43:58.405980 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:43:58.407054 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp094204861485"
    )


  
[0m09:43:58.411430 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m09:43:58.448901 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m09:43:58.450064 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m09:43:58.451553 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m09:43:58.457197 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m09:43:58.461266 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m09:43:58.465402 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877a8c7910>]}
[0m09:43:58.466853 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 0[0m in 113.94s]
[0m09:43:58.468761 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m09:44:03.895789 [debug] [Thread-4  ]: SQL status: SELECT 0 in 118.919 seconds
[0m09:44:03.903504 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:44:03.909218 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m09:44:03.912837 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m09:44:03.913926 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:44:03.914871 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp094204945275'
        
      order by ordinal_position

  
[0m09:44:03.932406 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.016 seconds
[0m09:44:03.940087 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:44:03.940927 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:44:03.948939 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m09:44:03.955582 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:44:03.956951 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:44:03.964389 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.007 seconds
[0m09:44:03.969942 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m09:44:03.972190 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:44:03.972916 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp094204945275"
    )


  
[0m09:44:03.977187 [debug] [Thread-4  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m09:44:03.981566 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m09:44:03.982657 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m09:44:03.983809 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m09:44:03.990649 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m09:44:03.993082 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m09:44:03.994333 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8776083f40>]}
[0m09:44:03.995647 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 0[0m in 119.47s]
[0m09:44:03.997666 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m09:44:06.179215 [debug] [Thread-2  ]: SQL status: SELECT 0 in 121.204 seconds
[0m09:44:06.186609 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:44:06.187564 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m09:44:06.190119 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m09:44:06.191311 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:44:06.192201 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp094204851308'
        
      order by ordinal_position

  
[0m09:44:06.205635 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.012 seconds
[0m09:44:06.217419 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:44:06.218671 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:44:06.228440 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m09:44:06.239819 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:44:06.242454 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:44:06.249839 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m09:44:06.257701 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m09:44:06.260087 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:44:06.260884 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp094204851308"
    )


  
[0m09:44:06.264106 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:44:06.266979 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m09:44:06.267734 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m09:44:06.268871 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m09:44:06.276236 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m09:44:06.278754 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m09:44:06.280357 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8776083a30>]}
[0m09:44:06.281846 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 0[0m in 121.76s]
[0m09:44:06.283955 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m09:44:09.115937 [debug] [Thread-1  ]: SQL status: SELECT 0 in 124.126 seconds
[0m09:44:09.134011 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:44:09.134948 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m09:44:09.139103 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m09:44:09.140002 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:44:09.140558 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp094204895061'
        
      order by ordinal_position

  
[0m09:44:09.156339 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.015 seconds
[0m09:44:09.163410 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:44:09.164514 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:44:09.174383 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.009 seconds
[0m09:44:09.183268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:44:09.184206 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m09:44:09.197677 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.010 seconds
[0m09:44:09.202568 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m09:44:09.203574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:44:09.204338 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp094204895061"
    )


  
[0m09:44:09.213382 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.008 seconds
[0m09:44:09.216249 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m09:44:09.217164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m09:44:09.217911 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m09:44:09.225486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m09:44:09.227346 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m09:44:09.228848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8776083790>]}
[0m09:44:09.230141 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 0[0m in 124.71s]
[0m09:44:09.231857 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m09:44:09.233263 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m09:44:09.234717 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m09:44:09.235983 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m09:44:09.242586 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m09:44:09.244765 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m09:44:09.246338 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m09:44:09.247075 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m09:44:09.236917 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m09:44:09.300403 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m09:44:09.303307 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m09:44:09.305450 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m09:44:09.316534 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m09:44:09.327379 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:44:09.328410 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp094409310978"
  
  
    as
  
  (
    with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_hour > (
        select COALESCE(MAX(load_hour), '1900-01-01')
        from "lab08_db"."dm"."dm_events"
    )

  );
  
  
[0m09:44:09.329132 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:44:09.325559 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:44:09.330353 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp094409322122"
  
  
    as
  
  (
    with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
            and obe.load_hour
            > (select COALESCE(MAX(load_hour), '1900-01-01') from "lab08_db"."dm"."dm_sales")
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m09:44:09.331045 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:44:48.985761 [debug] [Thread-4  ]: SQL status: SELECT 0 in 39.655 seconds
[0m09:44:48.994953 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:44:48.995722 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: BEGIN
[0m09:44:49.001764 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m09:44:49.002936 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:44:49.004237 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales__dbt_tmp094409322122'
        
      order by ordinal_position

  
[0m09:44:49.030395 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.025 seconds
[0m09:44:49.038257 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:44:49.039418 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:44:49.048133 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.007 seconds
[0m09:44:49.060300 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:44:49.061543 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_sales'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:44:49.069661 [debug] [Thread-4  ]: SQL status: SELECT 21 in 0.006 seconds
[0m09:44:49.083106 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_sales"
[0m09:44:49.085243 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:44:49.088169 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

      insert into "lab08_db"."dm"."dm_sales" ("load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru")
    (
        select "load_hour", "sale_custom_id", "event_timestamp", "sale_timestamp", "sale_item_cnt", "sale_browser", "sale_platform", "sale_page_before", "sale_source", "sale_utm_campaign", "sale_referer_url", "sale_referer_medium", "sale_utm_content", "sale_geo_country", "sale_geo_region_name", "sale_geo_latitude", "sale_geo_longitude", "sale_hour", "clear_sale_page_before", "sale_geo_region_name_ru", "clear_sale_page_before_ru"
        from "dm_sales__dbt_tmp094409322122"
    )


  
[0m09:44:49.096881 [debug] [Thread-4  ]: SQL status: INSERT 0 0 in 0.007 seconds
[0m09:44:49.112104 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m09:44:49.114363 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m09:44:49.115865 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: COMMIT
[0m09:44:49.126626 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m09:44:49.128791 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: Close
[0m09:44:49.130138 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8774742d60>]}
[0m09:44:49.132563 [info ] [Thread-4  ]: 6 of 6 OK created sql incremental model dm.dm_sales ............................ [[32mINSERT 0 0[0m in 39.88s]
[0m09:44:49.135266 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m09:44:56.127665 [debug] [Thread-3  ]: SQL status: SELECT 0 in 46.798 seconds
[0m09:44:56.136976 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:44:56.141421 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: BEGIN
[0m09:44:56.145222 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m09:44:56.145955 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:44:56.146647 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dm_events__dbt_tmp094409310978'
        
      order by ordinal_position

  
[0m09:44:56.167917 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.020 seconds
[0m09:44:56.188181 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:44:56.189302 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:44:56.199802 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.006 seconds
[0m09:44:56.220842 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:44:56.222568 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'dm_events'
        
        and table_schema = 'dm'
        
      order by ordinal_position

  
[0m09:44:56.230772 [debug] [Thread-3  ]: SQL status: SELECT 7 in 0.007 seconds
[0m09:44:56.234883 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.dm_events"
[0m09:44:56.236152 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:44:56.241184 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

      insert into "lab08_db"."dm"."dm_events" ("load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour")
    (
        select "load_hour", "event_id", "event_type", "event_timestamp", "browser_name", "device_type", "event_hour"
        from "dm_events__dbt_tmp094409310978"
    )


  
[0m09:44:56.245338 [debug] [Thread-3  ]: SQL status: INSERT 0 0 in 0.003 seconds
[0m09:44:56.249039 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m09:44:56.249672 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m09:44:56.250087 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: COMMIT
[0m09:44:56.255427 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m09:44:56.257602 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m09:44:56.261893 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24540e62-7b86-4145-a7ae-4ecc91f34577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877476fd60>]}
[0m09:44:56.264577 [info ] [Thread-3  ]: 5 of 6 OK created sql incremental model dm.dm_events ........................... [[32mINSERT 0 0[0m in 47.02s]
[0m09:44:56.269683 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
[0m09:44:56.274749 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:56.275541 [debug] [MainThread]: On master: BEGIN
[0m09:44:56.276225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:56.322287 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m09:44:56.323539 [debug] [MainThread]: On master: COMMIT
[0m09:44:56.324355 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:56.325055 [debug] [MainThread]: On master: COMMIT
[0m09:44:56.327147 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:44:56.328080 [debug] [MainThread]: On master: Close
[0m09:44:56.329251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:56.329922 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m09:44:56.330686 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m09:44:56.331318 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_events' was properly closed.
[0m09:44:56.331882 [debug] [MainThread]: Connection 'model.dbt_lab08_project.dm_sales' was properly closed.
[0m09:44:56.332657 [info ] [MainThread]: 
[0m09:44:56.334588 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 2 minutes and 52.36 seconds (172.36s).
[0m09:44:56.338399 [debug] [MainThread]: Command end result
[0m09:44:56.444530 [info ] [MainThread]: 
[0m09:44:56.447058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:56.449410 [info ] [MainThread]: 
[0m09:44:56.452804 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:44:56.455364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 174.55678, "process_user_time": 5.298063, "process_kernel_time": 0.416903, "process_mem_max_rss": "115548", "process_in_blocks": "1616", "process_out_blocks": "2288"}
[0m09:44:56.456396 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:56.456230 after 174.56 seconds
[0m09:44:56.457058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f877ab8f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87777db820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87778b7850>]}
[0m09:44:56.457673 [debug] [MainThread]: Flushing usage events
[0m10:05:39.597349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb64be28b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb64411f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb64792280>]}


============================== 10:05:39.619401 | c74f1215-1306-46c7-8321-2a9c893939be ==============================
[0m10:05:39.619401 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:05:39.630362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt_history/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt_history', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt_history --project-dir /dbt_history --vars {"start_date": "2025-04-30T08:00:00", "end_date": "2025-04-30T09:00:00"}', 'send_anonymous_usage_stats': 'True'}
[0m10:05:40.030865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61935520>]}
[0m10:05:40.170394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb63333ee0>]}
[0m10:05:40.171932 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:05:40.233089 [debug] [MainThread]: checksum: c0cdfccc6beef27a274fdb0dbb837a8f42f43179fc430dbb6362226b233be2a0, vars: {'end_date': '2025-04-30T09:00:00', 'start_date': '2025-04-30T08:00:00'}, profile: , target: , version: 1.8.7
[0m10:05:40.602698 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:05:40.604308 [debug] [MainThread]: previous checksum: c0cdfccc6beef27a274fdb0dbb837a8f42f43179fc430dbb6362226b233be2a0, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m10:05:40.605317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb63dcfa60>]}
[0m10:05:43.154465 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:05:43.159366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb632b02e0>]}
[0m10:05:44.130191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6123a640>]}
[0m10:05:44.407681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61171100>]}
[0m10:05:44.409081 [info ] [MainThread]: Found 6 models, 2 seeds, 15 data tests, 4 sources, 424 macros
[0m10:05:44.410227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb611954f0>]}
[0m10:05:44.413687 [info ] [MainThread]: 
[0m10:05:44.414531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:44.423638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m10:05:44.438750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m10:05:44.543566 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m10:05:44.544688 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m10:05:44.545956 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m10:05:44.546516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:44.545355 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m10:05:44.548071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:44.591422 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.045 seconds
[0m10:05:44.593782 [debug] [ThreadPool]: On list_lab08_db: Close
[0m10:05:44.594929 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.047 seconds
[0m10:05:44.597571 [debug] [ThreadPool]: On list_lab08_db: Close
[0m10:05:44.601421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m10:05:44.613554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m10:05:44.612950 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m10:05:44.621131 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m10:05:44.622002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:44.620108 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m10:05:44.623272 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m10:05:44.623751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:44.674785 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m10:05:44.676100 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m10:05:44.675464 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m10:05:44.677419 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m10:05:44.677937 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m10:05:44.676828 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m10:05:44.685883 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m10:05:44.688997 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m10:05:44.690443 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m10:05:44.692456 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m10:05:44.693673 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m10:05:44.696393 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m10:05:44.706233 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:44.707298 [debug] [MainThread]: On master: BEGIN
[0m10:05:44.707796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:44.738311 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m10:05:44.739333 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:44.740662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:05:44.751574 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m10:05:44.753466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb64bd6d90>]}
[0m10:05:44.754303 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:44.756808 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:44.757524 [debug] [MainThread]: On master: BEGIN
[0m10:05:44.761791 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:05:44.762706 [debug] [MainThread]: On master: COMMIT
[0m10:05:44.763248 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:44.763953 [debug] [MainThread]: On master: COMMIT
[0m10:05:44.766459 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:05:44.767291 [debug] [MainThread]: On master: Close
[0m10:05:44.768626 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m10:05:44.772274 [info ] [MainThread]: 
[0m10:05:44.778221 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m10:05:44.779169 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m10:05:44.779812 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m10:05:44.787029 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m10:05:44.781766 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m10:05:44.791945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_browser_events)
[0m10:05:44.785275 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m10:05:44.794102 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m10:05:44.794819 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m10:05:44.783651 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m10:05:44.802263 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_device_events)
[0m10:05:44.803484 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m10:05:44.792933 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m10:05:44.790542 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m10:05:44.804581 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m10:05:44.805649 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m10:05:44.843226 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m10:05:44.850938 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m10:05:44.871413 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m10:05:44.866272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m10:05:44.882290 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m10:05:44.886960 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m10:05:44.888024 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m10:05:44.884639 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m10:05:45.539568 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:05:45.560115 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp100545376424"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm >= '' and load_dttm < ''

  );
  
  
[0m10:05:45.559376 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:05:45.561378 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp100545376095"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm >= '' and load_dttm < ''

  );
  
  
[0m10:05:45.562073 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:05:45.560771 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:05:45.548574 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:05:45.581908 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp100545449681"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm >= '' and load_dttm < ''

  );
  
  
[0m10:05:45.582810 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:05:45.558600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:05:45.583770 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp100545407336"
  
  
    as
  
  (
    select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm >= '' and load_dttm < ''

  );
  
  
[0m10:05:45.584379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:45.650339 [debug] [Thread-4  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: ""
LINE 27:     where load_dttm >= '' and load_dttm < ''
                                ^

[0m10:05:45.651847 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m10:05:45.659843 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: ""
LINE 25:     where load_dttm >= '' and load_dttm < ''
                                ^

[0m10:05:45.663480 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m10:05:45.661965 [debug] [Thread-2  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: ""
LINE 26:     where load_dttm >= '' and load_dttm < ''
                                ^

[0m10:05:45.670213 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m10:05:45.674373 [debug] [Thread-2  ]: Database Error in model ods_device_events (models/ods/ods_device_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 26:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.677540 [debug] [Thread-4  ]: Database Error in model ods_location_events (models/ods/ods_location_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 27:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.667813 [debug] [Thread-1  ]: Database Error in model ods_browser_events (models/ods/ods_browser_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 25:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.687666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb613b0d00>]}
[0m10:05:45.682089 [debug] [Thread-3  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: ""
LINE 25:     where load_dttm >= '' and load_dttm < ''
                                ^

[0m10:05:45.694882 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m10:05:45.697595 [debug] [Thread-3  ]: Database Error in model ods_geo_events (models/ods/ods_geo_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 25:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.702403 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5bcf76a0>]}
[0m10:05:45.692781 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb5bcf7310>]}
[0m10:05:45.690988 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74f1215-1306-46c7-8321-2a9c893939be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61832790>]}
[0m10:05:45.699927 [error] [Thread-1  ]: 1 of 6 ERROR creating sql incremental model ods.ods_browser_events ............. [[31mERROR[0m in 0.89s]
[0m10:05:45.711474 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m10:05:45.705095 [error] [Thread-3  ]: 3 of 6 ERROR creating sql incremental model ods.ods_geo_events ................. [[31mERROR[0m in 0.91s]
[0m10:05:45.707001 [error] [Thread-2  ]: 2 of 6 ERROR creating sql incremental model ods.ods_device_events .............. [[31mERROR[0m in 0.88s]
[0m10:05:45.723885 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m10:05:45.709164 [error] [Thread-4  ]: 4 of 6 ERROR creating sql incremental model ods.ods_location_events ............ [[31mERROR[0m in 0.88s]
[0m10:05:45.727743 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m10:05:45.726289 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.dm_events
[0m10:05:45.729382 [info ] [Thread-1  ]: 5 of 6 SKIP relation dm.dm_events .............................................. [[33mSKIP[0m]
[0m10:05:45.721457 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m10:05:45.738934 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.dm_sales
[0m10:05:45.732865 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.dm_events
[0m10:05:45.740942 [info ] [Thread-2  ]: 6 of 6 SKIP relation dm.dm_sales ............................................... [[33mSKIP[0m]
[0m10:05:45.746657 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.dm_sales
[0m10:05:45.751115 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:45.752401 [debug] [MainThread]: On master: BEGIN
[0m10:05:45.754161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:05:45.805884 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m10:05:45.806808 [debug] [MainThread]: On master: COMMIT
[0m10:05:45.807646 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:45.808446 [debug] [MainThread]: On master: COMMIT
[0m10:05:45.811688 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:05:45.812885 [debug] [MainThread]: On master: Close
[0m10:05:45.814459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:45.815231 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_browser_events' was properly closed.
[0m10:05:45.815824 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_device_events' was properly closed.
[0m10:05:45.816506 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_geo_events' was properly closed.
[0m10:05:45.817327 [debug] [MainThread]: Connection 'model.dbt_lab08_project.ods_location_events' was properly closed.
[0m10:05:45.818066 [info ] [MainThread]: 
[0m10:05:45.819566 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m10:05:45.822671 [debug] [MainThread]: Command end result
[0m10:05:45.920593 [info ] [MainThread]: 
[0m10:05:45.923137 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m10:05:45.925403 [info ] [MainThread]: 
[0m10:05:45.927661 [error] [MainThread]:   Database Error in model ods_browser_events (models/ods/ods_browser_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 25:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.932201 [info ] [MainThread]: 
[0m10:05:45.934635 [error] [MainThread]:   Database Error in model ods_device_events (models/ods/ods_device_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 26:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.940017 [info ] [MainThread]: 
[0m10:05:45.942610 [error] [MainThread]:   Database Error in model ods_location_events (models/ods/ods_location_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 27:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.946013 [info ] [MainThread]: 
[0m10:05:45.948503 [error] [MainThread]:   Database Error in model ods_geo_events (models/ods/ods_geo_events.sql)
  invalid input syntax for type timestamp: ""
  LINE 25:     where load_dttm >= '' and load_dttm < ''
                                  ^
[0m10:05:45.952277 [info ] [MainThread]: 
[0m10:05:45.953914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=2 TOTAL=6
[0m10:05:45.955880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.474311, "process_user_time": 7.452705, "process_kernel_time": 0.490636, "process_mem_max_rss": "113204", "process_in_blocks": "336", "process_out_blocks": "3360", "command_success": false}
[0m10:05:45.956938 [debug] [MainThread]: Command `dbt run` failed at 10:05:45.956758 after 6.48 seconds
[0m10:05:45.957711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb63dcfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb614f7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb614f7a60>]}
[0m10:05:45.958341 [debug] [MainThread]: Flushing usage events
[0m10:12:36.333907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b64ba8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b84cebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b511dc40>]}


============================== 10:12:36.368855 | 27b620d9-e57b-4f9c-a12f-4e23aefb2842 ==============================
[0m10:12:36.368855 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:12:36.370967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt_history/logs', 'debug': 'False', 'profiles_dir': '/dbt_history', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /dbt_history --project-dir /dbt_history --vars {"start_date": "2025-04-30T08:00:00", "end_date": "2025-04-30T09:00:00"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:12:36.900175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b4b8c910>]}
[0m10:12:37.004852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b4b9daf0>]}
[0m10:12:37.006448 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:12:37.083113 [debug] [MainThread]: checksum: c0cdfccc6beef27a274fdb0dbb837a8f42f43179fc430dbb6362226b233be2a0, vars: {'end_date': '2025-04-30T09:00:00', 'start_date': '2025-04-30T08:00:00'}, profile: , target: , version: 1.8.7
[0m10:12:37.582232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m10:12:37.583418 [debug] [MainThread]: Partial parsing: updated file: dbt_lab08_project://models/ods/ods_browser_events.sql
[0m10:12:37.584189 [debug] [MainThread]: Partial parsing: updated file: dbt_lab08_project://models/ods/ods_location_events.sql
[0m10:12:37.584866 [debug] [MainThread]: Partial parsing: updated file: dbt_lab08_project://models/ods/ods_device_events.sql
[0m10:12:37.585619 [debug] [MainThread]: Partial parsing: updated file: dbt_lab08_project://models/dm/dm_sales.sql
[0m10:12:37.586382 [debug] [MainThread]: Partial parsing: updated file: dbt_lab08_project://models/ods/ods_geo_events.sql
[0m10:12:37.587200 [debug] [MainThread]: Partial parsing: updated file: dbt_lab08_project://models/dm/dm_events.sql
[0m10:12:38.533192 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:12:38.537046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b5d258e0>]}
[0m10:12:38.988551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b2b93f70>]}
[0m10:12:39.415296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b2b430a0>]}
[0m10:12:39.416223 [info ] [MainThread]: Found 2 seeds, 15 data tests, 6 models, 4 sources, 424 macros
[0m10:12:39.417700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b2b19c40>]}
[0m10:12:39.420883 [info ] [MainThread]: 
[0m10:12:39.422252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:39.431598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m10:12:39.552510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_lab08_db'
[0m10:12:39.639714 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m10:12:39.642442 [debug] [ThreadPool]: Using postgres connection "list_lab08_db"
[0m10:12:39.648102 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m10:12:39.648590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:39.643815 [debug] [ThreadPool]: On list_lab08_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db"} */

    select distinct nspname from pg_namespace
  
[0m10:12:39.649735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:39.690552 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.042 seconds
[0m10:12:39.693285 [debug] [ThreadPool]: On list_lab08_db: Close
[0m10:12:39.719108 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.069 seconds
[0m10:12:39.722547 [debug] [ThreadPool]: On list_lab08_db: Close
[0m10:12:39.728680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_dm)
[0m10:12:39.740547 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m10:12:39.741794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab08_db, now list_lab08_db_ods)
[0m10:12:39.743181 [debug] [ThreadPool]: On list_lab08_db_dm: BEGIN
[0m10:12:39.751674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:39.751153 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m10:12:39.753103 [debug] [ThreadPool]: On list_lab08_db_ods: BEGIN
[0m10:12:39.754017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:39.788095 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m10:12:39.788872 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_dm"
[0m10:12:39.789761 [debug] [ThreadPool]: On list_lab08_db_dm: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_dm"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dm'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dm'
  
[0m10:12:39.790773 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m10:12:39.791433 [debug] [ThreadPool]: Using postgres connection "list_lab08_db_ods"
[0m10:12:39.792471 [debug] [ThreadPool]: On list_lab08_db_ods: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "list_lab08_db_ods"} */
select
      'lab08_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ods'
    union all
    select
      'lab08_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ods'
  
[0m10:12:39.797646 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m10:12:39.800757 [debug] [ThreadPool]: On list_lab08_db_dm: ROLLBACK
[0m10:12:39.801744 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m10:12:39.803973 [debug] [ThreadPool]: On list_lab08_db_ods: ROLLBACK
[0m10:12:39.804487 [debug] [ThreadPool]: On list_lab08_db_dm: Close
[0m10:12:39.806826 [debug] [ThreadPool]: On list_lab08_db_ods: Close
[0m10:12:39.823956 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:39.826206 [debug] [MainThread]: On master: BEGIN
[0m10:12:39.826918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:39.861623 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m10:12:39.862678 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:39.863706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:39.874059 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m10:12:39.876395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b2cd5e50>]}
[0m10:12:39.877287 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:39.879777 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:39.881214 [debug] [MainThread]: On master: BEGIN
[0m10:12:39.886322 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:12:39.887303 [debug] [MainThread]: On master: COMMIT
[0m10:12:39.888003 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:39.889133 [debug] [MainThread]: On master: COMMIT
[0m10:12:39.892150 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:12:39.893154 [debug] [MainThread]: On master: Close
[0m10:12:39.894430 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m10:12:39.895602 [info ] [MainThread]: 
[0m10:12:39.899965 [debug] [Thread-1  ]: Began running node model.dbt_lab08_project.ods_browser_events
[0m10:12:39.901545 [info ] [Thread-1  ]: 1 of 6 START sql incremental model ods.ods_browser_events ...................... [RUN]
[0m10:12:39.902582 [debug] [Thread-2  ]: Began running node model.dbt_lab08_project.ods_device_events
[0m10:12:39.907520 [info ] [Thread-2  ]: 2 of 6 START sql incremental model ods.ods_device_events ....................... [RUN]
[0m10:12:39.909098 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_lab08_db_dm, now model.dbt_lab08_project.ods_device_events)
[0m10:12:39.909814 [debug] [Thread-2  ]: Began compiling node model.dbt_lab08_project.ods_device_events
[0m10:12:39.903137 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.ods_geo_events
[0m10:12:39.917763 [info ] [Thread-3  ]: 3 of 6 START sql incremental model ods.ods_geo_events .......................... [RUN]
[0m10:12:39.919173 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_geo_events'
[0m10:12:39.903705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_lab08_db_ods, now model.dbt_lab08_project.ods_browser_events)
[0m10:12:39.921431 [debug] [Thread-1  ]: Began compiling node model.dbt_lab08_project.ods_browser_events
[0m10:12:39.906303 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.ods_location_events
[0m10:12:39.922566 [info ] [Thread-4  ]: 4 of 6 START sql incremental model ods.ods_location_events ..................... [RUN]
[0m10:12:39.924089 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_lab08_project.ods_location_events'
[0m10:12:39.926173 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.ods_location_events
[0m10:12:39.920377 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.ods_geo_events
[0m10:12:39.965939 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_device_events"
[0m10:12:39.978141 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_browser_events"
[0m10:12:39.980757 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_location_events"
[0m10:12:39.984029 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.ods_location_events
[0m10:12:39.985092 [debug] [Thread-1  ]: Began executing node model.dbt_lab08_project.ods_browser_events
[0m10:12:39.986389 [debug] [Thread-2  ]: Began executing node model.dbt_lab08_project.ods_device_events
[0m10:12:39.995538 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.ods_geo_events"
[0m10:12:40.084727 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.ods_geo_events
[0m10:12:40.471082 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:12:40.510510 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

    
  
    

  create temporary table "ods_device_events__dbt_tmp101240215679"
  
  
    as
  
  (
    


select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'device_is_mobile')::bool as device_is_mobile,
    (json_data ->> 'user_domain_id')::uuid as user_domain_id,
    json_data ->> 'os' as os,
    json_data ->> 'os_name' as os_name,
    json_data ->> 'os_timezone' as os_timezone,
    json_data ->> 'device_type' as device_type,
    json_data ->> 'user_custom_id' as user_custom_id
from "lab08_db"."stg"."stg_device_events"


    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'

  );
  
  
[0m10:12:40.512730 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:12:40.456174 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:12:40.485653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:12:40.517225 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

    
  
    

  create temporary table "ods_browser_events__dbt_tmp101240198845"
  
  
    as
  
  (
    


select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    (json_data ->> 'event_timestamp')::timestamp as event_timestamp,
    (json_data ->> 'click_id')::uuid as click_id,
    json_data ->> 'event_type' as event_type,
    json_data ->> 'browser_name' as browser_name,
    json_data ->> 'browser_user_agent' as browser_user_agent,
    json_data ->> 'browser_language' as browser_language
from "lab08_db"."stg"."stg_browser_events"


    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'

  );
  
  
[0m10:12:40.500503 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:12:40.526587 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

    
  
    

  create temporary table "ods_geo_events__dbt_tmp101240306946"
  
  
    as
  
  (
    


select
    load_dttm as load_hour,
    (json_data ->> 'click_id')::uuid as click_id,
    (json_data ->> 'geo_latitude')::float as geo_latitude,
    (json_data ->> 'geo_longitude')::float as geo_longitude,
    json_data ->> 'geo_country' as geo_country,
    json_data ->> 'geo_timezone' as geo_timezone,
    json_data ->> 'geo_region_name' as geo_region_name,
    json_data ->> 'ip_address' as ip_address
from "lab08_db"."stg"."stg_geo_events"


    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'

  );
  
  
[0m10:12:40.533638 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:12:40.525379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:12:40.516042 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

    
  
    

  create temporary table "ods_location_events__dbt_tmp101240185349"
  
  
    as
  
  (
    


select
    load_dttm as load_hour,
    (json_data ->> 'event_id')::uuid as event_id,
    json_data ->> 'page_url' as page_url,
    json_data ->> 'page_url_path' as page_url_path,
    json_data ->> 'referer_url' as referer_url,
    json_data ->> 'referer_medium' as referer_medium,
    json_data ->> 'utm_medium' as utm_medium,
    json_data ->> 'utm_source' as utm_source,
    json_data ->> 'utm_content' as utm_content,
    json_data ->> 'utm_campaign' as utm_campaign
from "lab08_db"."stg"."stg_location_events"


    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'

  );
  
  
[0m10:12:40.536407 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:13:40.040304 [debug] [Thread-3  ]: SQL status: SELECT 12088 in 59.507 seconds
[0m10:13:40.075841 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:13:40.077671 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: BEGIN
[0m10:13:40.081107 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m10:13:40.081739 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:13:40.082269 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events__dbt_tmp101240306946'
        
      order by ordinal_position

  
[0m10:13:40.108159 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.025 seconds
[0m10:13:40.120649 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:13:40.121593 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:40.134303 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.012 seconds
[0m10:13:40.152739 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:13:40.153989 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_geo_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:40.164473 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.009 seconds
[0m10:13:40.187239 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_geo_events"
[0m10:13:40.188240 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:13:40.188792 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_geo_events"} */

      insert into "lab08_db"."ods"."ods_geo_events" ("load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address")
    (
        select "load_hour", "click_id", "geo_latitude", "geo_longitude", "geo_country", "geo_timezone", "geo_region_name", "ip_address"
        from "ods_geo_events__dbt_tmp101240306946"
    )


  
[0m10:13:40.242717 [debug] [Thread-3  ]: SQL status: INSERT 0 12088 in 0.053 seconds
[0m10:13:40.281355 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m10:13:40.282319 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.ods_geo_events"
[0m10:13:40.283268 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: COMMIT
[0m10:13:40.288381 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m10:13:40.294214 [debug] [Thread-3  ]: On model.dbt_lab08_project.ods_geo_events: Close
[0m10:13:40.298236 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b511dd60>]}
[0m10:13:40.299669 [info ] [Thread-3  ]: 3 of 6 OK created sql incremental model ods.ods_geo_events ..................... [[32mINSERT 0 12088[0m in 60.38s]
[0m10:13:40.301168 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.ods_geo_events
[0m10:13:44.665241 [debug] [Thread-4  ]: SQL status: SELECT 12088 in 64.129 seconds
[0m10:13:44.671608 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:13:44.672324 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: BEGIN
[0m10:13:44.692361 [debug] [Thread-2  ]: SQL status: SELECT 12088 in 64.180 seconds
[0m10:13:44.699840 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:13:44.700638 [debug] [Thread-4  ]: SQL status: BEGIN in 0.028 seconds
[0m10:13:44.707772 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:13:44.706988 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: BEGIN
[0m10:13:44.708357 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events__dbt_tmp101240185349'
        
      order by ordinal_position

  
[0m10:13:44.718759 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m10:13:44.719962 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:13:44.720791 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events__dbt_tmp101240215679'
        
      order by ordinal_position

  
[0m10:13:44.729613 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.016 seconds
[0m10:13:44.737917 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:13:44.738594 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:44.740890 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.019 seconds
[0m10:13:44.757661 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.018 seconds
[0m10:13:44.759784 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:13:44.773731 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:44.783890 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:13:44.784846 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_location_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:44.788359 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.006 seconds
[0m10:13:44.799012 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:13:44.799599 [debug] [Thread-4  ]: SQL status: SELECT 10 in 0.014 seconds
[0m10:13:44.800336 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_device_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:44.806930 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_location_events"
[0m10:13:44.815424 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:13:44.816336 [debug] [Thread-2  ]: SQL status: SELECT 9 in 0.008 seconds
[0m10:13:44.824856 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_device_events"
[0m10:13:44.818578 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_location_events"} */

      insert into "lab08_db"."ods"."ods_location_events" ("load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign")
    (
        select "load_hour", "event_id", "page_url", "page_url_path", "referer_url", "referer_medium", "utm_medium", "utm_source", "utm_content", "utm_campaign"
        from "ods_location_events__dbt_tmp101240185349"
    )


  
[0m10:13:44.826780 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:13:44.827760 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_device_events"} */

      insert into "lab08_db"."ods"."ods_device_events" ("load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id")
    (
        select "load_hour", "click_id", "device_is_mobile", "user_domain_id", "os", "os_name", "os_timezone", "device_type", "user_custom_id"
        from "ods_device_events__dbt_tmp101240215679"
    )


  
[0m10:13:44.867484 [debug] [Thread-4  ]: SQL status: INSERT 0 12088 in 0.041 seconds
[0m10:13:44.870167 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m10:13:44.871315 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.ods_location_events"
[0m10:13:44.872301 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: COMMIT
[0m10:13:44.877527 [debug] [Thread-2  ]: SQL status: INSERT 0 12088 in 0.049 seconds
[0m10:13:44.879897 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m10:13:44.880521 [debug] [Thread-2  ]: Using postgres connection "model.dbt_lab08_project.ods_device_events"
[0m10:13:44.881145 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: COMMIT
[0m10:13:44.893728 [debug] [Thread-4  ]: SQL status: COMMIT in 0.021 seconds
[0m10:13:44.895205 [debug] [Thread-4  ]: On model.dbt_lab08_project.ods_location_events: Close
[0m10:13:44.896281 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b2e7ed30>]}
[0m10:13:44.898087 [debug] [Thread-2  ]: SQL status: COMMIT in 0.016 seconds
[0m10:13:44.899476 [debug] [Thread-2  ]: On model.dbt_lab08_project.ods_device_events: Close
[0m10:13:44.901241 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b3146670>]}
[0m10:13:44.897422 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model ods.ods_location_events ................ [[32mINSERT 0 12088[0m in 64.97s]
[0m10:13:44.906545 [debug] [Thread-4  ]: Finished running node model.dbt_lab08_project.ods_location_events
[0m10:13:44.905286 [info ] [Thread-2  ]: 2 of 6 OK created sql incremental model ods.ods_device_events .................. [[32mINSERT 0 12088[0m in 64.99s]
[0m10:13:44.911376 [debug] [Thread-2  ]: Finished running node model.dbt_lab08_project.ods_device_events
[0m10:13:54.780413 [debug] [Thread-1  ]: SQL status: SELECT 12088 in 74.255 seconds
[0m10:13:54.788222 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:13:54.789165 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: BEGIN
[0m10:13:54.792520 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:13:54.793547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:13:54.794646 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events__dbt_tmp101240198845'
        
      order by ordinal_position

  
[0m10:13:54.807095 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.011 seconds
[0m10:13:54.815635 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:13:54.820291 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:54.829267 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.008 seconds
[0m10:13:54.839776 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:13:54.841162 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "lab08_db".INFORMATION_SCHEMA.columns
      where table_name = 'ods_browser_events'
        
        and table_schema = 'ods'
        
      order by ordinal_position

  
[0m10:13:54.848397 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.006 seconds
[0m10:13:54.853677 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_lab08_project.ods_browser_events"
[0m10:13:54.855711 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:13:54.856608 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.ods_browser_events"} */

      insert into "lab08_db"."ods"."ods_browser_events" ("load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language")
    (
        select "load_hour", "event_id", "event_timestamp", "click_id", "event_type", "browser_name", "browser_user_agent", "browser_language"
        from "ods_browser_events__dbt_tmp101240198845"
    )


  
[0m10:13:54.959161 [debug] [Thread-1  ]: SQL status: INSERT 0 12088 in 0.101 seconds
[0m10:13:54.962735 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m10:13:54.964043 [debug] [Thread-1  ]: Using postgres connection "model.dbt_lab08_project.ods_browser_events"
[0m10:13:54.965303 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: COMMIT
[0m10:13:54.985956 [debug] [Thread-1  ]: SQL status: COMMIT in 0.020 seconds
[0m10:13:54.988122 [debug] [Thread-1  ]: On model.dbt_lab08_project.ods_browser_events: Close
[0m10:13:54.989569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b3117cd0>]}
[0m10:13:54.990678 [info ] [Thread-1  ]: 1 of 6 OK created sql incremental model ods.ods_browser_events ................. [[32mINSERT 0 12088[0m in 75.09s]
[0m10:13:54.992139 [debug] [Thread-1  ]: Finished running node model.dbt_lab08_project.ods_browser_events
[0m10:13:54.993741 [debug] [Thread-3  ]: Began running node model.dbt_lab08_project.dm_events
[0m10:13:54.996543 [info ] [Thread-3  ]: 5 of 6 START sql incremental model dm.dm_events ................................ [RUN]
[0m10:13:54.995052 [debug] [Thread-4  ]: Began running node model.dbt_lab08_project.dm_sales
[0m10:13:55.000461 [info ] [Thread-4  ]: 6 of 6 START sql incremental model dm.dm_sales ................................. [RUN]
[0m10:13:55.002523 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_location_events, now model.dbt_lab08_project.dm_sales)
[0m10:13:54.998055 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_lab08_project.ods_geo_events, now model.dbt_lab08_project.dm_events)
[0m10:13:55.005381 [debug] [Thread-3  ]: Began compiling node model.dbt_lab08_project.dm_events
[0m10:13:55.003856 [debug] [Thread-4  ]: Began compiling node model.dbt_lab08_project.dm_sales
[0m10:13:55.025345 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_sales"
[0m10:13:55.029361 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_lab08_project.dm_events"
[0m10:13:55.031567 [debug] [Thread-3  ]: Began executing node model.dbt_lab08_project.dm_events
[0m10:13:55.032593 [debug] [Thread-4  ]: Began executing node model.dbt_lab08_project.dm_sales
[0m10:13:55.046718 [debug] [Thread-4  ]: Using postgres connection "model.dbt_lab08_project.dm_sales"
[0m10:13:55.050552 [debug] [Thread-4  ]: On model.dbt_lab08_project.dm_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_sales"} */

    
  
    

  create temporary table "dm_sales__dbt_tmp101355043863"
  
  
    as
  
  (
    


with unique_devices as (
    select distinct
        click_id,
        os,
        os_name,
        device_type,
        user_custom_id
    from "lab08_db"."ods"."ods_device_events"
),

unique_geo as (
    select distinct
        click_id,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude
    from "lab08_db"."ods"."ods_geo_events"
),

cte_lead as (
    select
        obe.load_hour,
        event_timestamp,
        event_type,
        page_url,
        page_url_path,
        referer_url,
        referer_medium,
        utm_medium,
        utm_source,
        utm_content,
        utm_campaign,
        browser_name,
        browser_user_agent,
        browser_language,
        os,
        os_name,
        user_custom_id,
        device_type,
        geo_country,
        geo_region_name,
        geo_latitude,
        geo_longitude,
        LEAD(page_url_path, 1) over w as next_page_lead1,
        LEAD(page_url_path, 2) over w as next_page_lead2,
        LEAD(page_url_path, 3) over w as next_page_lead3,
        LEAD(event_timestamp, 3) over w as confirmation_timestamp
    from "lab08_db"."ods"."ods_location_events" as ole
    inner join
        "lab08_db"."ods"."ods_browser_events" as obe
        on ole.event_id = obe.event_id
    inner join unique_devices as ud on obe.click_id = ud.click_id
    inner join unique_geo as ug on obe.click_id = ug.click_id
    where
        ole.page_url_path != '/home'
        
            and ole.load_hour >= '2025-04-30T08:00:00' and ole.load_hour < '2025-04-30T09:00:00'
            and obe.load_hour >= '2025-04-30T08:00:00' and obe.load_hour < '2025-04-30T09:00:00'
        
    window w as (
        partition by user_custom_id
        order by event_timestamp
    )
)

select
    load_hour,
    user_custom_id as sale_custom_id,
    event_timestamp,
    confirmation_timestamp as sale_timestamp,
    1 as sale_item_cnt,
    browser_name as sale_browser,
    device_type as sale_platform,
    page_url_path as sale_page_before,
    utm_source as sale_source,
    utm_campaign as sale_utm_campaign,
    referer_url as sale_referer_url,
    referer_medium as sale_referer_medium,
    utm_content as sale_utm_content,
    geo_country as sale_geo_country,
    geo_region_name as sale_geo_region_name,
    geo_latitude as sale_geo_latitude,
    geo_longitude as sale_geo_longitude,
    EXTRACT(hour from confirmation_timestamp) as sale_hour,
    REPLACE(page_url_path, '/product_', '') as clear_sale_page_before,
    COALESCE(ic.city_ru, '') as sale_geo_region_name_ru,
    COALESCE(i.item_ru, '') as clear_sale_page_before_ru
from cte_lead
left join "lab08_db"."ods"."italian_cities" as ic on ic.city_en = geo_region_name
left join
    "lab08_db"."ods"."items" as i
    on i.item_en = REPLACE(page_url_path, '/product_', '')
where
    (next_page_lead1, next_page_lead2, next_page_lead3)
    = ('/cart', '/payment', '/confirmation')
    and page_url_path not in ('/payment', '/cart', '/confirmation')
  );
  
  
[0m10:13:55.049439 [debug] [Thread-3  ]: Using postgres connection "model.dbt_lab08_project.dm_events"
[0m10:13:55.052951 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_lab08_project", "target_name": "prod", "node_id": "model.dbt_lab08_project.dm_events"} */

    
  
    

  create temporary table "dm_events__dbt_tmp101355037534"
  
  
    as
  
  (
    


with distinct_clicks as (
    select distinct
        click_id,
        device_type
    from "lab08_db"."ods"."ods_device_events"
)

select
    e.load_hour,
    e.event_id,
    e.event_type,
    e.event_timestamp,
    e.browser_name,
    d.device_type,
    EXTRACT(hour from e.event_timestamp) as event_hour
from "lab08_db"."ods"."ods_browser_events" as e
inner join distinct_clicks as d on e.click_id = d.click_id

    where load_dttm >= '2025-04-30T08:00:00' and load_dttm < '2025-04-30T09:00:00'

  );
  
  
[0m10:13:55.053572 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:13:55.051977 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:13:55.143913 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "load_dttm" does not exist
LINE 34:     where load_dttm >= '2025-04-30T08:00:00' and load_dttm <...
                   ^

[0m10:13:55.145216 [debug] [Thread-3  ]: On model.dbt_lab08_project.dm_events: Close
[0m10:13:55.159510 [debug] [Thread-3  ]: Database Error in model dm_events (models/dm/dm_events.sql)
  column "load_dttm" does not exist
  LINE 34:     where load_dttm >= '2025-04-30T08:00:00' and load_dttm <...
                     ^
[0m10:13:55.170037 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b620d9-e57b-4f9c-a12f-4e23aefb2842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b070bd30>]}
[0m10:13:55.171448 [error] [Thread-3  ]: 5 of 6 ERROR creating sql incremental model dm.dm_events ....................... [[31mERROR[0m in 0.17s]
[0m10:13:55.183740 [debug] [Thread-3  ]: Finished running node model.dbt_lab08_project.dm_events
